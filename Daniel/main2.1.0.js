function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}!function(t){var e=!1;if("function"==typeof define&&define.amd&&(define(t),e=!0),"object"==typeof exports&&(module.exports=t(),e=!0),!e){var i=window.Cookies,n=window.Cookies=t();n.noConflict=function(){return window.Cookies=i,n}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function e(i){function n(e,r,o){var s;if("undefined"!=typeof document){if(arguments.length>1){if(o=t({path:"/"},n.defaults,o),"number"==typeof o.expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*o.expires),o.expires=a}o.expires=o.expires?o.expires.toUTCString():"";try{s=JSON.stringify(r),/^[\{\[]/.test(s)&&(r=s)}catch(t){}r=i.write?i.write(r,e):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape);var u="";for(var l in o)o[l]&&(u+="; "+l,!0!==o[l]&&(u+="="+o[l]));return document.cookie=e+"="+r+u}e||(s={});for(var c=document.cookie?document.cookie.split("; "):[],h=/(%[0-9A-Z]{2})+/g,f=0;f<c.length;f++){var d=c[f].split("="),p=d.slice(1).join("=");this.json||'"'!==p.charAt(0)||(p=p.slice(1,-1));try{var m=d[0].replace(h,decodeURIComponent);if(p=i.read?i.read(p,m):i(p,m)||p.replace(h,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(t){}if(e===m){s=p;break}e||(s[m]=p)}catch(t){}}return s}}return n.set=n,n.get=function(t){return n.call(n,t)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(e,i){n(e,"",t(i,{expires:-1}))},n.withConverter=e,n}return e(function(){})}),function(t){t.cookie=function(t,e,i){return t?e?Cookies.set(t,e,i):""==e?Cookies.remove(t):Cookies.get(t):Cookies.get()},t.removeCookie=function(t){return!!t&&Cookies.remove(t)}}(jQuery),function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return r(i||t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){(function(e){"use strict";function i(t,e,i){t[e]||Object[n](t,e,{writable:!0,configurable:!0,value:i})}if(t(327),t(328),t(2),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var n="defineProperty";i(String.prototype,"padLeft","".padStart),i(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&i(Array,t,Function.call.bind([][t]))})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2,327:327,328:328}],2:[function(t,e,i){t(130),e.exports=t(23).RegExp.escape},{130:130,23:23}],3:[function(t,e,i){e.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},{}],4:[function(t,e,i){var n=t(18);e.exports=function(t,e){if("number"!=typeof t&&"Number"!=n(t))throw TypeError(e);return+t}},{18:18}],5:[function(t,e,i){var n=t(128)("unscopables"),r=Array.prototype;void 0==r[n]&&t(42)(r,n,{}),e.exports=function(t){r[n][t]=!0}},{128:128,42:42}],6:[function(t,e,i){e.exports=function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!");return t}},{}],7:[function(t,e,i){var n=t(51);e.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},{51:51}],8:[function(t,e,i){"use strict";var n=t(119),r=t(114),o=t(118);e.exports=[].copyWithin||function(t,e){var i=n(this),s=o(i.length),a=r(t,s),u=r(e,s),l=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===l?s:r(l,s))-u,s-a),h=1;for(u<a&&a<u+c&&(h=-1,u+=c-1,a+=c-1);c-- >0;)u in i?i[a]=i[u]:delete i[a],a+=h,u+=h;return i}},{114:114,118:118,119:119}],9:[function(t,e,i){"use strict";var n=t(119),r=t(114),o=t(118);e.exports=function(t){for(var e=n(this),i=o(e.length),s=arguments.length,a=r(s>1?arguments[1]:void 0,i),u=s>2?arguments[2]:void 0,l=void 0===u?i:r(u,i);l>a;)e[a++]=t;return e}},{114:114,118:118,119:119}],10:[function(t,e,i){var n=t(39);e.exports=function(t,e){var i=[];return n(t,!1,i.push,i,e),i}},{39:39}],11:[function(t,e,i){var n=t(117),r=t(118),o=t(114);e.exports=function(t){return function(e,i,s){var a,u=n(e),l=r(u.length),c=o(s,l);if(t&&i!=i){for(;l>c;)if((a=u[c++])!=a)return!0}else for(;l>c;c++)if((t||c in u)&&u[c]===i)return t||c||0;return!t&&-1}}},{114:114,117:117,118:118}],12:[function(t,e,i){var n=t(25),r=t(47),o=t(119),s=t(118),a=t(15);e.exports=function(t,e){var i=1==t,u=2==t,l=3==t,c=4==t,h=6==t,f=5==t||h,d=e||a;return function(e,a,p){for(var m,_,g=o(e),v=r(g),y=n(a,p,3),b=s(v.length),x=0,w=i?d(e,b):u?d(e,0):void 0;b>x;x++)if((f||x in v)&&(m=v[x],_=y(m,x,g),t))if(i)w[x]=_;else if(_)switch(t){case 3:return!0;case 5:return m;case 6:return x;case 2:w.push(m)}else if(c)return!1;return h?-1:l||c?c:w}}},{118:118,119:119,15:15,25:25,47:47}],13:[function(t,e,i){var n=t(3),r=t(119),o=t(47),s=t(118);e.exports=function(t,e,i,a,u){n(e);var l=r(t),c=o(l),h=s(l.length),f=u?h-1:0,d=u?-1:1;if(i<2)for(;;){if(f in c){a=c[f],f+=d;break}if(f+=d,u?f<0:h<=f)throw TypeError("Reduce of empty array with no initial value")}for(;u?f>=0:h>f;f+=d)f in c&&(a=e(a,c[f],f,l));return a}},{118:118,119:119,3:3,47:47}],14:[function(t,e,i){var n=t(51),r=t(49),o=t(128)("species");e.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),n(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},{128:128,49:49,51:51}],15:[function(t,e,i){var n=t(14);e.exports=function(t,e){return new(n(t))(e)}},{14:14}],16:[function(t,e,i){"use strict";var n=t(3),r=t(51),o=t(46),s=[].slice,a={},u=function(t,e,i){if(!(e in a)){for(var n=[],r=0;r<e;r++)n[r]="a["+r+"]";a[e]=Function("F,a","return new F("+n.join(",")+")")}return a[e](t,i)};e.exports=Function.bind||function(t){var e=n(this),i=s.call(arguments,1),a=function(){var n=i.concat(s.call(arguments));return this instanceof a?u(e,n.length,n):o(e,n,t)};return r(e.prototype)&&(a.prototype=e.prototype),a}},{3:3,46:46,51:51}],17:[function(t,e,i){var n=t(18),r=t(128)("toStringTag"),o="Arguments"==n(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};e.exports=function(t){var e,i,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=s(e=Object(t),r))?i:o?n(e):"Object"==(a=n(e))&&"function"==typeof e.callee?"Arguments":a}},{128:128,18:18}],18:[function(t,e,i){var n={}.toString;e.exports=function(t){return n.call(t).slice(8,-1)}},{}],19:[function(t,e,i){"use strict";var n=t(72).f,r=t(71),o=t(93),s=t(25),a=t(6),u=t(39),l=t(55),c=t(57),h=t(100),f=t(29),d=t(66).fastKey,p=t(125),m=f?"_s":"size",_=function(t,e){var i,n=d(e);if("F"!==n)return t._i[n];for(i=t._f;i;i=i.n)if(i.k==e)return i};e.exports={getConstructor:function(t,e,i,l){var c=t(function(t,n){a(t,c,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=n&&u(n,i,t[l],t)});return o(c.prototype,{clear:function(){for(var t=p(this,e),i=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var i=p(this,e),n=_(i,t);if(n){var r=n.n,o=n.p;delete i._i[n.i],n.r=!0,o&&(o.n=r),r&&(r.p=o),i._f==n&&(i._f=r),i._l==n&&(i._l=o),i[m]--}return!!n},forEach:function(t){p(this,e);for(var i,n=s(t,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(n(i.v,i.k,this);i&&i.r;)i=i.p},has:function(t){return!!_(p(this,e),t)}}),f&&n(c.prototype,"size",{get:function(){return p(this,e)[m]}}),c},def:function(t,e,i){var n,r,o=_(t,e);return o?o.v=i:(t._l=o={i:r=d(e,!0),k:e,v:i,p:n=t._l,n:void 0,r:!1},t._f||(t._f=o),n&&(n.n=o),t[m]++,"F"!==r&&(t._i[r]=o)),t},getEntry:_,setStrong:function(t,e,i){l(t,e,function(t,i){this._t=p(t,e),this._k=i,this._l=void 0},function(){for(var t=this,e=t._k,i=t._l;i&&i.r;)i=i.p;return t._t&&(t._l=i=i?i.n:t._t._f)?"keys"==e?c(0,i.k):"values"==e?c(0,i.v):c(0,[i.k,i.v]):(t._t=void 0,c(1))},i?"entries":"values",!i,!0),h(e)}}},{100:100,125:125,25:25,29:29,39:39,55:55,57:57,6:6,66:66,71:71,72:72,93:93}],20:[function(t,e,i){var n=t(17),r=t(10);e.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},{10:10,17:17}],21:[function(t,e,i){"use strict";var n=t(93),r=t(66).getWeak,o=t(7),s=t(51),a=t(6),u=t(39),l=t(12),c=t(41),h=t(125),f=l(5),d=l(6),p=0,m=function(t){return t._l||(t._l=new _)},_=function(){this.a=[]},g=function(t,e){return f(t.a,function(t){return t[0]===e})};_.prototype={get:function(t){var e=g(this,t);if(e)return e[1]},has:function(t){return!!g(this,t)},set:function(t,e){var i=g(this,t);i?i[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},e.exports={getConstructor:function(t,e,i,o){var l=t(function(t,n){a(t,l,e,"_i"),t._t=e,t._i=p++,t._l=void 0,void 0!=n&&u(n,i,t[o],t)});return n(l.prototype,{delete:function(t){if(!s(t))return!1;var i=r(t);return!0===i?m(h(this,e)).delete(t):i&&c(i,this._i)&&delete i[this._i]},has:function(t){if(!s(t))return!1;var i=r(t);return!0===i?m(h(this,e)).has(t):i&&c(i,this._i)}}),l},def:function(t,e,i){var n=r(o(e),!0);return!0===n?m(t).set(e,i):n[t._i]=i,t},ufstore:m}},{12:12,125:125,39:39,41:41,51:51,6:6,66:66,7:7,93:93}],22:[function(t,e,i){"use strict";var n=t(40),r=t(33),o=t(94),s=t(93),a=t(66),u=t(39),l=t(6),c=t(51),h=t(35),f=t(56),d=t(101),p=t(45);e.exports=function(t,e,i,m,_,g){var v=n[t],y=v,b=_?"set":"add",x=y&&y.prototype,w={},L=function(t){var e=x[t];o(x,t,"delete"==t?function(t){return!(g&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,i){return e.call(this,0===t?0:t,i),this})};if("function"==typeof y&&(g||x.forEach&&!h(function(){(new y).entries().next()}))){var S=new y,T=S[b](g?{}:-0,1)!=S,M=h(function(){S.has(1)}),E=f(function(t){new y(t)}),P=!g&&h(function(){for(var t=new y,e=5;e--;)t[b](e,e);return!t.has(-0)});E||(y=e(function(e,i){l(e,y,t);var n=p(new v,e,y);return void 0!=i&&u(i,_,n[b],n),n}),y.prototype=x,x.constructor=y),(M||P)&&(L("delete"),L("has"),_&&L("get")),(P||T)&&L(b),g&&x.clear&&delete x.clear}else y=m.getConstructor(e,t,_,b),s(y.prototype,i),a.NEED=!0;return d(y,t),w[t]=y,r(r.G+r.W+r.F*(y!=v),w),g||m.setStrong(y,t,_),y}},{101:101,33:33,35:35,39:39,40:40,45:45,51:51,56:56,6:6,66:66,93:93,94:94}],23:[function(t,e,i){var n=e.exports={version:"2.5.0"};"number"==typeof __e&&(__e=n)},{}],24:[function(t,e,i){"use strict";var n=t(72),r=t(92);e.exports=function(t,e,i){e in t?n.f(t,e,r(0,i)):t[e]=i}},{72:72,92:92}],25:[function(t,e,i){var n=t(3);e.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}}},{3:3}],26:[function(t,e,i){"use strict";var n=t(35),r=Date.prototype.getTime,o=Date.prototype.toISOString,s=function(t){return t>9?t:"0"+t};e.exports=n(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!n(function(){o.call(new Date(NaN))})?function(){if(!isFinite(r.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),i=t.getUTCMilliseconds(),n=e<0?"-":e>9999?"+":"";return n+("00000"+Math.abs(e)).slice(n?-6:-4)+"-"+s(t.getUTCMonth()+1)+"-"+s(t.getUTCDate())+"T"+s(t.getUTCHours())+":"+s(t.getUTCMinutes())+":"+s(t.getUTCSeconds())+"."+(i>99?i:"0"+s(i))+"Z"}:o},{35:35}],27:[function(t,e,i){"use strict";var n=t(7),r=t(120);e.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return r(n(this),"number"!=t)}},{120:120,7:7}],28:[function(t,e,i){e.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},{}],29:[function(t,e,i){e.exports=!t(35)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{35:35}],30:[function(t,e,i){var n=t(51),r=t(40).document,o=n(r)&&n(r.createElement);e.exports=function(t){return o?r.createElement(t):{}}},{40:40,51:51}],31:[function(t,e,i){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],32:[function(t,e,i){var n=t(81),r=t(78),o=t(82);e.exports=function(t){var e=n(t),i=r.f;if(i)for(var s,a=i(t),u=o.f,l=0;a.length>l;)u.call(t,s=a[l++])&&e.push(s);return e}},{78:78,81:81,82:82}],33:[function(t,e,i){var n=t(40),r=t(23),o=t(42),s=t(94),a=t(25),u=function(t,e,i){var l,c,h,f,d=t&u.F,p=t&u.G,m=t&u.S,_=t&u.P,g=t&u.B,v=p?n:m?n[e]||(n[e]={}):(n[e]||{}).prototype,y=p?r:r[e]||(r[e]={}),b=y.prototype||(y.prototype={});p&&(i=e);for(l in i)c=!d&&v&&void 0!==v[l],h=(c?v:i)[l],f=g&&c?a(h,n):_&&"function"==typeof h?a(Function.call,h):h,v&&s(v,l,h,t&u.U),y[l]!=h&&o(y,l,f),_&&b[l]!=h&&(b[l]=h)};n.core=r,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},{23:23,25:25,40:40,42:42,94:94}],34:[function(t,e,i){var n=t(128)("match");e.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},{128:128}],35:[function(t,e,i){e.exports=function(t){try{return!!t()}catch(t){return!0}}},{}],36:[function(t,e,i){"use strict";var n=t(42),r=t(94),o=t(35),s=t(28),a=t(128);e.exports=function(t,e,i){var u=a(t),l=i(s,u,""[t]),c=l[0],h=l[1];o(function(){var e={};return e[u]=function(){return 7},7!=""[t](e)})&&(r(String.prototype,t,c),n(RegExp.prototype,u,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},{128:128,28:28,35:35,42:42,94:94}],37:[function(t,e,i){"use strict";var n=t(7);e.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},{7:7}],38:[function(t,e,i){"use strict";function n(t,e,i,l,c,h,f,d){for(var p,m,_=c,g=0,v=!!f&&a(f,d,3);g<l;){if(g in i){if(p=v?v(i[g],g,e):i[g],m=!1,o(p)&&(m=p[u],m=void 0!==m?!!m:r(p)),m&&h>0)_=n(t,e,p,s(p.length),_,h-1)-1;else{if(_>=9007199254740991)throw TypeError();t[_]=p}_++}g++}return _}var r=t(49),o=t(51),s=t(118),a=t(25),u=t(128)("isConcatSpreadable");e.exports=n},{118:118,128:128,25:25,49:49,51:51}],39:[function(t,e,i){var n=t(25),r=t(53),o=t(48),s=t(7),a=t(118),u=t(129),l={},c={},i=e.exports=function(t,e,i,h,f){var d,p,m,_,g=f?function(){return t}:u(t),v=n(i,h,e?2:1),y=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(d=a(t.length);d>y;y++)if((_=e?v(s(p=t[y])[0],p[1]):v(t[y]))===l||_===c)return _}else for(m=g.call(t);!(p=m.next()).done;)if((_=r(m,v,p.value,e))===l||_===c)return _};i.BREAK=l,i.RETURN=c},{118:118,129:129,25:25,48:48,53:53,7:7}],40:[function(t,e,i){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],41:[function(t,e,i){var n={}.hasOwnProperty;e.exports=function(t,e){return n.call(t,e)}},{}],42:[function(t,e,i){var n=t(72),r=t(92);e.exports=t(29)?function(t,e,i){return n.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},{29:29,72:72,92:92}],43:[function(t,e,i){var n=t(40).document;e.exports=n&&n.documentElement},{40:40}],44:[function(t,e,i){e.exports=!t(29)&&!t(35)(function(){return 7!=Object.defineProperty(t(30)("div"),"a",{get:function(){return 7}}).a})},{29:29,30:30,35:35}],45:[function(t,e,i){var n=t(51),r=t(99).set;e.exports=function(t,e,i){var o,s=e.constructor;return s!==i&&"function"==typeof s&&(o=s.prototype)!==i.prototype&&n(o)&&r&&r(t,o),t}},{51:51,99:99}],46:[function(t,e,i){e.exports=function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},{}],47:[function(t,e,i){var n=t(18);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},{18:18}],48:[function(t,e,i){var n=t(58),r=t(128)("iterator"),o=Array.prototype;e.exports=function(t){return void 0!==t&&(n.Array===t||o[r]===t)}},{128:128,58:58}],49:[function(t,e,i){var n=t(18);e.exports=Array.isArray||function(t){return"Array"==n(t)}},{18:18}],50:[function(t,e,i){var n=t(51),r=Math.floor;e.exports=function(t){return!n(t)&&isFinite(t)&&r(t)===t}},{51:51}],51:[function(t,e,i){e.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},{}],52:[function(t,e,i){var n=t(51),r=t(18),o=t(128)("match");e.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},{128:128,18:18,51:51}],53:[function(t,e,i){var n=t(7);e.exports=function(t,e,i,r){try{return r?e(n(i)[0],i[1]):e(i)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},{7:7}],54:[function(t,e,i){"use strict";var n=t(71),r=t(92),o=t(101),s={};t(42)(s,t(128)("iterator"),function(){return this}),e.exports=function(t,e,i){t.prototype=n(s,{next:r(1,i)}),o(t,e+" Iterator")}},{101:101,128:128,42:42,71:71,92:92}],55:[function(t,e,i){"use strict";var n=t(60),r=t(33),o=t(94),s=t(42),a=t(41),u=t(58),l=t(54),c=t(101),h=t(79),f=t(128)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(t,e,i,m,_,g,v){l(i,e,m);var y,b,x,w=function(t){if(!d&&t in M)return M[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},L=e+" Iterator",S="values"==_,T=!1,M=t.prototype,E=M[f]||M["@@iterator"]||_&&M[_],P=E||w(_),C=_?S?w("entries"):P:void 0,A="Array"==e?M.entries||E:E;if(A&&(x=h(A.call(new t)))!==Object.prototype&&x.next&&(c(x,L,!0),n||a(x,f)||s(x,f,p)),S&&E&&"values"!==E.name&&(T=!0,P=function(){return E.call(this)}),n&&!v||!d&&!T&&M[f]||s(M,f,P),u[e]=P,u[L]=p,_)if(y={values:S?P:w("values"),keys:g?P:w("keys"),entries:C},v)for(b in y)b in M||o(M,b,y[b]);else r(r.P+r.F*(d||T),e,y);return y}},{101:101,128:128,33:33,41:41,42:42,54:54,58:58,60:60,79:79,94:94}],56:[function(t,e,i){var n=t(128)("iterator"),r=!1;try{var o=[7][n]();o.return=function(){r=!0},Array.from(o,function(){throw 2})}catch(t){}e.exports=function(t,e){if(!e&&!r)return!1;var i=!1;try{var o=[7],s=o[n]();s.next=function(){return{done:i=!0}},o[n]=function(){return s},t(o)}catch(t){}return i}},{128:128}],57:[function(t,e,i){e.exports=function(t,e){return{value:e,done:!!t}}},{}],58:[function(t,e,i){e.exports={}},{}],59:[function(t,e,i){var n=t(81),r=t(117);e.exports=function(t,e){for(var i,o=r(t),s=n(o),a=s.length,u=0;a>u;)if(o[i=s[u++]]===e)return i}},{117:117,81:81}],60:[function(t,e,i){e.exports=!1},{}],61:[function(t,e,i){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},{}],62:[function(t,e,i){var n=t(65),r=Math.pow,o=r(2,-52),s=r(2,-23),a=r(2,127)*(2-s),u=r(2,-126),l=function(t){return t+1/o-1/o};e.exports=Math.fround||function(t){var e,i,r=Math.abs(t),c=n(t);return r<u?c*l(r/u/s)*u*s:(e=(1+s/o)*r,i=e-(e-r),i>a||i!=i?c*(1/0):c*i)}},{65:65}],63:[function(t,e,i){e.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},{}],64:[function(t,e,i){e.exports=Math.scale||function(t,e,i,n,r){return 0===arguments.length||t!=t||e!=e||i!=i||n!=n||r!=r?NaN:t===1/0||t===-1/0?t:(t-e)*(r-n)/(i-e)+n}},{}],65:[function(t,e,i){e.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},{}],66:[function(t,e,i){var n=t(124)("meta"),r=t(51),o=t(41),s=t(72).f,a=0,u=Object.isExtensible||function(){return!0},l=!t(35)(function(){return u(Object.preventExtensions({}))}),c=function(t){s(t,n,{value:{i:"O"+ ++a,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!u(t))return"F";if(!e)return"E";c(t)}return t[n].i},f=function(t,e){if(!o(t,n)){if(!u(t))return!0;if(!e)return!1;c(t)}return t[n].w},d=function(t){return l&&p.NEED&&u(t)&&!o(t,n)&&c(t),t},p=e.exports={KEY:n,NEED:!1,fastKey:h,getWeak:f,onFreeze:d}},{124:124,35:35,41:41,51:51,72:72}],67:[function(t,e,i){var n=t(160),r=t(33),o=t(103)("metadata"),s=o.store||(o.store=new(t(266))),a=function(t,e,i){var r=s.get(t);if(!r){if(!i)return;s.set(t,r=new n)}var o=r.get(e);if(!o){if(!i)return;r.set(e,o=new n)}return o},u=function(t,e,i){var n=a(e,i,!1);return void 0!==n&&n.has(t)},l=function(t,e,i){var n=a(e,i,!1);return void 0===n?void 0:n.get(t)},c=function(t,e,i,n){a(i,n,!0).set(t,e)},h=function(t,e){var i=a(t,e,!1),n=[];return i&&i.forEach(function(t,e){n.push(e)}),n},f=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},d=function(t){r(r.S,"Reflect",t)};e.exports={store:s,map:a,has:u,get:l,set:c,keys:h,key:f,exp:d}},{103:103,160:160,266:266,33:33}],68:[function(t,e,i){var n=t(40),r=t(113).set,o=n.MutationObserver||n.WebKitMutationObserver,s=n.process,a=n.Promise,u="process"==t(18)(s);e.exports=function(){var t,e,i,l=function(){var n,r;for(u&&(n=s.domain)&&n.exit();t;){r=t.fn,t=t.next;try{r()}catch(n){throw t?i():e=void 0,n}}e=void 0,n&&n.enter()};if(u)i=function(){s.nextTick(l)};else if(o){var c=!0,h=document.createTextNode("");new o(l).observe(h,{characterData:!0}),i=function(){h.data=c=!c}}else if(a&&a.resolve){var f=a.resolve();i=function(){f.then(l)}}else i=function(){r.call(n,l)};return function(n){var r={fn:n,next:void 0};e&&(e.next=r),t||(t=r,i()),e=r}}},{113:113,18:18,40:40}],69:[function(t,e,i){"use strict";function n(t){var e,i;this.promise=new t(function(t,n){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=n}),this.resolve=r(e),this.reject=r(i)}var r=t(3);e.exports.f=function(t){return new n(t)}},{3:3}],70:[function(t,e,i){"use strict";var n=t(81),r=t(78),o=t(82),s=t(119),a=t(47),u=Object.assign;e.exports=!u||t(35)(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=u({},t)[i]||Object.keys(u({},e)).join("")!=n})?function(t,e){for(var i=s(t),u=arguments.length,l=1,c=r.f,h=o.f;u>l;)for(var f,d=a(arguments[l++]),p=c?n(d).concat(c(d)):n(d),m=p.length,_=0;m>_;)h.call(d,f=p[_++])&&(i[f]=d[f]);return i}:u},{119:119,35:35,47:47,78:78,81:81,82:82}],71:[function(t,e,i){var n=t(7),r=t(73),o=t(31),s=t(102)("IE_PROTO"),a=function(){},u=function(){var e,i=t(30)("iframe"),n=o.length;for(i.style.display="none",t(43).appendChild(i),i.src="javascript:",e=i.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u.prototype[o[n]];return u()};e.exports=Object.create||function(t,e){var i;return null!==t?(a.prototype=n(t),i=new a,a.prototype=null,i[s]=t):i=u(),void 0===e?i:r(i,e)}},{102:102,30:30,31:31,43:43,7:7,73:73}],72:[function(t,e,i){var n=t(7),r=t(44),o=t(120),s=Object.defineProperty;i.f=t(29)?Object.defineProperty:function(t,e,i){if(n(t),e=o(e,!0),n(i),r)try{return s(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},{120:120,29:29,44:44,7:7}],73:[function(t,e,i){var n=t(72),r=t(7),o=t(81);e.exports=t(29)?Object.defineProperties:function(t,e){r(t);for(var i,s=o(e),a=s.length,u=0;a>u;)n.f(t,i=s[u++],e[i]);return t}},{29:29,7:7,72:72,81:81}],74:[function(t,e,i){"use strict";e.exports=t(60)||!t(35)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete t(40)[e]})},{35:35,40:40,60:60}],75:[function(t,e,i){var n=t(82),r=t(92),o=t(117),s=t(120),a=t(41),u=t(44),l=Object.getOwnPropertyDescriptor;i.f=t(29)?l:function(t,e){if(t=o(t),e=s(e,!0),u)try{return l(t,e)}catch(t){}if(a(t,e))return r(!n.f.call(t,e),t[e])}},{117:117,120:120,29:29,41:41,44:44,82:82,92:92}],76:[function(t,e,i){var n=t(117),r=t(77).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return r(t)}catch(t){return s.slice()}};e.exports.f=function(t){return s&&"[object Window]"==o.call(t)?a(t):r(n(t))}},{117:117,77:77}],77:[function(t,e,i){var n=t(80),r=t(31).concat("length","prototype");i.f=Object.getOwnPropertyNames||function(t){return n(t,r)}},{31:31,80:80}],78:[function(t,e,i){i.f=Object.getOwnPropertySymbols},{}],79:[function(t,e,i){var n=t(41),r=t(119),o=t(102)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(t){return t=r(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},{102:102,119:119,41:41}],80:[function(t,e,i){var n=t(41),r=t(117),o=t(11)(!1),s=t(102)("IE_PROTO");e.exports=function(t,e){var i,a=r(t),u=0,l=[];for(i in a)i!=s&&n(a,i)&&l.push(i);for(;e.length>u;)n(a,i=e[u++])&&(~o(l,i)||l.push(i));return l}},{102:102,11:11,117:117,41:41}],81:[function(t,e,i){var n=t(80),r=t(31);e.exports=Object.keys||function(t){return n(t,r)}},{31:31,80:80}],82:[function(t,e,i){i.f={}.propertyIsEnumerable},{}],83:[function(t,e,i){var n=t(33),r=t(23),o=t(35);e.exports=function(t,e){var i=(r.Object||{})[t]||Object[t],s={};s[t]=e(i),n(n.S+n.F*o(function(){i(1)}),"Object",s)}},{23:23,33:33,35:35}],84:[function(t,e,i){var n=t(81),r=t(117),o=t(82).f;e.exports=function(t){return function(e){for(var i,s=r(e),a=n(s),u=a.length,l=0,c=[];u>l;)o.call(s,i=a[l++])&&c.push(t?[i,s[i]]:s[i]);return c}}},{117:117,81:81,82:82}],85:[function(t,e,i){var n=t(77),r=t(78),o=t(7),s=t(40).Reflect;e.exports=s&&s.ownKeys||function(t){var e=n.f(o(t)),i=r.f;return i?e.concat(i(t)):e}},{40:40,7:7,77:77,78:78}],86:[function(t,e,i){var n=t(40).parseFloat,r=t(111).trim;e.exports=1/n(t(112)+"-0")!=-1/0?function(t){var e=r(String(t),3),i=n(e);return 0===i&&"-"==e.charAt(0)?-0:i}:n},{111:111,112:112,40:40}],87:[function(t,e,i){var n=t(40).parseInt,r=t(111).trim,o=t(112),s=/^[-+]?0[xX]/;e.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(t,e){var i=r(String(t),3);return n(i,e>>>0||(s.test(i)?16:10))}:n},{111:111,112:112,40:40}],88:[function(t,e,i){"use strict";var n=t(89),r=t(46),o=t(3);e.exports=function(){for(var t=o(this),e=arguments.length,i=Array(e),s=0,a=n._,u=!1;e>s;)(i[s]=arguments[s++])===a&&(u=!0);return function(){var n,o=this,s=arguments.length,l=0,c=0;if(!u&&!s)return r(t,i,o);if(n=i.slice(),u)for(;e>l;l++)n[l]===a&&(n[l]=arguments[c++]);for(;s>c;)n.push(arguments[c++]);return r(t,n,o)}}},{3:3,46:46,89:89}],89:[function(t,e,i){e.exports=t(40)},{40:40}],90:[function(t,e,i){e.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},{}],91:[function(t,e,i){var n=t(69);e.exports=function(t,e){var i=n.f(t);return(0,i.resolve)(e),i.promise}},{69:69}],92:[function(t,e,i){e.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},{}],93:[function(t,e,i){var n=t(94);e.exports=function(t,e,i){for(var r in e)n(t,r,e[r],i);return t}},{94:94}],94:[function(t,e,i){var n=t(40),r=t(42),o=t(41),s=t(124)("src"),a=Function.toString,u=(""+a).split("toString");t(23).inspectSource=function(t){return a.call(t)},(e.exports=function(t,e,i,a){var l="function"==typeof i;l&&(o(i,"name")||r(i,"name",e)),t[e]!==i&&(l&&(o(i,s)||r(i,s,t[e]?""+t[e]:u.join(String(e)))),t===n?t[e]=i:a?t[e]?t[e]=i:r(t,e,i):(delete t[e],r(t,e,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},{124:124,23:23,40:40,41:41,42:42}],95:[function(t,e,i){e.exports=function(t,e){var i=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,i)}}},{}],96:[function(t,e,i){e.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},{}],97:[function(t,e,i){"use strict";var n=t(33),r=t(3),o=t(25),s=t(39);e.exports=function(t){n(n.S,t,{from:function(t){var e,i,n,a,u=arguments[1];return r(this),e=void 0!==u,e&&r(u),void 0==t?new this:(i=[],e?(n=0,a=o(u,arguments[2],2),s(t,!1,function(t){i.push(a(t,n++))})):s(t,!1,i.push,i),new this(i))}})}},{25:25,3:3,33:33,39:39}],98:[function(t,e,i){"use strict";var n=t(33);e.exports=function(t){n(n.S,t,{of:function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},{33:33}],99:[function(t,e,i){var n=t(51),r=t(7),o=function(t,e){if(r(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,i,n){try{n=t(25)(Function.call,t(75).f(Object.prototype,"__proto__").set,2),n(e,[]),i=!(e instanceof Array)}catch(t){i=!0}return function(t,e){return o(t,e),i?t.__proto__=e:n(t,e),t}}({},!1):void 0),check:o}},{25:25,51:51,7:7,75:75}],100:[function(t,e,i){"use strict";var n=t(40),r=t(72),o=t(29),s=t(128)("species");e.exports=function(t){var e=n[t];o&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},{128:128,29:29,40:40,72:72}],101:[function(t,e,i){var n=t(72).f,r=t(41),o=t(128)("toStringTag");e.exports=function(t,e,i){t&&!r(t=i?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},{128:128,41:41,72:72}],102:[function(t,e,i){var n=t(103)("keys"),r=t(124);e.exports=function(t){return n[t]||(n[t]=r(t))}},{103:103,124:124}],103:[function(t,e,i){var n=t(40),r=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(t){return r[t]||(r[t]={})}},{40:40}],104:[function(t,e,i){var n=t(7),r=t(3),o=t(128)("species");e.exports=function(t,e){var i,s=n(t).constructor;return void 0===s||void 0==(i=n(s)[o])?e:r(i)}},{128:128,3:3,7:7}],105:[function(t,e,i){"use strict";var n=t(35);e.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},{35:35}],106:[function(t,e,i){var n=t(116),r=t(28);e.exports=function(t){return function(e,i){var o,s,a=String(r(e)),u=n(i),l=a.length;return u<0||u>=l?t?"":void 0:(o=a.charCodeAt(u),o<55296||o>56319||u+1===l||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536)}}},{116:116,28:28}],107:[function(t,e,i){var n=t(52),r=t(28);e.exports=function(t,e,i){if(n(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(r(t))}},{28:28,52:52}],108:[function(t,e,i){var n=t(33),r=t(35),o=t(28),s=/"/g,a=function(t,e,i,n){var r=String(o(t)),a="<"+e;return""!==i&&(a+=" "+i+'="'+String(n).replace(s,"&quot;")+'"'),a+">"+r+"</"+e+">"};e.exports=function(t,e){var i={};i[t]=e(a),n(n.P+n.F*r(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",i)}},{28:28,33:33,35:35}],109:[function(t,e,i){var n=t(118),r=t(110),o=t(28);e.exports=function(t,e,i,s){var a=String(o(t)),u=a.length,l=void 0===i?" ":String(i),c=n(e);if(c<=u||""==l)return a;var h=c-u,f=r.call(l,Math.ceil(h/l.length));return f.length>h&&(f=f.slice(0,h)),s?f+a:a+f}},{110:110,118:118,28:28}],110:[function(t,e,i){"use strict";var n=t(116),r=t(28);e.exports=function(t){var e=String(r(this)),i="",o=n(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(i+=e);return i}},{116:116,28:28}],111:[function(t,e,i){var n=t(33),r=t(28),o=t(35),s=t(112),a="["+s+"]",u="​",l=RegExp("^"+a+a+"*"),c=RegExp(a+a+"*$"),h=function(t,e,i){var r={},a=o(function(){return!!s[t]()||u[t]()!=u}),l=r[t]=a?e(f):s[t];i&&(r[i]=l),n(n.P+n.F*a,"String",r)},f=h.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(c,"")),t};e.exports=h},{112:112,28:28,33:33,35:35}],112:[function(t,e,i){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},{}],113:[function(t,e,i){
var n,r,o,s=t(25),a=t(46),u=t(43),l=t(30),c=t(40),h=c.process,f=c.setImmediate,d=c.clearImmediate,p=c.MessageChannel,m=c.Dispatch,_=0,g={},v=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},y=function(t){v.call(t.data)};f&&d||(f=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return g[++_]=function(){a("function"==typeof t?t:Function(t),e)},n(_),_},d=function(t){delete g[t]},"process"==t(18)(h)?n=function(t){h.nextTick(s(v,t,1))}:m&&m.now?n=function(t){m.now(s(v,t,1))}:p?(r=new p,o=r.port2,r.port1.onmessage=y,n=s(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(t){c.postMessage(t+"","*")},c.addEventListener("message",y,!1)):n="onreadystatechange"in l("script")?function(t){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),v.call(t)}}:function(t){setTimeout(s(v,t,1),0)}),e.exports={set:f,clear:d}},{18:18,25:25,30:30,40:40,43:43,46:46}],114:[function(t,e,i){var n=t(116),r=Math.max,o=Math.min;e.exports=function(t,e){return t=n(t),t<0?r(t+e,0):o(t,e)}},{116:116}],115:[function(t,e,i){var n=t(116),r=t(118);e.exports=function(t){if(void 0===t)return 0;var e=n(t),i=r(e);if(e!==i)throw RangeError("Wrong length!");return i}},{116:116,118:118}],116:[function(t,e,i){var n=Math.ceil,r=Math.floor;e.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},{}],117:[function(t,e,i){var n=t(47),r=t(28);e.exports=function(t){return n(r(t))}},{28:28,47:47}],118:[function(t,e,i){var n=t(116),r=Math.min;e.exports=function(t){return t>0?r(n(t),9007199254740991):0}},{116:116}],119:[function(t,e,i){var n=t(28);e.exports=function(t){return Object(n(t))}},{28:28}],120:[function(t,e,i){var n=t(51);e.exports=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},{51:51}],121:[function(t,e,i){"use strict";if(t(29)){var n=t(60),r=t(40),o=t(35),s=t(33),a=t(123),u=t(122),l=t(25),c=t(6),h=t(92),f=t(42),d=t(93),p=t(116),m=t(118),_=t(115),g=t(114),v=t(120),y=t(41),b=t(17),x=t(51),w=t(119),L=t(48),S=t(71),T=t(79),M=t(77).f,E=t(129),P=t(124),C=t(128),A=t(12),k=t(11),z=t(104),I=t(141),R=t(58),O=t(56),F=t(100),D=t(9),j=t(8),N=t(72),B=t(75),U=N.f,Z=B.f,G=r.RangeError,q=r.TypeError,V=r.Uint8Array,W=Array.prototype,H=u.ArrayBuffer,Y=u.DataView,X=A(0),J=A(2),$=A(3),K=A(4),Q=A(5),tt=A(6),et=k(!0),it=k(!1),nt=I.values,rt=I.keys,ot=I.entries,st=W.lastIndexOf,at=W.reduce,ut=W.reduceRight,lt=W.join,ct=W.sort,ht=W.slice,ft=W.toString,dt=W.toLocaleString,pt=C("iterator"),mt=C("toStringTag"),_t=P("typed_constructor"),gt=P("def_constructor"),vt=a.CONSTR,yt=a.TYPED,bt=a.VIEW,xt=A(1,function(t,e){return Mt(z(t,t[gt]),e)}),wt=o(function(){return 1===new V(new Uint16Array([1]).buffer)[0]}),Lt=!!V&&!!V.prototype.set&&o(function(){new V(1).set({})}),St=function(t,e){var i=p(t);if(i<0||i%e)throw G("Wrong offset!");return i},Tt=function(t){if(x(t)&&yt in t)return t;throw q(t+" is not a typed array!")},Mt=function(t,e){if(!(x(t)&&_t in t))throw q("It is not a typed array constructor!");return new t(e)},Et=function(t,e){return Pt(z(t,t[gt]),e)},Pt=function(t,e){for(var i=0,n=e.length,r=Mt(t,n);n>i;)r[i]=e[i++];return r},Ct=function(t,e,i){U(t,e,{get:function(){return this._d[i]}})},At=function(t){var e,i,n,r,o,s,a=w(t),u=arguments.length,c=u>1?arguments[1]:void 0,h=void 0!==c,f=E(a);if(void 0!=f&&!L(f)){for(s=f.call(a),n=[],e=0;!(o=s.next()).done;e++)n.push(o.value);a=n}for(h&&u>2&&(c=l(c,arguments[2],2)),e=0,i=m(a.length),r=Mt(this,i);i>e;e++)r[e]=h?c(a[e],e):a[e];return r},kt=function(){for(var t=0,e=arguments.length,i=Mt(this,e);e>t;)i[t]=arguments[t++];return i},zt=!!V&&o(function(){dt.call(new V(1))}),It=function(){return dt.apply(zt?ht.call(Tt(this)):Tt(this),arguments)},Rt={copyWithin:function(t,e){return j.call(Tt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return K(Tt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return D.apply(Tt(this),arguments)},filter:function(t){return Et(this,J(Tt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Q(Tt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(Tt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){X(Tt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return it(Tt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(Tt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return lt.apply(Tt(this),arguments)},lastIndexOf:function(t){return st.apply(Tt(this),arguments)},map:function(t){return xt(Tt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return at.apply(Tt(this),arguments)},reduceRight:function(t){return ut.apply(Tt(this),arguments)},reverse:function(){for(var t,e=this,i=Tt(e).length,n=Math.floor(i/2),r=0;r<n;)t=e[r],e[r++]=e[--i],e[i]=t;return e},some:function(t){return $(Tt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ct.call(Tt(this),t)},subarray:function(t,e){var i=Tt(this),n=i.length,r=g(t,n);return new(z(i,i[gt]))(i.buffer,i.byteOffset+r*i.BYTES_PER_ELEMENT,m((void 0===e?n:g(e,n))-r))}},Ot=function(t,e){return Et(this,ht.call(Tt(this),t,e))},Ft=function(t){Tt(this);var e=St(arguments[1],1),i=this.length,n=w(t),r=m(n.length),o=0;if(r+e>i)throw G("Wrong length!");for(;o<r;)this[e+o]=n[o++]},Dt={entries:function(){return ot.call(Tt(this))},keys:function(){return rt.call(Tt(this))},values:function(){return nt.call(Tt(this))}},jt=function(t,e){return x(t)&&t[yt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Nt=function(t,e){return jt(t,e=v(e,!0))?h(2,t[e]):Z(t,e)},Bt=function(t,e,i){return!(jt(t,e=v(e,!0))&&x(i)&&y(i,"value"))||y(i,"get")||y(i,"set")||i.configurable||y(i,"writable")&&!i.writable||y(i,"enumerable")&&!i.enumerable?U(t,e,i):(t[e]=i.value,t)};vt||(B.f=Nt,N.f=Bt),s(s.S+s.F*!vt,"Object",{getOwnPropertyDescriptor:Nt,defineProperty:Bt}),o(function(){ft.call({})})&&(ft=dt=function(){return lt.call(this)});var Ut=d({},Rt);d(Ut,Dt),f(Ut,pt,Dt.values),d(Ut,{slice:Ot,set:Ft,constructor:function(){},toString:ft,toLocaleString:It}),Ct(Ut,"buffer","b"),Ct(Ut,"byteOffset","o"),Ct(Ut,"byteLength","l"),Ct(Ut,"length","e"),U(Ut,mt,{get:function(){return this[yt]}}),e.exports=function(t,e,i,u){u=!!u;var l=t+(u?"Clamped":"")+"Array",h="get"+t,d="set"+t,p=r[l],g=p||{},v=p&&T(p),y=!p||!a.ABV,w={},L=p&&p.prototype,E=function(t,i){var n=t._d;return n.v[h](i*e+n.o,wt)},P=function(t,i,n){var r=t._d;u&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),r.v[d](i*e+r.o,n,wt)},C=function(t,e){U(t,e,{get:function(){return E(this,e)},set:function(t){return P(this,e,t)},enumerable:!0})};y?(p=i(function(t,i,n,r){c(t,p,l,"_d");var o,s,a,u,h=0,d=0;if(x(i)){if(!(i instanceof H||"ArrayBuffer"==(u=b(i))||"SharedArrayBuffer"==u))return yt in i?Pt(p,i):At.call(p,i);o=i,d=St(n,e);var g=i.byteLength;if(void 0===r){if(g%e)throw G("Wrong length!");if((s=g-d)<0)throw G("Wrong length!")}else if((s=m(r)*e)+d>g)throw G("Wrong length!");a=s/e}else a=_(i),s=a*e,o=new H(s);for(f(t,"_d",{b:o,o:d,l:s,e:a,v:new Y(o)});h<a;)C(t,h++)}),L=p.prototype=S(Ut),f(L,"constructor",p)):o(function(){p(1)})&&o(function(){new p(-1)})&&O(function(t){new p,new p(null),new p(1.5),new p(t)},!0)||(p=i(function(t,i,n,r){c(t,p,l);var o;return x(i)?i instanceof H||"ArrayBuffer"==(o=b(i))||"SharedArrayBuffer"==o?void 0!==r?new g(i,St(n,e),r):void 0!==n?new g(i,St(n,e)):new g(i):yt in i?Pt(p,i):At.call(p,i):new g(_(i))}),X(v!==Function.prototype?M(g).concat(M(v)):M(g),function(t){t in p||f(p,t,g[t])}),p.prototype=L,n||(L.constructor=p));var A=L[pt],k=!!A&&("values"==A.name||void 0==A.name),z=Dt.values;f(p,_t,!0),f(L,yt,l),f(L,bt,!0),f(L,gt,p),(u?new p(1)[mt]==l:mt in L)||U(L,mt,{get:function(){return l}}),w[l]=p,s(s.G+s.W+s.F*(p!=g),w),s(s.S,l,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*o(function(){g.of.call(p,1)}),l,{from:At,of:kt}),"BYTES_PER_ELEMENT"in L||f(L,"BYTES_PER_ELEMENT",e),s(s.P,l,Rt),F(l),s(s.P+s.F*Lt,l,{set:Ft}),s(s.P+s.F*!k,l,Dt),n||L.toString==ft||(L.toString=ft),s(s.P+s.F*o(function(){new p(1).slice()}),l,{slice:Ot}),s(s.P+s.F*(o(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!o(function(){L.toLocaleString.call([1,2])})),l,{toLocaleString:It}),R[l]=k?A:z,n||k||f(L,pt,z)}}else e.exports=function(){}},{100:100,104:104,11:11,114:114,115:115,116:116,118:118,119:119,12:12,120:120,122:122,123:123,124:124,128:128,129:129,141:141,17:17,25:25,29:29,33:33,35:35,40:40,41:41,42:42,48:48,51:51,56:56,58:58,6:6,60:60,71:71,72:72,75:75,77:77,79:79,8:8,9:9,92:92,93:93}],122:[function(t,e,i){"use strict";function n(t,e,i){var n,r,o,s=Array(i),a=8*i-e-1,u=(1<<a)-1,l=u>>1,c=23===e?j(2,-24)-j(2,-77):0,h=0,f=t<0||0===t&&1/t<0?1:0;for(t=D(t),t!=t||t===O?(r=t!=t?1:0,n=u):(n=N(B(t)/U),t*(o=j(2,-n))<1&&(n--,o*=2),t+=n+l>=1?c/o:c*j(2,1-l),t*o>=2&&(n++,o/=2),n+l>=u?(r=0,n=u):n+l>=1?(r=(t*o-1)*j(2,e),n+=l):(r=t*j(2,l-1)*j(2,e),n=0));e>=8;s[h++]=255&r,r/=256,e-=8);for(n=n<<e|r,a+=e;a>0;s[h++]=255&n,n/=256,a-=8);return s[--h]|=128*f,s}function r(t,e,i){var n,r=8*i-e-1,o=(1<<r)-1,s=o>>1,a=r-7,u=i-1,l=t[u--],c=127&l;for(l>>=7;a>0;c=256*c+t[u],u--,a-=8);for(n=c&(1<<-a)-1,c>>=-a,a+=e;a>0;n=256*n+t[u],u--,a-=8);if(0===c)c=1-s;else{if(c===o)return n?NaN:l?-O:O;n+=j(2,e),c-=s}return(l?-1:1)*n*j(2,c-e)}function o(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function s(t){return[255&t]}function a(t){return[255&t,t>>8&255]}function u(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function l(t){return n(t,52,8)}function c(t){return n(t,23,4)}function h(t,e,i){M(t[C],e,{get:function(){return this[i]}})}function f(t,e,i,n){var r=+i,o=S(r);if(o+e>t[G])throw R(A);var s=t[Z]._b,a=o+t[q],u=s.slice(a,a+e);return n?u:u.reverse()}function d(t,e,i,n,r,o){var s=+i,a=S(s);if(a+e>t[G])throw R(A);for(var u=t[Z]._b,l=a+t[q],c=n(+r),h=0;h<e;h++)u[l+h]=c[o?h:e-h-1]}var p=t(40),m=t(29),_=t(60),g=t(123),v=t(42),y=t(93),b=t(35),x=t(6),w=t(116),L=t(118),S=t(115),T=t(77).f,M=t(72).f,E=t(9),P=t(101),C="prototype",A="Wrong index!",k=p.ArrayBuffer,z=p.DataView,I=p.Math,R=p.RangeError,O=p.Infinity,F=k,D=I.abs,j=I.pow,N=I.floor,B=I.log,U=I.LN2,Z=m?"_b":"buffer",G=m?"_l":"byteLength",q=m?"_o":"byteOffset";if(g.ABV){if(!b(function(){k(1)})||!b(function(){new k(-1)})||b(function(){return new k,new k(1.5),new k(NaN),"ArrayBuffer"!=k.name})){k=function(t){return x(this,k),new F(S(t))};for(var V,W=k[C]=F[C],H=T(F),Y=0;H.length>Y;)(V=H[Y++])in k||v(k,V,F[V]);_||(W.constructor=k)}var X=new z(new k(2)),J=z[C].setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||y(z[C],{setInt8:function(t,e){J.call(this,t,e<<24>>24)},setUint8:function(t,e){J.call(this,t,e<<24>>24)}},!0)}else k=function(t){x(this,k,"ArrayBuffer");var e=S(t);this._b=E.call(Array(e),0),this[G]=e},z=function(t,e,i){x(this,z,"DataView"),x(t,k,"DataView");var n=t[G],r=w(e);if(r<0||r>n)throw R("Wrong offset!");if(i=void 0===i?n-r:L(i),r+i>n)throw R("Wrong length!");this[Z]=t,this[q]=r,this[G]=i},m&&(h(k,"byteLength","_l"),h(z,"buffer","_b"),h(z,"byteLength","_l"),h(z,"byteOffset","_o")),y(z[C],{getInt8:function(t){return f(this,1,t)[0]<<24>>24},getUint8:function(t){return f(this,1,t)[0]},getInt16:function(t){var e=f(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=f(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return o(f(this,4,t,arguments[1]))},getUint32:function(t){return o(f(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return r(f(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return r(f(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){d(this,1,t,s,e)},setUint8:function(t,e){d(this,1,t,s,e)},setInt16:function(t,e){d(this,2,t,a,e,arguments[2])},setUint16:function(t,e){d(this,2,t,a,e,arguments[2])},setInt32:function(t,e){d(this,4,t,u,e,arguments[2])},setUint32:function(t,e){d(this,4,t,u,e,arguments[2])},setFloat32:function(t,e){d(this,4,t,c,e,arguments[2])},setFloat64:function(t,e){d(this,8,t,l,e,arguments[2])}});P(k,"ArrayBuffer"),P(z,"DataView"),v(z[C],g.VIEW,!0),i.ArrayBuffer=k,i.DataView=z},{101:101,115:115,116:116,118:118,123:123,29:29,35:35,40:40,42:42,6:6,60:60,72:72,77:77,9:9,93:93}],123:[function(t,e,i){for(var n,r=t(40),o=t(42),s=t(124),a=s("typed_array"),u=s("view"),l=!(!r.ArrayBuffer||!r.DataView),c=l,h=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(n=r[f[h++]])?(o(n.prototype,a,!0),o(n.prototype,u,!0)):c=!1;e.exports={ABV:l,CONSTR:c,TYPED:a,VIEW:u}},{124:124,40:40,42:42}],124:[function(t,e,i){var n=0,r=Math.random();e.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},{}],125:[function(t,e,i){var n=t(51);e.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},{51:51}],126:[function(t,e,i){var n=t(40),r=t(23),o=t(60),s=t(127),a=t(72).f;e.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},{127:127,23:23,40:40,60:60,72:72}],127:[function(t,e,i){i.f=t(128)},{128:128}],128:[function(t,e,i){var n=t(103)("wks"),r=t(124),o=t(40).Symbol,s="function"==typeof o;(e.exports=function(t){return n[t]||(n[t]=s&&o[t]||(s?o:r)("Symbol."+t))}).store=n},{103:103,124:124,40:40}],129:[function(t,e,i){var n=t(17),r=t(128)("iterator"),o=t(58);e.exports=t(23).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[n(t)]}},{128:128,17:17,23:23,58:58}],130:[function(t,e,i){var n=t(33),r=t(95)(/[\\^$*+?.()|[\]{}]/g,"\\$&");n(n.S,"RegExp",{escape:function(t){return r(t)}})},{33:33,95:95}],131:[function(t,e,i){var n=t(33);n(n.P,"Array",{copyWithin:t(8)}),t(5)("copyWithin")},{33:33,5:5,8:8}],132:[function(t,e,i){"use strict";var n=t(33),r=t(12)(4);n(n.P+n.F*!t(105)([].every,!0),"Array",{every:function(t){return r(this,t,arguments[1])}})},{105:105,12:12,33:33}],133:[function(t,e,i){var n=t(33);n(n.P,"Array",{fill:t(9)}),t(5)("fill")},{33:33,5:5,9:9}],134:[function(t,e,i){"use strict";var n=t(33),r=t(12)(2);n(n.P+n.F*!t(105)([].filter,!0),"Array",{filter:function(t){return r(this,t,arguments[1])}})},{105:105,12:12,33:33}],135:[function(t,e,i){"use strict";var n=t(33),r=t(12)(6),o="findIndex",s=!0;o in[]&&Array(1)[o](function(){s=!1}),n(n.P+n.F*s,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)(o)},{12:12,33:33,5:5}],136:[function(t,e,i){"use strict";var n=t(33),r=t(12)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),n(n.P+n.F*o,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)("find")},{12:12,33:33,5:5}],137:[function(t,e,i){"use strict";var n=t(33),r=t(12)(0),o=t(105)([].forEach,!0);n(n.P+n.F*!o,"Array",{forEach:function(t){return r(this,t,arguments[1])}})},{105:105,12:12,33:33}],138:[function(t,e,i){"use strict";var n=t(25),r=t(33),o=t(119),s=t(53),a=t(48),u=t(118),l=t(24),c=t(129);r(r.S+r.F*!t(56)(function(t){Array.from(t)}),"Array",{from:function(t){var e,i,r,h,f=o(t),d="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,_=void 0!==m,g=0,v=c(f);if(_&&(m=n(m,p>2?arguments[2]:void 0,2)),void 0==v||d==Array&&a(v))for(e=u(f.length),i=new d(e);e>g;g++)l(i,g,_?m(f[g],g):f[g]);else for(h=v.call(f),i=new d;!(r=h.next()).done;g++)l(i,g,_?s(h,m,[r.value,g],!0):r.value);return i.length=g,i}})},{118:118,119:119,129:129,24:24,25:25,33:33,48:48,53:53,56:56}],139:[function(t,e,i){"use strict";var n=t(33),r=t(11)(!1),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(s||!t(105)(o)),"Array",{indexOf:function(t){return s?o.apply(this,arguments)||0:r(this,t,arguments[1])}})},{105:105,11:11,33:33}],140:[function(t,e,i){var n=t(33);n(n.S,"Array",{isArray:t(49)})},{33:33,49:49}],141:[function(t,e,i){"use strict";var n=t(5),r=t(57),o=t(58),s=t(117);e.exports=t(55)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,i):"values"==e?r(0,t[i]):r(0,[i,t[i]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},{117:117,5:5,55:55,57:57,58:58}],142:[function(t,e,i){"use strict";var n=t(33),r=t(117),o=[].join;n(n.P+n.F*(t(47)!=Object||!t(105)(o)),"Array",{join:function(t){return o.call(r(this),void 0===t?",":t)}})},{105:105,117:117,33:33,47:47}],143:[function(t,e,i){"use strict";var n=t(33),r=t(117),o=t(116),s=t(118),a=[].lastIndexOf,u=!!a&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(u||!t(105)(a)),"Array",{lastIndexOf:function(t){if(u)return a.apply(this,arguments)||0;var e=r(this),i=s(e.length),n=i-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n<0&&(n=i+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}})},{105:105,116:116,117:117,118:118,33:33}],144:[function(t,e,i){"use strict";var n=t(33),r=t(12)(1);n(n.P+n.F*!t(105)([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},{105:105,12:12,33:33}],145:[function(t,e,i){"use strict";var n=t(33),r=t(24);n(n.S+n.F*t(35)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,i=new("function"==typeof this?this:Array)(e);e>t;)r(i,t,arguments[t++]);return i.length=e,i}})},{24:24,33:33,35:35}],146:[function(t,e,i){"use strict";var n=t(33),r=t(13);n(n.P+n.F*!t(105)([].reduceRight,!0),"Array",{reduceRight:function(t){return r(this,t,arguments.length,arguments[1],!0)}})},{105:105,13:13,33:33}],147:[function(t,e,i){"use strict";var n=t(33),r=t(13);n(n.P+n.F*!t(105)([].reduce,!0),"Array",{reduce:function(t){return r(this,t,arguments.length,arguments[1],!1)}})},{105:105,13:13,33:33}],148:[function(t,e,i){"use strict";var n=t(33),r=t(43),o=t(18),s=t(114),a=t(118),u=[].slice;n(n.P+n.F*t(35)(function(){r&&u.call(r)}),"Array",{slice:function(t,e){var i=a(this.length),n=o(this);if(e=void 0===e?i:e,"Array"==n)return u.call(this,t,e);for(var r=s(t,i),l=s(e,i),c=a(l-r),h=Array(c),f=0;f<c;f++)h[f]="String"==n?this.charAt(r+f):this[r+f];return h}})},{114:114,118:118,18:18,33:33,35:35,43:43}],149:[function(t,e,i){"use strict";var n=t(33),r=t(12)(3);n(n.P+n.F*!t(105)([].some,!0),"Array",{some:function(t){return r(this,t,arguments[1])}})},{105:105,12:12,33:33}],150:[function(t,e,i){"use strict";var n=t(33),r=t(3),o=t(119),s=t(35),a=[].sort,u=[1,2,3];n(n.P+n.F*(s(function(){u.sort(void 0)})||!s(function(){u.sort(null)})||!t(105)(a)),"Array",{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),r(t))}})},{105:105,119:119,3:3,33:33,35:35}],151:[function(t,e,i){t(100)("Array")},{100:100}],152:[function(t,e,i){var n=t(33);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},{33:33}],153:[function(t,e,i){var n=t(33),r=t(26);n(n.P+n.F*(Date.prototype.toISOString!==r),"Date",{toISOString:r})},{26:26,33:33}],154:[function(t,e,i){"use strict";var n=t(33),r=t(119),o=t(120);n(n.P+n.F*t(35)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=r(this),i=o(e);return"number"!=typeof i||isFinite(i)?e.toISOString():null}})},{119:119,120:120,33:33,35:35}],155:[function(t,e,i){var n=t(128)("toPrimitive"),r=Date.prototype;n in r||t(42)(r,n,t(27))},{128:128,27:27,42:42}],156:[function(t,e,i){var n=Date.prototype,r=n.toString,o=n.getTime;new Date(NaN)+""!="Invalid Date"&&t(94)(n,"toString",function(){var t=o.call(this);return t===t?r.call(this):"Invalid Date"})},{94:94}],157:[function(t,e,i){var n=t(33);n(n.P,"Function",{bind:t(16)})},{16:16,33:33}],158:[function(t,e,i){"use strict";var n=t(51),r=t(79),o=t(128)("hasInstance"),s=Function.prototype;o in s||t(72).f(s,o,{value:function(t){if("function"!=typeof this||!n(t))return!1;if(!n(this.prototype))return t instanceof this;for(;t=r(t);)if(this.prototype===t)return!0;return!1}})},{128:128,51:51,72:72,79:79}],159:[function(t,e,i){var n=t(72).f,r=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in r||t(29)&&n(r,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},{29:29,72:72}],160:[function(t,e,i){"use strict";var n=t(19),r=t(125);e.exports=t(22)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(r(this,"Map"),t);return e&&e.v},set:function(t,e){return n.def(r(this,"Map"),0===t?0:t,e)}},n,!0)},{125:125,19:19,22:22}],161:[function(t,e,i){var n=t(33),r=t(63),o=Math.sqrt,s=Math.acosh;n(n.S+n.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:r(t-1+o(t-1)*o(t+1))}})},{33:33,63:63}],162:[function(t,e,i){function n(t){return isFinite(t=+t)&&0!=t?t<0?-n(-t):Math.log(t+Math.sqrt(t*t+1)):t}var r=t(33),o=Math.asinh;r(r.S+r.F*!(o&&1/o(0)>0),"Math",{asinh:n})},{33:33}],163:[function(t,e,i){var n=t(33),r=Math.atanh;n(n.S+n.F*!(r&&1/r(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},{33:33}],164:[function(t,e,i){var n=t(33),r=t(65);n(n.S,"Math",{cbrt:function(t){return r(t=+t)*Math.pow(Math.abs(t),1/3)}})},{33:33,65:65}],165:[function(t,e,i){var n=t(33);n(n.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},{33:33}],166:[function(t,e,i){var n=t(33),r=Math.exp;n(n.S,"Math",{cosh:function(t){return(r(t=+t)+r(-t))/2}})},{33:33}],167:[function(t,e,i){var n=t(33),r=t(61);n(n.S+n.F*(r!=Math.expm1),"Math",{expm1:r})},{33:33,61:61}],168:[function(t,e,i){var n=t(33);n(n.S,"Math",{fround:t(62)})},{33:33,62:62}],169:[function(t,e,i){var n=t(33),r=Math.abs;n(n.S,"Math",{hypot:function(t,e){for(var i,n,o=0,s=0,a=arguments.length,u=0;s<a;)i=r(arguments[s++]),u<i?(n=u/i,o=o*n*n+1,u=i):i>0?(n=i/u,o+=n*n):o+=i;return u===1/0?1/0:u*Math.sqrt(o)}})},{33:33}],170:[function(t,e,i){var n=t(33),r=Math.imul;n(n.S+n.F*t(35)(function(){return-5!=r(4294967295,5)||2!=r.length}),"Math",{imul:function(t,e){var i=+t,n=+e,r=65535&i,o=65535&n;return 0|r*o+((65535&i>>>16)*o+r*(65535&n>>>16)<<16>>>0)}})},{33:33,35:35}],171:[function(t,e,i){var n=t(33);n(n.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},{33:33}],172:[function(t,e,i){var n=t(33);n(n.S,"Math",{log1p:t(63)})},{33:33,63:63}],173:[function(t,e,i){var n=t(33);n(n.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},{33:33}],174:[function(t,e,i){var n=t(33);n(n.S,"Math",{sign:t(65)})},{33:33,65:65}],175:[function(t,e,i){var n=t(33),r=t(61),o=Math.exp;n(n.S+n.F*t(35)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(r(t)-r(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},{33:33,35:35,61:61}],176:[function(t,e,i){var n=t(33),r=t(61),o=Math.exp;n(n.S,"Math",{tanh:function(t){var e=r(t=+t),i=r(-t);return e==1/0?1:i==1/0?-1:(e-i)/(o(t)+o(-t))}})},{33:33,61:61}],177:[function(t,e,i){var n=t(33);n(n.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},{33:33}],178:[function(t,e,i){"use strict";var n=t(40),r=t(41),o=t(18),s=t(45),a=t(120),u=t(35),l=t(77).f,c=t(75).f,h=t(72).f,f=t(111).trim,d=n.Number,p=d,m=d.prototype,_="Number"==o(t(71)(m)),g="trim"in String.prototype,v=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){e=g?e.trim():f(e,3);var i,n,r,o=e.charCodeAt(0);if(43===o||45===o){if(88===(i=e.charCodeAt(2))||120===i)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+e}for(var s,u=e.slice(2),l=0,c=u.length;l<c;l++)if((s=u.charCodeAt(l))<48||s>r)return NaN;return parseInt(u,n)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof d&&(_?u(function(){m.valueOf.call(i)}):"Number"!=o(i))?s(new p(v(e)),i,d):v(e)};for(var y,b=t(29)?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;b.length>x;x++)r(p,y=b[x])&&!r(d,y)&&h(d,y,c(p,y));d.prototype=m,m.constructor=d,t(94)(n,"Number",d)}},{111:111,120:120,18:18,29:29,35:35,40:40,41:41,45:45,71:71,72:72,75:75,77:77,94:94}],179:[function(t,e,i){var n=t(33);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},{33:33}],180:[function(t,e,i){var n=t(33),r=t(40).isFinite;n(n.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},{33:33,40:40}],181:[function(t,e,i){var n=t(33);n(n.S,"Number",{isInteger:t(50)})},{33:33,50:50}],182:[function(t,e,i){var n=t(33);n(n.S,"Number",{isNaN:function(t){return t!=t}})},{33:33}],183:[function(t,e,i){var n=t(33),r=t(50),o=Math.abs;n(n.S,"Number",{isSafeInteger:function(t){return r(t)&&o(t)<=9007199254740991}})},{33:33,50:50}],184:[function(t,e,i){var n=t(33);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{33:33}],185:[function(t,e,i){var n=t(33);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{33:33}],186:[function(t,e,i){var n=t(33),r=t(86);n(n.S+n.F*(Number.parseFloat!=r),"Number",{parseFloat:r})},{33:33,86:86}],187:[function(t,e,i){var n=t(33),r=t(87);n(n.S+n.F*(Number.parseInt!=r),"Number",{parseInt:r})},{33:33,87:87}],188:[function(t,e,i){"use strict";var n=t(33),r=t(116),o=t(4),s=t(110),a=1..toFixed,u=Math.floor,l=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",h=function(t,e){for(var i=-1,n=e;++i<6;)n+=t*l[i],l[i]=n%1e7,n=u(n/1e7)},f=function(t){for(var e=6,i=0;--e>=0;)i+=l[e],l[e]=u(i/t),i=i%t*1e7},d=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==l[t]){var i=String(l[t]);e=""===e?i:e+s.call("0",7-i.length)+i}return e},p=function(t,e,i){return 0===e?i:e%2==1?p(t,e-1,i*t):p(t*t,e/2,i)},m=function(t){for(var e=0,i=t;i>=4096;)e+=12,i/=4096;for(;i>=2;)e+=1,i/=2;return e};n(n.P+n.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!t(35)(function(){a.call({})})),"Number",{toFixed:function(t){var e,i,n,a,u=o(this,c),l=r(t),_="",g="0";if(l<0||l>20)throw RangeError(c);if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(_="-",u=-u),u>1e-21)if(e=m(u*p(2,69,1))-69,i=e<0?u*p(2,-e,1):u/p(2,e,1),i*=4503599627370496,(e=52-e)>0){for(h(0,i),n=l;n>=7;)h(1e7,0),n-=7;for(h(p(10,n,1),0),n=e-1;n>=23;)f(1<<23),n-=23;f(1<<n),h(1,1),f(2),g=d()}else h(0,i),h(1<<-e,0),g=d()+s.call("0",l);return l>0?(a=g.length,g=_+(a<=l?"0."+s.call("0",l-a)+g:g.slice(0,a-l)+"."+g.slice(a-l))):g=_+g,g}})},{110:110,116:116,33:33,35:35,4:4}],189:[function(t,e,i){"use strict";var n=t(33),r=t(35),o=t(4),s=1..toPrecision;n(n.P+n.F*(r(function(){return"1"!==s.call(1,void 0)})||!r(function(){s.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?s.call(e):s.call(e,t)}})},{33:33,35:35,4:4}],190:[function(t,e,i){var n=t(33);n(n.S+n.F,"Object",{assign:t(70)})},{33:33,70:70}],191:[function(t,e,i){var n=t(33);n(n.S,"Object",{create:t(71)})},{33:33,71:71}],192:[function(t,e,i){var n=t(33);n(n.S+n.F*!t(29),"Object",{defineProperties:t(73)})},{29:29,33:33,73:73}],193:[function(t,e,i){var n=t(33);n(n.S+n.F*!t(29),"Object",{defineProperty:t(72).f})},{29:29,33:33,72:72}],194:[function(t,e,i){var n=t(51),r=t(66).onFreeze;t(83)("freeze",function(t){return function(e){return t&&n(e)?t(r(e)):e}})},{51:51,66:66,83:83}],195:[function(t,e,i){var n=t(117),r=t(75).f;t(83)("getOwnPropertyDescriptor",function(){return function(t,e){return r(n(t),e)}})},{117:117,75:75,83:83}],196:[function(t,e,i){t(83)("getOwnPropertyNames",function(){return t(76).f})},{76:76,83:83}],197:[function(t,e,i){var n=t(119),r=t(79);t(83)("getPrototypeOf",function(){return function(t){return r(n(t))}})},{119:119,79:79,83:83}],198:[function(t,e,i){var n=t(51);t(83)("isExtensible",function(t){return function(e){return!!n(e)&&(!t||t(e))}})},{51:51,83:83}],199:[function(t,e,i){var n=t(51);t(83)("isFrozen",function(t){return function(e){return!n(e)||!!t&&t(e)}})},{51:51,83:83}],200:[function(t,e,i){var n=t(51);t(83)("isSealed",function(t){return function(e){return!n(e)||!!t&&t(e)}})},{51:51,83:83}],201:[function(t,e,i){var n=t(33);n(n.S,"Object",{is:t(96)})},{33:33,96:96}],202:[function(t,e,i){var n=t(119),r=t(81);t(83)("keys",function(){return function(t){return r(n(t))}})},{119:119,81:81,83:83}],203:[function(t,e,i){var n=t(51),r=t(66).onFreeze;t(83)("preventExtensions",function(t){return function(e){return t&&n(e)?t(r(e)):e}})},{51:51,66:66,83:83}],204:[function(t,e,i){var n=t(51),r=t(66).onFreeze;t(83)("seal",function(t){return function(e){return t&&n(e)?t(r(e)):e}})},{51:51,66:66,83:83}],205:[function(t,e,i){var n=t(33);n(n.S,"Object",{setPrototypeOf:t(99).set})},{33:33,99:99}],206:[function(t,e,i){"use strict";var n=t(17),r={};r[t(128)("toStringTag")]="z",r+""!="[object z]"&&t(94)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},{128:128,17:17,94:94}],207:[function(t,e,i){var n=t(33),r=t(86);n(n.G+n.F*(parseFloat!=r),{parseFloat:r})},{33:33,86:86}],208:[function(t,e,i){var n=t(33),r=t(87);n(n.G+n.F*(parseInt!=r),{parseInt:r})},{33:33,87:87}],209:[function(t,e,i){"use strict";var n,r,o,s,a=t(60),u=t(40),l=t(25),c=t(17),h=t(33),f=t(51),d=t(3),p=t(6),m=t(39),_=t(104),g=t(113).set,v=t(68)(),y=t(69),b=t(90),x=t(91),w=u.TypeError,L=u.process,S=u.Promise,T="process"==c(L),M=function(){},E=r=y.f,P=!!function(){try{var e=S.resolve(1),i=(e.constructor={})[t(128)("species")]=function(t){t(M,M)};return(T||"function"==typeof PromiseRejectionEvent)&&e.then(M)instanceof i}catch(t){}}(),C=a?function(t,e){return t===e||t===S&&e===s}:function(t,e){return t===e},A=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},k=function(t,e){if(!t._n){t._n=!0;var i=t._c;v(function(){for(var n=t._v,r=1==t._s,o=0;i.length>o;)!function(e){var i,o,s=r?e.ok:e.fail,a=e.resolve,u=e.reject,l=e.domain;try{s?(r||(2==t._h&&R(t),t._h=1),!0===s?i=n:(l&&l.enter(),i=s(n),l&&l.exit()),i===e.promise?u(w("Promise-chain cycle")):(o=A(i))?o.call(i,a,u):a(i)):u(n)}catch(t){u(t)}}(i[o++]);t._c=[],t._n=!1,e&&!t._h&&z(t)})}},z=function(t){g.call(u,function(){var e,i,n,r=t._v,o=I(t);if(o&&(e=b(function(){T?L.emit("unhandledRejection",r,t):(i=u.onunhandledrejection)?i({promise:t,reason:r}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",r)}),t._h=T||I(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},I=function(t){if(1==t._h)return!1;for(var e,i=t._a||t._c,n=0;i.length>n;)if(e=i[n++],e.fail||!I(e.promise))return!1;return!0},R=function(t){g.call(u,function(){var e;T?L.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},O=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),k(e,!0))},F=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw w("Promise can't be resolved itself");(e=A(t))?v(function(){var n={_w:i,_d:!1};try{e.call(t,l(F,n,1),l(O,n,1))}catch(t){O.call(n,t)}}):(i._v=t,i._s=1,k(i,!1))}catch(t){O.call({_w:i,_d:!1},t)}}};P||(S=function(t){p(this,S,"Promise","_h"),d(t),n.call(this);try{t(l(F,this,1),l(O,this,1))}catch(t){O.call(this,t)}},n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=t(93)(S.prototype,{then:function(t,e){var i=E(_(this,S));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=T?L.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&k(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new n;this.promise=t,this.resolve=l(F,t,1),this.reject=l(O,t,1)},y.f=E=function(t){return C(S,t)?new o(t):r(t)}),h(h.G+h.W+h.F*!P,{Promise:S}),t(101)(S,"Promise"),t(100)("Promise"),s=t(23).Promise,h(h.S+h.F*!P,"Promise",{reject:function(t){var e=E(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(a||!P),"Promise",{resolve:function(t){return t instanceof S&&C(t.constructor,this)?t:x(this,t)}}),h(h.S+h.F*!(P&&t(56)(function(t){
S.all(t).catch(M)})),"Promise",{all:function(t){var e=this,i=E(e),n=i.resolve,r=i.reject,o=b(function(){var i=[],o=0,s=1;m(t,!1,function(t){var a=o++,u=!1;i.push(void 0),s++,e.resolve(t).then(function(t){u||(u=!0,i[a]=t,--s||n(i))},r)}),--s||n(i)});return o.e&&r(o.v),i.promise},race:function(t){var e=this,i=E(e),n=i.reject,r=b(function(){m(t,!1,function(t){e.resolve(t).then(i.resolve,n)})});return r.e&&n(r.v),i.promise}})},{100:100,101:101,104:104,113:113,128:128,17:17,23:23,25:25,3:3,33:33,39:39,40:40,51:51,56:56,6:6,60:60,68:68,69:69,90:90,91:91,93:93}],210:[function(t,e,i){var n=t(33),r=t(3),o=t(7),s=(t(40).Reflect||{}).apply,a=Function.apply;n(n.S+n.F*!t(35)(function(){s(function(){})}),"Reflect",{apply:function(t,e,i){var n=r(t),u=o(i);return s?s(n,e,u):a.call(n,e,u)}})},{3:3,33:33,35:35,40:40,7:7}],211:[function(t,e,i){var n=t(33),r=t(71),o=t(3),s=t(7),a=t(51),u=t(35),l=t(16),c=(t(40).Reflect||{}).construct,h=u(function(){function t(){}return!(c(function(){},[],t)instanceof t)}),f=!u(function(){c(function(){})});n(n.S+n.F*(h||f),"Reflect",{construct:function(t,e){o(t),s(e);var i=arguments.length<3?t:o(arguments[2]);if(f&&!h)return c(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(l.apply(t,n))}var u=i.prototype,d=r(a(u)?u:Object.prototype),p=Function.apply.call(t,d,e);return a(p)?p:d}})},{16:16,3:3,33:33,35:35,40:40,51:51,7:7,71:71}],212:[function(t,e,i){var n=t(72),r=t(33),o=t(7),s=t(120);r(r.S+r.F*t(35)(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,i){o(t),e=s(e,!0),o(i);try{return n.f(t,e,i),!0}catch(t){return!1}}})},{120:120,33:33,35:35,7:7,72:72}],213:[function(t,e,i){var n=t(33),r=t(75).f,o=t(7);n(n.S,"Reflect",{deleteProperty:function(t,e){var i=r(o(t),e);return!(i&&!i.configurable)&&delete t[e]}})},{33:33,7:7,75:75}],214:[function(t,e,i){"use strict";var n=t(33),r=t(7),o=function(t){this._t=r(t),this._i=0;var e,i=this._k=[];for(e in t)i.push(e)};t(54)(o,"Object",function(){var t,e=this,i=e._k;do{if(e._i>=i.length)return{value:void 0,done:!0}}while(!((t=i[e._i++])in e._t));return{value:t,done:!1}}),n(n.S,"Reflect",{enumerate:function(t){return new o(t)}})},{33:33,54:54,7:7}],215:[function(t,e,i){var n=t(75),r=t(33),o=t(7);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return n.f(o(t),e)}})},{33:33,7:7,75:75}],216:[function(t,e,i){var n=t(33),r=t(79),o=t(7);n(n.S,"Reflect",{getPrototypeOf:function(t){return r(o(t))}})},{33:33,7:7,79:79}],217:[function(t,e,i){function n(t,e){var i,a,c=arguments.length<3?t:arguments[2];return l(t)===c?t[e]:(i=r.f(t,e))?s(i,"value")?i.value:void 0!==i.get?i.get.call(c):void 0:u(a=o(t))?n(a,e,c):void 0}var r=t(75),o=t(79),s=t(41),a=t(33),u=t(51),l=t(7);a(a.S,"Reflect",{get:n})},{33:33,41:41,51:51,7:7,75:75,79:79}],218:[function(t,e,i){var n=t(33);n(n.S,"Reflect",{has:function(t,e){return e in t}})},{33:33}],219:[function(t,e,i){var n=t(33),r=t(7),o=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(t){return r(t),!o||o(t)}})},{33:33,7:7}],220:[function(t,e,i){var n=t(33);n(n.S,"Reflect",{ownKeys:t(85)})},{33:33,85:85}],221:[function(t,e,i){var n=t(33),r=t(7),o=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(t){r(t);try{return o&&o(t),!0}catch(t){return!1}}})},{33:33,7:7}],222:[function(t,e,i){var n=t(33),r=t(99);r&&n(n.S,"Reflect",{setPrototypeOf:function(t,e){r.check(t,e);try{return r.set(t,e),!0}catch(t){return!1}}})},{33:33,99:99}],223:[function(t,e,i){function n(t,e,i){var u,f,d=arguments.length<4?t:arguments[3],p=o.f(c(t),e);if(!p){if(h(f=s(t)))return n(f,e,i,d);p=l(0)}return a(p,"value")?!(!1===p.writable||!h(d))&&(u=o.f(d,e)||l(0),u.value=i,r.f(d,e,u),!0):void 0!==p.set&&(p.set.call(d,i),!0)}var r=t(72),o=t(75),s=t(79),a=t(41),u=t(33),l=t(92),c=t(7),h=t(51);u(u.S,"Reflect",{set:n})},{33:33,41:41,51:51,7:7,72:72,75:75,79:79,92:92}],224:[function(t,e,i){var n=t(40),r=t(45),o=t(72).f,s=t(77).f,a=t(52),u=t(37),l=n.RegExp,c=l,h=l.prototype,f=/a/g,d=/a/g,p=new l(f)!==f;if(t(29)&&(!p||t(35)(function(){return d[t(128)("match")]=!1,l(f)!=f||l(d)==d||"/a/i"!=l(f,"i")}))){l=function(t,e){var i=this instanceof l,n=a(t),o=void 0===e;return!i&&n&&t.constructor===l&&o?t:r(p?new c(n&&!o?t.source:t,e):c((n=t instanceof l)?t.source:t,n&&o?u.call(t):e),i?this:h,l)};for(var m=s(c),_=0;m.length>_;)!function(t){t in l||o(l,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})}(m[_++]);h.constructor=l,l.prototype=h,t(94)(n,"RegExp",l)}t(100)("RegExp")},{100:100,128:128,29:29,35:35,37:37,40:40,45:45,52:52,72:72,77:77,94:94}],225:[function(t,e,i){t(29)&&"g"!=/./g.flags&&t(72).f(RegExp.prototype,"flags",{configurable:!0,get:t(37)})},{29:29,37:37,72:72}],226:[function(t,e,i){t(36)("match",1,function(t,e,i){return[function(i){"use strict";var n=t(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,n):new RegExp(i)[e](String(n))},i]})},{36:36}],227:[function(t,e,i){t(36)("replace",2,function(t,e,i){return[function(n,r){"use strict";var o=t(this),s=void 0==n?void 0:n[e];return void 0!==s?s.call(n,o,r):i.call(String(o),n,r)},i]})},{36:36}],228:[function(t,e,i){t(36)("search",1,function(t,e,i){return[function(i){"use strict";var n=t(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,n):new RegExp(i)[e](String(n))},i]})},{36:36}],229:[function(t,e,i){t(36)("split",2,function(e,i,n){"use strict";var r=t(52),o=n,s=[].push,a="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[a]||2!="ab".split(/(?:ab)*/)[a]||4!=".".split(/(.?)(.?)/)[a]||".".split(/()()/)[a]>1||"".split(/.?/)[a]){var u=void 0===/()??/.exec("")[1];n=function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return o.call(i,t,e);var n,l,c,h,f,d=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),m=0,_=void 0===e?4294967295:e>>>0,g=new RegExp(t.source,p+"g");for(u||(n=new RegExp("^"+g.source+"$(?!\\s)",p));(l=g.exec(i))&&!((c=l.index+l[0][a])>m&&(d.push(i.slice(m,l.index)),!u&&l[a]>1&&l[0].replace(n,function(){for(f=1;f<arguments[a]-2;f++)void 0===arguments[f]&&(l[f]=void 0)}),l[a]>1&&l.index<i[a]&&s.apply(d,l.slice(1)),h=l[0][a],m=c,d[a]>=_));)g.lastIndex===l.index&&g.lastIndex++;return m===i[a]?!h&&g.test("")||d.push(""):d.push(i.slice(m)),d[a]>_?d.slice(0,_):d}}else"0".split(void 0,0)[a]&&(n=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(t,r){var o=e(this),s=void 0==t?void 0:t[i];return void 0!==s?s.call(t,o,r):n.call(String(o),t,r)},n]})},{36:36,52:52}],230:[function(t,e,i){"use strict";t(225);var n=t(7),r=t(37),o=t(29),s=/./.toString,a=function(e){t(94)(RegExp.prototype,"toString",e,!0)};t(35)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?a(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?r.call(t):void 0)}):"toString"!=s.name&&a(function(){return s.call(this)})},{225:225,29:29,35:35,37:37,7:7,94:94}],231:[function(t,e,i){"use strict";var n=t(19),r=t(125);e.exports=t(22)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(r(this,"Set"),t=0===t?0:t,t)}},n)},{125:125,19:19,22:22}],232:[function(t,e,i){"use strict";t(108)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},{108:108}],233:[function(t,e,i){"use strict";t(108)("big",function(t){return function(){return t(this,"big","","")}})},{108:108}],234:[function(t,e,i){"use strict";t(108)("blink",function(t){return function(){return t(this,"blink","","")}})},{108:108}],235:[function(t,e,i){"use strict";t(108)("bold",function(t){return function(){return t(this,"b","","")}})},{108:108}],236:[function(t,e,i){"use strict";var n=t(33),r=t(106)(!1);n(n.P,"String",{codePointAt:function(t){return r(this,t)}})},{106:106,33:33}],237:[function(t,e,i){"use strict";var n=t(33),r=t(118),o=t(107),s="".endsWith;n(n.P+n.F*t(34)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),i=arguments.length>1?arguments[1]:void 0,n=r(e.length),a=void 0===i?n:Math.min(r(i),n),u=String(t);return s?s.call(e,u,a):e.slice(a-u.length,a)===u}})},{107:107,118:118,33:33,34:34}],238:[function(t,e,i){"use strict";t(108)("fixed",function(t){return function(){return t(this,"tt","","")}})},{108:108}],239:[function(t,e,i){"use strict";t(108)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},{108:108}],240:[function(t,e,i){"use strict";t(108)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},{108:108}],241:[function(t,e,i){var n=t(33),r=t(114),o=String.fromCharCode,s=String.fromCodePoint;n(n.S+n.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(t){for(var e,i=[],n=arguments.length,s=0;n>s;){if(e=+arguments[s++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");i.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return i.join("")}})},{114:114,33:33}],242:[function(t,e,i){"use strict";var n=t(33),r=t(107);n(n.P+n.F*t(34)("includes"),"String",{includes:function(t){return!!~r(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},{107:107,33:33,34:34}],243:[function(t,e,i){"use strict";t(108)("italics",function(t){return function(){return t(this,"i","","")}})},{108:108}],244:[function(t,e,i){"use strict";var n=t(106)(!0);t(55)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})})},{106:106,55:55}],245:[function(t,e,i){"use strict";t(108)("link",function(t){return function(e){return t(this,"a","href",e)}})},{108:108}],246:[function(t,e,i){var n=t(33),r=t(117),o=t(118);n(n.S,"String",{raw:function(t){for(var e=r(t.raw),i=o(e.length),n=arguments.length,s=[],a=0;i>a;)s.push(String(e[a++])),a<n&&s.push(String(arguments[a]));return s.join("")}})},{117:117,118:118,33:33}],247:[function(t,e,i){var n=t(33);n(n.P,"String",{repeat:t(110)})},{110:110,33:33}],248:[function(t,e,i){"use strict";t(108)("small",function(t){return function(){return t(this,"small","","")}})},{108:108}],249:[function(t,e,i){"use strict";var n=t(33),r=t(118),o=t(107),s="".startsWith;n(n.P+n.F*t(34)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),i=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return s?s.call(e,n,i):e.slice(i,i+n.length)===n}})},{107:107,118:118,33:33,34:34}],250:[function(t,e,i){"use strict";t(108)("strike",function(t){return function(){return t(this,"strike","","")}})},{108:108}],251:[function(t,e,i){"use strict";t(108)("sub",function(t){return function(){return t(this,"sub","","")}})},{108:108}],252:[function(t,e,i){"use strict";t(108)("sup",function(t){return function(){return t(this,"sup","","")}})},{108:108}],253:[function(t,e,i){"use strict";t(111)("trim",function(t){return function(){return t(this,3)}})},{111:111}],254:[function(t,e,i){"use strict";var n=t(40),r=t(41),o=t(29),s=t(33),a=t(94),u=t(66).KEY,l=t(35),c=t(103),h=t(101),f=t(124),d=t(128),p=t(127),m=t(126),_=t(59),g=t(32),v=t(49),y=t(7),b=t(117),x=t(120),w=t(92),L=t(71),S=t(76),T=t(75),M=t(72),E=t(81),P=T.f,C=M.f,A=S.f,k=n.Symbol,z=n.JSON,I=z&&z.stringify,R=d("_hidden"),O=d("toPrimitive"),F={}.propertyIsEnumerable,D=c("symbol-registry"),j=c("symbols"),N=c("op-symbols"),B=Object.prototype,U="function"==typeof k,Z=n.QObject,G=!Z||!Z.prototype||!Z.prototype.findChild,q=o&&l(function(){return 7!=L(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=P(B,e);n&&delete B[e],C(t,e,i),n&&t!==B&&C(B,e,n)}:C,V=function(t){var e=j[t]=L(k.prototype);return e._k=t,e},W=U&&"symbol"==typeof k.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof k},H=function(t,e,i){return t===B&&H(N,e,i),y(t),e=x(e,!0),y(i),r(j,e)?(i.enumerable?(r(t,R)&&t[R][e]&&(t[R][e]=!1),i=L(i,{enumerable:w(0,!1)})):(r(t,R)||C(t,R,w(1,{})),t[R][e]=!0),q(t,e,i)):C(t,e,i)},Y=function(t,e){y(t);for(var i,n=g(e=b(e)),r=0,o=n.length;o>r;)H(t,i=n[r++],e[i]);return t},X=function(t,e){return void 0===e?L(t):Y(L(t),e)},J=function(t){var e=F.call(this,t=x(t,!0));return!(this===B&&r(j,t)&&!r(N,t))&&(!(e||!r(this,t)||!r(j,t)||r(this,R)&&this[R][t])||e)},$=function(t,e){if(t=b(t),e=x(e,!0),t!==B||!r(j,e)||r(N,e)){var i=P(t,e);return!i||!r(j,e)||r(t,R)&&t[R][e]||(i.enumerable=!0),i}},K=function(t){for(var e,i=A(b(t)),n=[],o=0;i.length>o;)r(j,e=i[o++])||e==R||e==u||n.push(e);return n},Q=function(t){for(var e,i=t===B,n=A(i?N:b(t)),o=[],s=0;n.length>s;)!r(j,e=n[s++])||i&&!r(B,e)||o.push(j[e]);return o};U||(k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(i){this===B&&e.call(N,i),r(this,R)&&r(this[R],t)&&(this[R][t]=!1),q(this,t,w(1,i))};return o&&G&&q(B,t,{configurable:!0,set:e}),V(t)},a(k.prototype,"toString",function(){return this._k}),T.f=$,M.f=H,t(77).f=S.f=K,t(82).f=J,t(78).f=Q,o&&!t(60)&&a(B,"propertyIsEnumerable",J,!0),p.f=function(t){return V(d(t))}),s(s.G+s.W+s.F*!U,{Symbol:k});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)d(tt[et++]);for(var it=E(d.store),nt=0;it.length>nt;)m(it[nt++]);s(s.S+s.F*!U,"Symbol",{for:function(t){return r(D,t+="")?D[t]:D[t]=k(t)},keyFor:function(t){if(W(t))return _(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){G=!0},useSimple:function(){G=!1}}),s(s.S+s.F*!U,"Object",{create:X,defineProperty:H,defineProperties:Y,getOwnPropertyDescriptor:$,getOwnPropertyNames:K,getOwnPropertySymbols:Q}),z&&s(s.S+s.F*(!U||l(function(){var t=k();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!W(t)){for(var e,i,n=[t],r=1;arguments.length>r;)n.push(arguments[r++]);return e=n[1],"function"==typeof e&&(i=e),!i&&v(e)||(e=function(t,e){if(i&&(e=i.call(this,t,e)),!W(e))return e}),n[1]=e,I.apply(z,n)}}}),k.prototype[O]||t(42)(k.prototype,O,k.prototype.valueOf),h(k,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},{101:101,103:103,117:117,120:120,124:124,126:126,127:127,128:128,29:29,32:32,33:33,35:35,40:40,41:41,42:42,49:49,59:59,60:60,66:66,7:7,71:71,72:72,75:75,76:76,77:77,78:78,81:81,82:82,92:92,94:94}],255:[function(t,e,i){"use strict";var n=t(33),r=t(123),o=t(122),s=t(7),a=t(114),u=t(118),l=t(51),c=t(40).ArrayBuffer,h=t(104),f=o.ArrayBuffer,d=o.DataView,p=r.ABV&&c.isView,m=f.prototype.slice,_=r.VIEW;n(n.G+n.W+n.F*(c!==f),{ArrayBuffer:f}),n(n.S+n.F*!r.CONSTR,"ArrayBuffer",{isView:function(t){return p&&p(t)||l(t)&&_ in t}}),n(n.P+n.U+n.F*t(35)(function(){return!new f(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==m&&void 0===e)return m.call(s(this),t);for(var i=s(this).byteLength,n=a(t,i),r=a(void 0===e?i:e,i),o=new(h(this,f))(u(r-n)),l=new d(this),c=new d(o),p=0;n<r;)c.setUint8(p++,l.getUint8(n++));return o}}),t(100)("ArrayBuffer")},{100:100,104:104,114:114,118:118,122:122,123:123,33:33,35:35,40:40,51:51,7:7}],256:[function(t,e,i){var n=t(33);n(n.G+n.W+n.F*!t(123).ABV,{DataView:t(122).DataView})},{122:122,123:123,33:33}],257:[function(t,e,i){t(121)("Float32",4,function(t){return function(e,i,n){return t(this,e,i,n)}})},{121:121}],258:[function(t,e,i){t(121)("Float64",8,function(t){return function(e,i,n){return t(this,e,i,n)}})},{121:121}],259:[function(t,e,i){t(121)("Int16",2,function(t){return function(e,i,n){return t(this,e,i,n)}})},{121:121}],260:[function(t,e,i){t(121)("Int32",4,function(t){return function(e,i,n){return t(this,e,i,n)}})},{121:121}],261:[function(t,e,i){t(121)("Int8",1,function(t){return function(e,i,n){return t(this,e,i,n)}})},{121:121}],262:[function(t,e,i){t(121)("Uint16",2,function(t){return function(e,i,n){return t(this,e,i,n)}})},{121:121}],263:[function(t,e,i){t(121)("Uint32",4,function(t){return function(e,i,n){return t(this,e,i,n)}})},{121:121}],264:[function(t,e,i){t(121)("Uint8",1,function(t){return function(e,i,n){return t(this,e,i,n)}})},{121:121}],265:[function(t,e,i){t(121)("Uint8",1,function(t){return function(e,i,n){return t(this,e,i,n)}},!0)},{121:121}],266:[function(t,e,i){"use strict";var n,r=t(12)(0),o=t(94),s=t(66),a=t(70),u=t(21),l=t(51),c=t(35),h=t(125),f=s.getWeak,d=Object.isExtensible,p=u.ufstore,m={},_=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},g={get:function(t){if(l(t)){var e=f(t);return!0===e?p(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(h(this,"WeakMap"),t,e)}},v=e.exports=t(22)("WeakMap",_,g,u,!0,!0);c(function(){return 7!=(new v).set((Object.freeze||Object)(m),7).get(m)})&&(n=u.getConstructor(_,"WeakMap"),a(n.prototype,g),s.NEED=!0,r(["delete","has","get","set"],function(t){var e=v.prototype,i=e[t];o(e,t,function(e,r){if(l(e)&&!d(e)){this._f||(this._f=new n);var o=this._f[t](e,r);return"set"==t?this:o}return i.call(this,e,r)})}))},{12:12,125:125,21:21,22:22,35:35,51:51,66:66,70:70,94:94}],267:[function(t,e,i){"use strict";var n=t(21),r=t(125);t(22)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(r(this,"WeakSet"),t,!0)}},n,!1,!0)},{125:125,21:21,22:22}],268:[function(t,e,i){"use strict";var n=t(33),r=t(38),o=t(119),s=t(118),a=t(3),u=t(15);n(n.P,"Array",{flatMap:function(t){var e,i,n=o(this);return a(t),e=s(n.length),i=u(n,0),r(i,n,n,e,0,1,t,arguments[1]),i}}),t(5)("flatMap")},{118:118,119:119,15:15,3:3,33:33,38:38,5:5}],269:[function(t,e,i){"use strict";var n=t(33),r=t(38),o=t(119),s=t(118),a=t(116),u=t(15);n(n.P,"Array",{flatten:function(){var t=arguments[0],e=o(this),i=s(e.length),n=u(e,0);return r(n,e,e,i,0,void 0===t?1:a(t)),n}}),t(5)("flatten")},{116:116,118:118,119:119,15:15,33:33,38:38,5:5}],270:[function(t,e,i){"use strict";var n=t(33),r=t(11)(!0);n(n.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)("includes")},{11:11,33:33,5:5}],271:[function(t,e,i){var n=t(33),r=t(68)(),o=t(40).process,s="process"==t(18)(o);n(n.G,{asap:function(t){var e=s&&o.domain;r(e?e.bind(t):t)}})},{18:18,33:33,40:40,68:68}],272:[function(t,e,i){var n=t(33),r=t(18);n(n.S,"Error",{isError:function(t){return"Error"===r(t)}})},{18:18,33:33}],273:[function(t,e,i){var n=t(33);n(n.G,{global:t(40)})},{33:33,40:40}],274:[function(t,e,i){t(97)("Map")},{97:97}],275:[function(t,e,i){t(98)("Map")},{98:98}],276:[function(t,e,i){var n=t(33);n(n.P+n.R,"Map",{toJSON:t(20)("Map")})},{20:20,33:33}],277:[function(t,e,i){var n=t(33);n(n.S,"Math",{clamp:function(t,e,i){return Math.min(i,Math.max(e,t))}})},{33:33}],278:[function(t,e,i){var n=t(33);n(n.S,"Math",{DEG_PER_RAD:Math.PI/180})},{33:33}],279:[function(t,e,i){var n=t(33),r=180/Math.PI;n(n.S,"Math",{degrees:function(t){return t*r}})},{33:33}],280:[function(t,e,i){var n=t(33),r=t(64),o=t(62);n(n.S,"Math",{fscale:function(t,e,i,n,s){return o(r(t,e,i,n,s))}})},{33:33,62:62,64:64}],281:[function(t,e,i){var n=t(33);n(n.S,"Math",{iaddh:function(t,e,i,n){var r=t>>>0,o=e>>>0,s=i>>>0;return o+(n>>>0)+((r&s|(r|s)&~(r+s>>>0))>>>31)|0}})},{33:33}],282:[function(t,e,i){var n=t(33);n(n.S,"Math",{imulh:function(t,e){var i=+t,n=+e,r=65535&i,o=65535&n,s=i>>16,a=n>>16,u=(s*o>>>0)+(r*o>>>16);return s*a+(u>>16)+((r*a>>>0)+(65535&u)>>16)}})},{33:33}],283:[function(t,e,i){var n=t(33);n(n.S,"Math",{isubh:function(t,e,i,n){var r=t>>>0,o=e>>>0,s=i>>>0;return o-(n>>>0)-((~r&s|~(r^s)&r-s>>>0)>>>31)|0}})},{33:33}],284:[function(t,e,i){var n=t(33);n(n.S,"Math",{RAD_PER_DEG:180/Math.PI})},{33:33}],285:[function(t,e,i){var n=t(33),r=Math.PI/180;n(n.S,"Math",{radians:function(t){return t*r}})},{33:33}],286:[function(t,e,i){var n=t(33);n(n.S,"Math",{scale:t(64)})},{33:33,64:64}],287:[function(t,e,i){var n=t(33);n(n.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},{33:33}],288:[function(t,e,i){var n=t(33);n(n.S,"Math",{umulh:function(t,e){var i=+t,n=+e,r=65535&i,o=65535&n,s=i>>>16,a=n>>>16,u=(s*o>>>0)+(r*o>>>16);return s*a+(u>>>16)+((r*a>>>0)+(65535&u)>>>16)}})},{33:33}],289:[function(t,e,i){"use strict";var n=t(33),r=t(119),o=t(3),s=t(72);t(29)&&n(n.P+t(74),"Object",{__defineGetter__:function(t,e){s.f(r(this),t,{get:o(e),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],290:[function(t,e,i){"use strict";var n=t(33),r=t(119),o=t(3),s=t(72);t(29)&&n(n.P+t(74),"Object",{__defineSetter__:function(t,e){s.f(r(this),t,{set:o(e),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],291:[function(t,e,i){var n=t(33),r=t(84)(!0);n(n.S,"Object",{entries:function(t){return r(t)}})},{33:33,84:84}],292:[function(t,e,i){var n=t(33),r=t(85),o=t(117),s=t(75),a=t(24);n(n.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,i,n=o(t),u=s.f,l=r(n),c={},h=0;l.length>h;)void 0!==(i=u(n,e=l[h++]))&&a(c,e,i);return c}})},{117:117,24:24,33:33,75:75,85:85}],293:[function(t,e,i){"use strict";var n=t(33),r=t(119),o=t(120),s=t(79),a=t(75).f;t(29)&&n(n.P+t(74),"Object",{__lookupGetter__:function(t){var e,i=r(this),n=o(t,!0);do{if(e=a(i,n))return e.get}while(i=s(i))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],294:[function(t,e,i){"use strict";var n=t(33),r=t(119),o=t(120),s=t(79),a=t(75).f;t(29)&&n(n.P+t(74),"Object",{__lookupSetter__:function(t){var e,i=r(this),n=o(t,!0);do{if(e=a(i,n))return e.set}while(i=s(i))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],295:[function(t,e,i){var n=t(33),r=t(84)(!1);n(n.S,"Object",{values:function(t){return r(t)}})},{33:33,84:84}],296:[function(t,e,i){"use strict";var n=t(33),r=t(40),o=t(23),s=t(68)(),a=t(128)("observable"),u=t(3),l=t(7),c=t(6),h=t(93),f=t(42),d=t(39),p=d.RETURN,m=function(t){return null==t?void 0:u(t)},_=function(t){var e=t._c;e&&(t._c=void 0,e())},g=function(t){return void 0===t._o},v=function(t){g(t)||(t._o=void 0,_(t))},y=function(t,e){l(t),this._c=void 0,this._o=t,t=new b(this);try{var i=e(t),n=i;null!=i&&("function"==typeof i.unsubscribe?i=function(){n.unsubscribe()}:u(i),this._c=i)}catch(e){return void t.error(e)}g(this)&&_(this)};y.prototype=h({},{unsubscribe:function(){v(this)}});var b=function(t){this._s=t};b.prototype=h({},{next:function(t){var e=this._s;if(!g(e)){var i=e._o;try{var n=m(i.next);if(n)return n.call(i,t)}catch(t){try{v(e)}finally{throw t}}}},error:function(t){var e=this._s;if(g(e))throw t;var i=e._o;e._o=void 0;try{var n=m(i.error);if(!n)throw t;t=n.call(i,t)}catch(t){try{_(e)}finally{throw t}}return _(e),t},complete:function(t){var e=this._s;if(!g(e)){var i=e._o;e._o=void 0;try{var n=m(i.complete);t=n?n.call(i,t):void 0}catch(t){try{_(e)}finally{throw t}}return _(e),t}}});var x=function(t){c(this,x,"Observable","_f")._f=u(t)};h(x.prototype,{subscribe:function(t){return new y(t,this._f)},forEach:function(t){var e=this;return new(o.Promise||r.Promise)(function(i,n){u(t);var r=e.subscribe({next:function(e){try{return t(e)}catch(t){n(t),r.unsubscribe()}},error:n,complete:i})})}}),h(x,{from:function(t){var e="function"==typeof this?this:x,i=m(l(t)[a]);if(i){var n=l(i.call(t));return n.constructor===e?n:new e(function(t){return n.subscribe(t)})}return new e(function(e){var i=!1;return s(function(){if(!i){try{if(d(t,!1,function(t){if(e.next(t),i)return p})===p)return}catch(t){if(i)throw t;return void e.error(t)}e.complete()}}),function(){i=!0}})},of:function(){for(var t=0,e=arguments.length,i=Array(e);t<e;)i[t]=arguments[t++];return new("function"==typeof this?this:x)(function(t){var e=!1;return s(function(){if(!e){for(var n=0;n<i.length;++n)if(t.next(i[n]),e)return;t.complete()}}),function(){e=!0}})}}),f(x.prototype,a,function(){return this}),n(n.G,{Observable:x}),t(100)("Observable")},{100:100,128:128,23:23,3:3,33:33,39:39,40:40,42:42,6:6,68:68,7:7,93:93}],297:[function(t,e,i){"use strict";var n=t(33),r=t(23),o=t(40),s=t(104),a=t(91);n(n.P+n.R,"Promise",{finally:function(t){var e=s(this,r.Promise||o.Promise),i="function"==typeof t;return this.then(i?function(i){return a(e,t()).then(function(){return i})}:t,i?function(i){return a(e,t()).then(function(){throw i})}:t)}})},{104:104,23:23,33:33,40:40,91:91}],298:[function(t,e,i){"use strict";var n=t(33),r=t(69),o=t(90);n(n.S,"Promise",{try:function(t){var e=r.f(this),i=o(t);return(i.e?e.reject:e.resolve)(i.v),e.promise}})},{33:33,69:69,90:90}],299:[function(t,e,i){var n=t(67),r=t(7),o=n.key,s=n.set;n.exp({defineMetadata:function(t,e,i,n){s(t,e,r(i),o(n))}})},{67:67,7:7}],300:[function(t,e,i){var n=t(67),r=t(7),o=n.key,s=n.map,a=n.store;n.exp({deleteMetadata:function(t,e){var i=arguments.length<3?void 0:o(arguments[2]),n=s(r(e),i,!1);if(void 0===n||!n.delete(t))return!1;if(n.size)return!0;var u=a.get(e);return u.delete(i),!!u.size||a.delete(e)}})},{67:67,7:7}],301:[function(t,e,i){var n=t(231),r=t(10),o=t(67),s=t(7),a=t(79),u=o.keys,l=o.key,c=function(t,e){var i=u(t,e),o=a(t);if(null===o)return i;var s=c(o,e);return s.length?i.length?r(new n(i.concat(s))):s:i};o.exp({getMetadataKeys:function(t){return c(s(t),arguments.length<2?void 0:l(arguments[1]))}})},{10:10,231:231,67:67,7:7,79:79}],302:[function(t,e,i){var n=t(67),r=t(7),o=t(79),s=n.has,a=n.get,u=n.key,l=function(t,e,i){if(s(t,e,i))return a(t,e,i);var n=o(e);return null!==n?l(t,n,i):void 0};n.exp({getMetadata:function(t,e){return l(t,r(e),arguments.length<3?void 0:u(arguments[2]))}})},{67:67,7:7,79:79}],303:[function(t,e,i){var n=t(67),r=t(7),o=n.keys,s=n.key;n.exp({getOwnMetadataKeys:function(t){return o(r(t),arguments.length<2?void 0:s(arguments[1]))}})},{67:67,7:7}],304:[function(t,e,i){var n=t(67),r=t(7),o=n.get,s=n.key;n.exp({getOwnMetadata:function(t,e){return o(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},{67:67,7:7}],305:[function(t,e,i){var n=t(67),r=t(7),o=t(79),s=n.has,a=n.key,u=function(t,e,i){if(s(t,e,i))return!0;var n=o(e);return null!==n&&u(t,n,i)};n.exp({hasMetadata:function(t,e){return u(t,r(e),arguments.length<3?void 0:a(arguments[2]))}})},{67:67,7:7,79:79}],306:[function(t,e,i){var n=t(67),r=t(7),o=n.has,s=n.key;n.exp({hasOwnMetadata:function(t,e){return o(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},{67:67,7:7}],307:[function(t,e,i){var n=t(67),r=t(7),o=t(3),s=n.key,a=n.set;n.exp({metadata:function(t,e){return function(i,n){a(t,e,(void 0!==n?r:o)(i),s(n))}}})},{3:3,67:67,7:7}],308:[function(t,e,i){t(97)("Set")},{97:97}],309:[function(t,e,i){t(98)("Set")},{98:98}],310:[function(t,e,i){var n=t(33);n(n.P+n.R,"Set",{toJSON:t(20)("Set")})},{20:20,33:33}],311:[function(t,e,i){"use strict";var n=t(33),r=t(106)(!0);n(n.P,"String",{at:function(t){return r(this,t)}})},{106:106,33:33}],312:[function(t,e,i){"use strict";var n=t(33),r=t(28),o=t(118),s=t(52),a=t(37),u=RegExp.prototype,l=function(t,e){this._r=t,this._s=e};t(54)(l,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),n(n.P,"String",{matchAll:function(t){if(r(this),!s(t))throw TypeError(t+" is not a regexp!");var e=String(this),i="flags"in u?String(t.flags):a.call(t),n=new RegExp(t.source,~i.indexOf("g")?i:"g"+i);return n.lastIndex=o(t.lastIndex),new l(n,e)}})},{118:118,28:28,33:33,37:37,52:52,54:54}],313:[function(t,e,i){"use strict";var n=t(33),r=t(109);n(n.P,"String",{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},{109:109,33:33}],314:[function(t,e,i){"use strict";var n=t(33),r=t(109);n(n.P,"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},{109:109,33:33}],315:[function(t,e,i){"use strict";t(111)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},{111:111}],316:[function(t,e,i){"use strict";t(111)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},{111:111}],317:[function(t,e,i){t(126)("asyncIterator")},{126:126}],318:[function(t,e,i){t(126)("observable")},{126:126}],319:[function(t,e,i){var n=t(33);n(n.S,"System",{global:t(40)})},{33:33,40:40}],320:[function(t,e,i){t(97)("WeakMap")},{97:97}],321:[function(t,e,i){t(98)("WeakMap")},{98:98}],322:[function(t,e,i){t(97)("WeakSet")},{97:97}],323:[function(t,e,i){t(98)("WeakSet")},{98:98}],324:[function(t,e,i){for(var n=t(141),r=t(81),o=t(94),s=t(40),a=t(42),u=t(58),l=t(128),c=l("iterator"),h=l("toStringTag"),f=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(d),m=0;m<p.length;m++){var _,g=p[m],v=d[g],y=s[g],b=y&&y.prototype;if(b&&(b[c]||a(b,c,f),b[h]||a(b,h,g),u[g]=f,v))for(_ in n)b[_]||o(b,_,n[_],!0)}},{128:128,141:141,40:40,42:42,58:58,81:81,94:94}],325:[function(t,e,i){var n=t(33),r=t(113);n(n.G+n.B,{setImmediate:r.set,clearImmediate:r.clear})},{113:113,33:33}],326:[function(t,e,i){var n=t(40),r=t(33),o=t(46),s=t(88),a=n.navigator,u=!!a&&/MSIE .\./.test(a.userAgent),l=function(t){return u?function(e,i){return t(o(s,[].slice.call(arguments,2),"function"==typeof e?e:Function(e)),i)}:t};r(r.G+r.B+r.F*u,{setTimeout:l(n.setTimeout),setInterval:l(n.setInterval)})},{33:33,40:40,46:46,88:88}],327:[function(t,e,i){t(254),t(191),t(193),t(192),t(195),t(197),t(202),t(196),t(194),t(204),t(203),t(199),t(200),t(198),t(190),t(201),t(205),t(206),t(157),t(159),t(158),t(208),t(207),t(178),t(188),t(189),t(179),t(180),t(181),t(182),t(183),t(184),t(185),t(186),t(187),t(161),t(162),t(163),t(164),t(165),t(166),t(167),t(168),t(169),t(170),t(171),t(172),t(173),t(174),t(175),t(176),t(177),t(241),t(246),t(253),t(244),t(236),t(237),t(242),t(247),t(249),t(232),t(233),t(234),t(235),t(238),t(239),t(240),t(243),t(245),t(248),t(250),t(251),t(252),t(152),t(154),t(153),t(156),t(155),t(140),t(138),t(145),t(142),t(148),t(150),t(137),t(144),t(134),t(149),t(132),t(147),t(146),t(139),t(143),t(131),t(133),t(136),t(135),t(151),t(141),t(224),t(230),t(225),t(226),t(227),t(228),t(229),t(209),t(160),t(231),t(266),t(267),t(255),t(256),t(261),t(264),t(265),t(259),t(262),t(260),t(263),t(257),t(258),t(210),t(211),t(212),t(213),t(214),t(217),t(215),t(216),t(218),t(219),t(220),t(221),t(223),t(222),t(270),t(268),t(269),t(311),t(314),t(313),t(315),t(316),t(312),t(317),t(318),t(292),t(295),t(291),t(289),t(290),t(293),t(294),t(276),t(310),t(275),t(309),t(321),t(323),t(274),t(308),t(320),t(322),t(273),t(319),t(272),t(277),t(278),t(279),t(280),t(281),t(283),t(282),t(284),t(285),t(286),t(288),t(287),t(297),t(298),t(299),t(300),t(302),t(301),t(304),t(303),t(305),t(306),t(307),t(271),t(296),t(326),t(325),t(324),e.exports=t(23)},{131:131,132:132,133:133,134:134,135:135,136:136,137:137,138:138,139:139,140:140,141:141,142:142,143:143,144:144,145:145,146:146,147:147,148:148,149:149,150:150,151:151,152:152,153:153,154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,23:23,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,
267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,292:292,293:293,294:294,295:295,296:296,297:297,298:298,299:299,300:300,301:301,302:302,303:303,304:304,305:305,306:306,307:307,308:308,309:309,310:310,311:311,312:312,313:313,314:314,315:315,316:316,317:317,318:318,319:319,320:320,321:321,322:322,323:323,324:324,325:325,326:326}],328:[function(t,e,i){(function(t){!function(t){"use strict";function i(t,e,i,n){var o=e&&e.prototype instanceof r?e:r,s=Object.create(o.prototype),a=new d(n||[]);return s._invoke=l(t,i,a),s}function n(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function r(){}function o(){}function s(){}function a(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function u(e){function i(t,r,o,s){var a=n(e[t],e,r);if("throw"!==a.type){var u=a.arg,l=u.value;return l&&"object"==typeof l&&v.call(l,"__await")?Promise.resolve(l.__await).then(function(t){i("next",t,o,s)},function(t){i("throw",t,o,s)}):Promise.resolve(l).then(function(t){u.value=t,o(u)},s)}s(a.arg)}function r(t,e){function n(){return new Promise(function(n,r){i(t,e,n,r)})}return o=o?o.then(n,n):n()}"object"==typeof t.process&&t.process.domain&&(i=t.process.domain.bind(i));var o;this._invoke=r}function l(t,e,i){var r=T;return function(o,s){if(r===E)throw new Error("Generator is already running");if(r===P){if("throw"===o)throw s;return m()}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var u=c(a,i);if(u){if(u===C)continue;return u}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===T)throw r=P,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=E;var l=n(t,e,i);if("normal"===l.type){if(r=i.done?P:M,l.arg===C)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r=P,i.method="throw",i.arg=l.arg)}}}function c(t,e){var i=t.iterator[e.method];if(i===_){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=_,c(t,e),"throw"===e.method))return C;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var r=n(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,C;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=_),e.delegate=null,C):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,C)}function h(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function p(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(v.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=_,e.done=!0,e};return n.next=n}}return{next:m}}function m(){return{value:_,done:!0}}var _,g=Object.prototype,v=g.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},b=y.iterator||"@@iterator",x=y.asyncIterator||"@@asyncIterator",w=y.toStringTag||"@@toStringTag",L="object"==typeof e,S=t.regeneratorRuntime;if(S)return void(L&&(e.exports=S));S=t.regeneratorRuntime=L?e.exports:{},S.wrap=i;var T="suspendedStart",M="suspendedYield",E="executing",P="completed",C={},A={};A[b]=function(){return this};var k=Object.getPrototypeOf,z=k&&k(k(p([])));z&&z!==g&&v.call(z,b)&&(A=z);var I=s.prototype=r.prototype=Object.create(A);o.prototype=I.constructor=s,s.constructor=o,s[w]=o.displayName="GeneratorFunction",S.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},S.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,w in t||(t[w]="GeneratorFunction")),t.prototype=Object.create(I),t},S.awrap=function(t){return{__await:t}},a(u.prototype),u.prototype[x]=function(){return this},S.AsyncIterator=u,S.async=function(t,e,n,r){var o=new u(i(t,e,n,r));return S.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},a(I),I[w]="Generator",I[b]=function(){return this},I.toString=function(){return"[object Generator]"},S.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},S.values=p,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=_,this.done=!1,this.delegate=null,this.method="next",this.arg=_,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&v.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=_)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,n){return o.type="throw",o.arg=t,i.next=e,n&&(i.method="next",i.arg=_),!!n}if(this.done)throw t;for(var i=this,n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],o=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var s=v.call(r,"catchLoc"),a=v.call(r,"finallyLoc");if(s&&a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&v.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,C):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),C},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),f(i),C}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;f(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:p(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=_),C}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},e=t._,i=Array.prototype,n=Object.prototype,r="undefined"!=typeof Symbol?Symbol.prototype:null,o=i.push,s=i.slice,a=n.toString,u=n.hasOwnProperty,l=Array.isArray,c=Object.keys,h=Object.create,f=function(){},d=function(t){return t instanceof d?t:this instanceof d?void(this._wrapped=t):new d(t)};"undefined"==typeof exports||exports.nodeType?t._=d:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=d),exports._=d),d.VERSION="1.9.1";var p,m=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,o){return t.call(e,i,n,r,o)}}return function(){return t.apply(e,arguments)}},_=function(t,e,i){return d.iteratee!==p?d.iteratee(t,e):null==t?d.identity:d.isFunction(t)?m(t,e,i):d.isObject(t)&&!d.isArray(t)?d.matcher(t):d.property(t)};d.iteratee=p=function(t,e){return _(t,e,1/0)};var g=function(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),n=Array(i),r=0;r<i;r++)n[r]=arguments[r+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var o=Array(e+1);for(r=0;r<e;r++)o[r]=arguments[r];return o[e]=n,t.apply(this,o)}},v=function(t){if(!d.isObject(t))return{};if(h)return h(t);f.prototype=t;var e=new f;return f.prototype=null,e},y=function(t){return function(e){return null==e?void 0:e[t]}},b=function(t,e){return null!=t&&u.call(t,e)},x=function(t,e){for(var i=e.length,n=0;n<i;n++){if(null==t)return;t=t[e[n]]}return i?t:void 0},w=Math.pow(2,53)-1,L=y("length"),S=function(t){var e=L(t);return"number"==typeof e&&e>=0&&e<=w};d.each=d.forEach=function(t,e,i){e=m(e,i);var n,r;if(S(t))for(n=0,r=t.length;n<r;n++)e(t[n],n,t);else{var o=d.keys(t);for(n=0,r=o.length;n<r;n++)e(t[o[n]],o[n],t)}return t},d.map=d.collect=function(t,e,i){e=_(e,i);for(var n=!S(t)&&d.keys(t),r=(n||t).length,o=Array(r),s=0;s<r;s++){var a=n?n[s]:s;o[s]=e(t[a],a,t)}return o};var T=function(t){var e=function(e,i,n,r){var o=!S(e)&&d.keys(e),s=(o||e).length,a=t>0?0:s-1;for(r||(n=e[o?o[a]:a],a+=t);a>=0&&a<s;a+=t){var u=o?o[a]:a;n=i(n,e[u],u,e)}return n};return function(t,i,n,r){var o=arguments.length>=3;return e(t,m(i,r,4),n,o)}};d.reduce=d.foldl=d.inject=T(1),d.reduceRight=d.foldr=T(-1),d.find=d.detect=function(t,e,i){var n=S(t)?d.findIndex:d.findKey,r=n(t,e,i);if(void 0!==r&&-1!==r)return t[r]},d.filter=d.select=function(t,e,i){var n=[];return e=_(e,i),d.each(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n},d.reject=function(t,e,i){return d.filter(t,d.negate(_(e)),i)},d.every=d.all=function(t,e,i){e=_(e,i);for(var n=!S(t)&&d.keys(t),r=(n||t).length,o=0;o<r;o++){var s=n?n[o]:o;if(!e(t[s],s,t))return!1}return!0},d.some=d.any=function(t,e,i){e=_(e,i);for(var n=!S(t)&&d.keys(t),r=(n||t).length,o=0;o<r;o++){var s=n?n[o]:o;if(e(t[s],s,t))return!0}return!1},d.contains=d.includes=d.include=function(t,e,i,n){return S(t)||(t=d.values(t)),("number"!=typeof i||n)&&(i=0),d.indexOf(t,e,i)>=0},d.invoke=g(function(t,e,i){var n,r;return d.isFunction(e)?r=e:d.isArray(e)&&(n=e.slice(0,-1),e=e[e.length-1]),d.map(t,function(t){var o=r;if(!o){if(n&&n.length&&(t=x(t,n)),null==t)return;o=t[e]}return null==o?o:o.apply(t,i)})}),d.pluck=function(t,e){return d.map(t,d.property(e))},d.where=function(t,e){return d.filter(t,d.matcher(e))},d.findWhere=function(t,e){return d.find(t,d.matcher(e))},d.max=function(t,e,i){var n,r,o=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t){t=S(t)?t:d.values(t);for(var a=0,u=t.length;a<u;a++)null!=(n=t[a])&&n>o&&(o=n)}else e=_(e,i),d.each(t,function(t,i,n){((r=e(t,i,n))>s||r===-1/0&&o===-1/0)&&(o=t,s=r)});return o},d.min=function(t,e,i){var n,r,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t){t=S(t)?t:d.values(t);for(var a=0,u=t.length;a<u;a++)null!=(n=t[a])&&n<o&&(o=n)}else e=_(e,i),d.each(t,function(t,i,n){((r=e(t,i,n))<s||r===1/0&&o===1/0)&&(o=t,s=r)});return o},d.shuffle=function(t){return d.sample(t,1/0)},d.sample=function(t,e,i){if(null==e||i)return S(t)||(t=d.values(t)),t[d.random(t.length-1)];var n=S(t)?d.clone(t):d.values(t),r=L(n);e=Math.max(Math.min(e,r),0);for(var o=r-1,s=0;s<e;s++){var a=d.random(s,o),u=n[s];n[s]=n[a],n[a]=u}return n.slice(0,e)},d.sortBy=function(t,e,i){var n=0;return e=_(e,i),d.pluck(d.map(t,function(t,i,r){return{value:t,index:n++,criteria:e(t,i,r)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var M=function(t,e){return function(i,n,r){var o=e?[[],[]]:{};return n=_(n,r),d.each(i,function(e,r){var s=n(e,r,i);t(o,e,s)}),o}};d.groupBy=M(function(t,e,i){b(t,i)?t[i].push(e):t[i]=[e]}),d.indexBy=M(function(t,e,i){t[i]=e}),d.countBy=M(function(t,e,i){b(t,i)?t[i]++:t[i]=1});var E=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;d.toArray=function(t){return t?d.isArray(t)?s.call(t):d.isString(t)?t.match(E):S(t)?d.map(t,d.identity):d.values(t):[]},d.size=function(t){return null==t?0:S(t)?t.length:d.keys(t).length},d.partition=M(function(t,e,i){t[i?0:1].push(e)},!0),d.first=d.head=d.take=function(t,e,i){return null==t||t.length<1?null==e?void 0:[]:null==e||i?t[0]:d.initial(t,t.length-e)},d.initial=function(t,e,i){return s.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},d.last=function(t,e,i){return null==t||t.length<1?null==e?void 0:[]:null==e||i?t[t.length-1]:d.rest(t,Math.max(0,t.length-e))},d.rest=d.tail=d.drop=function(t,e,i){return s.call(t,null==e||i?1:e)},d.compact=function(t){return d.filter(t,Boolean)};var P=function(t,e,i,n){n=n||[];for(var r=n.length,o=0,s=L(t);o<s;o++){var a=t[o];if(S(a)&&(d.isArray(a)||d.isArguments(a)))if(e)for(var u=0,l=a.length;u<l;)n[r++]=a[u++];else P(a,e,i,n),r=n.length;else i||(n[r++]=a)}return n};d.flatten=function(t,e){return P(t,e,!1)},d.without=g(function(t,e){return d.difference(t,e)}),d.uniq=d.unique=function(t,e,i,n){d.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=_(i,n));for(var r=[],o=[],s=0,a=L(t);s<a;s++){var u=t[s],l=i?i(u,s,t):u;e&&!i?(s&&o===l||r.push(u),o=l):i?d.contains(o,l)||(o.push(l),r.push(u)):d.contains(r,u)||r.push(u)}return r},d.union=g(function(t){return d.uniq(P(t,!0,!0))}),d.intersection=function(t){for(var e=[],i=arguments.length,n=0,r=L(t);n<r;n++){var o=t[n];if(!d.contains(e,o)){var s;for(s=1;s<i&&d.contains(arguments[s],o);s++);s===i&&e.push(o)}}return e},d.difference=g(function(t,e){return e=P(e,!0,!0),d.filter(t,function(t){return!d.contains(e,t)})}),d.unzip=function(t){for(var e=t&&d.max(t,L).length||0,i=Array(e),n=0;n<e;n++)i[n]=d.pluck(t,n);return i},d.zip=g(d.unzip),d.object=function(t,e){for(var i={},n=0,r=L(t);n<r;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i};var C=function(t){return function(e,i,n){i=_(i,n);for(var r=L(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(i(e[o],o,e))return o;return-1}};d.findIndex=C(1),d.findLastIndex=C(-1),d.sortedIndex=function(t,e,i,n){i=_(i,n,1);for(var r=i(e),o=0,s=L(t);o<s;){var a=Math.floor((o+s)/2);i(t[a])<r?o=a+1:s=a}return o};var A=function(t,e,i){return function(n,r,o){var a=0,u=L(n);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+u,a):u=o>=0?Math.min(o+1,u):o+u+1;else if(i&&o&&u)return o=i(n,r),n[o]===r?o:-1;if(r!==r)return o=e(s.call(n,a,u),d.isNaN),o>=0?o+a:-1;for(o=t>0?a:u-1;o>=0&&o<u;o+=t)if(n[o]===r)return o;return-1}};d.indexOf=A(1,d.findIndex,d.sortedIndex),d.lastIndexOf=A(-1,d.findLastIndex),d.range=function(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/i),0),r=Array(n),o=0;o<n;o++,t+=i)r[o]=t;return r},d.chunk=function(t,e){if(null==e||e<1)return[];for(var i=[],n=0,r=t.length;n<r;)i.push(s.call(t,n,n+=e));return i};var k=function(t,e,i,n,r){if(!(n instanceof e))return t.apply(i,r);var o=v(t.prototype),s=t.apply(o,r);return d.isObject(s)?s:o};d.bind=g(function(t,e,i){if(!d.isFunction(t))throw new TypeError("Bind must be called on a function");var n=g(function(r){return k(t,n,e,this,i.concat(r))});return n}),d.partial=g(function(t,e){var i=d.partial.placeholder,n=function(){for(var r=0,o=e.length,s=Array(o),a=0;a<o;a++)s[a]=e[a]===i?arguments[r++]:e[a];for(;r<arguments.length;)s.push(arguments[r++]);return k(t,n,this,this,s)};return n}),d.partial.placeholder=d,d.bindAll=g(function(t,e){e=P(e,!1,!1);var i=e.length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=e[i];t[n]=d.bind(t[n],t)}}),d.memoize=function(t,e){var i=function(n){var r=i.cache,o=""+(e?e.apply(this,arguments):n);return b(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return i.cache={},i},d.delay=g(function(t,e,i){return setTimeout(function(){return t.apply(null,i)},e)}),d.defer=d.partial(d.delay,d,1),d.throttle=function(t,e,i){var n,r,o,s,a=0;i||(i={});var u=function(){a=!1===i.leading?0:d.now(),n=null,s=t.apply(r,o),n||(r=o=null)},l=function(){var l=d.now();a||!1!==i.leading||(a=l);var c=e-(l-a);return r=this,o=arguments,c<=0||c>e?(n&&(clearTimeout(n),n=null),a=l,s=t.apply(r,o),n||(r=o=null)):n||!1===i.trailing||(n=setTimeout(u,c)),s};return l.cancel=function(){clearTimeout(n),a=0,n=r=o=null},l},d.debounce=function(t,e,i){var n,r,o=function(e,i){n=null,i&&(r=t.apply(e,i))},s=g(function(s){if(n&&clearTimeout(n),i){var a=!n;n=setTimeout(o,e),a&&(r=t.apply(this,s))}else n=d.delay(o,e,this,s);return r});return s.cancel=function(){clearTimeout(n),n=null},s},d.wrap=function(t,e){return d.partial(e,t)},d.negate=function(t){return function(){return!t.apply(this,arguments)}},d.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},d.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},d.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},d.once=d.partial(d.before,2),d.restArguments=g;var z=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],R=function(t,e){var i=I.length,r=t.constructor,o=d.isFunction(r)&&r.prototype||n,s="constructor";for(b(t,s)&&!d.contains(e,s)&&e.push(s);i--;)(s=I[i])in t&&t[s]!==o[s]&&!d.contains(e,s)&&e.push(s)};d.keys=function(t){if(!d.isObject(t))return[];if(c)return c(t);var e=[];for(var i in t)b(t,i)&&e.push(i);return z&&R(t,e),e},d.allKeys=function(t){if(!d.isObject(t))return[];var e=[];for(var i in t)e.push(i);return z&&R(t,e),e},d.values=function(t){for(var e=d.keys(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=t[e[r]];return n},d.mapObject=function(t,e,i){e=_(e,i);for(var n=d.keys(t),r=n.length,o={},s=0;s<r;s++){var a=n[s];o[a]=e(t[a],a,t)}return o},d.pairs=function(t){for(var e=d.keys(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=[e[r],t[e[r]]];return n},d.invert=function(t){for(var e={},i=d.keys(t),n=0,r=i.length;n<r;n++)e[t[i[n]]]=i[n];return e},d.functions=d.methods=function(t){var e=[];for(var i in t)d.isFunction(t[i])&&e.push(i);return e.sort()};var O=function(t,e){return function(i){var n=arguments.length;if(e&&(i=Object(i)),n<2||null==i)return i;for(var r=1;r<n;r++)for(var o=arguments[r],s=t(o),a=s.length,u=0;u<a;u++){var l=s[u];e&&void 0!==i[l]||(i[l]=o[l])}return i}};d.extend=O(d.allKeys),d.extendOwn=d.assign=O(d.keys),d.findKey=function(t,e,i){e=_(e,i);for(var n,r=d.keys(t),o=0,s=r.length;o<s;o++)if(n=r[o],e(t[n],n,t))return n};var F=function(t,e,i){return e in i};d.pick=g(function(t,e){var i={},n=e[0];if(null==t)return i;d.isFunction(n)?(e.length>1&&(n=m(n,e[1])),e=d.allKeys(t)):(n=F,e=P(e,!1,!1),t=Object(t));for(var r=0,o=e.length;r<o;r++){var s=e[r],a=t[s];n(a,s,t)&&(i[s]=a)}return i}),d.omit=g(function(t,e){var i,n=e[0];return d.isFunction(n)?(n=d.negate(n),e.length>1&&(i=e[1])):(e=d.map(P(e,!1,!1),String),n=function(t,i){return!d.contains(e,i)}),d.pick(t,n,i)}),d.defaults=O(d.allKeys,!0),d.create=function(t,e){var i=v(t);return e&&d.extendOwn(i,e),i},d.clone=function(t){return d.isObject(t)?d.isArray(t)?t.slice():d.extend({},t):t},d.tap=function(t,e){return e(t),t},d.isMatch=function(t,e){var i=d.keys(e),n=i.length;if(null==t)return!n;for(var r=Object(t),o=0;o<n;o++){var s=i[o];if(e[s]!==r[s]||!(s in r))return!1}return!0};var D,j;D=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!==t)return e!==e;var r=typeof t;return("function"===r||"object"===r||"object"==typeof e)&&j(t,e,i,n)},j=function(t,e,i,n){t instanceof d&&(t=t._wrapped),e instanceof d&&(e=e._wrapped);var o=a.call(t);if(o!==a.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return r.valueOf.call(t)===r.valueOf.call(e)}var s="[object Array]"===o;if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var u=t.constructor,l=e.constructor;if(u!==l&&!(d.isFunction(u)&&u instanceof u&&d.isFunction(l)&&l instanceof l)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var c=i.length;c--;)if(i[c]===t)return n[c]===e;if(i.push(t),n.push(e),s){if((c=t.length)!==e.length)return!1;for(;c--;)if(!D(t[c],e[c],i,n))return!1}else{var h,f=d.keys(t);if(c=f.length,d.keys(e).length!==c)return!1;for(;c--;)if(h=f[c],!b(e,h)||!D(t[h],e[h],i,n))return!1}return i.pop(),n.pop(),!0},d.isEqual=function(t,e){return D(t,e)},d.isEmpty=function(t){return null==t||(S(t)&&(d.isArray(t)||d.isString(t)||d.isArguments(t))?0===t.length:0===d.keys(t).length)},d.isElement=function(t){return!(!t||1!==t.nodeType)},d.isArray=l||function(t){return"[object Array]"===a.call(t)},d.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},d.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){d["is"+t]=function(e){return a.call(e)==="[object "+t+"]"}}),d.isArguments(arguments)||(d.isArguments=function(t){return b(t,"callee")});var N=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof N&&(d.isFunction=function(t){return"function"==typeof t||!1}),d.isFinite=function(t){return!d.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},d.isNaN=function(t){return d.isNumber(t)&&isNaN(t)},d.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===a.call(t)},d.isNull=function(t){return null===t},d.isUndefined=function(t){return void 0===t},d.has=function(t,e){if(!d.isArray(e))return b(t,e);for(var i=e.length,n=0;n<i;n++){var r=e[n];if(null==t||!u.call(t,r))return!1;t=t[r]}return!!i},d.noConflict=function(){return t._=e,this},d.identity=function(t){return t},d.constant=function(t){return function(){return t}},d.noop=function(){},d.property=function(t){return d.isArray(t)?function(e){return x(e,t)}:y(t)},d.propertyOf=function(t){return null==t?function(){}:function(e){return d.isArray(e)?x(t,e):t[e]}},d.matcher=d.matches=function(t){return t=d.extendOwn({},t),function(e){return d.isMatch(e,t)}},d.times=function(t,e,i){var n=Array(Math.max(0,t));e=m(e,i,1);for(var r=0;r<t;r++)n[r]=e(r);return n},d.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},d.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},U=d.invert(B),Z=function(t){var e=function(e){return t[e]},i="(?:"+d.keys(t).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(r,e):t}};d.escape=Z(B),d.unescape=Z(U),d.result=function(t,e,i){d.isArray(e)||(e=[e]);var n=e.length;if(!n)return d.isFunction(i)?i.call(t):i;for(var r=0;r<n;r++){var o=null==t?void 0:t[e[r]];void 0===o&&(o=i,r=n),t=d.isFunction(o)?o.call(t):o}return t};var G=0;d.uniqueId=function(t){var e=++G+"";return t?t+e:e},d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,V={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\u2028|\u2029/g,H=function(t){return"\\"+V[t]};d.template=function(t,e,i){!e&&i&&(e=i),e=d.defaults({},e,d.templateSettings);var n=RegExp([(e.escape||q).source,(e.interpolate||q).source,(e.evaluate||q).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(n,function(e,i,n,s,a){return o+=t.slice(r,a).replace(W,H),r=a+e.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";var s;try{s=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var a=function(t){return s.call(this,t,d)};return a.source="function("+(e.variable||"obj")+"){\n"+o+"}",a},d.chain=function(t){var e=d(t);return e._chain=!0,e};var Y=function(t,e){return t._chain?d(e).chain():e};d.mixin=function(t){return d.each(d.functions(t),function(e){var i=d[e]=t[e];d.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),Y(this,i.apply(d,t))}}),d},d.mixin(d),d.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];d.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],Y(this,i)}}),d.each(["concat","join","slice"],function(t){var e=i[t];d.prototype[t]=function(){return Y(this,e.apply(this._wrapped,arguments))}}),d.prototype.value=function(){return this._wrapped},d.prototype.valueOf=d.prototype.toJSON=d.prototype.value,d.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return d})}(),function(t){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(i,n,r){e.Backbone=t(e,r,i,n)});else if("undefined"!=typeof exports){var i,n=require("underscore");try{i=require("jquery")}catch(t){}t(e,exports,n,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(function(t,e,i,n){var r=t.Backbone,o=Array.prototype.slice;e.VERSION="1.3.3",e.$=n,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=function(t,e,n){switch(t){case 1:return function(){return i[e](this[n])};case 2:return function(t){return i[e](this[n],t)};case 3:return function(t,r){return i[e](this[n],u(t,this),r)};case 4:return function(t,r,o){return i[e](this[n],u(t,this),r,o)};default:return function(){var t=o.call(arguments);return t.unshift(this[n]),i[e].apply(i,t)}}},a=function(t,e,n){i.each(e,function(e,r){i[r]&&(t.prototype[r]=s(e,r,n))})},u=function(t,e){return i.isFunction(t)?t:i.isObject(t)&&!e._isModel(t)?l(t):i.isString(t)?function(e){return e.get(t)}:t},l=function(t){var e=i.matches(t);return function(t){return e(t.attributes)}},c=e.Events={},h=/\s+/,f=function(t,e,n,r,o){var s,a=0;if(n&&"object"==typeof n){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(s=i.keys(n);a<s.length;a++)e=f(t,e,s[a],n[s[a]],o)}else if(n&&h.test(n))for(s=n.split(h);a<s.length;a++)e=t(e,s[a],r,o);else e=t(e,n,r,o);return e};c.on=function(t,e,i){return d(this,t,e,i)};var d=function(t,e,i,n,r){if(t._events=f(p,t._events||{},e,i,{context:n,ctx:t,listening:r}),r){(t._listeners||(t._listeners={}))[r.id]=r}return t};c.listenTo=function(t,e,n){if(!t)return this;var r=t._listenId||(t._listenId=i.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=o[r];if(!s){var a=this._listenId||(this._listenId=i.uniqueId("l"));s=o[r]={obj:t,objId:r,id:a,listeningTo:o,count:0}}return d(t,e,n,this,s),this};var p=function(t,e,i,n){if(i){var r=t[e]||(t[e]=[]),o=n.context,s=n.ctx,a=n.listening;a&&a.count++,r.push({callback:i,context:o,ctx:o||s,listening:a})}return t};c.off=function(t,e,i){return this._events?(this._events=f(m,this._events,t,e,{context:i,listeners:this._listeners}),this):this},c.stopListening=function(t,e,n){var r=this._listeningTo;if(!r)return this;for(var o=t?[t._listenId]:i.keys(r),s=0;s<o.length;s++){var a=r[o[s]];if(!a)break;a.obj.off(e,n,this)}return this};var m=function(t,e,n,r){if(t){var o,s=0,a=r.context,u=r.listeners;if(e||n||a){for(var l=e?[e]:i.keys(t);s<l.length;s++){e=l[s];var c=t[e];if(!c)break;for(var h=[],f=0;f<c.length;f++){var d=c[f];n&&n!==d.callback&&n!==d.callback._callback||a&&a!==d.context?h.push(d):(o=d.listening)&&0==--o.count&&(delete u[o.id],delete o.listeningTo[o.objId])}h.length?t[e]=h:delete t[e]}return t}for(var p=i.keys(u);s<p.length;s++)o=u[p[s]],delete u[o.id],delete o.listeningTo[o.objId]}};c.once=function(t,e,n){var r=f(_,{},t,e,i.bind(this.off,this));return"string"==typeof t&&null==n&&(e=void 0),this.on(r,e,n)},c.listenToOnce=function(t,e,n){var r=f(_,{},e,n,i.bind(this.stopListening,this,t));return this.listenTo(t,r)};var _=function(t,e,n,r){if(n){var o=t[e]=i.once(function(){r(e,o),n.apply(this,arguments)});o._callback=n}return t};c.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return f(g,this._events,t,void 0,i),this};var g=function(t,e,i,n){if(t){var r=t[e],o=t.all;r&&o&&(o=o.slice()),r&&v(r,n),o&&v(o,[e].concat(n))}return t},v=function(t,e){var i,n=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e);return}};c.bind=c.on,c.unbind=c.off,i.extend(e,c);var y=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var r=i.result(this,"defaults");n=i.defaults(i.extend({},r,n),r),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(y.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var r;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;var o=n.unset,s=n.silent,a=[],u=this._changing;this._changing=!0,u||(this._previousAttributes=i.clone(this.attributes),this.changed={});var l=this.attributes,c=this.changed,h=this._previousAttributes;for(var f in r)e=r[f],i.isEqual(l[f],e)||a.push(f),i.isEqual(h[f],e)?delete c[f]:c[f]=e,o?delete l[f]:l[f]=e;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=n);for(var d=0;d<a.length;d++)this.trigger("change:"+a[d],this,l[a[d]],n)}if(u)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var r in t){var o=t[r];i.isEqual(e[r],o)||(n[r]=o)}return!!i.size(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=i.extend({parse:!0},t);var e=this,n=t.success;return t.success=function(i){var r=t.parse?e.parse(i,t):i;if(!e.set(r,t))return!1;n&&n.call(t.context,e,i,t),e.trigger("sync",e,i,t)},N(this,t),this.sync("read",this,t)},save:function(t,e,n){var r;null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e,n=i.extend({validate:!0,parse:!0},n);var o=n.wait;if(r&&!o){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;var s=this,a=n.success,u=this.attributes;n.success=function(t){s.attributes=u;var e=n.parse?s.parse(t,n):t;if(o&&(e=i.extend({},r,e)),e&&!s.set(e,n))return!1;a&&a.call(n.context,s,t,n),s.trigger("sync",s,t,n)},N(this,n),r&&o&&(this.attributes=i.extend({},u,r));var l=this.isNew()?"create":n.patch?"patch":"update";"patch"!==l||n.attrs||(n.attrs=r);var c=this.sync(l,this,n);return this.attributes=u,c},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,r=t.wait,o=function(){e.stopListening(),
e.trigger("destroy",e,e.collection,t)};t.success=function(i){r&&o(),n&&n.call(t.context,e,i,t),e.isNew()||e.trigger("sync",e,i,t)};var s=!1;return this.isNew()?i.defer(t.success):(N(this,t),s=this.sync("delete",this,t)),r||o(),s},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||j();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}}),a(y,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var b=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},x={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},L=function(t,e,i){i=Math.min(Math.max(i,0),t.length);var n,r=Array(t.length-i),o=e.length;for(n=0;n<r.length;n++)r[n]=t[n+i];for(n=0;n<o;n++)t[n+i]=e[n];for(n=0;n<r.length;n++)t[n+o+i]=r[n]};i.extend(b.prototype,c,{model:y,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,w))},remove:function(t,e){e=i.extend({},e);var n=!i.isArray(t);t=n?[t]:t.slice();var r=this._removeModels(t,e);return!e.silent&&r.length&&(e.changes={added:[],merged:[],removed:r},this.trigger("update",this,e)),n?r[0]:r},set:function(t,e){if(null!=t){e=i.extend({},x,e),e.parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var n=!i.isArray(t);t=n?[t]:t.slice();var r=e.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var o,s,a=[],u=[],l=[],c=[],h={},f=e.add,d=e.merge,p=e.remove,m=!1,_=this.comparator&&null==r&&!1!==e.sort,g=i.isString(this.comparator)?this.comparator:null;for(s=0;s<t.length;s++){o=t[s];var v=this.get(o);if(v){if(d&&o!==v){var y=this._isModel(o)?o.attributes:o;e.parse&&(y=v.parse(y,e)),v.set(y,e),l.push(v),_&&!m&&(m=v.hasChanged(g))}h[v.cid]||(h[v.cid]=!0,a.push(v)),t[s]=v}else f&&(o=t[s]=this._prepareModel(o,e))&&(u.push(o),this._addReference(o,e),h[o.cid]=!0,a.push(o))}if(p){for(s=0;s<this.length;s++)o=this.models[s],h[o.cid]||c.push(o);c.length&&this._removeModels(c,e)}var b=!1,w=!_&&f&&p;if(a.length&&w?(b=this.length!==a.length||i.some(this.models,function(t,e){return t!==a[e]}),this.models.length=0,L(this.models,a,0),this.length=this.models.length):u.length&&(_&&(m=!0),L(this.models,u,null==r?this.length:r),this.length=this.models.length),m&&this.sort({silent:!0}),!e.silent){for(s=0;s<u.length;s++)null!=r&&(e.index=r+s),o=u[s],o.trigger("add",o,this,e);(m||b)&&this.trigger("sort",this,e),(u.length||c.length||l.length)&&(e.changes={added:u,removed:c,merged:l},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?i.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(t.attributes||t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return i.isFunction(e)&&(e=i.bind(e,this)),1===n||i.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){t=i.extend({parse:!0},t);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e.call(t.context,n,i,t),n.trigger("sync",n,i,t)},N(this,t),this.sync("read",this,t)},create:function(t,e){e=e?i.clone(e):{};var n=e.wait;if(!(t=this._prepareModel(t,e)))return!1;n||this.add(t,e);var r=this,o=e.success;return e.success=function(t,e,i){n&&r.add(t,i),o&&o.call(i.context,t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var r=this.get(t[n]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];var s=this.modelId(r.attributes);null!=s&&delete this._byId[s],e.silent||(e.index=o,r.trigger("remove",r,this,e)),i.push(r),this._removeReference(r,e)}}return i},_isModel:function(t){return t instanceof y},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;if("destroy"===t&&this.remove(e,n),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}}this.trigger.apply(this,arguments)}}),a(b,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models");var S=e.View=function(t){this.cid=i.uniqueId("view"),i.extend(this,i.pick(t,M)),this._ensureElement(),this.initialize.apply(this,arguments)},T=/^(\S+)\s*(.*)$/,M=["model","collection","el","id","attributes","className","tagName","events"];i.extend(S.prototype,c,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=i.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[n]),n){var r=e.match(T);this.delegate(r[1],r[2],i.bind(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,n,r){var o=E[t];i.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=i.result(n,"url")||j()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1);var u=r.error;r.error=function(t,e,i){r.textStatus=e,r.errorThrown=i,u&&u.call(r.context,t,e,i)};var l=r.xhr=e.ajax(i.extend(s,r));return n.trigger("request",n,l,r),l};var E={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var P=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,A=/(\(\?)?:\w+/g,k=/\*\w+/g,z=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(P.prototype,c,{initialize:function(){},route:function(t,n,r){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var o=this;return e.history.route(t,function(i){var s=o._extractParameters(t,i);!1!==o.execute(r,s,n)&&(o.trigger.apply(o,["route:"+n].concat(s)),o.trigger("route",n,s),e.history.trigger("route",o,n,s))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(z,"\\$&").replace(C,"(?:$1)?").replace(A,function(t,e){return e?t:"([^/?]+)"}).replace(k,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var I=e.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},R=/^[#\/]|\s+$/g,O=/^\/+|\/+$/g,F=/#.*$/;I.started=!1,i.extend(I.prototype,c,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(R,"")},start:function(t){if(I.started)throw new Error("Backbone.history has already been started");if(I.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(O,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,r=n.insertBefore(this.iframe,n.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),I.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),i.some(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!I.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;if(t=this.decodeFragment(t.replace(F,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;e.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new I;var D=function(t,e){var n,r=this;return n=t&&i.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,e),n.prototype=i.create(r.prototype,t),n.prototype.constructor=n,n.__super__=r.prototype,n};y.extend=b.extend=P.extend=S.extend=I.extend=D;var j=function(){throw new Error('A "url" property or function must be specified')},N=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}};return e});var CotModel=Backbone.Model.extend({get:function(t){var e=(t||"").split("."),i=Backbone.Model.prototype.get.apply(this,[e[0]]);if(1==e.length)return i;if("object"==typeof i){for(var n=1;n<e.length&&void 0!=i;n++)i=i[e[n]];return i}},set:function(t,e,i){if("object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&this._set(n,t[n],e);else this._set(t,e,i);return this},_set:function(t,e,i){var n=(t||"").split(".");if(1==n.length){var r=this.get(t);r&&r instanceof CotCollection&&!(e instanceof CotCollection)?r.set(e):Backbone.Model.prototype.set.apply(this,arguments)}else{var r=this.get(n[0]);"object"!=typeof r&&(r={}),r=_.clone(r);for(var o=r,s=1;s<n.length-1;s++)void 0===o[n[s]]&&(o[n[s]]={}),o=o[n[s]];var a=n[n.length-1];o[a];o[a]=e,Backbone.Model.prototype.set.apply(this,[n[0],r])}},toJSON:function(){var t=Backbone.Model.prototype.toJSON.apply(this);for(var e in t)t[e]&&t[e].toJSON&&(t[e]=t[e].toJSON());return t}}),CotView=Backbone.View.extend({localId:function(t){return(this.id||this._fallbackId())+"_"+t},localEl:function(t){return this.$("#"+this.localId(t))},_fallbackId:function(){return this._fallbackId_val=this._fallbackId_val||Math.random().toString().split(".")[1],this._fallbackId_val}}),CotCollection=Backbone.Collection.extend({model:CotModel});$(function(){(window.cot_app||window.CotApp).showModal=function(t){function e(t){if("click"===t.type)return!0;if("keyup"!==t.type)return!1;var e=t.charCode||t.keyCode;return 32===e||13===e||void 0}var i="modal_"+Math.random().toString().split(".")[1],n=function(t,e){if(e&&e.hasOwnProperty("bootstrapType")){-1==["primary","success","info","warning","danger"].indexOf(e.bootstrapType)&&(e.bootstrapType="default")}switch(t){case"cancel":return'<button class="btn btn-'+e.bootstrapType+'" type="button" data-dismiss="modal">'+e.label+"</button>";case"confirm":return'<button class="btn btn-'+e.bootstrapType+" js-confirm_"+i+'" type="button">'+e.label+"</button>";default:return'<button class="btn btn-default" type="button" data-dismiss="modal">Close</button>'}},r=$.extend({preset:!1,title:"",body:"",bootstrapType:"default",footerButtonsHtml:n(),modalSize:"",originatingElement:null,className:"",onShow:t.onShow||function(){},onShown:t.onShown||function(){},onHide:t.onHide||function(){},onHidden:t.onHidden||function(){},buttons:{cancel:{label:'<i class="glyphicon glyphicon-remove"></i> Cancel',bootstrapType:"default"},confirm:{label:'<i class="glyphicon glyphicon-ok"></i> Confirm',bootstrapType:"primary"}},callback:function(){}},t);if(null===r.originatingElement)return console.error("originatingElement is required"),!1;var o="";switch(r.preset){case"alert":o='<div class="modal fade alert-'+r.bootstrapType+" "+r.className+'" id="'+i+'" tabindex="-1" role="dialog" aria-label="Alert" aria-hidden="true" aria-modal="true" aria-describedby="'+i+'_body">    <div class="modal-dialog '+r.modalSize+'">      <div class="modal-content">        <div id="'+i+'_body" class="modal-body" >'+r.body+'</div>        <div class="modal-footer">'+n()+"        </div>      </div>    </div>  </div>";break;case"confirm":o='<div class="modal fade '+r.className+'" id="'+i+'" tabindex="-1" role="dialog" aria-labelledby="'+i+'_title" aria-hidden="true" aria-modal="true">    <div class="modal-dialog '+r.modalSize+'">      <div class="modal-content">        <div class="modal-header">          <button type="button" aria-label="Close" class="close" type="button" data-dismiss="modal">            <span aria-hidden="true">&times;</span>          </button>          <div role="heading" aria-level="2" id="'+i+'_title" class="modal-title">'+r.title+'</div>        </div>        <div id="'+i+'_body" class="modal-body">'+r.body+'</div>        <div class="modal-footer">'+n("cancel",{bootstrapType:r.buttons.cancel.bootstrapType,label:r.buttons.cancel.label})+" "+n("confirm",{bootstrapType:r.buttons.confirm.bootstrapType,label:r.buttons.confirm.label}),"function"==typeof r.callback&&$("body").delegate(".js-confirm_"+i,"click keyup",function(t){!0===e(t)&&(r.callback(),$("#"+i).modal("hide"))});break;default:o='<div class="modal fade '+r.className+'" id="'+i+'" tabindex="-1" role="dialog" aria-labelledby="'+i+'_title" aria-hidden="true" aria-modal="true">    <div class="modal-dialog '+r.modalSize+'">      <div class="modal-content">        <div class="modal-header">          <button type="button" aria-label="Close" class="close" type="button" data-dismiss="modal">            <span aria-hidden="true">&times;</span>          </button>          <div role="heading" aria-level="2" id="'+i+'_title" class="modal-title">'+r.title+'</div>        </div>        <div id="'+i+'_body" class="modal-body">'+r.body+'</div>        <div class="modal-footer">'+r.footerButtonsHtml+"        </div>      </div>    </div>  </div>"}$("body").append(o);var s=$("#"+i),a=s.find(".modal-header button").first(),u=s.find(".modal-footer button").last();return s.modal({show:!1}).on("show.bs.modal",function(){r.onShow()}).on("shown.bs.modal",function(){(0!=a.length?a:u).focus(),r.onShown()}).on("hide.bs.modal",function(){r.onHide()}).on("hidden.bs.modal",function(){r.onHidden(),r.originatingElement.focus(),s.remove()}).modal("show").attr("aria-hidden",!1),a.on("keydown",function(t){if(9===(t.which||t.keyCode)&&t.shiftKey)return u.focus(),!1}),u.on("keydown",function(t){if(9===(t.which||t.keyCode)&&!t.shiftKey)return a.focus(),!1}),s}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.L={})}(this,function(t){"use strict";function e(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++){r=arguments[i];for(e in r)t[e]=r[e]}return t}function i(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}function n(t){return t._leaflet_id=t._leaflet_id||++te,t._leaflet_id}function r(t,e,i){var n,r,o,s;return s=function(){n=!1,r&&(o.apply(i,r),r=!1)},o=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}}function o(t,e,i){var n=e[1],r=e[0],o=n-r;return t===n&&i?t:((t-r)%o+o)%o+r}function s(){return!1}function a(t,e){var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function l(t){return u(t).split(/\s+/)}function c(t,e){t.hasOwnProperty("options")||(t.options=t.options?Qt(t.options):{});for(var i in e)t.options[i]=e[i];return t.options}function h(t,e,i){var n=[];for(var r in t)n.push(encodeURIComponent(i?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}function f(t,e){return t.replace(ee,function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})}function d(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}function p(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function m(t){var e=+new Date,i=Math.max(0,16-(e-re));return re=e+i,window.setTimeout(t,i)}function _(t,e,n){if(!n||oe!==m)return oe.call(window,i(t,e));t.call(e)}function g(t){t&&se.call(window,t)}function v(){}function y(t){if("undefined"!=typeof L&&L&&L.Mixin){t=ie(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}function b(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}function x(t,e,i){return t instanceof b?t:ie(t)?new b(t[0],t[1]):void 0===t||null===t?t:"object"==typeof t&&"x"in t&&"y"in t?new b(t.x,t.y):new b(t,e,i)}function w(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;n<r;n++)this.extend(i[n])}function S(t,e){return!t||t instanceof w?t:new w(t,e)}function T(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;n<r;n++)this.extend(i[n])}function M(t,e){return t instanceof T?t:new T(t,e)}function E(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function P(t,e,i){return t instanceof E?t:ie(t)&&"object"!=typeof t[0]?3===t.length?new E(t[0],t[1],t[2]):2===t.length?new E(t[0],t[1]):null:void 0===t||null===t?t:"object"==typeof t&&"lat"in t?new E(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new E(t,e,i)}function C(t,e,i,n){if(ie(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=n}function A(t,e,i,n){return new C(t,e,i,n)}function k(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function z(t,e){var i,n,r,o,s,a,u="";for(i=0,r=t.length;i<r;i++){for(n=0,o=(s=t[i]).length;n<o;n++)a=s[n],u+=(n?"L":"M")+a.x+" "+a.y;u+=e?Je?"z":"x":""}return u||"M0 0"}function I(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}function R(t,e,i,n){return"touchstart"===e?F(t,i,n):"touchmove"===e?U(t,i,n):"touchend"===e&&Z(t,i,n),this}function O(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(Qe,n,!1):"touchmove"===e?t.removeEventListener(ti,n,!1):"touchend"===e&&(t.removeEventListener(ei,n,!1),t.removeEventListener(ii,n,!1)),this}function F(t,e,n){var r=i(function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(ni.indexOf(t.target.tagName)<0))return;K(t)}B(t,e)});t["_leaflet_touchstart"+n]=r,t.addEventListener(Qe,r,!1),oi||(document.documentElement.addEventListener(Qe,D,!0),document.documentElement.addEventListener(ti,j,!0),document.documentElement.addEventListener(ei,N,!0),document.documentElement.addEventListener(ii,N,!0),oi=!0)}function D(t){ri[t.pointerId]=t,si++}function j(t){ri[t.pointerId]&&(ri[t.pointerId]=t)}function N(t){delete ri[t.pointerId],si--}function B(t,e){t.touches=[];for(var i in ri)t.touches.push(ri[i]);t.changedTouches=[t],e(t)}function U(t,e,i){var n=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&B(t,e)};t["_leaflet_touchmove"+i]=n,t.addEventListener(ti,n,!1)}function Z(t,e,i){var n=function(t){B(t,e)};t["_leaflet_touchend"+i]=n,t.addEventListener(ei,n,!1),t.addEventListener(ii,n,!1)}function G(t,e,i){function n(t){var e;if(qe){if(!Le||"mouse"===t.pointerType)return;e=si}else e=t.touches.length;if(!(e>1)){var i=Date.now(),n=i-(o||i);s=t.touches?t.touches[0]:t,a=n>0&&n<=u,o=i}}function r(t){if(a&&!s.cancelBubble){if(qe){if(!Le||"mouse"===t.pointerType)return;var i,n,r={};for(n in s)i=s[n],r[n]=i&&i.bind?i.bind(s):i;s=r}s.type="dblclick",e(s),o=null}}var o,s,a=!1,u=250;return t[li+ai+i]=n,t[li+ui+i]=r,t[li+"dblclick"+i]=e,t.addEventListener(ai,n,!1),t.addEventListener(ui,r,!1),t.addEventListener("dblclick",e,!1),this}function q(t,e){var i=t[li+ai+e],n=t[li+ui+e],r=t[li+"dblclick"+e];return t.removeEventListener(ai,i,!1),t.removeEventListener(ui,n,!1),Le||t.removeEventListener("dblclick",r,!1),this}function V(t,e,i,n){if("object"==typeof e)for(var r in e)H(t,r,e[r],i);else for(var o=0,s=(e=l(e)).length;o<s;o++)H(t,e[o],i,n);return this}function W(t,e,i,n){if("object"==typeof e)for(var r in e)Y(t,r,e[r],i);else if(e)for(var o=0,s=(e=l(e)).length;o<s;o++)Y(t,e[o],i,n);else{for(var a in t[ci])Y(t,a,t[ci][a]);delete t[ci]}return this}function H(t,e,i,r){var o=e+n(i)+(r?"_"+n(r):"");if(t[ci]&&t[ci][o])return this;var s=function(e){return i.call(r||t,e||window.event)},a=s;qe&&0===e.indexOf("touch")?R(t,e,s,o):!Ve||"dblclick"!==e||!G||qe&&Ae?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",s,!1):"mouseenter"===e||"mouseleave"===e?(s=function(e){e=e||window.event,rt(t,e)&&a(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1)):("click"===e&&Te&&(s=function(t){ot(t,a)}),t.addEventListener(e,s,!1)):"attachEvent"in t&&t.attachEvent("on"+e,s):G(t,s,o),t[ci]=t[ci]||{},t[ci][o]=s}function Y(t,e,i,r){var o=e+n(i)+(r?"_"+n(r):""),s=t[ci]&&t[ci][o];if(!s)return this;qe&&0===e.indexOf("touch")?O(t,e,o):!Ve||"dblclick"!==e||!q||qe&&Ae?"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",s,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s):q(t,o),t[ci][o]=null}function X(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,nt(t),this}function J(t){return H(t,"mousewheel",X),this}function $(t){return V(t,"mousedown touchstart dblclick",X),H(t,"click",it),this}function K(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Q(t){return K(t),X(t),this}function tt(t,e){if(!e)return new b(t.clientX,t.clientY);var i=e.getBoundingClientRect(),n=i.width/e.offsetWidth||1,r=i.height/e.offsetHeight||1;return new b(t.clientX/n-i.left-e.clientLeft,t.clientY/r-i.top-e.clientTop)}function et(t){return Le?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/hi:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function it(t){fi[t.type]=!0}function nt(t){var e=fi[t.type];return fi[t.type]=!1,e}function rt(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}function ot(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=pe&&i-pe;n&&n>100&&n<500||t.target._simulatedClick&&!t._simulated?Q(t):(pe=i,e(t))}function st(t){return"string"==typeof t?document.getElementById(t):t}function at(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i}function ut(t,e,i){var n=document.createElement(t);return n.className=e||"",i&&i.appendChild(n),n}function lt(t){var e=t.parentNode;e&&e.removeChild(t)}function ct(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ht(t){var e=t.parentNode;e.lastChild!==t&&e.appendChild(t)}function ft(t){var e=t.parentNode;e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function dt(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=gt(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function pt(t,e){if(void 0!==t.classList)for(var i=l(e),n=0,r=i.length;n<r;n++)t.classList.add(i[n]);else if(!dt(t,e)){var o=gt(t);_t(t,(o?o+" ":"")+e)}}function mt(t,e){void 0!==t.classList?t.classList.remove(e):_t(t,u((" "+gt(t)+" ").replace(" "+e+" "," ")))}function _t(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function gt(t){return void 0===t.className.baseVal?t.className:t.className.baseVal}function vt(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&yt(t,e)}function yt(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}function bt(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function xt(t,e,i){var n=e||new b(0,0);t.style[pi]=(Fe?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}function wt(t,e){t._leaflet_pos=e,Ne?xt(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Lt(t){return t._leaflet_pos||new b(0,0)}function St(){V(window,"dragstart",K)}function Tt(){W(window,"dragstart",K)}function Mt(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Et(),vi=t,yi=t.style.outline,t.style.outline="none",V(window,"keydown",Et))}function Et(){vi&&(vi.style.outline=yi,vi=void 0,yi=void 0,W(window,"keydown",Et))}function Pt(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=zt(t,i),t=At(t,i)}function Ct(t,e,i){return Math.sqrt(Dt(t,e,i,!0))}function At(t,e){var i=t.length,n=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,kt(t,n,e,0,i-1);var r,o=[];for(r=0;r<i;r++)n[r]&&o.push(t[r]);return o}function kt(t,e,i,n,r){var o,s,a,u=0;for(s=n+1;s<=r-1;s++)(a=Dt(t[s],t[n],t[r],!0))>u&&(o=s,u=a);u>i&&(e[o]=1,kt(t,e,i,n,o),kt(t,e,i,o,r))}function zt(t,e){for(var i=[t[0]],n=1,r=0,o=t.length;n<o;n++)Ft(t[n],t[r])>e&&(i.push(t[n]),r=n);return r<o-1&&i.push(t[o-1]),i}function It(t,e,i,n,r){var o,s,a,u=n?Ai:Ot(t,i),l=Ot(e,i);for(Ai=l;;){if(!(u|l))return[t,e];if(u&l)return!1;a=Ot(s=Rt(t,e,o=u||l,i,r),i),o===u?(t=s,u=a):(e=s,l=a)}}function Rt(t,e,i,n,r){var o,s,a=e.x-t.x,u=e.y-t.y,l=n.min,c=n.max;return 8&i?(o=t.x+a*(c.y-t.y)/u,s=c.y):4&i?(o=t.x+a*(l.y-t.y)/u,s=l.y):2&i?(o=c.x,s=t.y+u*(c.x-t.x)/a):1&i&&(o=l.x,s=t.y+u*(l.x-t.x)/a),
new b(o,s,r)}function Ot(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function Ft(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function Dt(t,e,i,n){var r,o=e.x,s=e.y,a=i.x-o,u=i.y-s,l=a*a+u*u;return l>0&&((r=((t.x-o)*a+(t.y-s)*u)/l)>1?(o=i.x,s=i.y):r>0&&(o+=a*r,s+=u*r)),a=t.x-o,u=t.y-s,n?a*a+u*u:new b(o,s)}function jt(t){return!ie(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function Nt(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),jt(t)}function Bt(t,e,i){var n,r,o,s,a,u,l,c,h,f=[1,4,2,8];for(r=0,l=t.length;r<l;r++)t[r]._code=Ot(t[r],e);for(s=0;s<4;s++){for(c=f[s],n=[],r=0,o=(l=t.length)-1;r<l;o=r++)a=t[r],u=t[o],a._code&c?u._code&c||((h=Rt(u,a,c,e,i))._code=Ot(h,e),n.push(h)):(u._code&c&&((h=Rt(u,a,c,e,i))._code=Ot(h,e),n.push(h)),n.push(a));t=n}return t}function Ut(t,e){var i,n,r,o,s="Feature"===t.type?t.geometry:t,a=s?s.coordinates:null,u=[],l=e&&e.pointToLayer,c=e&&e.coordsToLatLng||Zt;if(!a&&!s)return null;switch(s.type){case"Point":return i=c(a),l?l(t,i):new Ji(i);case"MultiPoint":for(r=0,o=a.length;r<o;r++)i=c(a[r]),u.push(l?l(t,i):new Ji(i));return new Wi(u);case"LineString":case"MultiLineString":return n=Gt(a,"LineString"===s.type?0:1,c),new tn(n,e);case"Polygon":case"MultiPolygon":return n=Gt(a,"Polygon"===s.type?1:2,c),new en(n,e);case"GeometryCollection":for(r=0,o=s.geometries.length;r<o;r++){var h=Ut({geometry:s.geometries[r],type:"Feature",properties:t.properties},e);h&&u.push(h)}return new Wi(u);default:throw new Error("Invalid GeoJSON object.")}}function Zt(t){return new E(t[1],t[0],t[2])}function Gt(t,e,i){for(var n,r=[],o=0,s=t.length;o<s;o++)n=e?Gt(t[o],e-1,i):(i||Zt)(t[o]),r.push(n);return r}function qt(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[a(t.lng,e),a(t.lat,e),a(t.alt,e)]:[a(t.lng,e),a(t.lat,e)]}function Vt(t,e,i,n){for(var r=[],o=0,s=t.length;o<s;o++)r.push(e?Vt(t[o],e-1,i,n):qt(t[o],n));return!e&&i&&r.push(r[0]),r}function Wt(t,i){return t.feature?e({},t.feature,{geometry:i}):Ht(i)}function Ht(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}function Yt(t,e){return new nn(t,e)}function Xt(t,e){return new dn(t,e)}function Jt(t){return Xe?new _n(t):null}function $t(t){return Je||$e?new bn(t):null}var Kt=Object.freeze;Object.freeze=function(t){return t};var Qt=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),te=0,ee=/\{ *([\w_-]+) *\}/g,ie=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},ne="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",re=0,oe=window.requestAnimationFrame||p("RequestAnimationFrame")||m,se=window.cancelAnimationFrame||p("CancelAnimationFrame")||p("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)},ae=(Object.freeze||Object)({freeze:Kt,extend:e,create:Qt,bind:i,lastId:te,stamp:n,throttle:r,wrapNum:o,falseFn:s,formatNum:a,trim:u,splitWords:l,setOptions:c,getParamString:h,template:f,isArray:ie,indexOf:d,emptyImageUrl:ne,requestFn:oe,cancelFn:se,requestAnimFrame:_,cancelAnimFrame:g});v.extend=function(t){var i=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=i.__super__=this.prototype,r=Qt(n);r.constructor=i,i.prototype=r;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&"__super__"!==o&&(i[o]=this[o]);return t.statics&&(e(i,t.statics),delete t.statics),t.includes&&(y(t.includes),e.apply(null,[r].concat(t.includes)),delete t.includes),r.options&&(t.options=e(Qt(r.options),t.options)),e(r,t),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},i},v.include=function(t){return e(this.prototype,t),this},v.mergeOptions=function(t){return e(this.prototype.options,t),this},v.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var ue={on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else for(var r=0,o=(t=l(t)).length;r<o;r++)this._on(t[r],e,i);return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else for(var r=0,o=(t=l(t)).length;r<o;r++)this._off(t[r],e,i);else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),i===this&&(i=void 0);for(var r={fn:e,ctx:i},o=n,s=0,a=o.length;s<a;s++)if(o[s].fn===e&&o[s].ctx===i)return;o.push(r)},_off:function(t,e,i){var n,r,o;if(this._events&&(n=this._events[t]))if(e){if(i===this&&(i=void 0),n)for(r=0,o=n.length;r<o;r++){var a=n[r];if(a.ctx===i&&a.fn===e)return a.fn=s,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(r,1)}}else{for(r=0,o=n.length;r<o;r++)n[r].fn=s;delete this._events[t]}},fire:function(t,i,n){if(!this.listens(t,n))return this;var r=e({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var s=0,a=o.length;s<a;s++){var u=o[s];u.fn.call(u.ctx||this,r)}this._firingCount--}}return n&&this._propagateEvent(r),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var r in t)this.once(r,t[r],e);return this}var o=i(function(){this.off(t,e,n).off(t,o,n)},this);return this.on(t,e,n).on(t,o,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[n(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[n(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};ue.addEventListener=ue.on,ue.removeEventListener=ue.clearAllEventListeners=ue.off,ue.addOneTimeEventListener=ue.once,ue.fireEvent=ue.fire,ue.hasEventListeners=ue.listens;var le=v.extend(ue),ce=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};b.prototype={clone:function(){return new b(this.x,this.y)},add:function(t){return this.clone()._add(x(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(x(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new b(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new b(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ce(this.x),this.y=ce(this.y),this},distanceTo:function(t){var e=(t=x(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=x(t)).x===this.x&&t.y===this.y},contains:function(t){return t=x(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+a(this.x)+", "+a(this.y)+")"}},w.prototype={extend:function(t){return t=x(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new b((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new b(this.min.x,this.max.y)},getTopRight:function(){return new b(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof b?x(t):S(t))instanceof w?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=S(t);var e=this.min,i=this.max,n=t.min,r=t.max,o=r.x>=e.x&&n.x<=i.x,s=r.y>=e.y&&n.y<=i.y;return o&&s},overlaps:function(t){t=S(t);var e=this.min,i=this.max,n=t.min,r=t.max,o=r.x>e.x&&n.x<i.x,s=r.y>e.y&&n.y<i.y;return o&&s},isValid:function(){return!(!this.min||!this.max)}},T.prototype={extend:function(t){var e,i,n=this._southWest,r=this._northEast;if(t instanceof E)e=t,i=t;else{if(!(t instanceof T))return t?this.extend(P(t)||M(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||r?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),r.lat=Math.max(i.lat,r.lat),r.lng=Math.max(i.lng,r.lng)):(this._southWest=new E(e.lat,e.lng),this._northEast=new E(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,r=Math.abs(e.lng-i.lng)*t;return new T(new E(e.lat-n,e.lng-r),new E(i.lat+n,i.lng+r))},getCenter:function(){return new E((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new E(this.getNorth(),this.getWest())},getSouthEast:function(){return new E(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof E||"lat"in t?P(t):M(t);var e,i,n=this._southWest,r=this._northEast;return t instanceof T?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=r.lat&&e.lng>=n.lng&&i.lng<=r.lng},intersects:function(t){t=M(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>=e.lat&&n.lat<=i.lat,s=r.lng>=e.lng&&n.lng<=i.lng;return o&&s},overlaps:function(t){t=M(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>e.lat&&n.lat<i.lat,s=r.lng>e.lng&&n.lng<i.lng;return o&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=M(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},E.prototype={equals:function(t,e){return!!t&&(t=P(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+a(this.lat,t)+", "+a(this.lng,t)+")"},distanceTo:function(t){return fe.distance(this,P(t))},wrap:function(){return fe.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return M([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new E(this.lat,this.lng,this.alt)}};var he={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new w(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?o(t.lng,this.wrapLng,!0):t.lng;return new E(this.wrapLat?o(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,r=e.lng-i.lng;if(0===n&&0===r)return t;var o=t.getSouthWest(),s=t.getNorthEast();return new T(new E(o.lat-n,o.lng-r),new E(s.lat-n,s.lng-r))}},fe=e({},he,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,r=e.lat*i,o=Math.sin((e.lat-t.lat)*i/2),s=Math.sin((e.lng-t.lng)*i/2),a=o*o+Math.cos(n)*Math.cos(r)*s*s,u=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*u}}),de={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=Math.sin(n*e);return new b(this.R*t.lng*e,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(t){var e=180/Math.PI;return new E((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return new w([-t,-t],[t,t])}()};C.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new b((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var pe,me,_e,ge,ve=e({},fe,{code:"EPSG:3857",projection:de,transformation:function(){var t=.5/(Math.PI*de.R);return A(t,.5,-t,.5)}()}),ye=e({},ve,{code:"EPSG:900913"}),be=document.documentElement.style,xe="ActiveXObject"in window,we=xe&&!document.addEventListener,Le="msLaunchUri"in navigator&&!("documentMode"in document),Se=I("webkit"),Te=I("android"),Me=I("android 2")||I("android 3"),Ee=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Pe=Te&&I("Google")&&Ee<537&&!("AudioNode"in window),Ce=!!window.opera,Ae=I("chrome"),ke=I("gecko")&&!Se&&!Ce&&!xe,ze=!Ae&&I("safari"),Ie=I("phantom"),Re="OTransition"in be,Oe=0===navigator.platform.indexOf("Win"),Fe=xe&&"transition"in be,De="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Me,je="MozPerspective"in be,Ne=!window.L_DISABLE_3D&&(Fe||De||je)&&!Re&&!Ie,Be="undefined"!=typeof orientation||I("mobile"),Ue=Be&&Se,Ze=Be&&De,Ge=!window.PointerEvent&&window.MSPointerEvent,qe=!(!window.PointerEvent&&!Ge),Ve=!window.L_NO_TOUCH&&(qe||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),We=Be&&Ce,He=Be&&ke,Ye=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Xe=!!document.createElement("canvas").getContext,Je=!(!document.createElementNS||!k("svg").createSVGRect),$e=!Je&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}(),Ke=(Object.freeze||Object)({ie:xe,ielt9:we,edge:Le,webkit:Se,android:Te,android23:Me,androidStock:Pe,opera:Ce,chrome:Ae,gecko:ke,safari:ze,phantom:Ie,opera12:Re,win:Oe,ie3d:Fe,webkit3d:De,gecko3d:je,any3d:Ne,mobile:Be,mobileWebkit:Ue,mobileWebkit3d:Ze,msPointer:Ge,pointer:qe,touch:Ve,mobileOpera:We,mobileGecko:He,retina:Ye,canvas:Xe,svg:Je,vml:$e}),Qe=Ge?"MSPointerDown":"pointerdown",ti=Ge?"MSPointerMove":"pointermove",ei=Ge?"MSPointerUp":"pointerup",ii=Ge?"MSPointerCancel":"pointercancel",ni=["INPUT","SELECT","OPTION"],ri={},oi=!1,si=0,ai=Ge?"MSPointerDown":qe?"pointerdown":"touchstart",ui=Ge?"MSPointerUp":qe?"pointerup":"touchend",li="_leaflet_",ci="_leaflet_events",hi=Oe&&Ae?2*window.devicePixelRatio:ke?window.devicePixelRatio:1,fi={},di=(Object.freeze||Object)({on:V,off:W,stopPropagation:X,disableScrollPropagation:J,disableClickPropagation:$,preventDefault:K,stop:Q,getMousePosition:tt,getWheelDelta:et,fakeStop:it,skipped:nt,isExternalTarget:rt,addListener:V,removeListener:W}),pi=bt(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),mi=bt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),_i="webkitTransition"===mi||"OTransition"===mi?mi+"End":"transitionend";if("onselectstart"in document)me=function(){V(window,"selectstart",K)},_e=function(){W(window,"selectstart",K)};else{var gi=bt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);me=function(){if(gi){var t=document.documentElement.style;ge=t[gi],t[gi]="none"}},_e=function(){gi&&(document.documentElement.style[gi]=ge,ge=void 0)}}var vi,yi,bi=(Object.freeze||Object)({TRANSFORM:pi,TRANSITION:mi,TRANSITION_END:_i,get:st,getStyle:at,create:ut,remove:lt,empty:ct,toFront:ht,toBack:ft,hasClass:dt,addClass:pt,removeClass:mt,setClass:_t,getClass:gt,setOpacity:vt,testProp:bt,setTransform:xt,setPosition:wt,getPosition:Lt,disableTextSelection:me,enableTextSelection:_e,disableImageDrag:St,enableImageDrag:Tt,preventOutline:Mt,restoreOutline:Et}),xi=le.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=Lt(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=_(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),wt(this._el,i),this.fire("step")},_complete:function(){g(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),wi=le.extend({options:{crs:ve,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=c(this,e),this._initContainer(t),this._initLayout(),this._onResize=i(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(P(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=mi&&Ne&&!We&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),V(this._proxy,_i,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,i,n){return i=void 0===i?this._zoom:this._limitZoom(i),t=this._limitCenter(P(t),i,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n&&(void 0!==n.animate&&(n.zoom=e({animate:n.animate},n.zoom),n.pan=e({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,i,n.zoom):this._tryAnimatedPan(t,n.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,i),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Ne?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Ne?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),r=this.getSize().divideBy(2),o=(t instanceof b?t:this.latLngToContainerPoint(t)).subtract(r).multiplyBy(1-1/n),s=this.containerPointToLatLng(r.add(o));return this.setView(s,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():M(t);var i=x(e.paddingTopLeft||e.padding||[0,0]),n=x(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,i.add(n));if((r="number"==typeof e.maxZoom?Math.min(e.maxZoom,r):r)===1/0)return{center:t.getCenter(),zoom:r};var o=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),r),a=this.project(t.getNorthEast(),r);return{center:this.unproject(s.add(a).divideBy(2).add(o),r),zoom:r}},fitBounds:function(t,e){if(!(t=M(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=x(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new xi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){pt(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){function n(t){var e=(g*g-m*m+(t?-1:1)*b*b*v*v)/(2*(t?g:m)*b*v),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function r(t){return(Math.exp(t)-Math.exp(-t))/2}function o(t){return(Math.exp(t)+Math.exp(-t))/2}function s(t){return r(t)/o(t)}function a(t){return m*(o(x)/o(x+y*t))}function u(t){return m*(o(x)*s(x+y*t)-r(x))/b}function l(t){return 1-Math.pow(1-t,1.5)}function c(){var i=(Date.now()-w)/S,n=l(i)*L;i<=1?(this._flyToFrame=_(c,this),this._move(this.unproject(h.add(f.subtract(h).multiplyBy(u(n)/v)),p),this.getScaleZoom(m/a(n),p),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}if(!1===(i=i||{}).animate||!Ne)return this.setView(t,e,i);this._stop();var h=this.project(this.getCenter()),f=this.project(t),d=this.getSize(),p=this._zoom;t=P(t),e=void 0===e?p:e;var m=Math.max(d.x,d.y),g=m*this.getZoomScale(p,e),v=f.distanceTo(h)||1,y=1.42,b=y*y,x=n(0),w=Date.now(),L=(n(1)-x)/y,S=i.duration?1e3*i.duration:1e3*L*.8;return this._moveStart(!0,i.noMoveStart),c.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return(t=M(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,M(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var n=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var r=this.getSize(),o=n.divideBy(2).round(),s=r.divideBy(2).round(),a=o.subtract(s);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:n,newSize:r})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var n=i(this._handleGeolocationResponse,this),r=i(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(n,r,t):navigator.geolocation.getCurrentPosition(n,r,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=new E(t.coords.latitude,t.coords.longitude),i=e.toBounds(t.coords.accuracy),n=this._locateOptions;if(n.setView){var r=this.getBoundsZoom(i);this.setView(e,n.maxZoom?Math.min(r,n.maxZoom):r)}var o={latlng:e,bounds:i,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(o[s]=t.coords[s]);this.fire("locationfound",o)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),lt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)lt(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=ut("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new T(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=M(t),i=x(i||[0,0]);var n=this.getZoom()||0,r=this.getMinZoom(),o=this.getMaxZoom(),s=t.getNorthWest(),a=t.getSouthEast(),u=this.getSize().subtract(i),l=S(this.project(a,n),this.project(s,n)).getSize(),c=Ne?this.options.zoomSnap:1,h=u.x/l.x,f=u.y/l.y,d=e?Math.max(h,f):Math.min(h,f);return n=this.getScaleZoom(d,n),c&&(n=Math.round(n/(c/100))*(c/100),n=e?Math.ceil(n/c)*c:Math.floor(n/c)*c),Math.max(r,Math.min(o,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new b(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new w(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(P(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(x(t),e)},layerPointToLatLng:function(t){var e=x(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(P(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(P(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(M(t))},distance:function(t,e){return this.options.crs.distance(P(t),P(e))},containerPointToLayerPoint:function(t){return x(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return x(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(x(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(P(t)))},mouseEventToContainerPoint:function(t){return tt(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=st(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");V(e,"scroll",this._onScroll,this),this._containerId=n(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ne,pt(t,"leaflet-container"+(Ve?" leaflet-touch":"")+(Ye?" leaflet-retina":"")+(we?" leaflet-oldie":"")+(ze?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=at(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),wt(this._mapPane,new b(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(pt(t.markerPane,"leaflet-zoom-hide"),pt(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){wt(this._mapPane,new b(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n,!1)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i){void 0===e&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return g(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){wt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[n(this._container)]=this;var e=t?W:V;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Ne&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){g(this._resizeRequest),this._resizeRequest=_(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,r=[],o="mouseout"===e||"mouseover"===e,s=t.target||t.srcElement,a=!1;s;){
if((i=this._targets[n(s)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(o&&!rt(s,t))break;if(r.push(i),o)break}if(s===this._container)break;s=s.parentNode}return r.length||a||o||!rt(s,t)||(r=[this]),r},_handleDOMEvent:function(t){if(this._loaded&&!nt(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e||Mt(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,i,n){if("click"===t.type){var r=e({},t);r.type="preclick",this._fireDOMEvent(r,r.type,n)}if(!t._stopped&&(n=(n||[]).concat(this._findEventTargets(t,i))).length){var o=n[0];"contextmenu"===i&&o.listens(i,!0)&&K(t);var s={originalEvent:t};if("keypress"!==t.type){var a=o.getLatLng&&(!o._radius||o._radius<=10);s.containerPoint=a?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=a?o.getLatLng():this.layerPointToLatLng(s.layerPoint)}for(var u=0;u<n.length;u++)if(n[u].fire(i,s,!0),s.originalEvent._stopped||!1===n[u].options.bubblingMouseEvents&&-1!==d(this._mouseEvents,i))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Lt(this._mapPane)||new b(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return S([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),r=this.getSize().divideBy(2),o=new w(n.subtract(r),n.add(r)),s=this._getBoundsOffset(o,i,e);return s.round().equals([0,0])?t:this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new w(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=S(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),r=n.min.subtract(t.min),o=n.max.subtract(t.max);return new b(this._rebound(r.x,-o.x),this._rebound(r.y,-o.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=Ne?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){mt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i)||(this.panBy(i,e),0))},_createAnimProxy:function(){var t=this._proxy=ut("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var e=pi,i=this._proxy.style[e];xt(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var t=this.getCenter(),e=this.getZoom();xt(this._proxy,this.project(t,e),this.getZoomScale(e,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){lt(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==i.animate&&!this.getSize().contains(r)||(_(function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)},this),0))},_animateZoom:function(t,e,n,r){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,pt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:r}),setTimeout(i(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&mt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),_(function(){this._moveEnd(!0)},this))}}),Li=v.extend({options:{position:"topright"},initialize:function(t){c(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return pt(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return this._map?(lt(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Si=function(t){return new Li(t)};wi.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,r){var o=i+t+" "+i+r;e[t+r]=ut("div",o,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=ut("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)lt(this._controlCorners[t]);lt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ti=Li.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){c(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Li.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(n(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){pt(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(pt(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):mt(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return mt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=ut("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),$(e),J(e);var n=this._form=ut("form",t+"-list");i&&(this._map.on("click",this.collapse,this),Te||V(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var r=this._layersLink=ut("a",t+"-toggle",e);r.href="#",r.title="Layers",Ve?(V(r,"click",Q),V(r,"click",this.expand,this)):V(r,"focus",this.expand,this),i||this.expand(),this._baseLayersList=ut("div",t+"-base",n),this._separator=ut("div",t+"-separator",n),this._overlaysList=ut("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&n(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(i(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ct(this._baseLayersList),ct(this._overlaysList),this._layerControlInputs=[];var t,e,i,n,r=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,r+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&r>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(n(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=r):e=this._createRadioElement("leaflet-base-layers",r),this._layerControlInputs.push(e),e.layerId=n(t.layer),V(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var s=document.createElement("div");return i.appendChild(s),s.appendChild(e),s.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){var t,e,i=this._layerControlInputs,n=[],r=[];this._handlingClick=!0;for(var o=i.length-1;o>=0;o--)t=i[o],e=this._getLayer(t.layerId).layer,t.checked?n.push(e):t.checked||r.push(e);for(o=0;o<r.length;o++)this._map.hasLayer(r[o])&&this._map.removeLayer(r[o]);for(o=0;o<n.length;o++)this._map.hasLayer(n[o])||this._map.addLayer(n[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,n=this._map.getZoom(),r=i.length-1;r>=0;r--)t=i[r],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&n<e.options.minZoom||void 0!==e.options.maxZoom&&n>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Mi=Li.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=ut("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,r){var o=ut("a",i,n);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),$(o),V(o,"click",Q),V(o,"click",r,this),V(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";mt(this._zoomInButton,e),mt(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&pt(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&pt(this._zoomInButton,e)}});wi.mergeOptions({zoomControl:!0}),wi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Mi,this.addControl(this.zoomControl))});var Ei=Li.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e=ut("div","leaflet-control-scale"),i=this.options;return this._addScales(i,"leaflet-control-scale-line",e),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),e},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=ut("div",e,i)),t.imperial&&(this._iScale=ut("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,r=3.2808399*t;r>5280?(e=r/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(r),this._updateScale(this._iScale,n+" ft",n/r))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),Pi=Li.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){c(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=ut("div","leaflet-control-attribution"),$(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}});wi.mergeOptions({attributionControl:!0}),wi.addInitHook(function(){this.options.attributionControl&&(new Pi).addTo(this)}),Li.Layers=Ti,Li.Zoom=Mi,Li.Scale=Ei,Li.Attribution=Pi,Si.layers=function(t,e,i){return new Ti(t,e,i)},Si.zoom=function(t){return new Mi(t)},Si.scale=function(t){return new Ei(t)},Si.attribution=function(t){return new Pi(t)};var Ci=v.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ci.addTo=function(t,e){return t.addHandler(e,this),this};var Ai,ki={Events:ue},zi=Ve?"touchstart mousedown":"mousedown",Ii={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Ri={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Oi=le.extend({options:{clickTolerance:3},initialize:function(t,e,i,n){c(this,n),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(V(this._dragStartTarget,zi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Oi._dragging===this&&this.finishDrag(),W(this._dragStartTarget,zi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!dt(this._element,"leaflet-zoom-anim")&&!(Oi._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(Oi._dragging=this,this._preventOutline&&Mt(this._element),St(),me(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new b(e.clientX,e.clientY),V(document,Ri[t.type],this._onMove,this),V(document,Ii[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new b(e.clientX,e.clientY).subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(K(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Lt(this._element).subtract(i),pt(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),pt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,g(this._animRequest),this._lastEvent=t,this._animRequest=_(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),wt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){mt(document.body,"leaflet-dragging"),this._lastTarget&&(mt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in Ri)W(document,Ri[t],this._onMove,this),W(document,Ii[t],this._onUp,this);Tt(),_e(),this._moved&&this._moving&&(g(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Oi._dragging=!1}}),Fi=(Object.freeze||Object)({simplify:Pt,pointToSegmentDistance:Ct,closestPointOnSegment:function(t,e,i){return Dt(t,e,i)},clipSegment:It,_getEdgeIntersection:Rt,_getBitCode:Ot,_sqClosestPointOnSegment:Dt,isFlat:jt,_flat:Nt}),Di=(Object.freeze||Object)({clipPolygon:Bt}),ji={project:function(t){return new b(t.lng,t.lat)},unproject:function(t){return new E(t.y,t.x)},bounds:new w([-180,-90],[180,90])},Ni={R:6378137,R_MINOR:6356752.314245179,bounds:new w([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,r=this.R_MINOR/i,o=Math.sqrt(1-r*r),s=o*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),o/2);return n=-i*Math.log(Math.max(a,1e-10)),new b(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,r=this.R_MINOR/n,o=Math.sqrt(1-r*r),s=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(s),u=0,l=.1;u<15&&Math.abs(l)>1e-7;u++)e=o*Math.sin(a),e=Math.pow((1-e)/(1+e),o/2),a+=l=Math.PI/2-2*Math.atan(s*e)-a;return new E(a*i,t.x*i/n)}},Bi=(Object.freeze||Object)({LonLat:ji,Mercator:Ni,SphericalMercator:de}),Ui=e({},fe,{code:"EPSG:3395",projection:Ni,transformation:function(){var t=.5/(Math.PI*Ni.R);return A(t,.5,-t,.5)}()}),Zi=e({},fe,{code:"EPSG:4326",projection:ji,transformation:A(1/180,1,-1/180,.5)}),Gi=e({},he,{projection:ji,transformation:A(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0});he.Earth=fe,he.EPSG3395=Ui,he.EPSG3857=ve,he.EPSG900913=ye,he.EPSG4326=Zi,he.Simple=Gi;var qi=le.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[n(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[n(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});wi.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=n(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=n(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&n(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?ie(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[n(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=n(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var r=this._zoomBoundLayers[n].options;t=void 0===r.minZoom?t:Math.min(t,r.minZoom),e=void 0===r.maxZoom?e:Math.max(e,r.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Vi=qi.extend({initialize:function(t,e){c(this,e),this._layers={};var i,n;if(t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return n(t)}}),Wi=Vi.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Vi.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Vi.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new T;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),Hi=v.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){c(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var r=x(n),o=x("shadow"===e&&i.shadowAnchor||i.iconAnchor||r&&r.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return Ye&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),Yi=Hi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Yi.imagePath||(Yi.imagePath=this._detectIconPath()),(this.options.imagePath||Yi.imagePath)+Hi.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=ut("div","leaflet-default-icon-path",document.body),e=at(t,"background-image")||at(t,"backgroundImage");return document.body.removeChild(t),e=null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Xi=Ci.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Oi(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),pt(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&mt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,n=this._marker.options.autoPanSpeed,r=this._marker.options.autoPanPadding,o=L.DomUtil.getPosition(e._icon),s=i.getPixelBounds(),a=i.getPixelOrigin(),u=S(s.min._subtract(a).add(r),s.max._subtract(a).subtract(r));if(!u.contains(o)){var l=x((Math.max(u.max.x,o.x)-u.max.x)/(s.max.x-u.max.x)-(Math.min(u.min.x,o.x)-u.min.x)/(s.min.x-u.min.x),(Math.max(u.max.y,o.y)-u.max.y)/(s.max.y-u.max.y)-(Math.min(u.min.y,o.y)-u.min.y)/(s.min.y-u.min.y)).multiplyBy(n);i.panBy(l,{animate:!1}),this._draggable._newPos._add(l),this._draggable._startPos._add(l),L.DomUtil.setPosition(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=_(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(g(this._panRequest),this._panRequest=_(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,n=Lt(e._icon),r=e._map.layerPointToLatLng(n);i&&wt(i,n),e._latlng=r,t.latlng=r,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){g(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Ji=qi.extend({options:{icon:new Yi,interactive:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(t,e){c(this,e),this._latlng=P(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=P(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),pt(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var r=t.icon.createShadow(this._shadow),o=!1;r!==this._shadow&&(this._removeShadow(),o=!0),r&&(pt(r,e),r.alt=""),this._shadow=r,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&o&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),lt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&lt(this._shadow),this._shadow=null},_setPos:function(t){wt(this._icon,t),this._shadow&&wt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(pt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Xi)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Xi(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;vt(this._icon,t),this._shadow&&vt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),$i=qi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,
lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return c(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Ki=$i.extend({options:{fill:!0,radius:10},initialize:function(t,e){c(this,e),this._latlng=P(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=P(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return $i.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new w(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Qi=Ki.extend({initialize:function(t,i,n){if("number"==typeof i&&(i=e({},n,{radius:i})),c(this,i),this._latlng=P(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new T(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:$i.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===fe.distance){var r=Math.PI/180,o=this._mRadius/fe.R/r,s=i.project([e+o,t]),a=i.project([e-o,t]),u=s.add(a).divideBy(2),l=i.unproject(u).lat,c=Math.acos((Math.cos(o*r)-Math.sin(e*r)*Math.sin(l*r))/(Math.cos(e*r)*Math.cos(l*r)))/r;(isNaN(c)||0===c)&&(c=o/Math.cos(Math.PI/180*e)),this._point=u.subtract(i.getPixelOrigin()),this._radius=isNaN(c)?0:u.x-i.project([l,t-c]).x,this._radiusY=u.y-s.y}else{var h=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(h).x}this._updateBounds()}}),tn=$i.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){c(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,r=null,o=Dt,s=0,a=this._parts.length;s<a;s++)for(var u=this._parts[s],l=1,c=u.length;l<c;l++){var h=o(t,e=u[l-1],i=u[l],!0);h<n&&(n=h,r=o(t,e,i))}return r&&(r.distance=Math.sqrt(n)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,r,o,s,a=this._rings[0],u=a.length;if(!u)return null;for(t=0,e=0;t<u-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;t<u-1;t++)if(r=a[t],o=a[t+1],i=r.distanceTo(o),(n+=i)>e)return s=(n-e)/i,this._map.layerPointToLatLng([o.x-s*(o.x-r.x),o.y-s*(o.y-r.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=P(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new T,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return jt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=jt(t),n=0,r=t.length;n<r;n++)i?(e[n]=P(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new w;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new b(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var n,r,o=t[0]instanceof E,s=t.length;if(o){for(r=[],n=0;n<s;n++)r[n]=this._map.latLngToLayerPoint(t[n]),i.extend(r[n]);e.push(r)}else for(n=0;n<s;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,n,r,o,s,a,u=this._parts;for(e=0,n=0,r=this._rings.length;e<r;e++)for(i=0,o=(a=this._rings[e]).length;i<o-1;i++)(s=It(a[i],a[i+1],t,i,!0))&&(u[n]=u[n]||[],u[n].push(s[0]),s[1]===a[i+1]&&i!==o-2||(u[n].push(s[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=Pt(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,n,r,o,s,a,u=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,o=this._parts.length;i<o;i++)for(n=0,r=(s=(a=this._parts[i]).length)-1;n<s;r=n++)if((e||0!==n)&&Ct(t,a[r],a[n])<=u)return!0;return!1}});tn._flat=Nt;var en=tn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,r,o,s,a,u,l=this._rings[0],c=l.length;if(!c)return null;for(o=s=a=0,t=0,e=c-1;t<c;e=t++)i=l[t],n=l[e],r=i.y*n.x-n.y*i.x,s+=(i.x+n.x)*r,a+=(i.y+n.y)*r,o+=3*r;return u=0===o?l[0]:[s/o,a/o],this._map.layerPointToLatLng(u)},_convertLatLngs:function(t){var e=tn.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof E&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){tn.prototype._setLatLngs.call(this,t),jt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return jt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new b(e,e);if(t=new w(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,r=0,o=this._rings.length;r<o;r++)(n=Bt(this._rings[r],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,n,r,o,s,a,u,l=!1;if(!this._pxBounds.contains(t))return!1;for(r=0,a=this._parts.length;r<a;r++)for(o=0,s=(u=(e=this._parts[r]).length)-1;o<u;s=o++)i=e[o],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(l=!l);return l||tn.prototype._containsPoint.call(this,t,!0)}}),nn=Wi.extend({initialize:function(t,e){c(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,r=ie(t)?t:t.features;if(r){for(e=0,i=r.length;e<i;e++)((n=r[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var s=Ut(t,o);return s?(s.feature=Ht(t),s.defaultOptions=s.options,this.resetStyle(s),o.onEachFeature&&o.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),rn={toGeoJSON:function(t){return Wt(this,{type:"Point",coordinates:qt(this.getLatLng(),t)})}};Ji.include(rn),Qi.include(rn),Ki.include(rn),tn.include({toGeoJSON:function(t){var e=!jt(this._latlngs),i=Vt(this._latlngs,e?1:0,!1,t);return Wt(this,{type:(e?"Multi":"")+"LineString",coordinates:i})}}),en.include({toGeoJSON:function(t){var e=!jt(this._latlngs),i=e&&!jt(this._latlngs[0]),n=Vt(this._latlngs,i?2:e?1:0,!0,t);return e||(n=[n]),Wt(this,{type:(i?"Multi":"")+"Polygon",coordinates:n})}}),Vi.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(i){e.push(i.toGeoJSON(t).geometry.coordinates)}),Wt(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,n=[];return this.eachLayer(function(e){if(e.toGeoJSON){var r=e.toGeoJSON(t);if(i)n.push(r.geometry);else{var o=Ht(r);"FeatureCollection"===o.type?n.push.apply(n,o.features):n.push(o)}}}),i?Wt(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var on=Yt,sn=qi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=M(e),c(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(pt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){lt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ht(this._image),this},bringToBack:function(){return this._map&&ft(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=M(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:ut("img");pt(e,"leaflet-image-layer"),this._zoomAnimated&&pt(e,"leaflet-zoom-animated"),this.options.className&&pt(e,this.options.className),e.onselectstart=s,e.onmousemove=s,e.onload=i(this.fire,this,"load"),e.onerror=i(this._overlayOnError,this,"error"),this.options.crossOrigin&&(e.crossOrigin=""),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;xt(this._image,i,e)},_reset:function(){var t=this._image,e=new w(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();wt(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){vt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),an=sn.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:ut("video");if(pt(e,"leaflet-image-layer"),this._zoomAnimated&&pt(e,"leaflet-zoom-animated"),e.onselectstart=s,e.onmousemove=s,e.onloadeddata=i(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),r=[],o=0;o<n.length;o++)r.push(n[o].src);this._url=n.length>0?r:[e.src]}else{ie(this._url)||(this._url=[this._url]),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var a=0;a<this._url.length;a++){var u=ut("source");u.src=this._url[a],e.appendChild(u)}}}}),un=qi.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){c(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&vt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&vt(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(vt(this._container,0),this._removeTimeout=setTimeout(i(lt,void 0,this._container),200)):lt(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=P(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ht(this._container),this},bringToBack:function(){return this._map&&ft(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=x(this.options.offset),i=this._getAnchor();this._zoomAnimated?wt(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,r=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=r+"px"}},_getAnchor:function(){return[0,0]}}),ln=un.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){un.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof $i||this._source.on("preclick",X))},onRemove:function(t){un.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof $i||this._source.off("preclick",X))},getEvents:function(){var t=un.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=ut("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=ut("div",t+"-content-wrapper",e);if(this._contentNode=ut("div",t+"-content",i),$(i),J(this._contentNode),V(i,"contextmenu",X),this._tipContainer=ut("div",t+"-tip-container",e),this._tip=ut("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=ut("a",t+"-close-button",e);n.href="#close",n.innerHTML="&#215;",V(n,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,r=this.options.maxHeight;r&&n>r?(e.height=r+"px",pt(t,"leaflet-popup-scrolled")):mt(t,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();wt(this._container,e.add(i))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(at(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,r=new b(this._containerLeft,-i-this._containerBottom);r._add(Lt(this._container));var o=t.layerPointToContainerPoint(r),s=x(this.options.autoPanPadding),a=x(this.options.autoPanPaddingTopLeft||s),u=x(this.options.autoPanPaddingBottomRight||s),l=t.getSize(),c=0,h=0;o.x+n+u.x>l.x&&(c=o.x+n-l.x+u.x),o.x-c-a.x<0&&(c=o.x-a.x),o.y+i+u.y>l.y&&(h=o.y+i-l.y+u.y),o.y-h-a.y<0&&(h=o.y-a.y),(c||h)&&t.fire("autopanstart").panBy([c,h])}},_onCloseButtonClick:function(t){this._close(),Q(t)},_getAnchor:function(){return x(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});wi.mergeOptions({closePopupOnClick:!0}),wi.include({openPopup:function(t,e,i){return t instanceof ln||(t=new ln(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),qi.include({bindPopup:function(t,e){return t instanceof ln?(c(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new ln(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof qi||(e=t,t=this),t instanceof Wi)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(Q(t),e instanceof $i?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var cn=un.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){un.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){un.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=un.prototype.getEvents.call(this);return Ve&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ut("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,i=this._container,n=e.latLngToContainerPoint(e.getCenter()),r=e.layerPointToContainerPoint(t),o=this.options.direction,s=i.offsetWidth,a=i.offsetHeight,u=x(this.options.offset),l=this._getAnchor();"top"===o?t=t.add(x(-s/2+u.x,-a+u.y+l.y,!0)):"bottom"===o?t=t.subtract(x(s/2-u.x,-u.y,!0)):"center"===o?t=t.subtract(x(s/2+u.x,a/2-l.y+u.y,!0)):"right"===o||"auto"===o&&r.x<n.x?(o="right",t=t.add(x(u.x+l.x,l.y-a/2+u.y,!0))):(o="left",t=t.subtract(x(s+l.x-u.x,a/2-l.y-u.y,!0))),mt(i,"leaflet-tooltip-right"),mt(i,"leaflet-tooltip-left"),mt(i,"leaflet-tooltip-top"),mt(i,"leaflet-tooltip-bottom"),pt(i,"leaflet-tooltip-"+o),wt(i,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&vt(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return x(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});wi.include({openTooltip:function(t,e,i){return t instanceof cn||(t=new cn(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),qi.include({bindTooltip:function(t,e){return t instanceof cn?(c(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new cn(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),Ve&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof qi||(e=t,t=this),t instanceof Wi)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(pt(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(mt(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}});var hn=Hi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var n=x(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});Hi.Default=Yi;var fn=qi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Be,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){c(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),lt(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ht(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ft(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=r(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof b?t:new b(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),r=0,o=i.length;r<o;r++)e=i[r].style.zIndex,i[r]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!we){vt(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var r=this._tiles[n];if(r.current&&r.loaded){var o=Math.min(1,(t-r.loaded)/200);vt(r.el,o),o<1?e=!0:(r.active?i=!0:this._onOpaqueTile(r),r.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(g(this._fadeFrame),this._fadeFrame=_(this._updateOpacity,this))}},_onOpaqueTile:s,_initContainer:function(){this._container||(this._container=ut("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(lt(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var n=this._levels[t],r=this._map;return n||((n=this._levels[t]={}).el=ut("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,r.getCenter(),r.getZoom()),n.el.offsetWidth,this._onCreateLevel(n)),this._level=n,n}},_onUpdateLevel:s,_onRemoveLevel:s,_onCreateLevel:s,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)lt(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,n){var r=Math.floor(t/2),o=Math.floor(e/2),s=i-1,a=new b(+r,+o);a.z=+s;var u=this._tileCoordsToKey(a),l=this._tiles[u];return l&&l.active?(l.retain=!0,!0):(l&&l.loaded&&(l.retain=!0),s>n&&this._retainParent(r,o,s,n))},_retainChildren:function(t,e,i,n){for(var r=2*t;r<2*t+2;r++)for(var o=2*e;o<2*e+2;o++){var s=new b(r,o);s.z=i+1;var a=this._tileCoordsToKey(s),u=this._tiles[a];u&&u.active?u.retain=!0:(u&&u.loaded&&(u.retain=!0),i+1<n&&this._retainChildren(r,o,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,n){var r=this._clampZoom(Math.round(e));(void 0!==this.options.maxZoom&&r>this.options.maxZoom||void 0!==this.options.minZoom&&r<this.options.minZoom)&&(r=void 0);var o=this.options.updateWhenZooming&&r!==this._tileZoom;n&&!o||(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==r&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),r=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();Ne?xt(t.el,r,n):wt(t.el,r)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,r=this._map.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),r=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*n);return new w(r.subtract(o),r.add(o))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),r=this._pxBoundsToTileRange(n),o=r.getCenter(),s=[],a=this.options.keepBuffer,u=new w(r.getBottomLeft().subtract([a,-a]),r.getTopRight().add([a,-a]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var l in this._tiles){var c=this._tiles[l].coords;c.z===this._tileZoom&&u.contains(new b(c.x,c.y))||(this._tiles[l].current=!1)}if(Math.abs(i-this._tileZoom)>1)this._setView(t,i);else{for(var h=r.min.y;h<=r.max.y;h++)for(var f=r.min.x;f<=r.max.x;f++){var d=new b(f,h);if(d.z=this._tileZoom,this._isValidTile(d)){var p=this._tiles[this._tileCoordsToKey(d)];p?p.current=!0:s.push(d)}}if(s.sort(function(t,e){return t.distanceTo(o)-e.distanceTo(o)}),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(f=0;f<s.length;f++)this._addTile(s[f],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){
var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return M(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),r=n.add(i);return[e.unproject(n,t.z),e.unproject(r,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new T(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new b(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(Pe||e.el.setAttribute("src",ne),lt(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){pt(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=s,t.onmousemove=s,we&&this.options.opacity<1&&vt(t,this.options.opacity),Te&&!Me&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var n=this._getTilePos(t),r=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),i(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&_(i(this._tileReady,this,t,null,o)),wt(o,n),this._tiles[r]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,n){if(this._map){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var r=this._tileCoordsToKey(t);(n=this._tiles[r])&&(n.loaded=+new Date,this._map._fadeAnimated?(vt(n.el,0),g(this._fadeFrame),this._fadeFrame=_(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(pt(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),we||!this._map._fadeAnimated?_(this._pruneTiles,this):setTimeout(i(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new b(this._wrapX?o(t.x,this._wrapX):t.x,this._wrapY?o(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new w(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),dn=fn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=c(this,e)).detectRetina&&Ye&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),Te||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return V(n,"load",i(this._tileOnLoad,this,e,n)),V(n,"error",i(this._tileOnError,this,e,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var i={r:Ye?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(i.y=n),i["-y"]=n}return f(this._url,e(i,this.options))},_tileOnLoad:function(t,e){we?setTimeout(i(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.getAttribute("src")!==n&&(e.src=n),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,i=this.options.zoomReverse,n=this.options.zoomOffset;return i&&(t=e-t),t+n},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=s,e.onerror=s,e.complete||(e.src=ne,lt(e),delete this._tiles[t]))}}),pn=dn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,i){this._url=t;var n=e({},this.defaultWmsParams);for(var r in i)r in this.options||(n[r]=i[r]);var o=(i=c(this,i)).detectRetina&&Ye?2:1,s=this.getTileSize();n.width=s.x*o,n.height=s.y*o,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,dn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,n=S(i.project(e[0]),i.project(e[1])),r=n.min,o=n.max,s=(this._wmsVersion>=1.3&&this._crs===Zi?[r.y,r.x,o.y,o.x]:[r.x,r.y,o.x,o.y]).join(","),a=L.TileLayer.prototype.getTileUrl.call(this,t);return a+h(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,i){return e(this.wmsParams,t),i||this.redraw(),this}});dn.WMS=pn,Xt.wms=function(t,e){return new pn(t,e)};var mn=qi.extend({options:{padding:.1,tolerance:0},initialize:function(t){c(this,t),n(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&pt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=Lt(this._container),r=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),s=this._map.project(t,e).subtract(o),a=r.multiplyBy(-i).add(n).add(r).subtract(s);Ne?xt(this._container,a,i):wt(this._container,a)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new w(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),_n=mn.extend({getEvents:function(){var t=mn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){mn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");V(t,"mousemove",r(this._onMouseMove,32,this),this),V(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),V(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){delete this._ctx,lt(this._container),W(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var t in this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},mn.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=Ye?2:1;wt(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Ye&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){mn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[n(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[L.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,i=t.options.dashArray.split(","),n=[];for(e=0;e<i.length;e++)n.push(Number(i[e]));t.options._dashArray=n}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||_(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new w,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,r,o,s=t._parts,a=s.length,u=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,u.beginPath(),i=0;i<a;i++){for(n=0,r=s[i].length;n<r;n++)o=s[i][n],u[n?"lineTo":"moveTo"](o.x,o.y);e&&u.closePath()}this._fillStroke(u,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=Math.max(Math.round(t._radius),1),r=(Math.max(Math.round(t._radiusY),1)||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==r&&(i.save(),i.scale(1,r)),i.beginPath(),i.arc(e.x,e.y/r,n,0,2*Math.PI,!1),1!==r&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),r=this._drawFirst;r;r=r.next)(e=r.layer).options.interactive&&e._containsPoint(n)&&!this._map._draggableMoved(e)&&(i=e);i&&(it(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(mt(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var i,n,r=this._drawFirst;r;r=r.next)(i=r.layer).options.interactive&&i._containsPoint(e)&&(n=i);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(pt(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order,i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,i=e.next,n=e.prev;n&&(n.next=i,i?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}),gn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),vn={_initContainer:function(){this._container=ut("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(mn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=gn("shape");pt(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=gn("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[n(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;lt(e),t.removeInteractiveTarget(e),delete this._layers[n(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,r=t._container;r.stroked=!!n.stroke,r.filled=!!n.fill,n.stroke?(e||(e=t._stroke=gn("stroke")),r.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=ie(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(r.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=gn("fill")),r.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(r.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ht(t._container)},_bringToBack:function(t){ft(t._container)}},yn=$e?gn:k,bn=mn.extend({getEvents:function(){var t=mn.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=yn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=yn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){lt(this._container),W(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){mn.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),wt(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=yn("path");t.options.className&&pt(e,t.options.className),t.options.interactive&&pt(e,"leaflet-interactive"),this._updateStyle(t),this._layers[n(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){lt(t._path),t.removeInteractiveTarget(t._path),delete this._layers[n(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,z(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),n="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ht(t._path)},_bringToBack:function(t){ft(t._path)}});$e&&bn.include(vn),wi.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&Jt()||$t()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=bn&&$t({pane:t})||_n&&Jt({pane:t}),this._paneRenderers[t]=e),e}});var xn=en.extend({initialize:function(t,e){en.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=M(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});bn.create=yn,bn.pointsToPath=z,nn.geometryToLayer=Ut,nn.coordsToLatLng=Zt,nn.coordsToLatLngs=Gt,nn.latLngToCoords=qt,nn.latLngsToCoords=Vt,nn.getFeature=Wt,nn.asFeature=Ht,wi.mergeOptions({boxZoom:!0});var wn=Ci.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){V(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){W(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){lt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),me(),St(),this._startPoint=this._map.mouseEventToContainerPoint(t),V(document,{contextmenu:Q,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ut("div","leaflet-zoom-box",this._container),pt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new w(this._point,this._startPoint),i=e.getSize();wt(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(lt(this._box),mt(this._container,"leaflet-crosshair")),_e(),Tt(),W(document,{contextmenu:Q,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(i(this._resetState,this),0);var e=new T(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});wi.addInitHook("addHandler","boxZoom",wn),wi.mergeOptions({doubleClickZoom:!0});var Ln=Ci.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,r=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(r):e.setZoomAround(t.containerPoint,r)}});wi.addInitHook("addHandler","doubleClickZoom",Ln),wi.mergeOptions({dragging:!0,inertia:!Me,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Sn=Ci.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Oi(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}pt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){mt(this._map._container,"leaflet-grab"),mt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=M(this._map.options.maxBounds);this._offsetLimit=S(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,r=(n-e+i)%t+e-i,o=(n+e+i)%t-e-i,s=Math.abs(r+i)<Math.abs(o+i)?r:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{this._prunePositions(+new Date);var r=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,s=i.easeLinearity,a=r.multiplyBy(s/o),u=a.distanceTo([0,0]),l=Math.min(i.inertiaMaxSpeed,u),c=a.multiplyBy(l/u),h=l/(i.inertiaDeceleration*s),f=c.multiplyBy(-h/2).round();f.x||f.y?(f=e._limitOffset(f,e.options.maxBounds),_(function(){e.panBy(f,{duration:h,easeLinearity:s,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}});wi.addInitHook("addHandler","dragging",Sn),wi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Tn=Ci.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),V(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),W(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},r=this.keyCodes;for(e=0,i=r.left.length;e<i;e++)n[r.left[e]]=[-1*t,0];for(e=0,i=r.right.length;e<i;e++)n[r.right[e]]=[t,0];for(e=0,i=r.down.length;e<i;e++)n[r.down[e]]=[0,t];for(e=0,i=r.up.length;e<i;e++)n[r.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},r=this.keyCodes;for(e=0,i=r.zoomIn.length;e<i;e++)n[r.zoomIn[e]]=t;for(e=0,i=r.zoomOut.length;e<i;e++)n[r.zoomOut[e]]=-t},_addHooks:function(){V(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){W(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;e=this._panKeys[i],t.shiftKey&&(e=x(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Q(t)}}});wi.addInitHook("addHandler","keyboard",Tn),wi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Mn=Ci.extend({addHooks:function(){V(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){W(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=et(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var r=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i(this._performZoom,this),r),Q(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),r=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,o=i?Math.ceil(r/i)*i:r,s=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});wi.addInitHook("addHandler","scrollWheelZoom",Mn),wi.mergeOptions({tap:!0,tapTolerance:15});var En=Ci.extend({addHooks:function(){V(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){W(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(K(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new b(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&pt(n,"leaflet-active"),this._holdTimeout=setTimeout(i(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),V(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),W(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&mt(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new b(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var i=document.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}});Ve&&!qe&&wi.addInitHook("addHandler","tap",En),wi.mergeOptions({touchZoom:Ve&&!Me,bounceAtZoomLimits:!0});var Pn=Ci.extend({addHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),V(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){mt(this._map._container,"leaflet-touch-zoom"),W(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),V(document,"touchmove",this._onTouchMove,this),V(document,"touchend",this._onTouchEnd,this),K(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]),o=n.distanceTo(r)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var s=n._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===s.x&&0===s.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),g(this._animRequest);var a=i(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=_(a,this,!0),K(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,g(this._animRequest),W(document,"touchmove",this._onTouchMove),W(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});wi.addInitHook("addHandler","touchZoom",Pn),wi.BoxZoom=wn,wi.DoubleClickZoom=Ln,wi.Drag=Sn,wi.Keyboard=Tn,wi.ScrollWheelZoom=Mn,wi.Tap=En,wi.TouchZoom=Pn;var Cn=window.L;window.L=t,Object.freeze=Kt,t.version="1.3.1",t.noConflict=function(){return window.L=Cn,this},t.Control=Li,t.control=Si,t.Browser=Ke,t.Evented=le,t.Mixin=ki,t.Util=ae,t.Class=v,t.Handler=Ci,t.extend=e,t.bind=i,t.stamp=n,t.setOptions=c,t.DomEvent=di,t.DomUtil=bi,t.PosAnimation=xi,t.Draggable=Oi,t.LineUtil=Fi,t.PolyUtil=Di,t.Point=b,t.point=x,t.Bounds=w,t.bounds=S,t.Transformation=C,t.transformation=A,t.Projection=Bi,t.LatLng=E,t.latLng=P,t.LatLngBounds=T,t.latLngBounds=M,t.CRS=he,t.GeoJSON=nn,t.geoJSON=Yt,t.geoJson=on,t.Layer=qi,t.LayerGroup=Vi,t.layerGroup=function(t,e){return new Vi(t,e)},t.FeatureGroup=Wi,t.featureGroup=function(t){return new Wi(t)},t.ImageOverlay=sn,t.imageOverlay=function(t,e,i){return new sn(t,e,i)},t.VideoOverlay=an,t.videoOverlay=function(t,e,i){return new an(t,e,i)},t.DivOverlay=un,t.Popup=ln,t.popup=function(t,e){return new ln(t,e)},t.Tooltip=cn,t.tooltip=function(t,e){return new cn(t,e)},t.Icon=Hi,t.icon=function(t){return new Hi(t)},t.DivIcon=hn,t.divIcon=function(t){return new hn(t)},t.Marker=Ji,t.marker=function(t,e){return new Ji(t,e)},t.TileLayer=dn,t.tileLayer=Xt,t.GridLayer=fn,t.gridLayer=function(t){return new fn(t)},t.SVG=bn,t.svg=$t,t.Renderer=mn,t.Canvas=_n,t.canvas=Jt,t.Path=$i,t.CircleMarker=Ki,t.circleMarker=function(t,e){return new Ki(t,e)},t.Circle=Qi,t.circle=function(t,e,i){return new Qi(t,e,i)},t.Polyline=tn,t.polyline=function(t,e){
return new tn(t,e)},t.Polygon=en,t.polygon=function(t,e){return new en(t,e)},t.Rectangle=xn,t.rectangle=function(t,e){return new xn(t,e)},t.Map=wi,t.map=function(t,e){return new wi(t,e)}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],e):e((t.L=t.L||{},t.L.esri={}),t.L)}(this,function(t,e){"use strict";function i(t){var e="";t.f=t.f||"json";for(var i in t)if(t.hasOwnProperty(i)){var n,r=t[i],o=Object.prototype.toString.call(r);e.length&&(e+="&"),n="[object Array]"===o?"[object Object]"===Object.prototype.toString.call(r[0])?JSON.stringify(r):r.join(","):"[object Object]"===o?JSON.stringify(r):"[object Date]"===o?r.valueOf():r,e+=encodeURIComponent(i)+"="+encodeURIComponent(n)}return e}function n(t,i){var n=new window.XMLHttpRequest;return n.onerror=function(r){n.onreadystatechange=e.Util.falseFn,t.call(i,{error:{code:500,message:"XMLHttpRequest error"}},null)},n.onreadystatechange=function(){var r,o;if(4===n.readyState){try{r=JSON.parse(n.responseText)}catch(t){r=null,o={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!o&&r.error&&(o=r.error,r=null),n.onerror=e.Util.falseFn,t.call(i,o,r)}},n.ontimeout=function(){this.onerror()},n}function r(t,e,r,o){var s=n(r,o);return s.open("POST",t),void 0!==o&&null!==o&&void 0!==o.options&&(s.timeout=o.options.timeout),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.send(i(e)),s}function o(t,e,r,o){var s=n(r,o);return s.open("GET",t+"?"+i(e),!0),void 0!==o&&null!==o&&void 0!==o.options&&(s.timeout=o.options.timeout),s.send(null),s}function s(t,e,r,o){var s=i(e),u=n(r,o),l=(t+"?"+s).length;if(l<=2e3&&nt.cors?u.open("GET",t+"?"+s):l>2e3&&nt.cors&&(u.open("POST",t),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),void 0!==o&&null!==o&&void 0!==o.options&&(u.timeout=o.options.timeout),l<=2e3&&nt.cors)u.send(null);else{if(!(l>2e3&&nt.cors))return l<=2e3&&!nt.cors?a(t,e,r,o):void I("a request to "+t+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");u.send(s)}return u}function a(t,n,r,o){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var s="c"+ot;n.callback="window._EsriLeafletCallbacks."+s,window._EsriLeafletCallbacks[s]=function(t){if(!0!==window._EsriLeafletCallbacks[s]){var e,i=Object.prototype.toString.call(t);"[object Object]"!==i&&"[object Array]"!==i&&(e={error:{code:500,message:"Expected array or object as JSONP response"}},t=null),!e&&t.error&&(e=t,t=null),r.call(o,e,t),window._EsriLeafletCallbacks[s]=!0}};var a=e.DomUtil.create("script",null,document.body);return a.type="text/javascript",a.src=t+"?"+i(n),a.id=s,a.onerror=function(t){if(t&&!0!==window._EsriLeafletCallbacks[s]){var e={error:{code:500,message:"An unknown error occurred"}};r.call(o,e),window._EsriLeafletCallbacks[s]=!0}},e.DomUtil.addClass(a,"esri-leaflet-jsonp"),ot++,{id:s,url:a.src,abort:function(){window._EsriLeafletCallbacks._callback[s]({code:0,message:"Request aborted."})}}}function u(t,e){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function l(t){return u(t[0],t[t.length-1])||t.push(t[0]),t}function c(t){var e,i=0,n=0,r=t.length,o=t[n];for(n;n<r-1;n++)e=t[n+1],i+=(e[0]-o[0])*(e[1]+o[1]),o=e;return i>=0}function h(t,e,i,n){var r=(n[0]-i[0])*(t[1]-i[1])-(n[1]-i[1])*(t[0]-i[0]),o=(e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]),s=(n[1]-i[1])*(e[0]-t[0])-(n[0]-i[0])*(e[1]-t[1]);if(0!==s){var a=r/s,u=o/s;if(a>=0&&a<=1&&u>=0&&u<=1)return!0}return!1}function f(t,e){for(var i=0;i<t.length-1;i++)for(var n=0;n<e.length-1;n++)if(h(t[i],t[i+1],e[n],e[n+1]))return!0;return!1}function d(t,e){for(var i=!1,n=-1,r=t.length,o=r-1;++n<r;o=n)(t[n][1]<=e[1]&&e[1]<t[o][1]||t[o][1]<=e[1]&&e[1]<t[n][1])&&e[0]<(t[o][0]-t[n][0])*(e[1]-t[n][1])/(t[o][1]-t[n][1])+t[n][0]&&(i=!i);return i}function p(t,e){var i=f(t,e),n=d(t,e[0]);return!(i||!n)}function m(t){for(var e,i,n,r=[],o=[],s=0;s<t.length;s++){var a=l(t[s].slice(0));if(!(a.length<4))if(c(a)){var u=[a.slice().reverse()];r.push(u)}else o.push(a.slice().reverse())}for(var h=[];o.length;){n=o.pop();var d=!1;for(e=r.length-1;e>=0;e--)if(i=r[e][0],p(i,n)){r[e].push(n),d=!0;break}d||h.push(n)}for(;h.length;){n=h.pop();var m=!1;for(e=r.length-1;e>=0;e--)if(i=r[e][0],f(i,n)){r[e].push(n),m=!0;break}m||r.push([n.reverse()])}return 1===r.length?{type:"Polygon",coordinates:r[0]}:{type:"MultiPolygon",coordinates:r}}function _(t){var e=[],i=t.slice(0),n=l(i.shift().slice(0));if(n.length>=4){c(n)||n.reverse(),e.push(n);for(var r=0;r<i.length;r++){var o=l(i[r].slice(0));o.length>=4&&(c(o)&&o.reverse(),e.push(o))}}return e}function g(t){for(var e=[],i=0;i<t.length;i++)for(var n=_(t[i]),r=n.length-1;r>=0;r--){var o=n[r].slice(0);e.push(o)}return e}function v(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function y(t,e){for(var i=e?[e,"OBJECTID","FID"]:["OBJECTID","FID"],n=0;n<i.length;n++){var r=i[n];if(r in t&&("string"==typeof t[r]||"number"==typeof t[r]))return t[r]}throw Error("No valid id attribute found")}function b(t,e){var i={};if(t.features){i.type="FeatureCollection",i.features=[];for(var n=0;n<t.features.length;n++)i.features.push(b(t.features[n],e))}if("number"==typeof t.x&&"number"==typeof t.y&&(i.type="Point",i.coordinates=[t.x,t.y],"number"==typeof t.z&&i.coordinates.push(t.z)),t.points&&(i.type="MultiPoint",i.coordinates=t.points.slice(0)),t.paths&&(1===t.paths.length?(i.type="LineString",i.coordinates=t.paths[0].slice(0)):(i.type="MultiLineString",i.coordinates=t.paths.slice(0))),t.rings&&(i=m(t.rings.slice(0))),"number"==typeof t.xmin&&"number"==typeof t.ymin&&"number"==typeof t.xmax&&"number"==typeof t.ymax&&(i.type="Polygon",i.coordinates=[[[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax]]]),(t.geometry||t.attributes)&&(i.type="Feature",i.geometry=t.geometry?b(t.geometry):null,i.properties=t.attributes?v(t.attributes):null,t.attributes))try{i.id=y(t.attributes,e)}catch(t){}return JSON.stringify(i.geometry)===JSON.stringify({})&&(i.geometry=null),t.spatialReference&&t.spatialReference.wkid&&4326!==t.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(t.spatialReference)),i}function x(t,e){e=e||"OBJECTID";var i,n={wkid:4326},r={};switch(t.type){case"Point":r.x=t.coordinates[0],r.y=t.coordinates[1],r.spatialReference=n;break;case"MultiPoint":r.points=t.coordinates.slice(0),r.spatialReference=n;break;case"LineString":r.paths=[t.coordinates.slice(0)],r.spatialReference=n;break;case"MultiLineString":r.paths=t.coordinates.slice(0),r.spatialReference=n;break;case"Polygon":r.rings=_(t.coordinates.slice(0)),r.spatialReference=n;break;case"MultiPolygon":r.rings=g(t.coordinates.slice(0)),r.spatialReference=n;break;case"Feature":t.geometry&&(r.geometry=x(t.geometry,e)),r.attributes=t.properties?v(t.properties):{},t.id&&(r.attributes[e]=t.id);break;case"FeatureCollection":for(r=[],i=0;i<t.features.length;i++)r.push(x(t.features[i],e));break;case"GeometryCollection":for(r=[],i=0;i<t.geometries.length;i++)r.push(x(t.geometries[i],e))}return r}function w(t,e){return x(t,e)}function L(t,e){return b(t,e)}function S(t){if("NaN"!==t.xmin&&"NaN"!==t.ymin&&"NaN"!==t.xmax&&"NaN"!==t.ymax){var i=e.latLng(t.ymin,t.xmin),n=e.latLng(t.ymax,t.xmax);return e.latLngBounds(i,n)}return null}function T(t){return t=e.latLngBounds(t),{xmin:t.getSouthWest().lng,ymin:t.getSouthWest().lat,xmax:t.getNorthEast().lng,ymax:t.getNorthEast().lat,spatialReference:{wkid:4326}}}function M(t){var e;if(t.objectIdFieldName)e=t.objectIdFieldName;else if(t.fields){for(var i=0;i<=t.fields.length-1;i++)if("esriFieldTypeOID"===t.fields[i].type){e=t.fields[i].name;break}if(!e)for(i=0;i<=t.fields.length-1;i++)if(t.fields[i].name.match(ut)){e=t.fields[i].name;break}}return e}function E(t){for(var e in t.attributes)if(e.match(ut))return e}function P(t,e){var i,n=t.features||t.results,r=n.length;i=e||M(t);var o={type:"FeatureCollection",features:[]};if(r)for(var s=n.length-1;s>=0;s--){var a=L(n[s],i||E(n[s]));o.features.push(a)}return o}function C(t){return t=e.Util.trim(t),"/"!==t[t.length-1]&&(t+="/"),t}function A(t){if(-1!==t.url.indexOf("?")){t.requestParams=t.requestParams||{};var e=t.url.substring(t.url.indexOf("?")+1);t.url=t.url.split("?")[0],t.requestParams=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return t.url=C(t.url.split("?")[0]),t}function k(t){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(t)}function z(t){var e;switch(t){case"Point":e="esriGeometryPoint";break;case"MultiPoint":e="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":e="esriGeometryPolyline";break;case"Polygon":case"MultiPolygon":e="esriGeometryPolygon"}return e}function I(){console&&console.warn&&console.warn.apply(console,arguments)}function R(t){return t.getSize().x-rt.attributionWidthOffset+"px"}function O(t){if(t.attributionControl&&!t.attributionControl._esriAttributionAdded){t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | Powered by <a href="https://www.esri.com">Esri</a>');var i=document.createElement("style");i.type="text/css",i.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(i),e.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution:hover");var n=document.createElement("style");n.type="text/css",n.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+R(t)+";}",document.getElementsByTagName("head")[0].appendChild(n),e.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution"),t.on("resize",function(e){t.attributionControl._container.style.maxWidth=R(e.target)}),t.on("unload",function(){i.parentNode.removeChild(i),n.parentNode.removeChild(n);for(var t=document.querySelectorAll(".esri-leaflet-jsonp"),e=0;e<t.length;e++)t.item(e).parentNode.removeChild(t.item(e))}),t.attributionControl._esriAttributionAdded=!0}}function F(t){var i={geometry:null,geometryType:null};return t instanceof e.LatLngBounds?(i.geometry=T(t),i.geometryType="esriGeometryEnvelope",i):(t.getLatLng&&(t=t.getLatLng()),t instanceof e.LatLng&&(t={type:"Point",coordinates:[t.lng,t.lat]}),t instanceof e.GeoJSON&&(t=t.getLayers()[0].feature.geometry,i.geometry=w(t),i.geometryType=z(t.type)),t.toGeoJSON&&(t=t.toGeoJSON()),"Feature"===t.type&&(t=t.geometry),"Point"===t.type||"LineString"===t.type||"Polygon"===t.type||"MultiPolygon"===t.type?(i.geometry=w(t),i.geometryType=z(t.type),i):void I("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}function D(t,i){a(t,{},e.Util.bind(function(t,n){if(!t){i._esriAttributions=[];for(var r=0;r<n.contributors.length;r++)for(var o=n.contributors[r],s=0;s<o.coverageAreas.length;s++){var a=o.coverageAreas[s],u=e.latLng(a.bbox[0],a.bbox[1]),l=e.latLng(a.bbox[2],a.bbox[3]);i._esriAttributions.push({attribution:o.attribution,score:a.score,bounds:e.latLngBounds(u,l),minZoom:a.zoomMin,maxZoom:a.zoomMax})}i._esriAttributions.sort(function(t,e){return e.score-t.score});j({target:i})}},this))}function j(t){var i=t.target,n=i._esriAttributions,r=i.attributionControl._container.querySelector(".esri-dynamic-attribution");if(i&&i.attributionControl&&r&&n){for(var o="",s=i.getBounds(),a=e.latLngBounds(s.getSouthWest().wrap(),s.getNorthEast().wrap()),u=i.getZoom(),l=0;l<n.length;l++){var c=n[l],h=c.attribution;!o.match(h)&&c.bounds.intersects(a)&&u>=c.minZoom&&u<=c.maxZoom&&(o+=", "+h)}o=o.substr(2),r.innerHTML=o,r.style.maxWidth=R(i),i.fire("attributionupdated",{attribution:o})}}function N(t){return t=A(t),new ct(t)}function B(t){return new ht(t)}function U(t){return new ft(t)}function Z(t){return new dt(t)}function G(t){return new pt(t)}function q(t){return new mt(t)}function V(t){return t=A(t),new _t(t)}function W(t){return new gt(t)}function H(t){return new vt(t)}function Y(t){return new yt(t)}function X(t,e){return new xt(t,e)}function J(t,e){return new wt(t,e)}function $(t,e){return new Tt(t,e)}function K(t,e){return new Mt(t,e)}function Q(t){this.values=[].concat(t||[])}function tt(t){return new Ct(t)}var et=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,it=""===document.documentElement.style.pointerEvents,nt={cors:et,pointerEvents:it},rt={attributionWidthOffset:55},ot=0,st=nt.cors?o:a;st.CORS=o,st.JSONP=a;var at={request:s,get:st,post:r},ut=/^(OBJECTID|FID|OID|ID)$/i,lt={warn:I,cleanUrl:C,getUrlParams:A,isArcgisOnline:k,geojsonTypeToArcGIS:z,responseToFeatureCollection:P,geojsonToArcGIS:w,arcgisToGeoJSON:L,boundsToExtent:T,extentToBounds:S,calcAttributionWidth:R,setEsriAttribution:O,_setGeometry:F,_getAttributionData:D,_updateMapAttribution:j,_findIdAttributeFromFeature:E,_findIdAttributeFromResponse:M},ct=e.Class.extend({options:{proxy:!1,useCors:et},generateSetter:function(t,i){return e.Util.bind(function(e){return this.params[t]=e,this},i)},initialize:function(t){if(t.request&&t.options?(this._service=t,e.Util.setOptions(this,t.options)):(e.Util.setOptions(this,t),this.options.url=C(t.url)),this.params=e.Util.extend({},this.params||{}),this.setters)for(var i in this.setters){var n=this.setters[i];this[i]=this.generateSetter(n,this)}},token:function(t){return this._service?this._service.authenticate(t):this.params.token=t,this},format:function(t){return this.params.returnUnformattedValues=!t,this},request:function(t,i){return this.options.requestParams&&e.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,t,i):this._request("request",this.path,this.params,t,i)},_request:function(t,e,i,n,r){var o=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?at[t](o,i,n,r):at.get.JSONP(o,i,n,r)}}),ht=ct.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSr:4326,outFields:"*"},within:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(t,i){return t=e.latLng(t),this.params.geometry=[t.lng,t.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=i,this.params.inSr=4326,this},where:function(t){return this.params.where=t,this},between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},orderBy:function(t,e){return e=e||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[t,e].join(" "),this},run:function(t,e){return this._cleanParams(),this.options.isModern||k(this.options.url)?(this.params.f="geojson",this.request(function(i,n){this._trapSQLerrors(i),t.call(e,i,n,n)},this)):this.request(function(i,n){this._trapSQLerrors(i),t.call(e,i,n&&P(n),n)},this)},count:function(t,e){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(e,i){t.call(this,e,i&&i.count,i)},e)},ids:function(t,e){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(e,i){t.call(this,e,i&&i.objectIds,i)},e)},bounds:function(t,e){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(i,n){n&&n.extent&&S(n.extent)?t.call(e,i,S(n.extent),n):(i={message:"Invalid Bounds"},t.call(e,i,null,n))},e)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(t){var i=e.point(t);return this.params.pixelSize=[i.x,i.y],this},layer:function(t){return this.path=t+"/query",this},_trapSQLerrors:function(t){t&&"400"===t.code&&I("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(t){this.params.inSr=4326;var e=F(t);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}}),ft=ct.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request(function(i,n){t.call(e,i,n&&P(n),n)},e)}}),dt=ct.extend({path:"identify",between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this}}),pt=dt.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(t){var e=T(t.getBounds()),i=t.getSize();return this.params.imageDisplay=[i.x,i.y,96],this.params.mapExtent=[e.xmin,e.ymin,e.xmax,e.ymax],this},at:function(t){return 2===t.length&&(t=e.latLng(t)),this._setGeometryParams(t),this},layerDef:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request(function(i,n){if(i)return void t.call(e,i,void 0,n);var r=P(n);n.results=n.results.reverse();for(var o=0;o<r.features.length;o++){r.features[o].layerId=n.results[o].layerId}t.call(e,void 0,r,n)})},_setGeometryParams:function(t){var e=F(t);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}}),mt=dt.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(t){return t=e.latLng(t),this.params.geometry=JSON.stringify({x:t.lng,y:t.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(t,e){return this.request(function(i,n){t.call(e,i,n&&this._responseToGeoJSON(n),n)},this)},_responseToGeoJSON:function(t){var e=t.location,i=t.catalogItems,n=t.catalogItemVisibilities,r={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[e.x,e.y]},crs:{type:"EPSG",properties:{code:e.spatialReference.wkid}},properties:{OBJECTID:t.objectId,name:t.name,value:t.value},id:t.objectId}};if(t.properties&&t.properties.Values&&(r.pixel.properties.values=t.properties.Values),i&&i.features&&(r.catalogItems=P(i),n&&n.length===r.catalogItems.features.length))for(var o=n.length-1;o>=0;o--)r.catalogItems.features[o].properties.catalogItemVisibility=n[o];return r}}),_t=e.Evented.extend({options:{proxy:!1,useCors:et,timeout:0},initialize:function(t){t=t||{},this._requestQueue=[],this._authenticating=!1,e.Util.setOptions(this,t),this.options.url=C(this.options.url)},get:function(t,e,i,n){return this._request("get",t,e,i,n)},post:function(t,e,i,n){return this._request("post",t,e,i,n)},request:function(t,e,i,n){return this._request("request",t,e,i,n)},metadata:function(t,e){return this._request("get","",{},t,e)},authenticate:function(t){return this._authenticating=!1,this.options.token=t,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(t){this.options.timeout=t},_request:function(t,i,n,r,o){this.fire("requeststart",{url:this.options.url+i,params:n,method:t},!0);var s=this._createServiceCallback(t,i,n,r,o);if(this.options.token&&(n.token=this.options.token),this.options.requestParams&&e.Util.extend(n,this.options.requestParams),this._authenticating)return void this._requestQueue.push([t,i,n,r,o]);var a=this.options.proxy?this.options.proxy+"?"+this.options.url+i:this.options.url+i;return"get"!==t&&"request"!==t||this.options.useCors?at[t](a,n,s,o):at.get.JSONP(a,n,s,o)},_createServiceCallback:function(t,i,n,r,o){return e.Util.bind(function(s,a){!s||499!==s.code&&498!==s.code||(this._authenticating=!0,this._requestQueue.push([t,i,n,r,o]),this.fire("authenticationrequired",{authenticate:e.Util.bind(this.authenticate,this)},!0),s.authenticate=e.Util.bind(this.authenticate,this)),r.call(o,s,a),s?this.fire("requesterror",{url:this.options.url+i,params:n,message:s.message,code:s.code,method:t},!0):this.fire("requestsuccess",{url:this.options.url+i,params:n,response:a,method:t},!0),this.fire("requestend",{url:this.options.url+i,params:n,method:t},!0)},this)},_runQueue:function(){for(var t=this._requestQueue.length-1;t>=0;t--){var e=this._requestQueue[t];this[e.shift()].apply(this,e)}this._requestQueue=[]}}),gt=_t.extend({identify:function(){return G(this)},find:function(){return U(this)},query:function(){return B(this)}}),vt=_t.extend({query:function(){return B(this)},identify:function(){return q(this)}}),yt=_t.extend({options:{idAttribute:"OBJECTID"},query:function(){return B(this)},addFeature:function(t,e,i){this.addFeatures(t,e,i)},addFeatures:function(t,e,i){for(var n=t.features?t.features:[t],r=n.length-1;r>=0;r--)delete n[r].id;return t=w(t),t=n.length>1?t:[t],this.post("addFeatures",{features:t},function(t,n){var r=n&&n.addResults?n.addResults.length>1?n.addResults:n.addResults[0]:void 0;e&&e.call(i,t||n.addResults[0].error,r)},i)},updateFeature:function(t,e,i){this.updateFeatures(t,e,i)},updateFeatures:function(t,e,i){var n=t.features?t.features:[t];return t=w(t,this.options.idAttribute),t=n.length>1?t:[t],this.post("updateFeatures",{features:t},function(t,n){var r=n&&n.updateResults?n.updateResults.length>1?n.updateResults:n.updateResults[0]:void 0;e&&e.call(i,t||n.updateResults[0].error,r)},i)},deleteFeature:function(t,e,i){this.deleteFeatures(t,e,i)},deleteFeatures:function(t,e,i){return this.post("deleteFeatures",{objectIds:t},function(t,n){var r=n&&n.deleteResults?n.deleteResults.length>1?n.deleteResults:n.deleteResults[0]:void 0;e&&e.call(i,t||n.deleteResults[0].error,r)},i)}}),bt="https:"!==window.location.protocol?"http:":"https:",xt=e.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:bt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:it?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:it?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:it?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:it?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:it?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:it?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:it?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:bt+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:bt+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:bt+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(t,i){var n;if("object"==typeof t&&t.urlTemplate&&t.options)n=t;else{if("string"!=typeof t||!xt.TILES[t])throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');n=xt.TILES[t]}var r=e.Util.extend(n.options,i);e.Util.setOptions(this,r),this.options.token&&-1===n.urlTemplate.indexOf("token=")&&(n.urlTemplate+="?token="+this.options.token),e.TileLayer.prototype.initialize.call(this,n.urlTemplate,r)},onAdd:function(t){O(t),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&D(this.options.attributionUrl,t),t.on("moveend",j),e.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){t.off("moveend",j),e.TileLayer.prototype.onRemove.call(this,t)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var t=this._map.createPane(this.options.pane);t.style.pointerEvents="none",t.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var t='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return t}}),wt=e.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(t){t=e.Util.setOptions(this,t),t=A(t),this.tileUrl=(t.proxy?t.proxy+"?":"")+t.url+"tile/{z}/{y}/{x}"+(t.requestParams&&Object.keys(t.requestParams).length>0?e.Util.getParamString(t.requestParams):""),-1!==t.url.indexOf("{s}")&&t.subdomains&&(t.url=t.url.replace("{s}",t.subdomains[0])),this.service=W(t),
this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(t.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),t.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),e.TileLayer.prototype.initialize.call(this,this.tileUrl,t)},getTileUrl:function(t){var i=this._getZoomForUrl();return e.Util.template(this.tileUrl,e.Util.extend({s:this._getSubdomain(t),x:t.x,y:t.y,z:this._lodMap&&this._lodMap[i]?this._lodMap[i]:i},this.options))},createTile:function(t,i){var n=document.createElement("img");return e.DomEvent.on(n,"load",e.Util.bind(this._tileOnLoad,this,i,n)),e.DomEvent.on(n,"error",e.Util.bind(this._tileOnError,this,i,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?n.src=this.getTileUrl(t):this.once("lodmap",function(){n.src=this.getTileUrl(t)},this),n},onAdd:function(t){O(t),this._lodMap||this.metadata(function(i,n){if(!i&&n.spatialReference){var r=n.spatialReference.latestWkid||n.spatialReference.wkid;if(!this.options.attribution&&t.attributionControl&&n.copyrightText&&(this.options.attribution=n.copyrightText,t.attributionControl.addAttribution(this.getAttribution())),t.options.crs!==e.CRS.EPSG3857||102100!==r&&3857!==r)t.options.crs&&t.options.crs.code&&t.options.crs.code.indexOf(r)>-1||I("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html");else{this._lodMap={};for(var o=n.tileInfo.lods,s=wt.MercatorZoomLevels,a=0;a<o.length;a++){var u=o[a];for(var l in s){var c=s[l];if(this._withinPercentage(u.resolution,c,this.options.zoomOffsetAllowance)){this._lodMap[l]=u.level;break}}}this.fire("lodmap")}}},this),e.TileLayer.prototype.onAdd.call(this,t)},metadata:function(t,e){return this.service.metadata(t,e),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(t){var e="?token="+t;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,e):this.tileUrl+e,this.options.token=t,this.service.authenticate(t),this},_withinPercentage:function(t,e,i){return Math.abs(t/e-1)<i}}),Lt=e.ImageOverlay.extend({onAdd:function(t){this._topLeft=t.getPixelBounds().min,e.ImageOverlay.prototype.onAdd.call(this,t)},_reset:function(){this._map.options.crs===e.CRS.EPSG3857?e.ImageOverlay.prototype._reset.call(this):e.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),St=e.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:et,attribution:null,interactive:!1,alt:""},onAdd:function(t){O(t),this._update=e.Util.throttle(this._update,this.options.updateInterval,this),t.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?t.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(e,i){!e&&!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(t){this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(t,i){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=e.popup(i),this._popupFunction=t,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&this._currentImage.bringToFront(),this},bringToBack:function(){return this.options.position="back",this._currentImage&&this._currentImage.bringToBack(),this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(t){return this.options.opacity=t,this._currentImage&&this._currentImage.setOpacity(t),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,e){return this.options.from=t,this.options.to=e,this._update(),this},metadata:function(t,e){return this.service.metadata(t,e),this},authenticate:function(t){return this.service.authenticate(t),this},redraw:function(){this._update()},_renderImage:function(t,e,i){if(this._map){if(i&&(t="data:"+i+";base64,"+t),!t)return;var n=new Lt(t,e,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),r=function(){this._map.removeLayer(n),this.fire("error"),n.off("load",o,this)},o=function(t){if(n.off("error",o,this),this._map){var i=t.target,r=this._currentImage;i._bounds.equals(e)&&i._bounds.equals(this._map.getBounds())?(this._currentImage=i,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),r&&this._map&&this._map.removeLayer(r),r&&r._map&&r._map.removeLayer(r)):this._map.removeLayer(i)}this.fire("load",{bounds:e})};n.once("error",r,this),n.once("load",o,this),this.fire("loading",{bounds:e})}},_update:function(){if(this._map){var t=this._map.getZoom(),i=this._map.getBounds();if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress)){if(t>this.options.maxZoom||t<this.options.minZoom)return void(this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null));var n=this._buildExportParams();e.Util.extend(n,this.options.requestParams),n?this._requestExport(n,i):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(t,i,n,r){if(t=e.latLng(t),this._shouldRenderPopup&&this._lastClick.equals(t)){var o=this._popupFunction(i,n,r);o&&this._popup.setLatLng(t).setContent(o).openOn(this._map)}},_resetPopupState:function(t){this._shouldRenderPopup=!1,this._lastClick=t.latlng},_calculateBbox:function(){var t=this._map.getPixelBounds(),i=this._map.unproject(t.getBottomLeft()),n=this._map.unproject(t.getTopRight()),r=this._map.options.crs.project(n),o=this._map.options.crs.project(i),s=e.bounds(r,o);return[s.getBottomLeft().x,s.getBottomLeft().y,s.getTopRight().x,s.getTopRight().y].join(",")},_calculateImageSize:function(){var t=this._map.getPixelBounds(),e=this._map.getSize(),i=this._map.unproject(t.getBottomLeft()),n=this._map.unproject(t.getTopRight()),r=this._map.latLngToLayerPoint(n).y,o=this._map.latLngToLayerPoint(i).y;return(r>0||o<e.y)&&(e.y=o-r),e.x+","+e.y}}),Tt=St.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(t){t=A(t),this.service=H(t),this.service.addEventParent(this),e.Util.setOptions(this,t)},setPixelType:function(t){return this.options.pixelType=t,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(t){return e.Util.isArray(t)?this.options.bandIds=t.join(","):this.options.bandIds=t.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(t,i){return e.Util.isArray(t)?this.options.noData=t.join(","):this.options.noData=t.toString(),i&&(this.options.noDataInterpretation=i),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(t){this.options.renderingRule=t,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(t){this.options.mosaicRule=t,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(t){var i=e.Util.bind(function(i,n,r){i||setTimeout(e.Util.bind(function(){this._renderPopup(t.latlng,i,n,r)},this),300)},this),n=this.identify().at(t.latlng);this.options.mosaicRule&&n.setMosaicRule(this.options.mosaicRule),n.run(i),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=parseInt(this._map.options.crs.code.split(":")[1],10),e={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:t,imageSR:t};return this.options.from&&this.options.to&&(e.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(e.pixelType=this.options.pixelType),this.options.interpolation&&(e.interpolation=this.options.interpolation),this.options.compressionQuality&&(e.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(e.bandIds=this.options.bandIds),(0===this.options.noData||this.options.noData)&&(e.noData=this.options.noData),this.options.noDataInterpretation&&(e.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(e.token=this.service.options.token),this.options.renderingRule&&(e.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(e.mosaicRule=JSON.stringify(this.options.mosaicRule)),e},_requestExport:function(t,i){"json"===this.options.f?this.service.request("exportImage",t,function(t,e){t||(this.options.token&&(e.href+="?token="+this.options.token),this._renderImage(e.href,i))},this):(t.f="image",this._renderImage(this.options.url+"exportImage"+e.Util.getParamString(t),i))}}),Mt=St.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(t){t=A(t),this.service=W(t),this.service.addEventParent(this),(t.proxy||t.token)&&"json"!==t.f&&(t.f="json"),e.Util.setOptions(this,t)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(t){return this.options.dynamicLayers=t,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(t){return this.options.layers=t,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(t){return this.options.layerDefs=t,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(t){return this.options.timeOptions=t,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(t){var i,n=e.Util.bind(function(i,n,r){i||setTimeout(e.Util.bind(function(){this._renderPopup(t.latlng,i,n,r)},this),300)},this);if(i=this.options.popup?this.options.popup.on(this._map).at(t.latlng):this.identify().on(this._map).at(t.latlng),!!i.params.maxAllowableOffset||i.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?i.layers("visible:"+this.options.layers.join(",")):i.layers("visible")),this.options.layerDefs&&"string"!=typeof this.options.layerDefs&&!i.params.layerDefs)for(var r in this.options.layerDefs)this.options.layerDefs.hasOwnProperty(r)&&i.layerDef(r,this.options.layerDefs[r]);i.run(n),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=parseInt(this._map.options.crs.code.split(":")[1],10),e={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:t,imageSR:t};if(this.options.dynamicLayers&&(e.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(0===this.options.layers.length)return;e.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(e.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(e.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(e.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(e.token=this.service.options.token),this.options.proxy&&(e.proxy=this.options.proxy),this.options.disableCache&&(e._ts=Date.now()),e},_requestExport:function(t,i){"json"===this.options.f?this.service.request("export",t,function(t,e){t||(this.options.token&&(e.href+="?token="+this.options.token),this.options.proxy&&(e.href=this.options.proxy+"?"+e.href),e.href?this._renderImage(e.href,i):this._renderImage(e.imageData,i,e.contentType))},this):(t.f="image",this._renderImage(this.options.url+"export"+e.Util.getParamString(t),i))}}),Et=e.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(t){t=e.setOptions(this,t),this._zooming=!1},onAdd:function(t){this._map=t,this._update=e.Util.throttle(this._update,this.options.updateInterval,this),this._reset(),this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this),this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(t){return t.addLayer(this),this},removeFrom:function(t){return t.removeLayer(this),this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells(),this._cells={},this._activeCells={},this._cellsToLoad=0,this._cellsTotal=0,this._cellNumBounds=this._getCellNumBounds(),this._resetWrap(),this._zooming=!1},_resetWrap:function(){var t=this._map,e=t.options.crs;if(!e.infinite){var i=this._getCellSize();e.wrapLng&&(this._wrapLng=[Math.floor(t.project([0,e.wrapLng[0]]).x/i),Math.ceil(t.project([0,e.wrapLng[1]]).x/i)]),e.wrapLat&&(this._wrapLat=[Math.floor(t.project([e.wrapLat[0],0]).y/i),Math.ceil(t.project([e.wrapLat[1],0]).y/i)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var t=this._map.getPixelBounds(),i=this._getCellSize(),n=e.bounds(t.min.divideBy(i).floor(),t.max.divideBy(i).floor());this._removeOtherCells(n),this._addCells(n),this.fire("cellsupdated")}},_addCells:function(t){var i,n,r,o=[],s=t.getCenter(),a=this._map.getZoom();for(i=t.min.y;i<=t.max.y;i++)for(n=t.min.x;n<=t.max.x;n++)r=e.point(n,i),r.z=a,this._isValidCell(r)&&o.push(r);var u=o.length;if(0!==u)for(this._cellsToLoad+=u,this._cellsTotal+=u,o.sort(function(t,e){return t.distanceTo(s)-e.distanceTo(s)}),n=0;n<u;n++)this._addCell(o[n])},_isValidCell:function(t){var i=this._map.options.crs;if(!i.infinite){var n=this._cellNumBounds;if(!n)return!1;if(!i.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!i.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var r=this._cellCoordsToBounds(t);return e.latLngBounds(this.options.bounds).intersects(r)},_cellCoordsToBounds:function(t){var i=this._map,n=this.options.cellSize,r=t.multiplyBy(n),o=r.add([n,n]),s=i.wrapLatLng(i.unproject(r,t.z)),a=i.wrapLatLng(i.unproject(o,t.z));return e.latLngBounds(s,a)},_cellCoordsToKey:function(t){return t.x+":"+t.y},_keyToCellCoords:function(t){var i=t.split(":"),n=parseInt(i[0],10),r=parseInt(i[1],10);return e.point(n,r)},_removeOtherCells:function(t){for(var e in this._cells)t.contains(this._keyToCellCoords(e))||this._removeCell(e)},_removeCell:function(t){var e=this._activeCells[t];e&&(delete this._activeCells[t],this.cellLeave&&this.cellLeave(e.bounds,e.coords),this.fire("cellleave",{bounds:e.bounds,coords:e.coords}))},_removeCells:function(){for(var t in this._cells){var e=this._cells[t].bounds,i=this._cells[t].coords;this.cellLeave&&this.cellLeave(e,i),this.fire("cellleave",{bounds:e,coords:i})}},_addCell:function(t){this._wrapCoords(t);var e=this._cellCoordsToKey(t),i=this._cells[e];i&&!this._activeCells[e]&&(this.cellEnter&&this.cellEnter(i.bounds,t),this.fire("cellenter",{bounds:i.bounds,coords:t}),this._activeCells[e]=i),i||(i={coords:t,bounds:this._cellCoordsToBounds(t)},this._cells[e]=i,this._activeCells[e]=i,this.createCell&&this.createCell(i.bounds,t),this.fire("cellcreate",{bounds:i.bounds,coords:t}))},_wrapCoords:function(t){t.x=this._wrapLng?e.Util.wrapNum(t.x,this._wrapLng):t.x,t.y=this._wrapLat?e.Util.wrapNum(t.y,this._wrapLat):t.y},_getCellNumBounds:function(){var t=this._map.getPixelWorldBounds(),i=this._getCellSize();return t?e.bounds(t.min.divideBy(i).floor(),t.max.divideBy(i).ceil().subtract([1,1])):null}});Q.prototype.query=function(t){var e=this.getIndex(t);return this.values[e]},Q.prototype.getIndex=function(t){this.dirty&&this.sort();for(var e,i,n=0,r=this.values.length-1;n<=r;)if(e=(n+r)/2|0,i=this.values[Math.round(e)],+i.value<+t)n=e+1;else{if(!(+i.value>+t))return e;r=e-1}return Math.abs(~r)},Q.prototype.between=function(t,e){var i=this.getIndex(t),n=this.getIndex(e);if(0===i&&0===n)return[];for(;this.values[i-1]&&this.values[i-1].value===t;)i--;for(;this.values[n+1]&&this.values[n+1].value===e;)n++;return this.values[n]&&this.values[n].value===e&&this.values[n+1]&&n++,this.values.slice(i,n)},Q.prototype.insert=function(t){return this.values.splice(this.getIndex(t.value),0,t),this},Q.prototype.bulkAdd=function(t,e){return this.values=this.values.concat([].concat(t||[])),e?this.sort():this.dirty=!0,this},Q.prototype.sort=function(){return this.values.sort(function(t,e){return+e.value-+t.value}).reverse(),this.dirty=!1,this};var Pt=Et.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(t){if(Et.prototype.initialize.call(this,t),t=A(t),t=e.Util.setOptions(this,t),this.service=Y(t),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var i=!1,n=0;n<this.options.fields.length;n++)this.options.fields[n].match(/^(OBJECTID|FID|OID|ID)$/i)&&(i=!0);!1===i&&I("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new Q,this._endTimeIndex=new Q):this.options.timeField&&(this._timeIndex=new Q),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(t){return O(t),this.service.metadata(function(e,i){if(!e){var n=i.supportedQueryFormats,r=!1;!1===this.service.options.isModern&&(r=!0),!r&&n&&-1!==n.indexOf("geoJSON")&&(this.service.options.isModern=!0),i.objectIdField&&(this.service.options.idAttribute=i.objectIdField),!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))}},this),t.on("zoomend",this._handleZoomChange,this),Et.prototype.onAdd.call(this,t)},onRemove:function(t){return t.off("zoomend",this._handleZoomChange,this),Et.prototype.onRemove.call(this,t)},getAttribution:function(){return this.options.attribution},createCell:function(t,e){this._visibleZoom()&&this._requestFeatures(t,e)},_requestFeatures:function(t,i,n){return this._activeRequests++,1===this._activeRequests&&this.fire("loading",{bounds:t},!0),this._buildQuery(t).run(function(r,o,s){s&&s.exceededTransferLimit&&this.fire("drawlimitexceeded"),!r&&o&&o.features.length&&e.Util.requestAnimFrame(e.Util.bind(function(){this._addFeatures(o.features,i),this._postProcessFeatures(t)},this)),r||!o||o.features.length||this._postProcessFeatures(t),r&&this._postProcessFeatures(t),n&&n.call(this,r,o)},this)},_postProcessFeatures:function(t){--this._activeRequests<=0&&this.fire("load",{bounds:t})},_cacheKey:function(t){return t.z+":"+t.x+":"+t.y},_addFeatures:function(t,e){var i=this._cacheKey(e);this._cache[i]=this._cache[i]||[];for(var n=t.length-1;n>=0;n--){var r=t[n].id;-1===this._currentSnapshot.indexOf(r)&&this._currentSnapshot.push(r),-1===this._cache[i].indexOf(r)&&this._cache[i].push(r)}this.options.timeField&&this._buildTimeIndexes(t),this.createLayers(t)},_buildQuery:function(t){var i=this.service.query().intersects(t).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.requestParams&&e.Util.extend(i.params,this.options.requestParams),this.options.simplifyFactor&&i.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&i.between(this.options.from,this.options.to),i},setWhere:function(t,i,n){this.options.where=t&&t.length?t:"1=1";for(var r=[],o=[],s=0,a=null,u=e.Util.bind(function(t,u){if(t&&(a=t),u)for(var l=u.features.length-1;l>=0;l--)o.push(u.features[l].id);--s<=0&&this._visibleZoom()&&(this._currentSnapshot=o,e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(r),this.addLayers(o),i&&i.call(n,a)},this)))},this),l=this._currentSnapshot.length-1;l>=0;l--)r.push(this._currentSnapshot[l]);for(var c in this._activeCells){s++;var h=this._keyToCellCoords(c),f=this._cellCoordsToBounds(h);this._requestFeatures(f,c,u)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,i,n,r){var o=this.options.from,s=this.options.to,a=0,u=null,l=e.Util.bind(function(e){e&&(u=e),this._filterExistingFeatures(o,s,t,i),a--,n&&a<=0&&n.call(r,u)},this);if(this.options.from=t,this.options.to=i,this._filterExistingFeatures(o,s,t,i),"server"===this.options.timeFilterMode)for(var c in this._activeCells){a++;var h=this._keyToCellCoords(c),f=this._cellCoordsToBounds(h);this._requestFeatures(f,c,l)}return this},refresh:function(){for(var t in this._activeCells){var e=this._keyToCellCoords(t),i=this._cellCoordsToBounds(e);this._requestFeatures(i,t)}this.redraw&&this.once("load",function(){this.eachFeature(function(t){this._redraw(t.feature.id)},this)},this)},_filterExistingFeatures:function(t,i,n,r){var o=t&&i?this._getFeaturesInTimeRange(t,i):this._currentSnapshot,s=this._getFeaturesInTimeRange(n,r);if(s.indexOf)for(var a=0;a<s.length;a++){var u=o.indexOf(s[a]);u>=0&&o.splice(u,1)}e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(o),this.addLayers(s)},this))},_getFeaturesInTimeRange:function(t,e){var i,n=[];if(this.options.timeField.start&&this.options.timeField.end){var r=this._startTimeIndex.between(t,e),o=this._endTimeIndex.between(t,e);i=r.concat(o)}else i=this._timeIndex.between(t,e);for(var s=i.length-1;s>=0;s--)n.push(i[s].id);return n},_buildTimeIndexes:function(t){var e,i;if(this.options.timeField.start&&this.options.timeField.end){var n=[],r=[];for(e=t.length-1;e>=0;e--)i=t[e],n.push({id:i.id,value:new Date(i.properties[this.options.timeField.start])}),r.push({id:i.id,value:new Date(i.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(n),this._endTimeIndex.bulkAdd(r)}else{var o=[];for(e=t.length-1;e>=0;e--)i=t[e],o.push({id:i.id,value:new Date(i.properties[this.options.timeField])});this._timeIndex.bulkAdd(o)}},_featureWithinTimeRange:function(t){if(!this.options.from||!this.options.to)return!0;var e=+this.options.from.valueOf(),i=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var n=+t.properties[this.options.timeField];return n>=e&&n<=i}if(this.options.timeField.start&&this.options.timeField.end){var r=+t.properties[this.options.timeField.start],o=+t.properties[this.options.timeField.end];return r>=e&&r<=i||o>=e&&o<=i}},_visibleZoom:function(){if(!this._map)return!1;var t=this._map.getZoom();return!(t>this.options.maxZoom||t<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var t in this._activeCells){var e=this._activeCells[t].coords,i=this._cacheKey(e);this._cache[i]&&this.addLayers(this._cache[i])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(t){return this.service.authenticate(t),this},metadata:function(t,e){return this.service.metadata(t,e),this},query:function(){return this.service.query()},_getMetadata:function(t){if(this._metadata){t(void 0,this._metadata)}else this.metadata(e.Util.bind(function(e,i){this._metadata=i,t(e,this._metadata)},this))},addFeature:function(t,e,i){this.addFeatures(t,e,i)},addFeatures:function(t,i,n){this._getMetadata(e.Util.bind(function(r,o){if(r)return void(i&&i.call(this,r,null));var s=t.features?t.features:[t];this.service.addFeatures(t,e.Util.bind(function(t,e){if(!t){for(var r=s.length-1;r>=0;r--)s[r].properties[o.objectIdField]=s.length>1?e[r].objectId:e.objectId,s[r].id=s.length>1?e[r].objectId:e.objectId;this.createLayers(s)}i&&i.call(n,t,e)},this))},this))},updateFeature:function(t,e,i){this.updateFeatures(t,e,i)},updateFeatures:function(t,e,i){var n=t.features?t.features:[t];this.service.updateFeatures(t,function(t,r){if(!t){for(var o=n.length-1;o>=0;o--)this.removeLayers([n[o].id],!0);this.createLayers(n)}e&&e.call(i,t,r)},this)},deleteFeature:function(t,e,i){this.deleteFeatures(t,e,i)},deleteFeatures:function(t,e,i){return this.service.deleteFeatures(t,function(t,n){var r=n.length?n:[n];if(!t&&r.length>0)for(var o=r.length-1;o>=0;o--)this.removeLayers([r[o].objectId],!0);e&&e.call(i,t,n)},this)}}),Ct=Pt.extend({options:{cacheLayers:!0},initialize:function(t){Pt.prototype.initialize.call(this,t),this._originalStyle=this.options.style,this._layers={}},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e]),this.fire("removefeature",{feature:this._layers[e].feature,permanent:!1},!0);return Pt.prototype.onRemove.call(this,t)},createNewLayer:function(t){var i=e.GeoJSON.geometryToLayer(t,this.options);return i&&(i.defaultOptions=i.options),i},_updateLayer:function(t,i){var n=[],r=this.options.coordsToLatLng||e.GeoJSON.coordsToLatLng;switch(i.properties&&(t.feature.properties=i.properties),i.geometry.type){case"Point":n=e.GeoJSON.coordsToLatLng(i.geometry.coordinates),t.setLatLng(n);break;case"LineString":n=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,0,r),t.setLatLngs(n);break;case"MultiLineString":case"Polygon":n=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,1,r),t.setLatLngs(n);break;case"MultiPolygon":n=e.GeoJSON.coordsToLatLngs(i.geometry.coordinates,2,r),t.setLatLngs(n)}},createLayers:function(t){for(var e=t.length-1;e>=0;e--){var i,n=t[e],r=this._layers[n.id];this._visibleZoom()&&r&&!this._map.hasLayer(r)&&(this._map.addLayer(r),this.fire("addfeature",{feature:r.feature},!0)),r&&this.options.simplifyFactor>0&&(r.setLatLngs||r.setLatLng)&&this._updateLayer(r,n),r||(i=this.createNewLayer(n),i?(i.feature=n,i.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(i.feature,i),this._layers[i.feature.id]=i,this.setFeatureStyle(i.feature.id,this.options.style),this.fire("createfeature",{feature:i.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(n))&&this._map.addLayer(i)):I("invalid GeoJSON encountered"))}},addLayers:function(t){for(var e=t.length-1;e>=0;e--){var i=this._layers[t[e]];i&&this._map.addLayer(i)}},removeLayers:function(t,e){for(var i=t.length-1;i>=0;i--){var n=t[i],r=this._layers[n];r&&(this.fire("removefeature",{feature:r.feature,permanent:e},!0),this._map.removeLayer(r)),r&&e&&delete this._layers[n]}},cellEnter:function(t,i){this._visibleZoom()&&!this._zooming&&this._map&&e.Util.requestAnimFrame(e.Util.bind(function(){var t=this._cacheKey(i),e=this._cellCoordsToKey(i),n=this._cache[t];this._activeCells[e]&&n&&this.addLayers(n)},this))},cellLeave:function(t,i){this._zooming||e.Util.requestAnimFrame(e.Util.bind(function(){if(this._map){var t=this._cacheKey(i),e=this._cellCoordsToKey(i),n=this._cache[t],r=this._map.getBounds();if(!this._activeCells[e]&&n){for(var o=!0,s=0;s<n.length;s++){var a=this._layers[n[s]];a&&a.getBounds&&r.intersects(a.getBounds())&&(o=!1)}o&&this.removeLayers(n,!this.options.cacheLayers),!this.options.cacheLayers&&o&&(delete this._cache[t],delete this._cells[e],delete this._activeCells[e])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(t){this.resetFeatureStyle(t.feature.id)},this),this},setStyle:function(t){return this.options.style=t,this.eachFeature(function(e){this.setFeatureStyle(e.feature.id,t)},this),this},resetFeatureStyle:function(t){var i=this._layers[t],n=this._originalStyle||e.Path.prototype.options;return i&&(e.Util.extend(i.options,i.defaultOptions),this.setFeatureStyle(t,n)),this},setFeatureStyle:function(t,e){var i=this._layers[t];return"function"==typeof e&&(e=e(i.feature)),i.setStyle&&i.setStyle(e),this},eachActiveFeature:function(t,e){if(this._map){var i=this._map.getBounds();for(var n in this._layers)-1!==this._currentSnapshot.indexOf(this._layers[n].feature.id)&&("function"==typeof this._layers[n].getLatLng&&i.contains(this._layers[n].getLatLng())?t.call(e,this._layers[n]):"function"==typeof this._layers[n].getBounds&&i.intersects(this._layers[n].getBounds())&&t.call(e,this._layers[n]))}return this},eachFeature:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getFeature:function(t){return this._layers[t]},bringToBack:function(){this.eachFeature(function(t){t.bringToBack&&t.bringToBack()})},bringToFront:function(){this.eachFeature(function(t){t.bringToFront&&t.bringToFront()})},redraw:function(t){return t&&this._redraw(t),this},_redraw:function(t){var i=this._layers[t],n=i.feature;if(i&&i.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var r=this.options.pointToLayer(n,e.latLng(n.geometry.coordinates[1],n.geometry.coordinates[0])),o=r.options.icon;i.setIcon(o)}if(i&&i.setStyle&&this.options.pointToLayer){var s=this.options.pointToLayer(n,e.latLng(n.geometry.coordinates[1],n.geometry.coordinates[0])),a=s.options;this.setFeatureStyle(n.id,a)}i&&i.setStyle&&this.options.style&&this.resetStyle(n.id)}});t.VERSION="2.2.1",t.Support=nt,t.options=rt,t.Util=lt,t.get=st,t.post=r,t.request=s,t.Task=ct,t.task=N,t.Query=ht,t.query=B,t.Find=ft,t.find=U,t.Identify=dt,t.identify=Z,t.IdentifyFeatures=pt,t.identifyFeatures=G,t.IdentifyImage=mt,t.identifyImage=q,t.Service=_t,t.service=V,t.MapService=gt,t.mapService=W,t.ImageService=vt,t.imageService=H,t.FeatureLayerService=yt,t.featureLayerService=Y,t.BasemapLayer=xt,t.basemapLayer=X,t.TiledMapLayer=wt,t.tiledMapLayer=J,t.RasterLayer=St,t.ImageMapLayer=Tt,t.imageMapLayer=$,t.DynamicMapLayer=Mt,t.dynamicMapLayer=K,t.FeatureManager=Pt,t.FeatureLayer=Ct,t.featureLayer=tt,Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t.Leaflet=t.Leaflet||{},t.Leaflet.markercluster=t.Leaflet.markercluster||{}))}(this,function(t){"use strict";var e=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,
dragend:this._childMarkerDragEnd};var e=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,e?this._withAnimation:this._noAnimation),this._markerCluster=e?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(t){if(t instanceof L.LayerGroup)return this.addLayers([t]);if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this.fire("layeradd",{layer:t}),this;if(!this._map)return this._needsClustering.push(t),this.fire("layeradd",{layer:t}),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom),this.fire("layeradd",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var e=t,i=this._zoom;if(t.__parent)for(;e.__parent._zoom>=i;)e=e.__parent;return this._currentShownBounds.contains(e.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,e):this._animationAddLayerNonAnimated(t,e)),this},removeLayer:function(t){return t instanceof L.LayerGroup?this.removeLayers([t]):t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this.fire("layerremove",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),t.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push({layer:t,latlng:t._latlng}),this.fire("layerremove",{layer:t}),this):(this._nonPointGroup.removeLayer(t),this.fire("layerremove",{layer:t}),this)},addLayers:function(t,e){if(!L.Util.isArray(t))return this.addLayer(t);var i,n=this._featureGroup,r=this._nonPointGroup,o=this.options.chunkedLoading,s=this.options.chunkInterval,a=this.options.chunkProgress,u=t.length,l=0,c=!0;if(this._map){var h=(new Date).getTime(),f=L.bind(function(){for(var d=(new Date).getTime();l<u;l++){if(o&&l%200==0){if((new Date).getTime()-d>s)break}if((i=t[l])instanceof L.LayerGroup)c&&(t=t.slice(),c=!1),this._extractNonGroupLayers(i,t),u=t.length;else if(i.getLatLng){if(!this.hasLayer(i)&&(this._addLayer(i,this._maxZoom),e||this.fire("layeradd",{layer:i}),i.__parent&&2===i.__parent.getChildCount())){var p=i.__parent.getAllChildMarkers(),m=p[0]===i?p[1]:p[0];n.removeLayer(m)}}else r.addLayer(i),e||this.fire("layeradd",{layer:i})}a&&a(l,u,(new Date).getTime()-h),l===u?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(f,this.options.chunkDelay)},this);f()}else for(var d=this._needsClustering;l<u;l++)i=t[l],i instanceof L.LayerGroup?(c&&(t=t.slice(),c=!1),this._extractNonGroupLayers(i,t),u=t.length):i.getLatLng?this.hasLayer(i)||d.push(i):r.addLayer(i);return this},removeLayers:function(t){var e,i,n=t.length,r=this._featureGroup,o=this._nonPointGroup,s=!0;if(!this._map){for(e=0;e<n;e++)i=t[e],i instanceof L.LayerGroup?(s&&(t=t.slice(),s=!1),this._extractNonGroupLayers(i,t),n=t.length):(this._arraySplice(this._needsClustering,i),o.removeLayer(i),this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i}));return this}if(this._unspiderfy){this._unspiderfy();var a=t.slice(),u=n;for(e=0;e<u;e++)i=a[e],i instanceof L.LayerGroup?(this._extractNonGroupLayers(i,a),u=a.length):this._unspiderfyLayer(i)}for(e=0;e<n;e++)i=t[e],i instanceof L.LayerGroup?(s&&(t=t.slice(),s=!1),this._extractNonGroupLayers(i,t),n=t.length):i.__parent?(this._removeLayer(i,!0,!0),this.fire("layerremove",{layer:i}),r.hasLayer(i)&&(r.removeLayer(i),i.clusterShow&&i.clusterShow())):(o.removeLayer(i),this.fire("layerremove",{layer:i}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){t.off(this._childMarkerEventHandlers,this),delete t.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var i,n,r,o=this._needsClustering.slice(),s=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(o),n=o.length-1;n>=0;n--){for(i=!0,r=s.length-1;r>=0;r--)if(s[r].layer===o[n]){i=!1;break}i&&t.call(e,o[n])}this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer(function(e){t.push(e)}),t},getLayer:function(t){var e=null;return t=parseInt(t,10),this.eachLayer(function(i){L.stamp(i)===t&&(e=i)}),e},hasLayer:function(t){if(!t)return!1;var e,i=this._needsClustering;for(e=i.length-1;e>=0;e--)if(i[e]===t)return!0;for(i=this._needsRemoving,e=i.length-1;e>=0;e--)if(i[e].layer===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){"function"!=typeof e&&(e=function(){});var i=function(){!t._icon&&!t.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",i,this),this.off("animationend",i,this),t._icon?e():t.__parent._icon&&(this.once("spiderfied",e,this),t.__parent.spiderfy()))};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",i,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",i,this),this.on("animationend",i,this),t.__parent.zoomToBounds())},onAdd:function(t){this._map=t;var e,i,n;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),this._maxLat=t.options.crs.projection.MAX_LATITUDE,e=0,i=this._needsRemoving.length;e<i;e++)n=this._needsRemoving[e],n.newlatlng=n.layer._latlng,n.layer._latlng=n.latlng;for(e=0,i=this._needsRemoving.length;e<i;e++)n=this._needsRemoving[e],this._removeLayer(n.layer,!0),n.layer._latlng=n.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),i=this._needsClustering,this._needsClustering=[],this.addLayers(i,!0)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var i=t.length-1;i>=0;i--)if(t[i]===e)return t.splice(i,1),!0},_removeFromGridUnclustered:function(t,e){for(var i=this._map,n=this._gridUnclustered,r=Math.floor(this._map.getMinZoom());e>=r&&n[e].removeObject(t,i.project(t.getLatLng(),e));e--);},_childMarkerDragStart:function(t){t.target.__dragStart=t.target._latlng},_childMarkerMoved:function(t){if(!this._ignoreMove&&!t.target.__dragStart){var e=t.target._popup&&t.target._popup.isOpen();this._moveChild(t.target,t.oldLatLng,t.latlng),e&&t.target.openPopup()}},_moveChild:function(t,e,i){t._latlng=e,this.removeLayer(t),t._latlng=i,this.addLayer(t)},_childMarkerDragEnd:function(t){t.target.__dragStart&&this._moveChild(t.target,t.target.__dragStart,t.target._latlng),delete t.target.__dragStart},_removeLayer:function(t,e,i){var n=this._gridClusters,r=this._gridUnclustered,o=this._featureGroup,s=this._map,a=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(t,this._maxZoom);var u,l=t.__parent,c=l._markers;for(this._arraySplice(c,t);l&&(l._childCount--,l._boundsNeedUpdate=!0,!(l._zoom<a));)e&&l._childCount<=1?(u=l._markers[0]===t?l._markers[1]:l._markers[0],n[l._zoom].removeObject(l,s.project(l._cLatLng,l._zoom)),r[l._zoom].addObject(u,s.project(u.getLatLng(),l._zoom)),this._arraySplice(l.__parent._childClusters,l),l.__parent._markers.push(u),u.__parent=l.__parent,l._icon&&(o.removeLayer(l),i||o.addLayer(u))):l._iconNeedsUpdate=!0,l=l.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,i){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,i)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),i=" marker-cluster-";return i+=e<10?"small":e<100?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick;(e||n)&&this.on("clusterclick",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){for(var e=t.layer,i=e;1===i._childClusters.length;)i=i._childClusters[0];i._zoom===this._maxZoom&&i._childCount===e._childCount&&this.options.spiderfyOnMaxZoom?e.spiderfy():this.options.zoomToBoundsOnClick&&e.zoomToBounds(),t.originalEvent&&13===t.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,n=this._map;(t||i)&&this.off("clusterclick",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),i=this.options.maxClusterRadius,n=i;"function"!=typeof i&&(n=function(){return i}),null!==this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var r=t;r>=e;r--)this._gridClusters[r]=new L.DistanceGrid(n(r)),this._gridUnclustered[r]=new L.DistanceGrid(n(r));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(t,e){var i,n,r=this._gridClusters,o=this._gridUnclustered,s=Math.floor(this._map.getMinZoom());for(this.options.singleMarkerMode&&this._overrideMarkerIcon(t),t.on(this._childMarkerEventHandlers,this);e>=s;e--){i=this._map.project(t.getLatLng(),e);var a=r[e].getNearObject(i);if(a)return a._addChild(t),void(t.__parent=a);if(a=o[e].getNearObject(i)){var u=a.__parent;u&&this._removeLayer(a,!1);var l=new this._markerCluster(this,e,a,t);r[e].addObject(l,this._map.project(l._cLatLng,e)),a.__parent=l,t.__parent=l;var c=l;for(n=e-1;n>u._zoom;n--)c=new this._markerCluster(this,n,c),r[n].addObject(c,this._map.project(a.getLatLng(),n));return u._addChild(c),void this._removeFromGridUnclustered(a,e)}o[e].addObject(t,i)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()})},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(t){var e=this._maxLat;return void 0!==e&&(t.getNorth()>=e&&(t._northEast.lat=1/0),t.getSouth()<=-e&&(t._southWest.lat=-1/0)),t},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var i=e.getAllChildMarkers();this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else e._updateIcon()},_extractNonGroupLayers:function(t,e){var i,n=t.getLayers(),r=0;for(e=e||[];r<n.length;r++)i=n[r],i instanceof L.LayerGroup?this._extractNonGroupLayers(i,e):e.push(i);return e},_overrideMarkerIcon:function(t){return t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(t,e){var i,n=this._getExpandedVisibleBounds(),r=this._featureGroup,o=Math.floor(this._map.getMinZoom());this._ignoreMove=!0,this._topClusterLevel._recursively(n,t,o,function(o){var s,a=o._latlng,u=o._markers;for(n.contains(a)||(a=null),o._isSingleParent()&&t+1===e?(r.removeLayer(o),o._recursivelyAddChildrenToMap(null,e,n)):(o.clusterHide(),o._recursivelyAddChildrenToMap(a,e,n)),i=u.length-1;i>=0;i--)s=u[i],n.contains(s._latlng)||r.removeLayer(s)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(n,e),r.eachLayer(function(t){t instanceof L.MarkerCluster||!t._icon||t.clusterShow()}),this._topClusterLevel._recursively(n,t,e,function(t){t._recursivelyRestoreChildPositions(e)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(n,t,o,function(t){r.removeLayer(t),t.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){var i=this,n=this._featureGroup;n.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue(function(){n.removeLayer(t),t.clusterShow(),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(t,e,i){var n=this._getExpandedVisibleBounds(),r=Math.floor(this._map.getMinZoom());t._recursivelyAnimateChildrenInAndAddSelfToMap(n,r,e+1,i);var o=this;this._forceLayout(),t._recursivelyBecomeVisible(n,i),this._enqueue(function(){if(1===t._childCount){var s=t._markers[0];this._ignoreMove=!0,s.setLatLng(s.getLatLng()),this._ignoreMove=!1,s.clusterShow&&s.clusterShow()}else t._recursively(n,i,r,function(t){t._recursivelyRemoveChildrenFromMap(n,r,e+1)});o._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)};var i=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(t,e,i,n){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this,pane:t.options.clusterPane}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),n&&this._addChild(n)},getAllChildMarkers:function(t){t=t||[];for(var e=this._childClusters.length-1;e>=0;e--)this._childClusters[e].getAllChildMarkers(t);for(var i=this._markers.length-1;i>=0;i--)t.push(this._markers[i]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(t){for(var e,i=this._childClusters.slice(),n=this._group._map,r=n.getBoundsZoom(this._bounds),o=this._zoom+1,s=n.getZoom();i.length>0&&r>o;){o++;var a=[];for(e=0;e<i.length;e++)a=a.concat(i[e]._childClusters);i=a}r>o?this._group._map.setView(this._latlng,o):r<=s?this._group._map.setView(this._latlng,s+1):this._group._map.fitBounds(this._bounds,t)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_setClusterCenter:function(t){this._cLatLng||(this._cLatLng=t._cLatLng||t._latlng)},_resetBounds:function(){var t=this._bounds;t._southWest&&(t._southWest.lat=1/0,t._southWest.lng=1/0),t._northEast&&(t._northEast.lat=-1/0,t._northEast.lng=-1/0)},_recalculateBounds:function(){var t,e,i,n,r=this._markers,o=this._childClusters,s=0,a=0,u=this._childCount;if(0!==u){for(this._resetBounds(),t=0;t<r.length;t++)i=r[t]._latlng,this._bounds.extend(i),s+=i.lat,a+=i.lng;for(t=0;t<o.length;t++)e=o[t],e._boundsNeedUpdate&&e._recalculateBounds(),this._bounds.extend(e._bounds),i=e._wLatLng,n=e._childCount,s+=i.lat*n,a+=i.lng*n;this._latlng=this._wLatLng=new L.LatLng(s/u,a/u),this._boundsNeedUpdate=!1}},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,i){this._recursively(t,this._group._map.getMinZoom(),i-1,function(t){var i,n,r=t._markers;for(i=r.length-1;i>=0;i--)n=r[i],n._icon&&(n._setPos(e),n.clusterHide())},function(t){var i,n,r=t._childClusters;for(i=r.length-1;i>=0;i--)n=r[i],n._icon&&(n._setPos(e),n.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,i,n){this._recursively(t,n,e,function(r){r._recursivelyAnimateChildrenIn(t,r._group._map.latLngToLayerPoint(r.getLatLng()).round(),i),r._isSingleParent()&&i-1===n?(r.clusterShow(),r._recursivelyRemoveChildrenFromMap(t,e,i)):r.clusterHide(),r._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,this._group._map.getMinZoom(),e,null,function(t){t.clusterShow()})},_recursivelyAddChildrenToMap:function(t,e,i){this._recursively(i,this._group._map.getMinZoom()-1,e,function(n){if(e!==n._zoom)for(var r=n._markers.length-1;r>=0;r--){var o=n._markers[r];i.contains(o._latlng)&&(t&&(o._backupLatlng=o.getLatLng(),o.setLatLng(t),o.clusterHide&&o.clusterHide()),n._group._featureGroup.addLayer(o))}},function(e){e._addToMap(t)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var i=this._markers[e];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(t-1===this._zoom)for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._restorePosition();else for(var r=this._childClusters.length-1;r>=0;r--)this._childClusters[r]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,i,n){var r,o;this._recursively(t,e-1,i-1,function(t){for(o=t._markers.length-1;o>=0;o--)r=t._markers[o],n&&n.contains(r._latlng)||(t._group._featureGroup.removeLayer(r),r.clusterShow&&r.clusterShow())},function(t){for(o=t._childClusters.length-1;o>=0;o--)r=t._childClusters[o],n&&n.contains(r._latlng)||(t._group._featureGroup.removeLayer(r),r.clusterShow&&r.clusterShow())})},_recursively:function(t,e,i,n,r){var o,s,a=this._childClusters,u=this._zoom;if(e<=u&&(n&&n(this),r&&u===i&&r(this)),u<e||u<i)for(o=a.length-1;o>=0;o--)s=a[o],t.intersects(s._bounds)&&s._recursively(t,e,i,n,r)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){return this.options.opacityWhenUnclustered=this.options.opacity||1,this.setOpacity(0)},clusterShow:function(){var t=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);return delete this.options.opacityWhenUnclustered,t}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var i=this._getCoord(e.x),n=this._getCoord(e.y),r=this._grid,o=r[n]=r[n]||{},s=o[i]=o[i]||[],a=L.Util.stamp(t);this._objectPoint[a]=e,s.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var i,n,r=this._getCoord(e.x),o=this._getCoord(e.y),s=this._grid,a=s[o]=s[o]||{},u=a[r]=a[r]||[];for(delete this._objectPoint[L.Util.stamp(t)],i=0,n=u.length;i<n;i++)if(u[i]===t)return u.splice(i,1),1===n&&delete a[r],!0},eachObject:function(t,e){var i,n,r,o,s,a,u=this._grid;for(i in u){s=u[i];for(n in s)for(a=s[n],r=0,o=a.length;r<o;r++)t.call(e,a[r])&&(r--,o--)}},getNearObject:function(t){var e,i,n,r,o,s,a,u,l=this._getCoord(t.x),c=this._getCoord(t.y),h=this._objectPoint,f=this._sqCellSize,d=null;for(e=c-1;e<=c+1;e++)if(r=this._grid[e])for(i=l-1;i<=l+1;i++)if(o=r[i])for(n=0,s=o.length;n<s;n++)a=o[n],((u=this._sqDist(h[L.Util.stamp(a)],t))<f||u<=f&&null===d)&&(f=u,d=a);return d},_getCoord:function(t){var e=Math.floor(t/this._cellSize);return isFinite(e)?e:t},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}},function(){L.QuickHull={getDistant:function(t,e){var i=e[1].lat-e[0].lat;return(e[0].lng-e[1].lng)*(t.lat-e[0].lat)+i*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var i,n,r,o=0,s=null,a=[];for(i=e.length-1;i>=0;i--)n=e[i],(r=this.getDistant(n,t))>0&&(a.push(n),r>o&&(o=r,s=n));return{maxPoint:s,newPoints:a}},buildConvexHull:function(t,e){var i=[],n=this.findMostDistantPointFromBaseLine(t,e);return n.maxPoint?(i=i.concat(this.buildConvexHull([t[0],n.maxPoint],n.newPoints)),i=i.concat(this.buildConvexHull([n.maxPoint,t[1]],n.newPoints))):[t[0]]},getConvexHull:function(t){var e,i=!1,n=!1,r=!1,o=!1,s=null,a=null,u=null,l=null,c=null,h=null;for(e=t.length-1;e>=0;e--){var f=t[e];(!1===i||f.lat>i)&&(s=f,i=f.lat),(!1===n||f.lat<n)&&(a=f,n=f.lat),(!1===r||f.lng>r)&&(u=f,r=f.lng),(!1===o||f.lng<o)&&(l=f,o=f.lng)}return n!==i?(h=a,c=s):(h=l,c=u),[].concat(this.buildConvexHull([h,c],t),this.buildConvexHull([c,h],t))}}}(),L.MarkerCluster.include({getConvexHull:function(){var t,e,i=this.getAllChildMarkers(),n=[];for(e=i.length-1;e>=0;e--)t=i[e].getLatLng(),n.push(t);return L.QuickHull.getConvexHull(n)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(),i=this._group,n=i._map,r=n.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,e.length>=this._circleSpiralSwitchover?t=this._generatePointsSpiral(e.length,r):(r.y+=10,t=this._generatePointsCircle(e.length,r)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var i,n,r=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t),o=r/this._2PI,s=this._2PI/t,a=[];for(o=Math.max(o,35),a.length=t,i=0;i<t;i++)n=this._circleStartAngle+i*s,a[i]=new L.Point(e.x+o*Math.cos(n),e.y+o*Math.sin(n))._round();return a},_generatePointsSpiral:function(t,e){var i,n=this._group.options.spiderfyDistanceMultiplier,r=n*this._spiralLengthStart,o=n*this._spiralFootSeparation,s=n*this._spiralLengthFactor*this._2PI,a=0,u=[];for(u.length=t,i=t;i>=0;i--)i<t&&(u[i]=new L.Point(e.x+r*Math.cos(a),e.y+r*Math.sin(a))._round()),a+=o/r+5e-4*i,r+=s/a;return u},_noanimationUnspiderfy:function(){var t,e,i=this._group,n=i._map,r=i._featureGroup,o=this.getAllChildMarkers();for(i._ignoreMove=!0,this.setOpacity(1),e=o.length-1;e>=0;e--)t=o[e],r.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(n.removeLayer(t._spiderLeg),delete t._spiderLeg);i.fire("unspiderfied",{cluster:this,markers:o}),i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(t,e){var i,n,r,o,s=this._group,a=s._map,u=s._featureGroup,l=this._group.options.spiderLegPolylineOptions;for(s._ignoreMove=!0,i=0;i<t.length;i++)o=a.layerPointToLatLng(e[i]),n=t[i],r=new L.Polyline([this._latlng,o],l),a.addLayer(r),n._spiderLeg=r,n._preSpiderfyLatlng=n._latlng,n.setLatLng(o),n.setZIndexOffset&&n.setZIndexOffset(1e6),u.addLayer(n);this.setOpacity(.3),s._ignoreMove=!1,s.fire("spiderfied",{cluster:this,markers:t})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(t,e){var i,n,r,o,s,a,u=this,l=this._group,c=l._map,h=l._featureGroup,f=this._latlng,d=c.latLngToLayerPoint(f),p=L.Path.SVG,m=L.extend({},this._group.options.spiderLegPolylineOptions),_=m.opacity;for(void 0===_&&(_=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),p?(m.opacity=0,m.className=(m.className||"")+" leaflet-cluster-spider-leg"):m.opacity=_,l._ignoreMove=!0,i=0;i<t.length;i++)n=t[i],a=c.layerPointToLatLng(e[i]),r=new L.Polyline([f,a],m),c.addLayer(r),n._spiderLeg=r,p&&(o=r._path,s=o.getTotalLength()+.1,o.style.strokeDasharray=s,o.style.strokeDashoffset=s),n.setZIndexOffset&&n.setZIndexOffset(1e6),n.clusterHide&&n.clusterHide(),h.addLayer(n),n._setPos&&n._setPos(d);for(l._forceLayout(),l._animationStart(),i=t.length-1;i>=0;i--)a=c.layerPointToLatLng(e[i]),n=t[i],n._preSpiderfyLatlng=n._latlng,n.setLatLng(a),n.clusterShow&&n.clusterShow(),p&&(r=n._spiderLeg,o=r._path,o.style.strokeDashoffset=0,r.setStyle({opacity:_}));this.setOpacity(.3),l._ignoreMove=!1,setTimeout(function(){l._animationEnd(),l.fire("spiderfied",{cluster:u,markers:t})},200)},_animationUnspiderfy:function(t){var e,i,n,r,o,s,a=this,u=this._group,l=u._map,c=u._featureGroup,h=t?l._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):l.latLngToLayerPoint(this._latlng),f=this.getAllChildMarkers(),d=L.Path.SVG;for(u._ignoreMove=!0,u._animationStart(),this.setOpacity(1),i=f.length-1;i>=0;i--)e=f[i],e._preSpiderfyLatlng&&(e.closePopup(),e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,s=!0,e._setPos&&(e._setPos(h),s=!1),e.clusterHide&&(e.clusterHide(),s=!1),s&&c.removeLayer(e),d&&(n=e._spiderLeg,r=n._path,o=r.getTotalLength()+.1,r.style.strokeDashoffset=o,n.setStyle({opacity:0})));u._ignoreMove=!1,setTimeout(function(){var t=0;for(i=f.length-1;i>=0;i--)e=f[i],e._spiderLeg&&t++;for(i=f.length-1;i>=0;i--)e=f[i],e._spiderLeg&&(e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),t>1&&c.removeLayer(e),l.removeLayer(e._spiderLeg),delete e._spiderLeg);u._animationEnd(),u.fire("unspiderfied",{cluster:a,markers:f})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(t){return t?t instanceof L.MarkerClusterGroup?t=t._topClusterLevel.getAllChildMarkers():t instanceof L.LayerGroup?t=t._layers:t instanceof L.MarkerCluster?t=t.getAllChildMarkers():t instanceof L.Marker&&(t=[t]):t=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(t),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(t),this},_flagParentsIconsNeedUpdate:function(t){var e,i;for(e in t)for(i=t[e].__parent;i;)i._iconNeedsUpdate=!0,i=i.__parent},
_refreshSingleMarkerModeMarkers:function(t){var e,i;for(e in t)i=t[e],this.hasLayer(i)&&i.setIcon(this._overrideMarkerIcon(i))}}),L.Marker.include({refreshIconOptions:function(t,e){var i=this.options.icon;return L.setOptions(i,t),this.setIcon(i),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),t.MarkerClusterGroup=e,t.MarkerCluster=i}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leaflet"),require("esri-leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet","esri-leaflet"],e):e((t.L=t.L||{},t.L.esri=t.L.esri||{},t.L.esri.Vector=t.L.esri.Vector||{}),t.L,t.L.esri)}(this,function(t,e,i){"use strict";function n(t,n){i.request(t,{},function(o,s){if(o)throw new Error("Unable to fetch vector tile style metadata");i.request(s.sources.esri.url,{},function(i,o){i||(r(s,o,t),n._mapboxGL=e.mapboxGL({accessToken:"ezree",style:s}),n._ready=!0,n.fire("ready",{},!0))},n)},n)}function r(t,e,i){t.sources.esri.url&&-1===t.sources.esri.url.indexOf("http")&&(t.sources.esri.url=i.replace("/resources/styles/root.json","")),e.tiles&&"/"!==e.tiles[0].charAt(0)&&(e.tiles[0]="/"+e.tiles[0]),e.tileMap&&"/"!==e.tileMap.charAt(0)&&(e.tileMap="/"+e.tileMap),t.sources.esri={type:"vector",scheme:"xyz",tilejson:e.tilejson||"2.0.0",format:e.tileInfo&&e.tileInfo.format||"pbf",index:e.tileMap?t.sources.esri.url+e.tileMap:null,tiles:[t.sources.esri.url+e.tiles[0]],description:e.description,name:e.name},-1===t.glyphs.indexOf("http")&&(t.glyphs=i.replace("styles/root.json",t.glyphs.replace("../","")),t.sprite=i.replace("styles/root.json",t.sprite.replace("../","")))}function o(t){return new a(t)}function s(t){return new u(t)}e="default"in e?e.default:e,!function(e){if("object"==typeof t&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.mapboxgl=e()}}(function(){var t;return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){return r(e[s][1][t]||t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){function n(t){t?(this.array=t.array,this.pos=t.pos):(this.array=new ArrayBuffer(this.defaultLength),this.length=this.defaultLength,this.setupViews())}e.exports=n,n.prototype={pos:0,itemSize:4,defaultLength:8192,arrayType:"ARRAY_BUFFER",get index(){return this.pos/this.itemSize},setupViews:function(){this.ubytes=new Uint8Array(this.array),this.bytes=new Int8Array(this.array),this.ushorts=new Uint16Array(this.array),this.shorts=new Int16Array(this.array)},bind:function(t){var e=t[this.arrayType];this.buffer?t.bindBuffer(e,this.buffer):(this.buffer=t.createBuffer(),t.bindBuffer(e,this.buffer),t.bufferData(e,this.array.slice(0,this.pos),t.STATIC_DRAW),this.array=null)},destroy:function(t){this.buffer&&t.deleteBuffer(this.buffer)},resize:function(){if(this.length<this.pos+this.itemSize){for(;this.length<this.pos+this.itemSize;)this.length=2*Math.round(1.5*this.length/2);this.array=new ArrayBuffer(this.length),new Uint8Array(this.array).set(this.ubytes),this.setupViews()}}}},{}],2:[function(t,e,i){var n=t("./line_vertex_buffer"),r=t("./line_element_buffer"),o=t("./fill_vertex_buffer"),s=t("./triangle_element_buffer"),a=t("./outline_element_buffer"),u=t("./glyph_vertex_buffer"),l=t("./triangle_element_buffer"),c=t("./icon_vertex_buffer"),h=t("./triangle_element_buffer"),f=t("./collision_box_vertex_buffer"),d=t("./circle_vertex_buffer"),p=t("./triangle_element_buffer");e.exports=function(t){return t=t||{},{glyphVertex:new u(t.glyphVertex),glyphElement:new l(t.glyphElement),iconVertex:new c(t.iconVertex),iconElement:new h(t.iconElement),circleVertex:new d(t.circleVertex),circleElement:new p(t.circleElement),fillVertex:new o(t.fillVertex),fillElement:new s(t.fillElement),outlineElement:new a(t.outlineElement),lineVertex:new n(t.lineVertex),lineElement:new r(t.lineElement),collisionBoxVertex:new f(t.collisionBoxVertex)}}},{"./circle_vertex_buffer":3,"./collision_box_vertex_buffer":4,"./fill_vertex_buffer":5,"./glyph_vertex_buffer":6,"./icon_vertex_buffer":7,"./line_element_buffer":8,"./line_vertex_buffer":9,"./outline_element_buffer":10,"./triangle_element_buffer":11}],3:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{defaultLength:32768,itemSize:4,add:function(t,e,i,n){var r=this.pos,o=r/2;this.resize(),this.shorts[o+0]=2*t+(i+1)/2,this.shorts[o+1]=2*e+(n+1)/2,this.pos+=this.itemSize},bind:function(t,e,i){o.prototype.bind.call(this,t),t.vertexAttribPointer(e.a_pos,2,t.SHORT,!1,this.itemSize,i+0)}})},{"../../util/util":106,"./buffer":1}],4:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:12,defaultLength:32768,add:function(t,e,i,n){var r=this.pos,o=r/2,s=this.index;return this.resize(),this.shorts[o+0]=t.x,this.shorts[o+1]=t.y,this.shorts[o+2]=Math.round(e.x),this.shorts[o+3]=Math.round(e.y),this.ubytes[r+8]=Math.floor(10*i),this.ubytes[r+9]=Math.floor(10*n),this.pos+=this.itemSize,s}})},{"../../util/util":106,"./buffer":1}],5:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:4,add:function(t,e){var i=this.pos/2;this.resize(),this.shorts[i+0]=t,this.shorts[i+1]=e,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],6:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{defaultLength:32768,itemSize:16,add:function(t,e,i,n,r,o,s,a,u){var l=this.pos,c=l/2;this.resize(),this.shorts[c+0]=t,this.shorts[c+1]=e,this.shorts[c+2]=Math.round(64*i),this.shorts[c+3]=Math.round(64*n),this.ubytes[l+8]=Math.floor(r/4),this.ubytes[l+9]=Math.floor(o/4),this.ubytes[l+10]=Math.floor(10*u),this.ubytes[l+12]=Math.floor(10*s),this.ubytes[l+13]=Math.floor(10*Math.min(a,25)),this.pos+=this.itemSize},bind:function(t,e,i){o.prototype.bind.call(this,t);var n=this.itemSize;t.vertexAttribPointer(e.a_pos,2,t.SHORT,!1,n,i+0),t.vertexAttribPointer(e.a_offset,2,t.SHORT,!1,n,i+4),t.vertexAttribPointer(e.a_data1,4,t.UNSIGNED_BYTE,!1,n,i+8),t.vertexAttribPointer(e.a_data2,2,t.UNSIGNED_BYTE,!1,n,i+12)}})},{"../../util/util":106,"./buffer":1}],7:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{defaultLength:32768,itemSize:16,add:function(t,e,i,n,r,o,s,a,u){var l=this.pos,c=l/2;this.resize(),this.shorts[c+0]=t,this.shorts[c+1]=e,this.shorts[c+2]=Math.round(64*i),this.shorts[c+3]=Math.round(64*n),this.ubytes[l+8]=r/4,this.ubytes[l+9]=o/4,this.ubytes[l+10]=Math.floor(10*(u||0)),this.ubytes[l+12]=Math.floor(10*(s||0)),this.ubytes[l+13]=Math.floor(10*Math.min(a||25,25)),this.pos+=this.itemSize},bind:function(t,e,i){o.prototype.bind.call(this,t);var n=this.itemSize;t.vertexAttribPointer(e.a_pos,2,t.SHORT,!1,n,i+0),t.vertexAttribPointer(e.a_offset,2,t.SHORT,!1,n,i+4),t.vertexAttribPointer(e.a_data1,4,t.UNSIGNED_BYTE,!1,n,i+8),t.vertexAttribPointer(e.a_data2,2,t.UNSIGNED_BYTE,!1,n,i+12)}})},{"../../util/util":106,"./buffer":1}],8:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:6,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e,i){var n=this.pos/2;this.resize(),this.ushorts[n+0]=t,this.ushorts[n+1]=e,this.ushorts[n+2]=i,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],9:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.extrudeScale=63,n.prototype=r.inherit(o,{itemSize:8,defaultLength:32768,add:function(t,e,i,r,o){var s=this.pos,a=s/2,u=this.index,l=n.extrudeScale;return this.resize(),this.shorts[a+0]=2*Math.floor(t.x)|i,this.shorts[a+1]=2*Math.floor(t.y)|r,this.bytes[s+4]=Math.round(l*e.x),this.bytes[s+5]=Math.round(l*e.y),this.bytes[s+6]=(o||0)/128,this.bytes[s+7]=(o||0)%128,this.pos+=this.itemSize,u}})},{"../../util/util":106,"./buffer":1}],10:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:4,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e){var i=this.pos/2;this.resize(),this.ushorts[i+0]=t,this.ushorts[i+1]=e,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],11:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:6,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e,i){var n=this.pos/2;this.resize(),this.ushorts[n+0]=t,this.ushorts[n+1]=e,this.ushorts[n+2]=i,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],12:[function(t,e,i){function n(t){this.buffers=t,this.elementGroups=new r(t.circleVertex,t.circleElement)}var r=t("./element_groups");e.exports=n,n.prototype.addFeatures=function(){for(var t=0;t<this.features.length;t++)for(var e=this.features[t].loadGeometry()[0],i=0;i<e.length;i++){this.elementGroups.makeRoomFor(6);var n=e[i].x,r=e[i].y;if(!(0>n||n>=4096||0>r||r>=4096)){var o=this.buffers.circleVertex.index-this.elementGroups.current.vertexStartIndex;this.buffers.circleVertex.add(n,r,-1,-1),this.buffers.circleVertex.add(n,r,1,-1),this.buffers.circleVertex.add(n,r,1,1),this.buffers.circleVertex.add(n,r,-1,1),this.elementGroups.elementBuffer.add(o,o+1,o+2),this.elementGroups.elementBuffer.add(o,o+3,o+2),this.elementGroups.current.vertexLength+=4,this.elementGroups.current.elementLength+=2}}}},{"./element_groups":14}],13:[function(t,e,i){function n(t,e,i,n,h){var f=new c("layout",t.type,t.layout,{}).values(),d={lastIntegerZoom:1/0,lastIntegerZoomTime:0,lastZoom:0},p={};for(var m in f)p[m]=f[m].calculate(i,d);"symbol"===t.type&&(f["text-size"]&&(p["text-max-size"]=f["text-size"].calculate(18,d),p["text-size"]=f["text-size"].calculate(i+1,d)),f["icon-size"]&&(p["icon-max-size"]=f["icon-size"].calculate(18,d),p["icon-size"]=f["icon-size"].calculate(i+1,d)));var _="line"===t.type?r:"fill"===t.type?o:"symbol"===t.type?s:"circle"===t.type?a:null,g=new _(e,new u[t.type](p),n,i,h);return g.id=t.id,g.type=t.type,g["source-layer"]=t["source-layer"],g.interactive=t.interactive,g.minZoom=t.minzoom,g.maxZoom=t.maxzoom,g.filter=l(t.filter),g.features=[],g}e.exports=n;var r=t("./line_bucket"),o=t("./fill_bucket"),s=t("./symbol_bucket"),a=t("./circle_bucket"),u=t("../style/layout_properties"),l=t("feature-filter"),c=t("../style/style_declaration_set")},{"../style/layout_properties":53,"../style/style_declaration_set":59,"./circle_bucket":12,"./fill_bucket":16,"./line_bucket":17,"./symbol_bucket":18,"feature-filter":108}],14:[function(t,e,i){function n(t,e,i){this.vertexBuffer=t,this.elementBuffer=e,this.secondElementBuffer=i,this.groups=[]}function r(t,e,i){this.vertexStartIndex=t,this.elementStartIndex=e,this.secondElementStartIndex=i,this.elementLength=0,this.vertexLength=0,this.secondElementLength=0}e.exports=n,n.prototype.makeRoomFor=function(t){(!this.current||this.current.vertexLength+t>65535)&&(this.current=new r(this.vertexBuffer.index,this.elementBuffer&&this.elementBuffer.index,this.secondElementBuffer&&this.secondElementBuffer.index),this.groups.push(this.current))}},{}],15:[function(t,e,i){function n(t,e){this.x=t.x,this.y=t.y,this.z=t.z-Math.log(e)/Math.LN2,this.rtree=p(9),this.toBeInserted=[]}function r(t,e,i){return"Point"===e?u(t,i):"LineString"===e?s(t,i):"Polygon"===e&&(o(t,i)||s(t,i))}function o(t,e){return!!(f(t,new m(e[0],e[1]))||f(t,new m(e[0],e[3]))||f(t,new m(e[2],e[1]))||f(t,new m(e[2],e[3])))||s(t,e)}function s(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0,o=n.length-1;r<n.length;o=r++){var s=n[r],l=n[o],c=new m(s.y,s.x),h=new m(l.y,l.x);if(a(s,l,e[0],e[2],e[1])||a(s,l,e[0],e[2],e[3])||a(c,h,e[1],e[3],e[0])||a(c,h,e[1],e[3],e[2]))return!0}return u(t,e)}function a(t,e,i,n,r){if(e.y===t.y)return e.y===r&&Math.min(t.x,e.x)<=n&&Math.max(t.x,e.x)>=i;var o=(r-t.y)/(e.y-t.y),s=t.x+o*(e.x-t.x);return s>=i&&n>=s&&1>=o&&o>=0}function u(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;r++)if(n[r].x>=e[0]&&n[r].y>=e[1]&&n[r].x<=e[2]&&n[r].y<=e[3])return!0;return!1}function l(t,e,i,n){return"Point"===e?d(t,i,n):"LineString"===e?h(t,i,n):"Polygon"===e&&(f(t,i)||h(t,i,n))}function c(t,e,i){var n=e.distSqr(i);if(0===n)return t.distSqr(e);var r=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;return 0>r?t.distSqr(e):r>1?t.distSqr(i):t.distSqr(i.sub(e)._mult(r)._add(e))}function h(t,e,i){for(var n=i*i,r=0;r<t.length;r++)for(var o=t[r],s=1;s<o.length;s++){var a=o[s-1],u=o[s];if(c(e,a,u)<n)return!0}return!1}function f(t,e){for(var i,n,r,o=!1,s=0;s<t.length;s++){i=t[s];for(var a=0,u=i.length-1;a<i.length;u=a++)n=i[a],r=i[u],n.y>e.y!=r.y>e.y&&e.x<(r.x-n.x)*(e.y-n.y)/(r.y-n.y)+n.x&&(o=!o)}return o}function d(t,e,i){for(var n=i*i,r=0;r<t.length;r++)for(var o=t[r],s=0;s<o.length;s++)if(o[s].distSqr(e)<=n)return!0;return!1}var p=t("rbush"),m=t("point-geometry"),_=t("vector-tile"),g=t("../util/util");e.exports=n,n.prototype.insert=function(t,e,i){t.layers=e,t.feature=i,this.toBeInserted.push(t)},n.prototype._load=function(){this.rtree.load(this.toBeInserted),this.toBeInserted=[]},n.prototype.query=function(t,e){this.toBeInserted.length&&this._load();var i,n,o=t.params||{},s=t.x,a=t.y,u=[];void 0!==s&&void 0!==a?(i=(o.radius||0)*(t.tileExtent||4096)/t.scale,n=[s-i,a-i,s+i,a+i]):n=[t.minX,t.minY,t.maxX,t.maxY];for(var c=this.rtree.search(n),h=0;h<c.length;h++){var f=c[h].feature,d=c[h].layers,p=_.VectorTileFeature.types[f.type];if((!o.$type||p===o.$type)&&(!i||l(f.loadGeometry(),p,new m(s,a),i))&&r(f.loadGeometry(),p,n)){var v=f.toGeoJSON(this.x,this.y,this.z);o.includeGeometry||(v.geometry=null);for(var y=0;y<d.length;y++){var b=d[y];o.layerIds&&o.layerIds.indexOf(b)<0||u.push(g.extend({layer:b},v))}}}e(null,u)}},{"../util/util":106,"point-geometry":137,rbush:139,"vector-tile":144}],16:[function(t,e,i){function n(t){this.buffers=t,this.elementGroups=new r(t.fillVertex,t.fillElement,t.outlineElement)}var r=t("./element_groups");e.exports=n,n.prototype.addFeatures=function(){for(var t=this.features,e=0;e<t.length;e++){var i=t[e],n=i.loadGeometry();n&&this.addFeature(n)}},n.prototype.addFeature=function(t){for(var e=0;e<t.length;e++)this.addFill(t[e])},n.prototype.addFill=function(t){if(!(t.length<3)){var e=t.length;this.elementGroups.makeRoomFor(e+1);for(var i,n,r,o=this.elementGroups.current,s=this.buffers.fillVertex,a=this.buffers.fillElement,u=this.buffers.outlineElement,l=s.index-o.vertexStartIndex,c=0;c<t.length;c++)n=s.index-o.vertexStartIndex,r=t[c],s.add(r.x,r.y),o.vertexLength++,c>=2&&(r.x!==t[0].x||r.y!==t[0].y)&&(a.add(l,i,n),o.elementLength++),c>=1&&(u.add(i,n),o.secondElementLength++),i=n}}},{"./element_groups":14}],17:[function(t,e,i){function n(t,e){this.buffers=t,this.elementGroups=new r(t.lineVertex,t.lineElement),this.layoutProperties=e}var r=t("./element_groups");e.exports=n,n.prototype.addFeatures=function(){for(var t=this.features,e=0;e<t.length;e++){var i=t[e],n=i.loadGeometry();n&&this.addFeature(n)}},n.prototype.addFeature=function(t){for(var e=this.layoutProperties,i=0;i<t.length;i++)this.addLine(t[i],e["line-join"],e["line-cap"],e["line-miter-limit"],e["line-round-limit"])},n.prototype.addLine=function(t,e,i,n,r){for(var o=t.length;o>2&&t[o-1].equals(t[o-2]);)o--;if(!(t.length<2)){"bevel"===e&&(n=1.05);var s=t[0],a=t[o-1],u=s.equals(a);if(this.elementGroups.makeRoomFor(10*o),2!==o||!u){var l,c,h,f,d,p,m,_=i,g=u?"butt":i,v=1,y=0,b=!0;this.e1=this.e2=this.e3=-1,u&&(l=t[o-2],d=s.sub(l)._unit()._perp());for(var x=0;o>x;x++)if(!(h=u&&x===o-1?t[1]:t[x+1])||!t[x].equals(h)){d&&(f=d),l&&(c=l),l=t[x],c&&(y+=l.dist(c)),d=h?h.sub(l)._unit()._perp():f,f=f||d;var w=f.add(d)._unit(),L=w.x*d.x+w.y*d.y,S=1/L,T=c&&h,M=T?e:h?_:g;if(T&&"round"===M&&(r>S?M="miter":2>=S&&(M="fakeround")),"miter"===M&&S>n&&(M="bevel"),"bevel"===M&&(S>2&&(M="flipbevel"),n>S&&(M="miter")),"miter"===M)w._mult(S),this.addCurrentVertex(l,v,y,w,0,0,!1);else if("flipbevel"===M){if(S>100)w=d.clone();else{var E=f.x*d.y-f.y*d.x>0?-1:1,P=S*f.add(d).mag()/f.sub(d).mag();w._perp()._mult(P*E)}this.addCurrentVertex(l,v,y,w,0,0,!1),v=-v}else if("bevel"===M||"fakeround"===M){var C=v*(f.x*d.y-f.y*d.x)>0,A=-Math.sqrt(S*S-1);if(C?(m=0,p=A):(p=0,m=A),b||this.addCurrentVertex(l,v,y,f,p,m,!1),"fakeround"===M){for(var k,z=Math.floor(8*(.5-(L-.5))),I=0;z>I;I++)k=d.mult((I+1)/(z+1))._add(f)._unit(),this.addPieSliceVertex(l,v,y,k,C);this.addPieSliceVertex(l,v,y,w,C);for(var R=z-1;R>=0;R--)k=f.mult((R+1)/(z+1))._add(d)._unit(),this.addPieSliceVertex(l,v,y,k,C)}h&&this.addCurrentVertex(l,v,y,d,-p,-m,!1)}else"butt"===M?(b||this.addCurrentVertex(l,v,y,f,0,0,!1),h&&this.addCurrentVertex(l,v,y,d,0,0,!1)):"square"===M?(b||(this.addCurrentVertex(l,v,y,f,1,1,!1),this.e1=this.e2=-1,v=1),h&&this.addCurrentVertex(l,v,y,d,-1,-1,!1)):"round"===M&&(b||(this.addCurrentVertex(l,v,y,f,0,0,!1),this.addCurrentVertex(l,v,y,f,1,1,!0),this.e1=this.e2=-1,v=1),h&&(this.addCurrentVertex(l,v,y,d,-1,-1,!0),this.addCurrentVertex(l,v,y,d,0,0,!1)));b=!1}}}},n.prototype.addCurrentVertex=function(t,e,i,n,r,o,s){var a,u=s?1:0,l=this.buffers.lineVertex,c=this.buffers.lineElement,h=this.elementGroups.current,f=this.elementGroups.current.vertexStartIndex;a=n.mult(e),r&&a._sub(n.perp()._mult(r)),this.e3=l.add(t,a,u,0,i)-f,this.e1>=0&&this.e2>=0&&(c.add(this.e1,this.e2,this.e3),h.elementLength++),this.e1=this.e2,this.e2=this.e3,a=n.mult(-e),o&&a._sub(n.perp()._mult(o)),this.e3=l.add(t,a,u,1,i)-f,this.e1>=0&&this.e2>=0&&(c.add(this.e1,this.e2,this.e3),h.elementLength++),this.e1=this.e2,this.e2=this.e3,h.vertexLength+=2},n.prototype.addPieSliceVertex=function(t,e,i,n,r){var o=this.buffers.lineVertex,s=this.buffers.lineElement,a=this.elementGroups.current,u=this.elementGroups.current.vertexStartIndex,l=r;n=n.mult(e*(r?-1:1)),this.e3=o.add(t,n,0,l,i)-u,a.vertexLength+=1,this.e1>=0&&this.e2>=0&&(s.add(this.e1,this.e2,this.e3),a.elementLength++),r?this.e2=this.e3:this.e1=this.e3}},{"./element_groups":14}],18:[function(t,e,i){function n(t,e,i,n,r){this.buffers=t,this.layoutProperties=e,this.overscaling=i,this.zoom=n,this.collisionDebug=r;var o=512*i;this.tilePixelRatio=4096/o,this.compareText={},this.symbolInstances=[]}function r(t,e,i,n,r,o,s,a,u,l,c,h){this.x=t.x,this.y=t.y,this.hasText=!!i,this.hasIcon=!!n,this.hasText&&(this.glyphQuads=o?_(t,i,s,e,r,u):[],this.textCollisionFeature=new b(e,t,i,s,a,u)),this.hasIcon&&(this.iconQuads=o?g(t,n,l,e,r,h):[],this.iconCollisionFeature=new b(e,t,n,l,c,h))}var o=t("./element_groups"),s=t("../symbol/anchor"),a=t("../symbol/get_anchors"),u=t("../util/token"),l=t("../symbol/quads"),c=t("../symbol/shaping"),h=t("../symbol/resolve_text"),f=t("../symbol/resolve_icons"),d=t("../symbol/mergelines"),p=c.shapeText,m=c.shapeIcon,_=l.getGlyphQuads,g=l.getIconQuads,v=t("../symbol/clip_line"),y=t("point-geometry"),b=t("../symbol/collision_feature");e.exports=n,n.prototype.needsPlacement=!0,n.prototype.addFeatures=function(t){var e=this.layoutProperties,i=this.features,n=this.textFeatures,r=.5,o=.5;switch(e["text-anchor"]){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(e["text-anchor"]){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}for(var s="right"===e["text-justify"]?1:"left"===e["text-justify"]?0:.5,a=24*e["text-line-height"],l="line"!==e["symbol-placement"]?24*e["text-max-width"]:0,c=24*e["text-letter-spacing"],h=[24*e["text-offset"][0],24*e["text-offset"][1]],f=e["text-font"].join(","),_=[],g=0;g<i.length;g++)_.push(i[g].loadGeometry());if("line"===e["symbol-placement"]){var v=d(i,n,_);_=v.geometries,i=v.features,n=v.textFeatures}for(var y,b,x=0;x<i.length;x++)if(_[x]){if(y=n[x]?p(n[x],this.stacks[f],l,a,r,o,s,c,h):null,e["icon-image"]){var w=u(i[x].properties,e["icon-image"]),L=this.icons[w];b=m(L,e),L&&(void 0===this.sdfIcons?this.sdfIcons=L.sdf:this.sdfIcons!==L.sdf&&console.warn("Style sheet warning: Cannot mix SDF and non-SDF icons in one bucket"))}else b=null;(y||b)&&this.addFeature(_[x],y,b)}this.placeFeatures(t,this.buffers,this.collisionDebug)},n.prototype.addFeature=function(t,e,i){var n=this.layoutProperties,o=n["text-size"]/24,u=this.tilePixelRatio*o,l=this.tilePixelRatio*n["text-max-size"]/24,c=this.tilePixelRatio*n["icon-size"],h=this.tilePixelRatio*n["symbol-spacing"],f=n["symbol-avoid-edges"],d=n["text-padding"]*this.tilePixelRatio,p=n["icon-padding"]*this.tilePixelRatio,m=n["text-max-angle"]/180*Math.PI,_="map"===n["text-rotation-alignment"]&&"line"===n["symbol-placement"],g="map"===n["icon-rotation-alignment"]&&"line"===n["symbol-placement"],y=n["text-allow-overlap"]||n["icon-allow-overlap"]||n["text-ignore-placement"]||n["icon-ignore-placement"],b="line"===n["symbol-placement"],x=h/2;b&&(t=v(t,0,0,4096,4096));for(var w=0;w<t.length;w++)for(var L=t[w],S=b?a(L,h,m,e,i,24,l,this.overscaling):[new s(L[0].x,L[0].y,0)],T=0,M=S.length;M>T;T++){var E=S[T];if(!(e&&b&&this.anchorIsTooClose(e.text,x,E))){var P=!(E.x<0||E.x>4096||E.y<0||E.y>4096);if(!f||P){var C=P||y;this.symbolInstances.push(new r(E,L,e,i,n,C,u,d,_,c,p,g))}}}},n.prototype.anchorIsTooClose=function(t,e,i){var n=this.compareText;if(t in n){for(var r=n[t],o=r.length-1;o>=0;o--)if(i.dist(r[o])<e)return!0}else n[t]=[];return n[t].push(i),!1},n.prototype.placeFeatures=function(t,e,i){this.buffers=e;var n=this.elementGroups={text:new o(e.glyphVertex,e.glyphElement),icon:new o(e.iconVertex,e.iconElement),sdfIcons:this.sdfIcons},r=this.layoutProperties,s=t.maxScale;n.text["text-size"]=r["text-size"],n.icon["icon-size"]=r["icon-size"];var a="map"===r["text-rotation-alignment"]&&"line"===r["symbol-placement"],u="map"===r["icon-rotation-alignment"]&&"line"===r["symbol-placement"];if(r["text-allow-overlap"]||r["icon-allow-overlap"]||r["text-ignore-placement"]||r["icon-ignore-placement"]){var l=t.angle,c=Math.sin(l),h=Math.cos(l);this.symbolInstances.sort(function(t,e){var i=c*t.x+h*t.y;return c*e.x+h*e.y-i})}for(var f=0;f<this.symbolInstances.length;f++){var d=this.symbolInstances[f],p=d.hasText,m=d.hasIcon,_=r["text-optional"]||!p,g=r["icon-optional"]||!m,v=p&&!r["text-allow-overlap"]?t.placeCollisionFeature(d.textCollisionFeature):t.minScale,y=m&&!r["icon-allow-overlap"]?t.placeCollisionFeature(d.iconCollisionFeature):t.minScale;_||g?!g&&v?v=Math.max(y,v):!_&&y&&(y=Math.max(y,v)):y=v=Math.max(y,v),p&&(r["text-ignore-placement"]||t.insertCollisionFeature(d.textCollisionFeature,v),s>=v&&this.addSymbols(e.glyphVertex,e.glyphElement,n.text,d.glyphQuads,v,r["text-keep-upright"],a,t.angle)),m&&(r["icon-ignore-placement"]||t.insertCollisionFeature(d.iconCollisionFeature,y),s>=y&&this.addSymbols(e.iconVertex,e.iconElement,n.icon,d.iconQuads,y,r["icon-keep-upright"],u,t.angle))}i&&this.addToDebugBuffers(t)},n.prototype.addSymbols=function(t,e,i,n,r,o,s,a){i.makeRoomFor(4*n.length);for(var u=i.current,l=this.zoom,c=Math.max(Math.log(r)/Math.LN2+l,0),h=0;h<n.length;h++){var f=n[h],d=f.angle,p=(d+a+Math.PI)%(2*Math.PI);if(!(o&&s&&(p<=Math.PI/2||p>3*Math.PI/2))){var m=f.tl,_=f.tr,g=f.bl,v=f.br,y=f.tex,b=f.anchorPoint,x=Math.max(l+Math.log(f.minScale)/Math.LN2,c),w=Math.min(l+Math.log(f.maxScale)/Math.LN2,25);if(!(x>=w)){x===c&&(x=0);var L=t.index-u.vertexStartIndex;t.add(b.x,b.y,m.x,m.y,y.x,y.y,x,w,c),t.add(b.x,b.y,_.x,_.y,y.x+y.w,y.y,x,w,c),t.add(b.x,b.y,g.x,g.y,y.x,y.y+y.h,x,w,c),t.add(b.x,b.y,v.x,v.y,y.x+y.w,y.y+y.h,x,w,c),u.vertexLength+=4,e.add(L,L+1,L+2),e.add(L+1,L+2,L+3),u.elementLength+=2}}}},n.prototype.getDependencies=function(t,e,i){function n(t){return t||r?i(t):void(r=!0)}var r=!1;this.getTextDependencies(t,e,n),this.getIconDependencies(t,e,n)},n.prototype.getIconDependencies=function(t,e,i){function n(t,e){return t?i(t):(this.icons=e,void i())}if(this.layoutProperties["icon-image"]){var r=this.features,o=f(r,this.layoutProperties);o.length?e.send("get icons",{icons:o},n.bind(this)):i()}else i()},n.prototype.getTextDependencies=function(t,e,i){var n=this.features,r=this.layoutProperties["text-font"],o=this.stacks=t.stacks;void 0===o[r]&&(o[r]={});var s=o[r],a=h(n,this.layoutProperties,s);this.textFeatures=a.textFeatures,e.send("get glyphs",{uid:t.uid,fontstack:r,codepoints:a.codepoints},function(t,e){if(t)return i(t);for(var n in e)s[n]=e[n];i()})},n.prototype.addToDebugBuffers=function(t){this.elementGroups.collisionBox=new o(this.buffers.collisionBoxVertex),this.elementGroups.collisionBox.makeRoomFor(0);for(var e=this.buffers.collisionBoxVertex,i=-t.angle,n=t.yStretch,r=0;r<this.symbolInstances.length;r++)for(var s=0;2>s;s++){var a=this.symbolInstances[r][0===s?"textCollisionFeature":"iconCollisionFeature"];if(a)for(var u=a.boxes,l=0;l<u.length;l++){var c=u[l],h=c.anchorPoint,f=new y(c.x1,c.y1*n)._rotate(i),d=new y(c.x2,c.y1*n)._rotate(i),p=new y(c.x1,c.y2*n)._rotate(i),m=new y(c.x2,c.y2*n)._rotate(i),_=Math.max(0,Math.min(25,this.zoom+Math.log(c.maxScale)/Math.LN2)),g=Math.max(0,Math.min(25,this.zoom+Math.log(c.placementScale)/Math.LN2));e.add(h,f,_,g),e.add(h,d,_,g),e.add(h,d,_,g),e.add(h,m,_,g),e.add(h,m,_,g),e.add(h,p,_,g),e.add(h,p,_,g),e.add(h,f,_,g),this.elementGroups.collisionBox.current.vertexLength+=8}}}},{"../symbol/anchor":62,"../symbol/clip_line":65,"../symbol/collision_feature":67,"../symbol/get_anchors":69,"../symbol/mergelines":72,"../symbol/quads":73,"../symbol/resolve_icons":74,"../symbol/resolve_text":75,"../symbol/shaping":76,"../util/token":105,"./element_groups":14,"point-geometry":137}],19:[function(t,e,i){function n(t,e,i){this.column=t,this.row=e,this.zoom=i}e.exports=n,n.prototype={clone:function(){return new n(this.column,this.row,this.zoom)},zoomTo:function(t){return this.clone()._zoomTo(t)},sub:function(t){return this.clone()._sub(t)},_zoomTo:function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},_sub:function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this}}},{}],20:[function(t,e,i){function n(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}e.exports=n;var r=t("../util/util").wrap;n.prototype.wrap=function(){return new n(r(this.lng,-180,180),this.lat)},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},{"../util/util":106}],21:[function(t,e,i){function n(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;r>n;n++)this.extend(i[n])}e.exports=n;var r=t("./lng_lat");n.prototype={extend:function(t){var e,i,o=this._sw,s=this._ne;if(t instanceof r)e=t,i=t;else{if(!(t instanceof n))return t?this.extend(r.convert(t)||n.convert(t)):this;if(e=t._sw,i=t._ne,!e||!i)return this}return o||s?(o.lng=Math.min(e.lng,o.lng),o.lat=Math.min(e.lat,o.lat),s.lng=Math.max(i.lng,s.lng),s.lat=Math.max(i.lat,s.lat)):(this._sw=new r(e.lng,e.lat),this._ne=new r(i.lng,i.lat)),this},getCenter:function(){return new r((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},getNorthWest:function(){return new r(this.getWest(),this.getNorth())},getSouthEast:function(){return new r(this.getEast(),this.getSouth())},getWest:function(){return this._sw.lng},getSouth:function(){return this._sw.lat},getEast:function(){return this._ne.lng},getNorth:function(){return this._ne.lat}},n.convert=function(t){return!t||t instanceof n?t:new n(t)}},{"./lng_lat":20}],22:[function(t,e,i){function n(t,e){this.tileSize=512,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this.zoom=0,this.center=new r(0,0),this.angle=0,this._altitude=1.5,this._pitch=0}var r=t("./lng_lat"),o=t("point-geometry"),s=t("./coordinate"),a=t("../util/util").wrap,u=t("../util/interpolate"),l=t("gl-matrix").vec4,c=t("gl-matrix").mat4;e.exports=n,n.prototype={get minZoom(){return this._minZoom},set minZoom(t){this._minZoom=t,this.zoom=Math.max(this.zoom,t)},get maxZoom(){return this._maxZoom},set maxZoom(t){this._maxZoom=t,this.zoom=Math.min(this.zoom,t)},get worldSize(){return this.tileSize*this.scale},get centerPoint(){return this.size._div(2)},get size(){return new o(this.width,this.height)},get bearing(){return-this.angle/Math.PI*180},set bearing(t){this.angle=-a(t,-180,180)*Math.PI/180},get pitch(){return this._pitch/Math.PI*180},set pitch(t){this._pitch=Math.min(60,t)/180*Math.PI},get altitude(){return this._altitude},set altitude(t){this._altitude=Math.max(.75,t)},get zoom(){return this._zoom},set zoom(t){t=Math.min(Math.max(t,this.minZoom),this.maxZoom),this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain()},get center(){return this._center},set center(t){this._center=t,this._constrain()},zoomScale:function(t){return Math.pow(2,t)},scaleZoom:function(t){return Math.log(t)/Math.LN2},project:function(t,e){return new o(this.lngX(t.lng,e),this.latY(t.lat,e))},unproject:function(t,e){return new r(this.xLng(t.x,e),this.yLat(t.y,e))},get x(){return this.lngX(this.center.lng)},get y(){return this.latY(this.center.lat)},get point(){return new o(this.x,this.y)},lngX:function(t,e){return(180+t)*(e||this.worldSize)/360},latY:function(t,e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*(e||this.worldSize)/360},xLng:function(t,e){return 360*t/(e||this.worldSize)-180},yLat:function(t,e){var i=180-360*t/(e||this.worldSize);return 360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90},panBy:function(t){var e=this.centerPoint._add(t);this.center=this.pointLocation(e)},setLocationAtPoint:function(t,e){var i=this.locationCoordinate(t),n=this.pointCoordinate(e),r=this.pointCoordinate(this.centerPoint),o=n._sub(i);this.center=this.coordinateLocation(r._sub(o))},setZoomAround:function(t,e){var i;e&&(i=this.locationPoint(e)),this.zoom=t,e&&this.setLocationAtPoint(e,i)},setBearingAround:function(t,e){var i;e&&(i=this.locationPoint(e)),this.bearing=t,e&&this.setLocationAtPoint(e,i)},locationPoint:function(t){return this.coordinatePoint(this.locationCoordinate(t))},pointLocation:function(t){return this.coordinateLocation(this.pointCoordinate(t))},locationCoordinate:function(t){var e=this.zoomScale(this.tileZoom)/this.worldSize,i=r.convert(t);return new s(this.lngX(i.lng)*e,this.latY(i.lat)*e,this.tileZoom)},coordinateLocation:function(t){var e=this.zoomScale(t.zoom);return new r(this.xLng(t.column,e),this.yLat(t.row,e))},pointCoordinate:function(t,e){void 0===e&&(e=0);var i=this.coordinatePointMatrix(this.tileZoom),n=c.invert(new Float64Array(16),i);if(!n)throw new Error("failed to invert matrix");var r=l.transformMat4([],[t.x,t.y,0,1],n),o=l.transformMat4([],[t.x,t.y,1,1],n),a=r[3],h=o[3],f=r[0]/a,d=o[0]/h,p=r[1]/a,m=o[1]/h,_=r[2]/a,g=o[2]/h,v=_===g?0:(e-_)/(g-_);return new s(u(f,d,v),u(p,m,v),this.tileZoom)},coordinatePoint:function(t){var e=this.coordinatePointMatrix(t.zoom),i=l.transformMat4([],[t.column,t.row,0,1],e);return new o(i[0]/i[3],i[1]/i[3])},coordinatePointMatrix:function(t){var e=this.getProjMatrix(),i=this.worldSize/this.zoomScale(t);return c.scale(e,e,[i,i,1]),c.multiply(e,this.getPixelMatrix(),e),e},getPixelMatrix:function(){var t=c.create();return c.scale(t,t,[this.width/2,-this.height/2,1]),c.translate(t,t,[1,-1,0]),t},_constrain:function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,e,i,n,r,s,a,u,l=this.size;this.latRange&&(t=this.latY(this.latRange[1]),e=this.latY(this.latRange[0]),r=e-t<l.y?l.y/(e-t):0),this.lngRange&&(i=this.lngX(this.lngRange[0]),
n=this.lngX(this.lngRange[1]),s=n-i<l.x?l.x/(n-i):0);var c=Math.max(s||0,r||0);if(c)return this.center=this.unproject(new o(s?(n+i)/2:this.x,r?(e+t)/2:this.y)),this.zoom+=this.scaleZoom(c),void(this._constraining=!1);if(this.latRange){var h=this.y,f=l.y/2;t>h-f&&(u=t+f),h+f>e&&(u=e-f)}if(this.lngRange){var d=this.x,p=l.x/2;i>d-p&&(a=i+p),d+p>n&&(a=n-p)}(void 0!==a||void 0!==u)&&(this.center=this.unproject(new o(void 0!==a?a:this.x,void 0!==u?u:this.y))),this._constraining=!1}},getProjMatrix:function(){var t=new Float64Array(16),e=Math.atan(.5/this.altitude),i=Math.sin(e)*this.altitude/Math.sin(Math.PI/2-this._pitch-e),n=Math.cos(Math.PI/2-this._pitch)*i+this.altitude;return c.perspective(t,2*Math.atan(this.height/2/this.altitude),this.width/this.height,.1,n),c.translate(t,t,[0,0,-this.altitude]),c.scale(t,t,[1,-1,1/this.height]),c.rotateX(t,t,this._pitch),c.rotateZ(t,t,this.angle),c.translate(t,t,[-this.x,-this.y,0]),t}}},{"../util/interpolate":102,"../util/util":106,"./coordinate":19,"./lng_lat":20,"gl-matrix":116,"point-geometry":137}],23:[function(t,e,i){var n={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};e.exports=function(t,e,i,r){r=r||1;var o,s,a,u,l,c,h,f,d=[];for(o=0,s=t.length;s>o;o++)if(l=n[t[o]]){for(f=null,a=0,u=l[1].length;u>a;a+=2)-1===l[1][a]&&-1===l[1][a+1]?f=null:(c=e+l[1][a]*r,h=i-l[1][a+1]*r,f&&d.push(f.x,f.y,c,h),f={x:c,y:h});e+=l[0]*r}return d}},{}],24:[function(t,e,i){var n=e.exports={};n.Map=t("./ui/map"),n.Control=t("./ui/control/control"),n.Navigation=t("./ui/control/navigation"),n.Attribution=t("./ui/control/attribution"),n.Popup=t("./ui/popup"),n.GeoJSONSource=t("./source/geojson_source"),n.VideoSource=t("./source/video_source"),n.ImageSource=t("./source/image_source"),n.Style=t("./style/style"),n.LngLat=t("./geo/lng_lat"),n.LngLatBounds=t("./geo/lng_lat_bounds"),n.Point=t("point-geometry"),n.Evented=t("./util/evented"),n.util=t("./util/util"),n.supported=t("./util/browser").supported;var r=t("./util/ajax");n.util.getJSON=r.getJSON,n.util.getArrayBuffer=r.getArrayBuffer;var o=t("./util/config");n.config=o,Object.defineProperty(n,"accessToken",{get:function(){return o.ACCESS_TOKEN},set:function(t){o.ACCESS_TOKEN=t}})},{"./geo/lng_lat":20,"./geo/lng_lat_bounds":21,"./source/geojson_source":39,"./source/image_source":41,"./source/video_source":48,"./style/style":56,"./ui/control/attribution":79,"./ui/control/control":80,"./ui/control/navigation":81,"./ui/map":91,"./ui/popup":92,"./util/ajax":94,"./util/browser":95,"./util/config":99,"./util/evented":100,"./util/util":106,"point-geometry":137}],25:[function(t,e,i){function n(t,e,i){var n,o=t.gl,s=e.paint["background-color"],a=e.paint["background-pattern"],u=e.paint["background-opacity"],l=a?t.spriteAtlas.getPosition(a.from,!0):null,c=a?t.spriteAtlas.getPosition(a.to,!0):null;if(l&&c){n=t.patternShader,o.switchShader(n,i),o.uniform1i(n.u_image,0),o.uniform2fv(n.u_pattern_tl_a,l.tl),o.uniform2fv(n.u_pattern_br_a,l.br),o.uniform2fv(n.u_pattern_tl_b,c.tl),o.uniform2fv(n.u_pattern_br_b,c.br),o.uniform1f(n.u_opacity,u);var h=t.transform,f=l.size,d=c.size,p=h.locationCoordinate(h.center),m=1/Math.pow(2,h.zoomFraction);o.uniform1f(n.u_mix,a.t);var _=r.create();r.scale(_,_,[1/(f[0]*a.fromScale),1/(f[1]*a.fromScale)]),r.translate(_,_,[p.column*h.tileSize%(f[0]*a.fromScale),p.row*h.tileSize%(f[1]*a.fromScale)]),r.rotate(_,_,-h.angle),r.scale(_,_,[m*h.width/2,-m*h.height/2]);var g=r.create();r.scale(g,g,[1/(d[0]*a.toScale),1/(d[1]*a.toScale)]),r.translate(g,g,[p.column*h.tileSize%(d[0]*a.toScale),p.row*h.tileSize%(d[1]*a.toScale)]),r.rotate(g,g,-h.angle),r.scale(g,g,[m*h.width/2,-m*h.height/2]),o.uniformMatrix3fv(n.u_patternmatrix_a,!1,_),o.uniformMatrix3fv(n.u_patternmatrix_b,!1,g),t.spriteAtlas.bind(o,!0)}else n=t.fillShader,o.switchShader(n,i),o.uniform4fv(n.u_color,s);o.disable(o.STENCIL_TEST),o.bindBuffer(o.ARRAY_BUFFER,t.backgroundBuffer),o.vertexAttribPointer(n.a_pos,t.backgroundBuffer.itemSize,o.SHORT,!1,0,0),o.drawArrays(o.TRIANGLE_STRIP,0,t.backgroundBuffer.itemCount),o.enable(o.STENCIL_TEST),o.stencilMask(0),o.stencilFunc(o.EQUAL,128,128)}var r=t("gl-matrix").mat3;e.exports=n},{"gl-matrix":116}],26:[function(t,e,i){function n(t,e,i,n){if(n.buffers){i=t.translateMatrix(i,n,e.paint["circle-translate"],e.paint["circle-translate-anchor"]);var o=n.elementGroups[e.ref||e.id];if(o){var s=t.gl;s.disable(s.STENCIL_TEST),s.switchShader(t.circleShader,i,n.exMatrix);var a=n.buffers.circleVertex,u=t.circleShader,l=n.buffers.circleElement,c=1/r.devicePixelRatio/e.paint["circle-radius"];s.uniform4fv(u.u_color,e.paint["circle-color"]),s.uniform1f(u.u_blur,Math.max(e.paint["circle-blur"],c)),s.uniform1f(u.u_size,e.paint["circle-radius"]);for(var h=0;h<o.groups.length;h++){var f=o.groups[h],d=f.vertexStartIndex*a.itemSize;a.bind(s,u,d),l.bind(s,u,d);var p=3*f.elementLength,m=f.elementStartIndex*l.itemSize;s.drawElements(s.TRIANGLES,p,s.UNSIGNED_SHORT,m)}s.enable(s.STENCIL_TEST)}}}var r=t("../util/browser.js");e.exports=n},{"../util/browser.js":95}],27:[function(t,e,i){function n(t,e,i,n){var r=n.elementGroups[e.ref||e.id].collisionBox;if(r){var o=t.gl,s=n.buffers.collisionBoxVertex,a=t.collisionBoxShader;o.enable(o.STENCIL_TEST),o.switchShader(a,i),s.bind(o,a),o.lineWidth(1),o.vertexAttribPointer(a.a_pos,2,o.SHORT,!1,12,0),o.vertexAttribPointer(a.a_extrude,2,o.SHORT,!1,12,4),o.vertexAttribPointer(a.a_data,2,o.UNSIGNED_BYTE,!1,12,8),o.uniform1f(a.u_scale,Math.pow(2,t.transform.zoom-n.coord.z)),o.uniform1f(a.u_zoom,10*t.transform.zoom),o.uniform1f(a.u_maxzoom,10*(n.coord.z+1));var u=r.groups[0].vertexStartIndex,l=r.groups[0].vertexLength;o.drawArrays(o.LINES,u,l),o.disable(o.STENCIL_TEST)}}e.exports=n},{}],28:[function(t,e,i){function n(t,e){var i=t.gl;i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.switchShader(t.debugShader,e.posMatrix),i.bindBuffer(i.ARRAY_BUFFER,t.debugBuffer),i.vertexAttribPointer(t.debugShader.a_pos,t.debugBuffer.itemSize,i.SHORT,!1,0,0),i.uniform4f(t.debugShader.u_color,1,0,0,1),i.lineWidth(4),i.drawArrays(i.LINE_STRIP,0,t.debugBuffer.itemCount);var n=r(e.coord.toString(),50,200,5);i.bindBuffer(i.ARRAY_BUFFER,t.debugTextBuffer),i.bufferData(i.ARRAY_BUFFER,new Int16Array(n),i.STREAM_DRAW),i.vertexAttribPointer(t.debugShader.a_pos,t.debugTextBuffer.itemSize,i.SHORT,!1,0,0),i.lineWidth(8*o.devicePixelRatio),i.uniform4f(t.debugShader.u_color,1,1,1,1),i.drawArrays(i.LINES,0,n.length/t.debugTextBuffer.itemSize),i.lineWidth(2*o.devicePixelRatio),i.uniform4f(t.debugShader.u_color,0,0,0,1),i.drawArrays(i.LINES,0,n.length/t.debugTextBuffer.itemSize),i.blendFunc(i.ONE_MINUS_DST_ALPHA,i.ONE)}var r=t("../lib/debugtext"),o=t("../util/browser");e.exports=n},{"../lib/debugtext":23,"../util/browser":95}],29:[function(t,e,i){function n(t,e,i,n){if(n.buffers){var s=n.elementGroups[e.ref||e.id];if(s){var a,u,l,c,h=t.gl,f=t.translateMatrix(i,n,e.paint["fill-translate"],e.paint["fill-translate-anchor"]),d=e.paint["fill-color"];h.stencilMask(63),h.clear(h.STENCIL_BUFFER_BIT),h.stencilFunc(h.NOTEQUAL,128,128),h.stencilOpSeparate(h.FRONT,h.INCR_WRAP,h.KEEP,h.KEEP),h.stencilOpSeparate(h.BACK,h.DECR_WRAP,h.KEEP,h.KEEP),h.colorMask(!1,!1,!1,!1),h.switchShader(t.fillShader,f),a=n.buffers.fillVertex,a.bind(h),u=n.buffers.fillElement,u.bind(h);for(var p,m,_=0;_<s.groups.length;_++)l=s.groups[_],p=l.vertexStartIndex*a.itemSize,h.vertexAttribPointer(t.fillShader.a_pos,2,h.SHORT,!1,4,p+0),c=3*l.elementLength,m=l.elementStartIndex*u.itemSize,h.drawElements(h.TRIANGLES,c,h.UNSIGNED_SHORT,m);h.colorMask(!0,!0,!0,!0),h.stencilOp(h.KEEP,h.KEEP,h.KEEP),h.stencilMask(0);var g=e.paint["fill-outline-color"];if(!0===e.paint["fill-antialias"]&&(!e.paint["fill-pattern"]||g)){h.switchShader(t.outlineShader,f),h.lineWidth(2*r.devicePixelRatio),g?h.stencilFunc(h.EQUAL,128,128):h.stencilFunc(h.EQUAL,128,191),h.uniform2f(t.outlineShader.u_world,h.drawingBufferWidth,h.drawingBufferHeight),h.uniform4fv(t.outlineShader.u_color,g||d),a=n.buffers.fillVertex,u=n.buffers.outlineElement,u.bind(h);for(var v=0;v<s.groups.length;v++)l=s.groups[v],p=l.vertexStartIndex*a.itemSize,h.vertexAttribPointer(t.outlineShader.a_pos,2,h.SHORT,!1,4,p+0),c=2*l.secondElementLength,m=l.secondElementStartIndex*u.itemSize,h.drawElements(h.LINES,c,h.UNSIGNED_SHORT,m)}var y,b=e.paint["fill-pattern"],x=e.paint["fill-opacity"]||1;if(b){var w=t.spriteAtlas.getPosition(b.from,!0),L=t.spriteAtlas.getPosition(b.to,!0);if(!w||!L)return;y=t.patternShader,h.switchShader(y,i),h.uniform1i(y.u_image,0),h.uniform2fv(y.u_pattern_tl_a,w.tl),h.uniform2fv(y.u_pattern_br_a,w.br),h.uniform2fv(y.u_pattern_tl_b,L.tl),h.uniform2fv(y.u_pattern_br_b,L.br),h.uniform1f(y.u_opacity,x),h.uniform1f(y.u_mix,b.t);var S=n.tileExtent/n.tileSize/Math.pow(2,t.transform.tileZoom-n.coord.z),T=o.create();o.scale(T,T,[1/(w.size[0]*S*b.fromScale),1/(w.size[1]*S*b.fromScale)]);var M=o.create();o.scale(M,M,[1/(L.size[0]*S*b.toScale),1/(L.size[1]*S*b.toScale)]),h.uniformMatrix3fv(y.u_patternmatrix_a,!1,T),h.uniformMatrix3fv(y.u_patternmatrix_b,!1,M),t.spriteAtlas.bind(h,!0)}else y=t.fillShader,h.switchShader(y,i),h.uniform4fv(y.u_color,d);h.stencilFunc(h.NOTEQUAL,0,63),h.bindBuffer(h.ARRAY_BUFFER,t.tileExtentBuffer),h.vertexAttribPointer(y.a_pos,t.tileExtentBuffer.itemSize,h.SHORT,!1,0,0),h.drawArrays(h.TRIANGLE_STRIP,0,t.tileExtentBuffer.itemCount),h.stencilMask(0),h.stencilFunc(h.EQUAL,128,128)}}}var r=t("../util/browser"),o=t("gl-matrix").mat3;e.exports=n},{"../util/browser":95,"gl-matrix":116}],30:[function(t,e,i){var n=t("../util/browser"),r=t("gl-matrix").mat2;e.exports=function(t,e,i,o){if(o.buffers){var s=o.elementGroups[e.ref||e.id];if(s){var a=t.gl;if(!(e.paint["line-width"]<=0)){var u=1/n.devicePixelRatio,l=e.paint["line-blur"]+u,c=e.paint["line-width"]/2,h=-1,f=0;e.paint["line-gap-width"]>0&&(h=e.paint["line-gap-width"]/2+.5*u,c=e.paint["line-width"],f=h-u/2);var d=f+c+u/2+0,p=e.paint["line-color"],m=t.transform.scale/(1<<o.coord.z)/(o.tileExtent/o.tileSize),_=t.translateMatrix(i,o,e.paint["line-translate"],e.paint["line-translate-anchor"]),g=t.transform,v=r.create();r.scale(v,v,[1,Math.cos(g._pitch)]),r.rotate(v,v,t.transform.angle);var y,b=Math.sqrt(g.height*g.height/4*(1+g.altitude*g.altitude)),x=g.height/2*Math.tan(g._pitch),w=(b+x)/b-1,L=o.tileSize/t.transform.tileSize,S=e.paint["line-dasharray"],T=e.paint["line-pattern"];if(S){y=t.linesdfpatternShader,a.switchShader(y,_,o.exMatrix),a.uniform2fv(y.u_linewidth,[d,h]),a.uniform1f(y.u_ratio,m),a.uniform1f(y.u_blur,l),a.uniform4fv(y.u_color,p);var M=t.lineAtlas.getDash(S.from,"round"===e.layout["line-cap"]),E=t.lineAtlas.getDash(S.to,"round"===e.layout["line-cap"]);t.lineAtlas.bind(a);var P=Math.pow(2,Math.floor(Math.log(t.transform.scale)/Math.LN2)-o.coord.z)/8*L,C=[P/M.width/S.fromScale,-M.height/2],A=t.lineAtlas.width/(S.fromScale*M.width*256*n.devicePixelRatio)/2,k=[P/E.width/S.toScale,-E.height/2],z=t.lineAtlas.width/(S.toScale*E.width*256*n.devicePixelRatio)/2;a.uniform2fv(y.u_patternscale_a,C),a.uniform1f(y.u_tex_y_a,M.y),a.uniform2fv(y.u_patternscale_b,k),a.uniform1f(y.u_tex_y_b,E.y),a.uniform1i(y.u_image,0),a.uniform1f(y.u_sdfgamma,Math.max(A,z)),a.uniform1f(y.u_mix,S.t),a.uniform1f(y.u_extra,w),a.uniformMatrix2fv(y.u_antialiasingmatrix,!1,v)}else if(T){var I=t.spriteAtlas.getPosition(T.from,!0),R=t.spriteAtlas.getPosition(T.to,!0);if(!I||!R)return;var O=o.tileExtent/o.tileSize/Math.pow(2,t.transform.tileZoom-o.coord.z)*L;t.spriteAtlas.bind(a,!0),y=t.linepatternShader,a.switchShader(y,_,o.exMatrix),a.uniform2fv(y.u_linewidth,[d,h]),a.uniform1f(y.u_ratio,m),a.uniform1f(y.u_blur,l),a.uniform2fv(y.u_pattern_size_a,[I.size[0]*O*T.fromScale,R.size[1]]),a.uniform2fv(y.u_pattern_size_b,[R.size[0]*O*T.toScale,R.size[1]]),a.uniform2fv(y.u_pattern_tl_a,I.tl),a.uniform2fv(y.u_pattern_br_a,I.br),a.uniform2fv(y.u_pattern_tl_b,R.tl),a.uniform2fv(y.u_pattern_br_b,R.br),a.uniform1f(y.u_fade,T.t),a.uniform1f(y.u_opacity,e.paint["line-opacity"]),a.uniform1f(y.u_extra,w),a.uniformMatrix2fv(y.u_antialiasingmatrix,!1,v)}else y=t.lineShader,a.switchShader(y,_,o.exMatrix),a.uniform2fv(y.u_linewidth,[d,h]),a.uniform1f(y.u_ratio,m),a.uniform1f(y.u_blur,l),a.uniform1f(y.u_extra,w),a.uniformMatrix2fv(y.u_antialiasingmatrix,!1,v),a.uniform4fv(y.u_color,p);var F=o.buffers.lineVertex;F.bind(a);var D=o.buffers.lineElement;D.bind(a);for(var j=0;j<s.groups.length;j++){var N=s.groups[j],B=N.vertexStartIndex*F.itemSize;a.vertexAttribPointer(y.a_pos,2,a.SHORT,!1,8,B+0),a.vertexAttribPointer(y.a_data,4,a.BYTE,!1,8,B+4);var U=3*N.elementLength,Z=N.elementStartIndex*D.itemSize;a.drawElements(a.TRIANGLES,U,a.UNSIGNED_SHORT,Z)}}}}}},{"../util/browser":95,"gl-matrix":116}],31:[function(t,e,i){function n(t,e,i,n){var u=t.gl;u.disable(u.STENCIL_TEST);var l=t.rasterShader;u.switchShader(l,i),u.uniform1f(l.u_brightness_low,e.paint["raster-brightness-min"]),u.uniform1f(l.u_brightness_high,e.paint["raster-brightness-max"]),u.uniform1f(l.u_saturation_factor,s(e.paint["raster-saturation"])),u.uniform1f(l.u_contrast_factor,o(e.paint["raster-contrast"])),u.uniform3fv(l.u_spin_weights,r(e.paint["raster-hue-rotate"]));var c,h,f=n.source&&n.source._pyramid.findLoadedParent(n.coord,0,{}),d=a(n,f,e,t.transform);u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,n.texture),f?(u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,f.texture),c=Math.pow(2,f.coord.z-n.coord.z),h=[n.coord.x*c%1,n.coord.y*c%1]):d[1]=0,u.uniform2fv(l.u_tl_parent,h||[0,0]),u.uniform1f(l.u_scale_parent,c||1),u.uniform1f(l.u_buffer_scale,1),u.uniform1f(l.u_opacity0,d[0]),u.uniform1f(l.u_opacity1,d[1]),u.uniform1i(l.u_image0,0),u.uniform1i(l.u_image1,1),u.bindBuffer(u.ARRAY_BUFFER,n.boundsBuffer||t.tileExtentBuffer),u.vertexAttribPointer(l.a_pos,2,u.SHORT,!1,8,0),u.vertexAttribPointer(l.a_texture_pos,2,u.SHORT,!1,8,4),u.drawArrays(u.TRIANGLE_STRIP,0,4),u.enable(u.STENCIL_TEST)}function r(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}function o(t){return t>0?1/(1-t):1+t}function s(t){return t>0?1-1/(1.001-t):-t}function a(t,e,i,n){if(!t.source)return[1,0];var r=(new Date).getTime(),o=i.paint["raster-fade-duration"],s=(r-t.timeAdded)/o,a=e?(r-e.timeAdded)/o:-1,l=t.source._pyramid.coveringZoomLevel(n),c=!!e&&Math.abs(e.coord.z-l)>Math.abs(t.coord.z-l),h=[];!e||c?(h[0]=u.clamp(s,0,1),h[1]=1-h[0]):(h[0]=u.clamp(1-a,0,1),h[1]=1-h[0]);var f=i.paint["raster-opacity"];return h[0]*=f,h[1]*=f,h}var u=t("../util/util");e.exports=n},{"../util/util":106}],32:[function(t,e,i){function n(t,e,i,n){if(n.buffers){var o=n.elementGroups[e.ref||e.id];if(o){var s=!(e.layout["text-allow-overlap"]||e.layout["icon-allow-overlap"]||e.layout["text-ignore-placement"]||e.layout["icon-ignore-placement"]),u=t.gl;s&&u.disable(u.STENCIL_TEST),o.text.groups.length&&r(t,e,i,n,o.text,"text",!0),o.icon.groups.length&&r(t,e,i,n,o.icon,"icon",o.sdfIcons),a(t,e,i,n),s&&u.enable(u.STENCIL_TEST)}}}function r(t,e,i,n,r,a,l){var c=t.gl;i=t.translateMatrix(i,n,e.paint[a+"-translate"],e.paint[a+"-translate-anchor"]);var h,f,d,p=t.transform,m="map"===e.layout[a+"-rotation-alignment"],_=m;_?(h=s.create(),f=n.tileExtent/n.tileSize/Math.pow(2,t.transform.zoom-n.coord.z),d=1/Math.cos(p._pitch)):(h=s.clone(n.exMatrix),f=t.transform.altitude,d=1),s.scale(h,h,[f,f,1]);var g=e.paint[a+"-size"],v=g/u[a];s.scale(h,h,[v,v,1]);var y,b,x,w,L=Math.sqrt(p.height*p.height/4*(1+p.altitude*p.altitude)),S=p.height/2*Math.tan(p._pitch),T=(L+S)/L-1,M="text"===a;if(M||t.style.sprite.loaded()){c.activeTexture(c.TEXTURE0),y=l?t.sdfShader:t.iconShader,M?(t.glyphAtlas.updateTexture(c),b=n.buffers.glyphVertex,x=n.buffers.glyphElement,w=[t.glyphAtlas.width/4,t.glyphAtlas.height/4]):(t.spriteAtlas.bind(c,m||t.options.rotating||t.options.zooming||1!==v||l||t.transform.pitch),b=n.buffers.iconVertex,x=n.buffers.iconElement,w=[t.spriteAtlas.width/4,t.spriteAtlas.height/4]),c.switchShader(y,i,h),c.uniform1i(y.u_texture,0),c.uniform2fv(y.u_texsize,w),c.uniform1i(y.u_skewed,_),c.uniform1f(y.u_extra,T);var E=Math.log(g/r[a+"-size"])/Math.LN2||0;c.uniform1f(y.u_zoom,10*(t.transform.zoom-E));var P=t.frameHistory.getFadeProperties(300);c.uniform1f(y.u_fadedist,10*P.fadedist),c.uniform1f(y.u_minfadezoom,Math.floor(10*P.minfadezoom)),c.uniform1f(y.u_maxfadezoom,Math.floor(10*P.maxfadezoom)),c.uniform1f(y.u_fadezoom,10*(t.transform.zoom+P.bump));var C,A,k,z;if(x.bind(c),l){var I=.105*u[a]/g/o.devicePixelRatio;c.uniform1f(y.u_gamma,I*d),c.uniform4fv(y.u_color,e.paint[a+"-color"]),c.uniform1f(y.u_buffer,.75);for(var R=0;R<r.groups.length;R++)C=r.groups[R],A=C.vertexStartIndex*b.itemSize,b.bind(c,y,A),k=3*C.elementLength,z=C.elementStartIndex*x.itemSize,c.drawElements(c.TRIANGLES,k,c.UNSIGNED_SHORT,z);if(e.paint[a+"-halo-width"]){c.uniform1f(y.u_gamma,(1.19*e.paint[a+"-halo-blur"]/v/8+I)*d),c.uniform4fv(y.u_color,e.paint[a+"-halo-color"]),c.uniform1f(y.u_buffer,(6-e.paint[a+"-halo-width"]/v)/8);for(var O=0;O<r.groups.length;O++)C=r.groups[O],A=C.vertexStartIndex*b.itemSize,b.bind(c,y,A),k=3*C.elementLength,z=C.elementStartIndex*x.itemSize,c.drawElements(c.TRIANGLES,k,c.UNSIGNED_SHORT,z)}}else{c.uniform1f(y.u_opacity,e.paint["icon-opacity"]);for(var F=0;F<r.groups.length;F++)C=r.groups[F],A=C.vertexStartIndex*b.itemSize,b.bind(c,y,A),k=3*C.elementLength,z=C.elementStartIndex*x.itemSize,c.drawElements(c.TRIANGLES,k,c.UNSIGNED_SHORT,z)}}}var o=t("../util/browser"),s=t("gl-matrix").mat4,a=t("./draw_collision_debug");e.exports=n;var u={icon:1,text:24}},{"../util/browser":95,"./draw_collision_debug":27,"gl-matrix":116}],33:[function(t,e,i){function n(t,e,i,n){function s(e,i,n,o){a.switchShader(t.dotShader,n),a.uniform1f(t.dotShader.u_size,4*r.devicePixelRatio),a.uniform1f(t.dotShader.u_blur,.25),a.uniform4fv(t.dotShader.u_color,[.1,0,0,.1]),e.bind(a,t.dotShader,0);for(var s=0;s<i.length;s++){var u=i[s],l=u.vertexStartIndex,c=u.vertexLength;a.vertexAttribPointer(t.dotShader.a_pos,2,a.SHORT,!1,o,0),a.drawArrays(a.POINTS,l,c)}}var a=t.gl;if(n&&n.buffers){var u=n.elementGroups[e.ref||e.id];if(u){if(a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),"fill"===e.type)s(n.buffers.fillVertex,u.groups,i,4);else if("symbol"===e.type)s(n.buffers.iconVertex,u.icon.groups,i,16),s(n.buffers.glyphVertex,u.text.groups,i,16);else if("line"===e.type){var l=o.clone(i);o.scale(l,l,[.5,.5,1]),s(n.buffers.lineVertex,u.groups,l,8)}a.blendFunc(a.ONE_MINUS_DST_ALPHA,a.ONE)}}}var r=t("../util/browser"),o=t("gl-matrix").mat4;e.exports=n},{"../util/browser":95,"gl-matrix":116}],34:[function(t,e,i){function n(){this.frameHistory=[]}e.exports=n,n.prototype.getFadeProperties=function(t){void 0===t&&(t=300);for(var e=(new Date).getTime();this.frameHistory.length>3&&this.frameHistory[1].time+t<e;)this.frameHistory.shift();this.frameHistory[1].time+t<e&&(this.frameHistory[0].z=this.frameHistory[1].z);var i=this.frameHistory.length;3>i&&console.warn("there should never be less than three frames in the history");var n=this.frameHistory[0].z,r=this.frameHistory[i-1],o=r.z,s=Math.min(n,o),a=Math.max(n,o),u=r.z-this.frameHistory[1].z,l=r.time-this.frameHistory[1].time,c=u/(l/t);return isNaN(c)&&console.warn("fadedist should never be NaN"),{fadedist:c,minfadezoom:s,maxfadezoom:a,bump:(e-r.time)/t*c}},n.prototype.record=function(t){var e=(new Date).getTime();this.frameHistory.length||this.frameHistory.push({time:0,z:t},{time:0,z:t}),(2===this.frameHistory.length||this.frameHistory[this.frameHistory.length-1].z!==t)&&this.frameHistory.push({time:e,z:t})}},{}],35:[function(t,e,i){var n=t("./shaders"),r=t("../util/util");i.extend=function(t){var e=t.lineWidth,i=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE);return t.lineWidth=function(n){e.call(t,r.clamp(n,i[0],i[1]))},t.getShader=function(t,e){var i=e===this.FRAGMENT_SHADER?"fragment":"vertex";if(!n[t]||!n[t][i])throw new Error("Could not find shader "+t);var r=this.createShader(e),o=n[t][i];if("undefined"==typeof orientation&&(o=o.replace(/ highp /g," ")),this.shaderSource(r,o),this.compileShader(r),!this.getShaderParameter(r,this.COMPILE_STATUS))throw new Error(this.getShaderInfoLog(r));return r},t.initializeShader=function(t,e,i){var n={program:this.createProgram(),fragment:this.getShader(t,this.FRAGMENT_SHADER),vertex:this.getShader(t,this.VERTEX_SHADER),attributes:[]};if(this.attachShader(n.program,n.vertex),this.attachShader(n.program,n.fragment),this.linkProgram(n.program),this.getProgramParameter(n.program,this.LINK_STATUS)){for(var r=0;r<e.length;r++)n[e[r]]=this.getAttribLocation(n.program,e[r]),n.attributes.push(n[e[r]]);for(var o=0;o<i.length;o++)n[i[o]]=this.getUniformLocation(n.program,i[o])}else console.error(this.getProgramInfoLog(n.program));return n},t.switchShader=function(t,e,i){if(e||console.trace("posMatrix does not have required argument"),this.currentShader!==t){this.useProgram(t.program);for(var n=this.currentShader?this.currentShader.attributes:[],r=t.attributes,o=0;o<n.length;o++)r.indexOf(n[o])<0&&this.disableVertexAttribArray(n[o]);for(var s=0;s<r.length;s++)n.indexOf(r[s])<0&&this.enableVertexAttribArray(r[s]);this.currentShader=t}t.posMatrix!==e&&(this.uniformMatrix4fv(t.u_matrix,!1,e),t.posMatrix=e),i&&t.exMatrix!==i&&t.u_exmatrix&&(this.uniformMatrix4fv(t.u_exmatrix,!1,i),t.exMatrix=i)},t.vertexAttrib2fv=function(e,i){t.vertexAttrib2f(e,i[0],i[1])},t.vertexAttrib3fv=function(e,i){t.vertexAttrib3f(e,i[0],i[1],i[2])},t.vertexAttrib4fv=function(e,i){t.vertexAttrib4f(e,i[0],i[1],i[2],i[3])},t}},{"../util/util":106,"./shaders":38}],36:[function(t,e,i){function n(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}}e.exports=n,n.prototype.setSprite=function(t){this.sprite=t},n.prototype.getDash=function(t,e){var i=t.join(",")+e;return this.positions[i]||(this.positions[i]=this.addDash(t,e)),this.positions[i]},n.prototype.addDash=function(t,e){var i=e?7:0,n=2*i+1;if(this.nextRow+n>this.height)return console.warn("LineAtlas out of space"),null;for(var r=0,o=0;o<t.length;o++)r+=t[o];for(var s=this.width/r,a=s/2,u=t.length%2==1,l=-i;i>=l;l++)for(var c=this.nextRow+i+l,h=this.width*c,f=u?-t[t.length-1]:0,d=t[0],p=1,m=0;m<this.width;m++){for(;m/s>d;)f=d,d+=t[p],u&&p===t.length-1&&(d+=t[0]),p++;var _,g=Math.abs(m-f*s),v=Math.abs(m-d*s),y=Math.min(g,v),b=p%2==1;if(e){var x=i?l/i*(a+1):0;if(b){var w=a-Math.abs(x);_=Math.sqrt(y*y+w*w)}else _=a-Math.sqrt(y*y+x*x)}else _=(b?1:-1)*y;this.data[3+4*(h+m)]=Math.max(0,Math.min(255,_+128))}var L={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:r};return this.nextRow+=n,this.dirty=!0,L},n.prototype.bind=function(t){this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))},n.prototype.debug=function(){var t=document.createElement("canvas");document.body.appendChild(t),t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.background="#ff0",t.width=this.width,t.height=this.height;for(var e=t.getContext("2d"),i=e.getImageData(0,0,this.width,this.height),n=0;n<this.data.length;n++)if(this.sdf){var r=4*n;i.data[r]=i.data[r+1]=i.data[r+2]=0,i.data[r+3]=this.data[n]}else i.data[n]=this.data[n];e.putImageData(i,0,0)}},{}],37:[function(t,e,i){function n(t,e){this.gl=r.extend(t),this.transform=e,this.reusableTextures={},this.preFbos={},this.frameHistory=new a,this.setup()}var r=t("./gl_util"),o=t("../util/browser"),s=t("gl-matrix").mat4,a=t("./frame_history");e.exports=n,n.prototype.resize=function(t,e){var i=this.gl;this.width=t*o.devicePixelRatio,this.height=e*o.devicePixelRatio,i.viewport(0,0,this.width,this.height)},n.prototype.setup=function(){var t=this.gl;t.verbose=!0,t.enable(t.BLEND),t.blendFunc(t.ONE_MINUS_DST_ALPHA,t.ONE),t.enable(t.STENCIL_TEST),this.debugShader=t.initializeShader("debug",["a_pos"],["u_matrix","u_color"]),this.rasterShader=t.initializeShader("raster",["a_pos","a_texture_pos"],["u_matrix","u_brightness_low","u_brightness_high","u_saturation_factor","u_spin_weights","u_contrast_factor","u_opacity0","u_opacity1","u_image0","u_image1","u_tl_parent","u_scale_parent","u_buffer_scale"]),this.circleShader=t.initializeShader("circle",["a_pos"],["u_matrix","u_exmatrix","u_blur","u_size","u_color"]),this.lineShader=t.initializeShader("line",["a_pos","a_data"],["u_matrix","u_linewidth","u_color","u_ratio","u_blur","u_extra","u_antialiasingmatrix"]),this.linepatternShader=t.initializeShader("linepattern",["a_pos","a_data"],["u_matrix","u_linewidth","u_ratio","u_pattern_size_a","u_pattern_size_b","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_blur","u_fade","u_opacity","u_extra","u_antialiasingmatrix"]),
this.linesdfpatternShader=t.initializeShader("linesdfpattern",["a_pos","a_data"],["u_matrix","u_linewidth","u_color","u_ratio","u_blur","u_patternscale_a","u_tex_y_a","u_patternscale_b","u_tex_y_b","u_image","u_sdfgamma","u_mix","u_extra","u_antialiasingmatrix"]),this.dotShader=t.initializeShader("dot",["a_pos"],["u_matrix","u_size","u_color","u_blur"]),this.sdfShader=t.initializeShader("sdf",["a_pos","a_offset","a_data1","a_data2"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_color","u_gamma","u_buffer","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_skewed","u_extra"]),this.iconShader=t.initializeShader("icon",["a_pos","a_offset","a_data1","a_data2"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_opacity","u_skewed","u_extra"]),this.outlineShader=t.initializeShader("outline",["a_pos"],["u_matrix","u_color","u_world"]),this.patternShader=t.initializeShader("pattern",["a_pos"],["u_matrix","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_mix","u_patternmatrix_a","u_patternmatrix_b","u_opacity","u_image"]),this.fillShader=t.initializeShader("fill",["a_pos"],["u_matrix","u_color"]),this.collisionBoxShader=t.initializeShader("collisionbox",["a_pos","a_extrude","a_data"],["u_matrix","u_scale","u_zoom","u_maxzoom"]),this.identityMatrix=s.create(),this.backgroundBuffer=t.createBuffer(),this.backgroundBuffer.itemSize=2,this.backgroundBuffer.itemCount=4,t.bindBuffer(t.ARRAY_BUFFER,this.backgroundBuffer),t.bufferData(t.ARRAY_BUFFER,new Int16Array([-1,-1,1,-1,-1,1,1,1]),t.STATIC_DRAW),this.setExtent(4096),this.debugTextBuffer=t.createBuffer(),this.debugTextBuffer.itemSize=2},n.prototype.setExtent=function(t){if(t&&t!==this.tileExtent){this.tileExtent=t;var e=this.gl;this.tileExtentBuffer=e.createBuffer(),this.tileExtentBuffer.itemSize=4,this.tileExtentBuffer.itemCount=4,e.bindBuffer(e.ARRAY_BUFFER,this.tileExtentBuffer),e.bufferData(e.ARRAY_BUFFER,new Int16Array([0,0,0,0,this.tileExtent,0,32767,0,0,this.tileExtent,0,32767,this.tileExtent,this.tileExtent,32767,32767]),e.STATIC_DRAW),this.debugBuffer=e.createBuffer(),this.debugBuffer.itemSize=2,this.debugBuffer.itemCount=5,e.bindBuffer(e.ARRAY_BUFFER,this.debugBuffer),e.bufferData(e.ARRAY_BUFFER,new Int16Array([0,0,this.tileExtent-1,0,this.tileExtent-1,this.tileExtent-1,0,this.tileExtent-1,0,0]),e.STATIC_DRAW)}},n.prototype.clearColor=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},n.prototype.clearStencil=function(){var t=this.gl;t.clearStencil(0),t.stencilMask(255),t.clear(t.STENCIL_BUFFER_BIT)},n.prototype.drawClippingMask=function(t){var e=this.gl;e.switchShader(this.fillShader,t.posMatrix),e.colorMask(!1,!1,!1,!1),e.clearStencil(0),e.stencilMask(191),e.clear(e.STENCIL_BUFFER_BIT),e.stencilFunc(e.EQUAL,192,64),e.stencilMask(192),e.stencilOp(e.REPLACE,e.KEEP,e.KEEP),e.bindBuffer(e.ARRAY_BUFFER,this.tileExtentBuffer),e.vertexAttribPointer(this.fillShader.a_pos,this.tileExtentBuffer.itemSize,e.SHORT,!1,8,0),e.drawArrays(e.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount),e.stencilFunc(e.EQUAL,128,128),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilMask(0),e.colorMask(!0,!0,!0,!0)},n.prototype.prepareBuffers=function(){},n.prototype.bindDefaultFramebuffer=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)};var u={symbol:t("./draw_symbol"),circle:t("./draw_circle"),line:t("./draw_line"),fill:t("./draw_fill"),raster:t("./draw_raster"),background:t("./draw_background"),debug:t("./draw_debug"),vertices:t("./draw_vertices")};n.prototype.render=function(t,e){this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.spriteAtlas=t.spriteAtlas,this.spriteAtlas.setSprite(t.sprite),this.glyphAtlas=t.glyphAtlas,this.glyphAtlas.bind(this.gl),this.frameHistory.record(this.transform.zoom),this.prepareBuffers(),this.clearColor();for(var i=t._groups.length-1;i>=0;i--){var n=t._groups[i],r=t.sources[n.source];r?(this.clearStencil(),r.render(n,this)):void 0===n.source&&this.drawLayers(n,this.identityMatrix)}},n.prototype.drawTile=function(t,e){this.setExtent(t.tileExtent),this.drawClippingMask(t),this.drawLayers(e,t.posMatrix,t),this.options.debug&&u.debug(this,t)},n.prototype.drawLayers=function(t,e,i){for(var n=t.length-1;n>=0;n--){var r=t[n];r.hidden||(u[r.type](this,r,e,i),this.options.vertices&&u.vertices(this,r,e,i))}},n.prototype.drawStencilBuffer=function(){var t=this.gl;t.switchShader(this.fillShader,this.identityMatrix),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.stencilMask(0),t.stencilFunc(t.EQUAL,128,128),t.bindBuffer(t.ARRAY_BUFFER,this.backgroundBuffer),t.vertexAttribPointer(this.fillShader.a_pos,this.backgroundBuffer.itemSize,t.SHORT,!1,0,0),t.uniform4fv(this.fillShader.u_color,[0,0,0,.5]),t.drawArrays(t.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount),t.blendFunc(t.ONE_MINUS_DST_ALPHA,t.ONE)},n.prototype.translateMatrix=function(t,e,i,n){if(!i[0]&&!i[1])return t;if("viewport"===n){var r=Math.sin(-this.transform.angle),o=Math.cos(-this.transform.angle);i=[i[0]*o-i[1]*r,i[0]*r+i[1]*o]}var a=this.transform.scale/(1<<e.coord.z)/(e.tileExtent/e.tileSize),u=[i[0]/a,i[1]/a,0],l=new Float32Array(16);return s.translate(l,t,u),l},n.prototype.saveTexture=function(t){var e=this.reusableTextures[t.size];e?e.push(t):this.reusableTextures[t.size]=[t]},n.prototype.getTexture=function(t){var e=this.reusableTextures[t];return e&&e.length>0?e.pop():null}},{"../util/browser":95,"./draw_background":25,"./draw_circle":26,"./draw_debug":28,"./draw_fill":29,"./draw_line":30,"./draw_raster":31,"./draw_symbol":32,"./draw_vertices":33,"./frame_history":34,"./gl_util":35,"gl-matrix":116}],38:[function(t,e,i){e.exports={debug:{vertex:"precision mediump float;attribute vec2 a_pos;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*vec4(a_pos,step(32767.,a_pos.x),1);}",fragment:"precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}"},dot:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform float u_size;attribute vec2 a_pos;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);gl_PointSize=u_size;}",fragment:"precision mediump float;uniform vec4 u_color;uniform float u_blur;void main(){float a,b;a=length(gl_PointCoord-.5);b=smoothstep(.5,.5-u_blur,a);gl_FragColor=u_color*b;}"},fill:{vertex:"precision mediump float;attribute vec2 a_pos;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);}",fragment:"precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}"},circle:{vertex:"precision mediump float;uniform float u_size;attribute vec2 a_pos;uniform mat4 u_matrix,u_exmatrix;varying vec2 a;void main(){a=vec2(mod(a_pos,2.)*2.-1.);vec4 b=u_exmatrix*vec4(a*u_size,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5),0,1);gl_Position+=b*gl_Position.w;}",fragment:"precision mediump float;uniform vec4 u_color;uniform float u_blur,u_size;varying vec2 a;void main(){float b=smoothstep(1.-u_blur,1.,length(a));gl_FragColor=u_color*(1.-b);}"},line:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform float u_ratio,u_extra;uniform vec2 u_linewidth;uniform mat2 u_antialiasingmatrix;varying vec2 a;varying float b,c;void main(){vec2 d,e;d=a_data.xy;e=mod(a_pos,2.);e.y=sign(e.y-.5);a=e;vec4 f=vec4(u_linewidth.s*d*.015873016,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5)+f.xy/u_ratio,0,1);float g,h,i;g=gl_Position.y/gl_Position.w;h=length(d)/length(u_antialiasingmatrix*d);i=1./(1.-min(g*u_extra,.9));c=i*h;}",fragment:"precision mediump float;uniform vec2 u_linewidth;uniform vec4 u_color;uniform float u_blur;varying vec2 a;varying float b,c;void main(){float d,e,f;d=length(a)*u_linewidth.s;e=u_blur*c;f=clamp(min(d-(u_linewidth.t-e),u_linewidth.s-d)/e,0.,1.);gl_FragColor=u_color*f;}"},linepattern:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform float u_ratio,u_extra;uniform vec2 u_linewidth;uniform vec4 u_color;uniform mat2 u_antialiasingmatrix;varying vec2 a;varying float b,c;void main(){vec2 d,f,g,h;d=a_data.xy;float e,i,j,k;e=a_data.z*128.+a_data.w;f=mod(a_pos,2.);f.y=sign(f.y-.5);a=f;g=d*.015873016;h=u_linewidth.s*g;gl_Position=u_matrix*vec4(floor(a_pos*.5)+h.xy/u_ratio,0,1);b=e;i=gl_Position.y/gl_Position.w;j=length(d)/length(u_antialiasingmatrix*d);k=1./(1.-min(i*u_extra,.9));c=k*j;}",fragment:"precision mediump float;uniform vec2 u_linewidth,u_pattern_size_a,u_pattern_size_b,u_pattern_tl_a,u_pattern_br_a,u_pattern_tl_b,u_pattern_br_b;uniform float u_point,u_blur,u_fade,u_opacity;uniform sampler2D u_image;varying vec2 a;varying float b,c;void main(){float d,e,f,g,h,i,j;d=length(a)*u_linewidth.s;e=u_blur*c;f=clamp(min(d-(u_linewidth.t-e),u_linewidth.s-d)/e,0.,1.);g=mod(b/u_pattern_size_a.x,1.);h=mod(b/u_pattern_size_b.x,1.);i=.5+a.y*u_linewidth.s/u_pattern_size_a.y;j=.5+a.y*u_linewidth.s/u_pattern_size_b.y;vec2 k,l;k=mix(u_pattern_tl_a,u_pattern_br_a,vec2(g,i));l=mix(u_pattern_tl_b,u_pattern_br_b,vec2(h,j));vec4 m=mix(texture2D(u_image,k),texture2D(u_image,l),u_fade);f*=u_opacity;gl_FragColor=m*f;}"},linesdfpattern:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform vec2 u_linewidth,u_patternscale_a,u_patternscale_b;uniform float u_ratio,u_tex_y_a,u_tex_y_b,u_extra;uniform mat2 u_antialiasingmatrix;varying vec2 a,b,c;varying float d;void main(){vec2 e,g;e=a_data.xy;float f,i,j,k;f=a_data.z*128.+a_data.w;g=mod(a_pos,2.);g.y=sign(g.y-.5);a=g;vec4 h=vec4(u_linewidth.s*e*.015873016,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5)+h.xy/u_ratio,0,1);b=vec2(f*u_patternscale_a.x,g.y*u_patternscale_a.y+u_tex_y_a);c=vec2(f*u_patternscale_b.x,g.y*u_patternscale_b.y+u_tex_y_b);i=gl_Position.y/gl_Position.w;j=length(e)/length(u_antialiasingmatrix*e);k=1./(1.-min(i*u_extra,.9));d=k*j;}",fragment:"precision mediump float;uniform vec2 u_linewidth;uniform vec4 u_color;uniform float u_blur,u_sdfgamma,u_mix;uniform sampler2D u_image;varying vec2 a,b,c;varying float d;void main(){float e,f,g,h,i,j;e=length(a)*u_linewidth.s;f=u_blur*d;g=clamp(min(e-(u_linewidth.t-f),u_linewidth.s-e)/f,0.,1.);h=texture2D(u_image,b).a;i=texture2D(u_image,c).a;j=mix(h,i,u_mix);g*=smoothstep(.5-u_sdfgamma,.5+u_sdfgamma,j);gl_FragColor=u_color*g;}"},outline:{vertex:"precision mediump float;attribute vec2 a_pos;uniform highp mat4 u_matrix;uniform vec2 u_world;varying vec2 a;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(gl_Position.xy/gl_Position.w+1.)/2.*u_world;}",fragment:"precision mediump float;uniform vec4 u_color;varying vec2 a;void main(){float b,c;b=length(a-gl_FragCoord.xy);c=smoothstep(1.,0.,b);gl_FragColor=u_color*c;}"},pattern:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform mat3 u_patternmatrix_a,u_patternmatrix_b;attribute vec2 a_pos;varying vec2 a,b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(u_patternmatrix_a*vec3(a_pos,1)).xy;b=(u_patternmatrix_b*vec3(a_pos,1)).xy;}",fragment:"precision mediump float;uniform float u_opacity,u_mix;uniform vec2 u_pattern_tl_a,u_pattern_br_a,u_pattern_tl_b,u_pattern_br_b;uniform sampler2D u_image;varying vec2 a,b;void main(){vec2 c,d,f,g;c=mod(a,1.);d=mix(u_pattern_tl_a,u_pattern_br_a,c);vec4 e,h;e=texture2D(u_image,d);f=mod(b,1.);g=mix(u_pattern_tl_b,u_pattern_br_b,f);h=texture2D(u_image,g);gl_FragColor=mix(e,h,u_mix)*u_opacity;}"},raster:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent,u_buffer_scale;attribute vec2 a_pos,a_texture_pos;varying vec2 a,b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(a_texture_pos/32767.-.5)/u_buffer_scale+.5;b=a*u_scale_parent+u_tl_parent;}",fragment:"precision mediump float;uniform float u_opacity0,u_opacity1,u_brightness_low,u_brightness_high,u_saturation_factor,u_contrast_factor;uniform sampler2D u_image0,u_image1;varying vec2 a,b;uniform vec3 u_spin_weights;void main(){vec4 c,d,e;c=texture2D(u_image0,a);d=texture2D(u_image1,b);e=c*u_opacity0+d*u_opacity1;vec3 f,h,i;f=e.rgb;f=vec3(dot(f,u_spin_weights.xyz),dot(f,u_spin_weights.zxy),dot(f,u_spin_weights.yzx));float g=(e.r+e.g+e.b)/3.;f+=(g-f)*u_saturation_factor;f=(f-.5)*u_contrast_factor+.5;h=vec3(u_brightness_low);i=vec3(u_brightness_high);gl_FragColor=vec4(mix(h,i,f),e.a);}"},icon:{vertex:"precision mediump float;attribute vec2 a_pos,a_offset;attribute vec4 a_data1,a_data2;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_zoom,u_fadedist,u_minfadezoom,u_maxfadezoom,u_fadezoom,u_opacity,u_extra;uniform bool u_skewed;uniform vec2 u_texsize;varying vec2 a;varying float b;void main(){vec2 c,e;c=a_data1.xy;float d,f,g,h,i,j;d=a_data1[2];e=a_data2.st;f=e[0];g=e[1];h=10.;i=2.-step(f,u_zoom)-(1.-step(g,u_zoom));j=clamp((u_fadezoom-d)/u_fadedist,0.,1.);if(u_fadedist>=0.)b=j;else b=1.-j;if(u_maxfadezoom<d)b=0.;if(u_minfadezoom>=d)b=1.;i+=step(b,0.);if(u_skewed){vec4 k=u_exmatrix*vec4(a_offset/64.,0,0);gl_Position=u_matrix*vec4(a_pos+k.xy,0,1);gl_Position.z+=i*gl_Position.w;}else{vec4 k=u_exmatrix*vec4(a_offset/64.,i,0);gl_Position=u_matrix*vec4(a_pos,0,1)+k;}a=c/u_texsize;b*=u_opacity;}",fragment:"precision mediump float;uniform sampler2D u_texture;varying vec2 a;varying float b;void main(){gl_FragColor=texture2D(u_texture,a)*b;}"},sdf:{vertex:"precision mediump float;attribute vec2 a_pos,a_offset;attribute vec4 a_data1,a_data2;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_zoom,u_fadedist,u_minfadezoom,u_maxfadezoom,u_fadezoom,u_extra;uniform bool u_skewed;uniform vec2 u_texsize;varying vec2 a;varying float b,c;void main(){vec2 d,f;d=a_data1.xy;float e,g,h,i,j,k,l;e=a_data1[2];f=a_data2.st;g=f[0];h=f[1];i=2.-step(g,u_zoom)-(1.-step(h,u_zoom));j=clamp((u_fadezoom-e)/u_fadedist,0.,1.);if(u_fadedist>=0.)b=j;else b=1.-j;if(u_maxfadezoom<e)b=0.;if(u_minfadezoom>=e)b=1.;i+=step(b,0.);if(u_skewed){vec4 k=u_exmatrix*vec4(a_offset/64.,0,0);gl_Position=u_matrix*vec4(a_pos+k.xy,0,1);gl_Position.z+=i*gl_Position.w;}else{vec4 k=u_exmatrix*vec4(a_offset/64.,i,0);gl_Position=u_matrix*vec4(a_pos,0,1)+k;}k=gl_Position.y/gl_Position.w;l=1./(1.-k*u_extra);c=l;a=d/u_texsize;}",fragment:"precision mediump float;uniform sampler2D u_texture;uniform vec4 u_color;uniform float u_buffer,u_gamma;varying vec2 a;varying float b,c;void main(){float d,e,f;d=u_gamma*c;e=texture2D(u_texture,a).a;f=smoothstep(u_buffer-d,u_buffer+d,e)*b;gl_FragColor=u_color*f;}"},collisionbox:{vertex:"precision mediump float;attribute vec2 a_pos,a_extrude,a_data;uniform mat4 u_matrix;uniform float u_scale;varying float a,b;void main(){gl_Position=u_matrix*vec4(a_pos+a_extrude/u_scale,0,1);a=a_data.x;b=a_data.y;}",fragment:"precision mediump float;uniform float u_zoom,u_maxzoom;varying float a,b;void main(){float c=.5;gl_FragColor=vec4(0,1,0,1)*c;if(b>u_zoom)gl_FragColor=vec4(1,0,0,1)*c;if(u_zoom>=a)gl_FragColor=vec4(0,0,0,1)*c*.25;if(b>=u_maxzoom)gl_FragColor=vec4(0,0,1,1)*c*.2;}"}}},{}],39:[function(t,e,i){function n(t){t=t||{},this._data=t.data,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom),this.geojsonVtOptions={maxZoom:this.maxzoom},void 0!==t.buffer&&(this.geojsonVtOptions.buffer=t.buffer),void 0!==t.tolerance&&(this.geojsonVtOptions.tolerance=t.tolerance),this._pyramid=new s({tileSize:512,minzoom:this.minzoom,maxzoom:this.maxzoom,cacheSize:20,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this)})}var r=t("../util/util"),o=t("../util/evented"),s=t("./tile_pyramid"),a=t("./source"),u=t("resolve-url");e.exports=n,n.prototype=r.inherit(o,{minzoom:0,maxzoom:14,_dirty:!0,setData:function(t){return this._data=t,this._dirty=!0,this.fire("change"),this.map&&this.update(this.map.transform),this},onAdd:function(t){this.map=t},loaded:function(){return this._loaded&&this._pyramid.loaded()},update:function(t){this._dirty&&this._updateData(),this._loaded&&this._pyramid.update(this.used,t)},reload:function(){this._loaded&&this._pyramid.reload()},render:a._renderTiles,featuresAt:a._vectorFeaturesAt,featuresIn:a._vectorFeaturesIn,_updateData:function(){this._dirty=!1;var t=this._data;"string"==typeof t&&(t=u(window.location.href,t)),this.workerID=this.dispatcher.send("parse geojson",{data:t,tileSize:512,source:this.id,geojsonVtOptions:this.geojsonVtOptions},function(t){return t?void this.fire("error",{error:t}):(this._loaded=!0,this._pyramid.reload(),void this.fire("change"))}.bind(this))},_loadTile:function(t){var e=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,i={uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:512,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug};t.workerID=this.dispatcher.send("load geojson tile",i,function(e,i){if(t.unloadVectorData(this.map.painter),!t.aborted){if(e)return void this.fire("tile.error",{tile:t});t.loadVectorData(i),this.fire("tile.load",{tile:t})}}.bind(this),this.workerID)},_abortTile:function(t){t.aborted=!0},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.unloadVectorData(this.map.painter),this.glyphAtlas.removeGlyphs(t.uid),this.dispatcher.send("remove tile",{uid:t.uid,source:this.id},null,t.workerID)}})},{"../util/evented":100,"../util/util":106,"./source":43,"./tile_pyramid":46,"resolve-url":140}],40:[function(t,e,i){function n(t){this.features=t,this.length=t.length}function r(t){this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=4096}var o=t("point-geometry"),s=t("vector-tile").VectorTileFeature;e.exports=n,n.prototype.feature=function(t){return new r(this.features[t])},r.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var i=t[e],n=[],r=0;r<i.length;r++)n.push(new o(i[r][0],i[r][1]));this.geometry.push(n)}return this.geometry},r.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,i=-1/0,n=1/0,r=-1/0,o=0;o<t.length;o++)for(var s=t[o],a=0;a<s.length;a++){var u=s[a];e=Math.min(e,u.x),i=Math.max(i,u.x),n=Math.min(n,u.y),r=Math.max(r,u.y)}return[e,n,i,r]},r.prototype.toGeoJSON=s.prototype.toGeoJSON},{"point-geometry":137,"vector-tile":144}],41:[function(t,e,i){function n(t){this.coordinates=t.coordinates,l.getImage(t.url,function(t,e){t||(this.image=e,this.image.addEventListener("load",function(){this.map._rerender()}.bind(this)),this._loaded=!0,this.map&&(this.createTile(),this.fire("change")))}.bind(this))}var r=t("../util/util"),o=t("./tile"),s=t("../geo/lng_lat"),a=t("point-geometry"),u=t("../util/evented"),l=t("../util/ajax");e.exports=n,n.prototype=r.inherit(u,{onAdd:function(t){this.map=t,this.image&&this.createTile()},createTile:function(){var t=this.map,e=this.coordinates.map(function(e){var i=s.convert(e);return t.transform.locationCoordinate(i).zoomTo(0)}),i=r.getCoordinatesCenter(e),n=e.map(function(t){var e=t.zoomTo(i.zoom);return new a(Math.round(4096*(e.column-i.column)),Math.round(4096*(e.row-i.row)))}),u=t.painter.gl,l=32767,c=new Int16Array([n[0].x,n[0].y,0,0,n[1].x,n[1].y,l,0,n[3].x,n[3].y,0,l,n[2].x,n[2].y,l,l]);this.tile=new o,this.tile.buckets={},this.tile.boundsBuffer=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,this.tile.boundsBuffer),u.bufferData(u.ARRAY_BUFFER,c,u.STATIC_DRAW),this.center=i},loaded:function(){return this.image&&this.image.complete},update:function(){},reload:function(){},render:function(t,e){if(this._loaded&&this.loaded()){var i=this.center;this.tile.calculateMatrices(i.zoom,i.column,i.row,this.map.transform,e);var n=e.gl;this.tile.texture?(n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.image)):(this.tile.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.image)),e.drawLayers(t,this.tile.posMatrix,this.tile)}},featuresAt:function(t,e,i){return i(null,[])}})},{"../geo/lng_lat":20,"../util/ajax":94,"../util/evented":100,"../util/util":106,"./tile":44,"point-geometry":137}],42:[function(t,e,i){function n(t){r.extend(this,r.pick(t,["url","tileSize"])),a._loadTileJSON.call(this,t)}var r=t("../util/util"),o=t("../util/ajax"),s=t("../util/evented"),a=t("./source"),u=t("../util/mapbox").normalizeTileURL;e.exports=n,n.prototype=r.inherit(s,{minzoom:0,maxzoom:22,roundZoom:!0,tileSize:512,_loaded:!1,onAdd:function(t){this.map=t},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(t){this._pyramid&&this._pyramid.update(this.used,t,this.map.style.rasterFadeDuration)},reload:function(){},render:a._renderTiles,_loadTile:function(t){function e(e,i){if(delete t.request,!t.aborted){if(e)return void this.fire("tile.error",{tile:t});var n=this.map.painter.gl;t.texture=this.map.painter.getTexture(i.width),t.texture?(n.bindTexture(n.TEXTURE_2D,t.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,i)):(t.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,t.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i),t.texture.size=i.width),n.generateMipmap(n.TEXTURE_2D),t.timeAdded=(new Date).getTime(),this.map.animationLoop.set(this.style.rasterFadeDuration),t.source=this,t.loaded=!0,this.fire("tile.load",{tile:t})}}var i=u(t.coord.url(this.tiles),this.url);t.request=o.getImage(i,e.bind(this))},_abortTile:function(t){t.aborted=!0,t.request&&(t.request.abort(),delete t.request)},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.texture&&this.map.painter.saveTexture(t.texture)},featuresAt:function(t,e,i){i(null,[])},featuresIn:function(t,e,i){i(null,[])}})},{"../util/ajax":94,"../util/evented":100,"../util/mapbox":103,"../util/util":106,"./source":43}],43:[function(t,e,i){var n=t("../util/util"),r=t("../util/ajax"),o=t("../util/browser"),s=t("./tile_pyramid"),a=t("./tile_coord"),u=t("../util/mapbox").normalizeSourceURL;i._loadTileJSON=function(t){var e=function(t){this._pyramid=new s({index:t,tileSize:this.tileSize,cacheSize:20,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom,reparseOverscaled:this.reparseOverscaled,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this),redoPlacement:this._redoTilePlacement?this._redoTilePlacement.bind(this):void 0})}.bind(this),i=function(t,i){return t?void this.fire("error",{error:t}):(n.extend(this,n.pick(i,["tiles","minzoom","maxzoom","attribution"])),void(i.index?r.getJSON(u(i.index),function(t,i){return t?void this.fire("error",{error:t}):(e(i.index),void this.fire("load"))}.bind(this)):(e(),this.fire("load"))))}.bind(this);t.url?r.getJSON(u(t.url),i):o.frame(i.bind(this,null,t))},i._renderTiles=function(t,e){if(this._pyramid)for(var i=this._pyramid.renderedIDs(),n=0;n<i.length;n++){var r=this._pyramid.getTile(i[n]),o=a.fromID(i[n]),s=o.z,u=o.x,l=o.y,c=o.w;s=Math.min(s,this.maxzoom),(r.tileExtent>4096||r.parentId)&&(r.tileExtent=4096),u+=c*(1<<s),r.calculateMatrices(s,u,l,e.transform,e),e.drawTile(r,t)}},i._vectorFeaturesAt=function(t,e,i){if(!this._pyramid)return i(null,[]);var n=this._pyramid.tileAt(t);return n?void this.dispatcher.send("query features",{uid:n.tile.uid,x:n.x,y:n.y,tileExtent:n.tile.tileExtent,scale:n.scale,source:this.id,params:e},i,n.tile.workerID):i(null,[])},i._vectorFeaturesIn=function(t,e,i){if(!this._pyramid)return i(null,[]);var r=this._pyramid.tilesIn(t);return r?void n.asyncAll(r,function(t,i){this.dispatcher.send("query features",{uid:t.tile.uid,source:this.id,minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY,params:e},i,t.tile.workerID)}.bind(this),function(t,e){i(t,Array.prototype.concat.apply([],e))}):i(null,[])},i.create=function(e){var i={vector:t("./vector_tile_source"),raster:t("./raster_tile_source"),geojson:t("./geojson_source"),video:t("./video_source"),image:t("./image_source")};for(var n in i)if(e instanceof i[n])return e;return new i[e.type](e)}},{"../util/ajax":94,"../util/browser":95,"../util/mapbox":103,"../util/util":106,"./geojson_source":39,"./image_source":41,"./raster_tile_source":42,"./tile_coord":45,"./tile_pyramid":46,"./vector_tile_source":47,"./video_source":48}],44:[function(t,e,i){function n(t,e){this.coord=t,this.uid=a.uniqueId(),this.loaded=!1,this.uses=0,this.tileSize=e}var r=t("gl-matrix"),o=r.mat2,s=r.mat4,a=t("../util/util"),u=t("../data/buffer/buffer_set");e.exports=n,n.prototype={tileExtent:4096,calculateMatrices:function(t,e,i,n){var r=Math.pow(2,t),a=n.worldSize/r;this.scale=a,this.posMatrix=new Float64Array(16),s.identity(this.posMatrix),s.translate(this.posMatrix,this.posMatrix,[e*a,i*a,0]),s.scale(this.posMatrix,this.posMatrix,[a/this.tileExtent,a/this.tileExtent,1]),s.multiply(this.posMatrix,n.getProjMatrix(),this.posMatrix),this.exMatrix=s.create(),s.ortho(this.exMatrix,0,n.width,n.height,0,0,-1),this.rotationMatrix=o.create(),o.rotate(this.rotationMatrix,this.rotationMatrix,n.angle),this.posMatrix=new Float32Array(this.posMatrix)},positionAt:function(t,e){return t=t.zoomTo(Math.min(this.coord.z,e)),{x:(t.column-this.coord.x)*this.tileExtent,y:(t.row-this.coord.y)*this.tileExtent,scale:this.scale}},loadVectorData:function(t){this.loaded=!0,t&&(this.buffers=new u(t.buffers),this.elementGroups=t.elementGroups,this.tileExtent=t.extent)},reloadSymbolData:function(t,e){if(this.buffers){this.buffers.glyphVertex.destroy(e.gl),this.buffers.glyphElement.destroy(e.gl),this.buffers.iconVertex.destroy(e.gl),this.buffers.iconElement.destroy(e.gl),this.buffers.collisionBoxVertex.destroy(e.gl);var i=new u(t.buffers);this.buffers.glyphVertex=i.glyphVertex,this.buffers.glyphElement=i.glyphElement,this.buffers.iconVertex=i.iconVertex,this.buffers.iconElement=i.iconElement,this.buffers.collisionBoxVertex=i.collisionBoxVertex;for(var n in t.elementGroups)this.elementGroups[n]=t.elementGroups[n]}},unloadVectorData:function(t){for(var e in this.buffers)this.buffers[e].destroy(t.gl);this.buffers=null}}},{"../data/buffer/buffer_set":2,"../util/util":106,"gl-matrix":116}],45:[function(t,e,i){function n(t,e,i,n){isNaN(n)&&(n=0),this.z=+t,this.x=+e,this.y=+i,this.w=+n,0>(n*=2)&&(n=-1*n-1);var r=1<<this.z;this.id=32*(r*r*n+r*this.y+this.x)+this.z}function r(t,e){if(t.row>e.row){var i=t;t=e,e=i}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function o(t,e,i,n,r){var o=Math.max(i,Math.floor(e.y0)),s=Math.min(n,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var a=t;t=e,e=a}for(var u=t.dx/t.dy,l=e.dx/e.dy,c=t.dx>0,h=e.dx<0,f=o;s>f;f++){var d=u*Math.max(0,Math.min(t.dy,f+c-t.y0))+t.x0,p=l*Math.max(0,Math.min(e.dy,f+h-e.y0))+e.x0;r(Math.floor(p),Math.ceil(d),f)}}function s(t,e,i,n,s,a){var u,l=r(t,e),c=r(e,i),h=r(i,t);l.dy>c.dy&&(u=l,l=c,c=u),l.dy>h.dy&&(u=l,l=h,h=u),c.dy>h.dy&&(u=c,c=h,h=u),l.dy&&o(h,l,n,s,a),c.dy&&o(h,c,n,s,a)}e.exports=n,n.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},n.fromID=function(t){var e=t%32,i=1<<e,r=(t-e)/32,o=r%i,s=(r-o)/i%i,a=Math.floor(r/(i*i));return a%2!=0&&(a=-1*a-1),a/=2,new n(e,o,s,a)},n.prototype.url=function(t,e){return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",Math.min(this.z,e||this.z)).replace("{x}",this.x).replace("{y}",this.y)},n.prototype.parent=function(t){return 0===this.z?null:this.z>t?new n(this.z-1,this.x,this.y,this.w):new n(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)},n.prototype.wrapped=function(){return new n(this.z,this.x,this.y,0)},n.prototype.children=function(t){if(this.z>=t)return[new n(this.z+1,this.x,this.y,this.w)];var e=this.z+1,i=2*this.x,r=2*this.y;return[new n(e,i,r,this.w),new n(e,i+1,r,this.w),new n(e,i,r+1,this.w),new n(e,i+1,r+1,this.w)]},n.cover=function(t,e,i){function r(t,e,r){var s,u,l;if(r>=0&&o>=r)for(s=t;e>s;s++)u=(s%o+o)%o,l=new n(i,u,r,Math.floor(s/o)),a[l.id]=l}var o=1<<t,a={};return s(e[0],e[1],e[2],0,o,r),s(e[2],e[3],e[0],0,o,r),Object.keys(a).map(function(t){return a[t]})}},{}],46:[function(t,e,i){function n(t){this.tileSize=t.tileSize,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.roundZoom=t.roundZoom,this.reparseOverscaled=t.reparseOverscaled,this.index=t.index,this._load=t.load,this._abort=t.abort,this._unload=t.unload,this._add=t.add,this._remove=t.remove,this._redoPlacement=t.redoPlacement,this._tiles={},this._cache=new a(t.cacheSize,function(t){return this._unload(t)}.bind(this))}var r=t("./tile"),o=t("./tile_coord"),s=t("point-geometry"),a=t("../util/mru_cache"),u=t("../util/util");e.exports=n,n.prototype={loaded:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0},orderedIDs:function(){return Object.keys(this._tiles).sort(function(t,e){return e%32-t%32}).map(function(t){return+t})},renderedIDs:function(){return this.orderedIDs().filter(function(t){return this._tiles[t].loaded&&!this._coveredTiles[t]}.bind(this))},reload:function(){this._cache.reset();for(var t in this._tiles)this._load(this._tiles[t])},getTile:function(t){return this._tiles[t]},getZoom:function(t){return t.zoom+Math.log(t.tileSize/this.tileSize)/Math.LN2},coveringZoomLevel:function(t){return(this.roundZoom?Math.round:Math.floor)(this.getZoom(t))},coveringTiles:function(t){var e=this.coveringZoomLevel(t),i=e;if(e<this.minzoom)return[];e>this.maxzoom&&(e=this.maxzoom);var n=t,r=n.locationCoordinate(n.center)._zoomTo(e),a=new s(r.column-.5,r.row-.5);return o.cover(e,[n.pointCoordinate(new s(0,0))._zoomTo(e),n.pointCoordinate(new s(n.width,0))._zoomTo(e),n.pointCoordinate(new s(n.width,n.height))._zoomTo(e),n.pointCoordinate(new s(0,n.height))._zoomTo(e)],this.reparseOverscaled?i:e).sort(function(t,e){return a.dist(t)-a.dist(e)})},findLoadedChildren:function(t,e,i){for(var n=!0,r=t.z,o=t.children(this.maxzoom),s=0;s<o.length;s++){var a=o[s].id;this._tiles[a]&&this._tiles[a].loaded?i[a]=!0:(n=!1,e>r&&this.findLoadedChildren(o[s],e,i))}return n},findLoadedParent:function(t,e,i){for(var n=t.z-1;n>=e;n--){t=t.parent(this.maxzoom);var r=this._tiles[t.id];if(r&&r.loaded)return i[t.id]=!0,r}},update:function(t,e,i){var n,r,s,a=(this.roundZoom?Math.round:Math.floor)(this.getZoom(e)),l=u.clamp(a-10,this.minzoom,this.maxzoom),c=u.clamp(a+1,this.minzoom,this.maxzoom),h={},f=(new Date).getTime();this._coveredTiles={};var d=t?this.coveringTiles(e):[];for(n=0;n<d.length;n++)r=d[n],s=this.addTile(r),h[r.id]=!0,s.loaded||this.findLoadedChildren(r,c,h)||this.findLoadedParent(r,l,h);for(var p in h)r=o.fromID(p),(s=this._tiles[p])&&s.timeAdded>f-(i||0)&&(this.findLoadedChildren(r,c,h)?(this._coveredTiles[p]=!0,h[p]=!0):this.findLoadedParent(r,l,h));var m=u.keysDifference(this._tiles,h);for(n=0;n<m.length;n++)this.removeTile(+m[n])},addTile:function(t){var e=this._tiles[t.id];if(e)return e;var i=t.wrapped();if(e=this._tiles[i.id],e||(e=this._cache.get(i.id))&&this._redoPlacement&&this._redoPlacement(e),!e){var n=t.z,o=n>this.maxzoom?Math.pow(2,n-this.maxzoom):1;e=new r(i,this.tileSize*o),this.index&&(e.parentId=this.indexSearch(t.id)),this._load(e)}return e.uses++,this._tiles[t.id]=e,this._add(e,t),e},removeTile:function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._remove(e),e.uses>0||(e.loaded?this._cache.add(e.coord.wrapped().id,e):(this._abort(e),this._unload(e))))},
clearTiles:function(){for(var t in this._tiles)this.removeTile(t);this._cache.reset()},tileAt:function(t){for(var e=this.orderedIDs(),i=0;i<e.length;i++){var n=this._tiles[e[i]],r=n.positionAt(t,this.maxzoom);if(r&&r.x>=0&&r.x<n.tileExtent&&r.y>=0&&r.y<n.tileExtent)return{tile:n,x:r.x,y:r.y,scale:r.scale}}},tilesIn:function(t){for(var e=[],i=this.orderedIDs(),n=0;n<i.length;n++){var r=this._tiles[i[n]],o=[r.positionAt(t[0],this.maxzoom),r.positionAt(t[1],this.maxzoom)];o[0].x<r.tileExtent&&o[0].y<r.tileExtent&&o[1].x>=0&&o[1].y>=0&&e.push({tile:r,minX:o[0].x,maxX:o[1].x,minY:o[0].y,maxY:o[1].y})}return e},indexSearch:function(t){for(var e=o.fromID(t),i=[t],n=e;0!==n.z;)n=n.parent(),i.push(n.id);for(var r,s=this.index,a=i.pop(),u=function(t){return t.id};i.length;)if(t=i.pop(),e=o.fromID(a),r=e.children(this.maxzoom).map(u).indexOf(t),s){if(0===s[r]){a=t;break}if(1===s[r]){a=t;break}a=t,s=s[r]}return 0===i.length?null:a}}},{"../util/mru_cache":104,"../util/util":106,"./tile":44,"./tile_coord":45,"point-geometry":137}],47:[function(t,e,i){function n(t){if(r.extend(this,r.pick(t,["url","tileSize"])),512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");s._loadTileJSON.call(this,t)}var r=t("../util/util"),o=t("../util/evented"),s=t("./source"),a=t("./tile_coord");e.exports=n,n.prototype=r.inherit(o,{minzoom:0,maxzoom:22,tileSize:512,reparseOverscaled:!0,_loaded:!1,onAdd:function(t){this.map=t},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(t){this._pyramid&&this._pyramid.update(this.used,t)},reload:function(){this._pyramid&&this._pyramid.reload()},redoPlacement:function(){if(this._pyramid)for(var t=this._pyramid.orderedIDs(),e=0;e<t.length;e++){var i=this._pyramid.getTile(t[e]);this._redoTilePlacement(i)}},render:s._renderTiles,featuresAt:s._vectorFeaturesAt,featuresIn:s._vectorFeaturesIn,_loadTile:function(t){var e=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,i={url:t.coord.url(this.tiles,this.maxzoom),uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize*e,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug,parentId:t.parentId};t.parentId&&(i.url=a.fromID(t.parentId).url(this.tiles,this.maxzoom)),t.workerID?this.dispatcher.send("reload tile",i,this._tileLoaded.bind(this,t),t.workerID):t.workerID=this.dispatcher.send("load tile",i,this._tileLoaded.bind(this,t))},_tileLoaded:function(t,e,i){if(!t.aborted){if(e)return void this.fire("tile.error",{tile:t});t.loadVectorData(i),t.redoWhenDone&&(t.redoWhenDone=!1,this._redoTilePlacement(t)),this.fire("tile.load",{tile:t}),this.fire("tile.stats",i.bucketStats)}},_abortTile:function(t){t.aborted=!0,this.dispatcher.send("abort tile",{uid:t.uid,source:this.id},null,t.workerID)},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.unloadVectorData(this.map.painter),this.glyphAtlas.removeGlyphs(t.uid),this.dispatcher.send("remove tile",{uid:t.uid,source:this.id},null,t.workerID)},_redoTilePlacement:function(t){function e(e,i){t.reloadSymbolData(i,this.map.painter),this.fire("tile.load",{tile:t}),t.redoingPlacement=!1,t.redoWhenDone&&(this._redoTilePlacement(t),t.redoWhenDone=!1)}return!t.loaded||t.redoingPlacement?void(t.redoWhenDone=!0):(t.redoingPlacement=!0,void this.dispatcher.send("redo placement",{uid:t.uid,source:this.id,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug},e.bind(this),t.workerID))}})},{"../util/evented":100,"../util/util":106,"./source":43,"./tile_coord":45}],48:[function(t,e,i){function n(t){this.coordinates=t.coordinates,l.getVideo(t.urls,function(t,e){if(!t){this.video=e,this.video.loop=!0;var i;this.video.addEventListener("playing",function(){i=this.map.style.animationLoop.set(1/0),this.map._rerender()}.bind(this)),this.video.addEventListener("pause",function(){this.map.style.animationLoop.cancel(i)}.bind(this)),this._loaded=!0,this.map&&(this.video.play(),this.createTile(),this.fire("change"))}}.bind(this))}var r=t("../util/util"),o=t("./tile"),s=t("../geo/lng_lat"),a=t("point-geometry"),u=t("../util/evented"),l=t("../util/ajax");e.exports=n,n.prototype=r.inherit(u,{roundZoom:!0,getVideo:function(){return this.video},onAdd:function(t){this.map=t,this.video&&(this.video.play(),this.createTile())},createTile:function(){var t=this.map,e=this.coordinates.map(function(e){var i=s.convert(e);return t.transform.locationCoordinate(i).zoomTo(0)}),i=r.getCoordinatesCenter(e),n=e.map(function(t){var e=t.zoomTo(i.zoom);return new a(Math.round(4096*(e.column-i.column)),Math.round(4096*(e.row-i.row)))}),u=t.painter.gl,l=32767,c=new Int16Array([n[0].x,n[0].y,0,0,n[1].x,n[1].y,l,0,n[3].x,n[3].y,0,l,n[2].x,n[2].y,l,l]);this.tile=new o,this.tile.buckets={},this.tile.boundsBuffer=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,this.tile.boundsBuffer),u.bufferData(u.ARRAY_BUFFER,c,u.STATIC_DRAW),this.center=i},loaded:function(){return this.video&&this.video.readyState>=2},update:function(){},reload:function(){},render:function(t,e){if(this._loaded&&!(this.video.readyState<2)){var i=this.center;this.tile.calculateMatrices(i.zoom,i.column,i.row,this.map.transform,e);var n=e.gl;this.tile.texture?(n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.tile.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.video)),e.drawLayers(t,this.tile.posMatrix,this.tile)}},featuresAt:function(t,e,i){return i(null,[])},featuresIn:function(t,e,i){return i(null,[])}})},{"../geo/lng_lat":20,"../util/ajax":94,"../util/evented":100,"../util/util":106,"./tile":44,"point-geometry":137}],49:[function(t,e,i){function n(t){this.self=t,this.actor=new r(t,this),this.loading={},this.loaded={},this.layers=[],this.geoJSONIndexes={}}var r=t("../util/actor"),o=t("./worker_tile"),s=t("../util/util"),a=t("../util/ajax"),u=t("vector-tile"),l=t("pbf"),c=t("./tile_coord"),h=t("geojson-vt"),f=t("./geojson_wrapper");e.exports=function(t){return new n(t)},s.extend(n.prototype,{"set layers":function(t){this.layers=t},"load tile":function(t,e){function i(i,o){if(delete this.loading[n][r],i)return e(i);if(s.data=new u.VectorTile(new l(new Uint8Array(o))),t.parentId&&s.data.layers){var a=this.getChildPosition(t.coord.id,t.parentId);s.parse(s.data,this.layers,this.actor,e,a.dz,a.xPos,a.yPos)}else s.parse(s.data,this.layers,this.actor,e);this.loaded[n]=this.loaded[n]||{},this.loaded[n][r]=s}var n=t.source,r=t.uid;this.loading[n]||(this.loading[n]={});var s=this.loading[n][r]=new o(t);s.xhr=a.getArrayBuffer(t.url,i.bind(this))},"reload tile":function(t,e){var i=this.loaded[t.source],n=t.uid;if(i&&i[n]){var r=i[n];r.parse(r.data,this.layers,this.actor,e)}},"abort tile":function(t){var e=this.loading[t.source],i=t.uid;e&&e[i]&&(e[i].xhr.abort(),delete e[i])},"remove tile":function(t){var e=this.loaded[t.source],i=t.uid;e&&e[i]&&delete e[i]},"redo placement":function(t,e){var i=this.loaded[t.source],n=this.loading[t.source],r=t.uid;if(i&&i[r]){var o=i[r],s=o.redoPlacement(t.angle,t.pitch,t.collisionDebug);s.result&&e(null,s.result,s.transferables)}else n&&n[r]&&(n[r].angle=t.angle)},"parse geojson":function(t,e){var i=function(i,n){return i?e(i):(this.geoJSONIndexes[t.source]=h(n,t.geojsonVtOptions),void e(null))}.bind(this);"string"==typeof t.data?a.getJSON(t.data,i):i(null,t.data)},"load geojson tile":function(t,e){var i=t.source,n=t.coord,r=this.geoJSONIndexes[i].getTile(n.z,n.x,n.y);if(!r)return e(null,null);var s=new o(t);s.parse(new f(r.features),this.layers,this.actor,e),this.loaded[i]=this.loaded[i]||{},this.loaded[i][t.uid]=s},"query features":function(t,e){var i=this.loaded[t.source]&&this.loaded[t.source][t.uid];i?i.featureTree.query(t,e):e(null,[])},getChildPosition:function(t,e){var i=c.fromID(t),n=c.fromID(e),r=i.z-n.z;return{dz:r,xPos:i.x&(1<<r)-1,yPos:i.y&(1<<r)-1}}})},{"../util/actor":93,"../util/ajax":94,"../util/util":106,"./geojson_wrapper":40,"./tile_coord":45,"./worker_tile":50,"geojson-vt":111,pbf:136,"vector-tile":144}],50:[function(t,e,i){function n(t){this.coord=t.coord,this.uid=t.uid,this.zoom=t.zoom,this.maxZoom=t.maxZoom,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=t.overscaling,this.angle=t.angle,this.pitch=t.pitch,this.collisionDebug=t.collisionDebug,this.stacks={}}var r=t("../data/feature_tree"),o=t("../symbol/collision_tile"),s=t("../data/buffer/buffer_set"),a=t("../data/create_bucket");e.exports=n,n.prototype.parse=function(t,e,i,n,u,l,c){function h(t,e,i,n,r){for(var o=0;o<t.length;o++){var s=t.feature(o);s.dz=i,s.xPos=n,s.yPos=r;for(var a in e){var u=e[a];u.filter(s)&&u.features.push(s)}}}function f(t,e,i){if((!e.getDependencies||e.dependenciesLoaded)&&(!e.needsPlacement||e.previousPlaced)){if(!i){var n=Date.now();e.features.length&&e.addFeatures(b);var r=Date.now()-n;if(e.interactive)for(var o=0;o<e.features.length;o++){var s=e.features[o];t.featureTree.insert(s.bbox(),e.layers,s)}"undefined"!=typeof self&&(self.bucketStats=self.bucketStats||{_total:0},self.bucketStats._total+=r,self.bucketStats[e.id]=(self.bucketStats[e.id]||0)+r),e.features=null}return A--,A?void(e.next&&(e.next.previousPlaced=!0,f(t,e.next))):void d()}}function d(){if(v.status="done",v.redoPlacementAfterDone){var t=v.redoPlacement(v.angle,v.pitch).result;y.glyphVertex=t.buffers.glyphVertex,y.iconVertex=t.buffers.iconVertex,y.collisionBoxVertex=t.buffers.collisionBoxVertex}var e=[],i={};for(m in y)e.push(y[m].array);for(m in x)i[m]=x[m].elementGroups;n(null,{elementGroups:i,buffers:y,extent:P,bucketStats:"undefined"!=typeof self?self.bucketStats:null},e)}this.status="parsing",this.featureTree=new r(this.coord,this.overscaling);var p,m,_,g,v=this,y=new s,b=new o(this.angle,this.pitch),x={},w=this.bucketsInOrder=[],L={};for(p=0;p<e.length;p++)if(_=e[p],_.source===this.source&&!_.ref){var S=_.minzoom;if(!(S&&this.zoom<S&&S<this.maxZoom)){var T=_.maxzoom;if(!(T&&this.zoom>=T)){var M=_.layout.visibility;if("none"!==M)if(g=a(_,y,this.zoom,this.overscaling,this.collisionDebug),g.layers=[_.id],x[g.id]=g,w.push(g),t.layers){var E=_["source-layer"];L[E]||(L[E]={}),L[E][g.id]=g}else L[g.id]=g}}}for(p=0;p<e.length;p++)_=e[p],_.source===this.source&&_.ref&&(g=x[_.ref])&&g.layers.push(_.id);var P=4096;if(t.layers)for(m in L)(_=t.layers[m])&&(_.extent&&(P=_.extent),h(_,L[m],u,l,c));else h(t,L);var C,A=w.length;for(p=w.length-1;p>=0;p--)g=w[p],g.needsPlacement&&(C?C.next=g:g.previousPlaced=!0,C=g),g.getDependencies&&g.getDependencies(this,i,function(t){return function(e){t.dependenciesLoaded=!0,f(v,t,e)}}(g)),g.needsPlacement||g.getDependencies||f(v,g)},n.prototype.redoPlacement=function(t,e,i){if("done"!==this.status)return this.redoPlacementAfterDone=!0,this.angle=t,{};for(var n=new s,r=[],a={},u=new o(t,e),l=this.bucketsInOrder,c=l.length-1;c>=0;c--){var h=l[c];"symbol"===h.type&&(h.placeFeatures(u,n,i),a[h.id]=h.elementGroups)}for(var f in n)r.push(n[f].array);return{result:{elementGroups:a,buffers:n},transferables:r}}},{"../data/buffer/buffer_set":2,"../data/create_bucket":13,"../data/feature_tree":15,"../symbol/collision_tile":68}],51:[function(t,e,i){function n(){this.n=0,this.times=[]}e.exports=n,n.prototype.stopped=function(){return this.times=this.times.filter(function(t){return t.time>=(new Date).getTime()}),!this.times.length},n.prototype.set=function(t){return this.times.push({id:this.n,time:t+(new Date).getTime()}),this.n++},n.prototype.cancel=function(t){this.times=this.times.filter(function(e){return e.id!==t})}},{}],52:[function(t,e,i){function n(t){this.base=t,this.retina=a.devicePixelRatio>1;var e=this.retina?"@2x":"";s.getJSON(u(t,e,".json"),function(t,e){return t?void this.fire("error",{error:t}):(this.data=e,void(this.img&&this.fire("load")))}.bind(this)),s.getImage(u(t,e,".png"),function(t,e){if(t)return void this.fire("error",{error:t});for(var i=e.getData(),n=e.data=new Uint8Array(i.length),r=0;r<i.length;r+=4){var o=i[r+3]/255;n[r+0]=i[r+0]*o,n[r+1]=i[r+1]*o,n[r+2]=i[r+2]*o,n[r+3]=i[r+3]}this.img=e,this.data&&this.fire("load")}.bind(this))}function r(){}var o=t("../util/evented"),s=t("../util/ajax"),a=t("../util/browser"),u=t("../util/mapbox").normalizeSpriteURL;e.exports=n,n.prototype=Object.create(o),n.prototype.toJSON=function(){return this.base},n.prototype.loaded=function(){return!(!this.data||!this.img)},n.prototype.resize=function(){if(a.devicePixelRatio>1!==this.retina){var t=new n(this.base);t.on("load",function(){this.img=t.img,this.data=t.data,this.retina=t.retina}.bind(this))}},r.prototype={x:0,y:0,width:0,height:0,pixelRatio:1,sdf:!1},n.prototype.getSpritePosition=function(t){if(!this.loaded())return new r;var e=this.data&&this.data[t];return e&&this.img?e:new r}},{"../util/ajax":94,"../util/browser":95,"../util/evented":100,"../util/mapbox":103}],53:[function(t,e,i){var n=t("./reference");e.exports={},n.layout.forEach(function(t){var i=function(t){for(var e in t)this[e]=t[e]},r=n[t];for(var o in r)void 0!==r[o].default&&(i.prototype[o]=r[o].default);e.exports[t.replace("layout_","")]=i})},{"./reference":55}],54:[function(t,e,i){var n=t("./reference"),r=t("csscolorparser").parseCSSColor;e.exports={},n.paint.forEach(function(t){var i=function(){},o=n[t];for(var s in o){var a=o[s],u=a.default;void 0!==u&&("color"===a.type&&(u=r(u)),i.prototype[s]=u)}i.prototype.hidden=!1,e.exports[t.replace("paint_","")]=i})},{"./reference":55,csscolorparser:107}],55:[function(t,e,i){e.exports=t("mapbox-gl-style-spec/reference/latest")},{"mapbox-gl-style-spec/reference/latest":131}],56:[function(t,e,i){function n(t,e){this.animationLoop=e||new g,this.dispatcher=new _(Math.max(m.hardwareConcurrency-1,1),this),this.glyphAtlas=new l(1024,1024),this.spriteAtlas=new c(512,512),this.spriteAtlas.resize(m.devicePixelRatio),this.lineAtlas=new h(256,512),this._layers={},this._order=[],this._groups=[],this.sources={},this.zoomHistory={},f.bindAll(["_forwardSourceEvent","_forwardTileEvent","_redoPlacement"],this);var i=function(t,e){if(t)return void this.fire("error",{error:t});var i=v(e);if(i.length)for(var n=0;n<i.length;n++)this.fire("error",{error:new Error(i[n].message)});else{this._loaded=!0,this.stylesheet=e;var r=e.sources;for(var o in r)this.addSource(o,r[o]);e.sprite&&(this.sprite=new a(e.sprite),this.sprite.on("load",this.fire.bind(this,"change"))),this.glyphSource=new u(e.glyphs,this.glyphAtlas),this._resolve(),this.fire("load")}}.bind(this);"string"==typeof t?d.getJSON(p(t),i):m.frame(i.bind(this,null,t))}var r=t("../util/evented"),o=t("./style_batch"),s=t("./style_layer"),a=t("./image_sprite"),u=t("../symbol/glyph_source"),l=t("../symbol/glyph_atlas"),c=t("../symbol/sprite_atlas"),h=t("../render/line_atlas"),f=t("../util/util"),d=t("../util/ajax"),p=t("../util/mapbox").normalizeStyleURL,m=t("../util/browser"),_=t("../util/dispatcher"),g=t("./animation_loop"),v=t("mapbox-gl-style-spec/lib/validate/latest");e.exports=n,n.prototype=f.inherit(r,{_loaded:!1,loaded:function(){if(!this._loaded)return!1;for(var t in this.sources)if(!this.sources[t].loaded())return!1;return!(this.sprite&&!this.sprite.loaded())},_resolve:function(){var t,e;this._layers={},this._order=[];for(var i=0;i<this.stylesheet.layers.length;i++)e=new s(this.stylesheet.layers[i]),this._layers[e.id]=e,this._order.push(e.id);for(t in this._layers)this._layers[t].resolveLayout();for(t in this._layers)this._layers[t].resolveReference(this._layers),this._layers[t].resolvePaint();this._groupLayers(),this._broadcastLayers()},_groupLayers:function(){var t;this._groups=[];for(var e=0;e<this._order.length;++e){var i=this._layers[this._order[e]];t&&i.source===t.source||(t=[],t.source=i.source,this._groups.push(t)),t.push(i)}},_broadcastLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e].json());this.dispatcher.broadcast("set layers",t)},_cascade:function(t,e){if(this._loaded){e=e||{transition:!0};for(var i in this._layers)this._layers[i].cascade(t,e,this.stylesheet.transition||{},this.animationLoop);this.fire("change")}},_recalculate:function(t){for(var e in this.sources)this.sources[e].used=!1;this._updateZoomHistory(t),this.rasterFadeDuration=300;for(e in this._layers){var i=this._layers[e];i.recalculate(t,this.zoomHistory)&&i.source&&(this.sources[i.source].used=!0)}Math.floor(this.z)!==Math.floor(t)&&this.animationLoop.set(300),this.z=t,this.fire("zoom")},_updateZoomHistory:function(t){var e=this.zoomHistory;void 0===e.lastIntegerZoom&&(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=0,e.lastZoom=t),Math.floor(e.lastZoom)<Math.floor(t)?(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=Date.now()):Math.floor(e.lastZoom)>Math.floor(t)&&(e.lastIntegerZoom=Math.floor(t+1),e.lastIntegerZoomTime=Date.now()),e.lastZoom=t},batch:function(t){o(this,t)},addSource:function(t,e){return this.batch(function(i){i.addSource(t,e)}),this},removeSource:function(t){return this.batch(function(e){e.removeSource(t)}),this},getSource:function(t){return this.sources[t]},addLayer:function(t,e){return this.batch(function(i){i.addLayer(t,e)}),this},removeLayer:function(t){return this.batch(function(e){e.removeLayer(t)}),this},getLayer:function(t){return this._layers[t]},getReferentLayer:function(t){var e=this.getLayer(t);return e.ref&&(e=this.getLayer(e.ref)),e},setFilter:function(t,e){return this.batch(function(i){i.setFilter(t,e)}),this},setLayerZoomRange:function(t,e,i){return this.batch(function(n){n.setLayerZoomRange(t,e,i)}),this},getFilter:function(t){return this.getReferentLayer(t).filter},getLayoutProperty:function(t,e){return this.getReferentLayer(t).getLayoutProperty(e)},getPaintProperty:function(t,e,i){return this.getLayer(t).getPaintProperty(e,i)},featuresAt:function(t,e,i){var n=[],r=null;e.layer&&(e.layerIds=Array.isArray(e.layer)?e.layer:[e.layer]),f.asyncEach(Object.keys(this.sources),function(i,o){this.sources[i].featuresAt(t,e,function(t,e){e&&(n=n.concat(e)),t&&(r=t),o()})}.bind(this),function(){return r?i(r):void i(null,n.filter(function(t){return void 0!==this._layers[t.layer]}.bind(this)).map(function(t){return t.layer=this._layers[t.layer].json(),t}.bind(this)))}.bind(this))},featuresIn:function(t,e,i){var n=[],r=null;e.layer&&(e.layer={id:e.layer}),f.asyncEach(Object.keys(this.sources),function(i,o){this.sources[i].featuresIn(t,e,function(t,e){e&&(n=n.concat(e)),t&&(r=t),o()})}.bind(this),function(){return r?i(r):void i(null,n.filter(function(t){return void 0!==this._layers[t.layer]}.bind(this)).map(function(t){return t.layer=this._layers[t.layer].json(),t}.bind(this)))}.bind(this))},_remove:function(){this.dispatcher.remove()},_reloadSource:function(t){this.sources[t].reload()},_updateSources:function(t){for(var e in this.sources)this.sources[e].update(t)},_redoPlacement:function(){for(var t in this.sources)this.sources[t].redoPlacement&&this.sources[t].redoPlacement()},_forwardSourceEvent:function(t){this.fire("source."+t.type,f.extend({source:t.target},t))},_forwardTileEvent:function(t){this.fire(t.type,f.extend({source:t.target},t))},"get sprite json":function(t,e){var i=this.sprite;i.loaded()?e(null,{sprite:i.data,retina:i.retina}):i.on("load",function(){e(null,{sprite:i.data,retina:i.retina})})},"get icons":function(t,e){var i=this.sprite,n=this.spriteAtlas;i.loaded()?(n.setSprite(i),n.addIcons(t.icons,e)):i.on("load",function(){n.setSprite(i),n.addIcons(t.icons,e)})},"get glyphs":function(t,e){this.glyphSource.getSimpleGlyphs(t.fontstack,t.codepoints,t.uid,e)}})},{"../render/line_atlas":36,"../symbol/glyph_atlas":70,"../symbol/glyph_source":71,"../symbol/sprite_atlas":77,"../util/ajax":94,"../util/browser":95,"../util/dispatcher":97,"../util/evented":100,"../util/mapbox":103,"../util/util":106,"./animation_loop":51,"./image_sprite":52,"./style_batch":57,"./style_layer":60,"mapbox-gl-style-spec/lib/validate/latest":129}],57:[function(t,e,i){function n(t,e){if(!t._loaded)throw new Error("Style is not done loading");var i=Object.create(n.prototype);i._style=t,i._groupLayers=!1,i._broadcastLayers=!1,i._reloadSources={},i._events=[],i._change=!1,e(i),i._groupLayers&&i._style._groupLayers(),i._broadcastLayers&&i._style._broadcastLayers(),Object.keys(i._reloadSources).forEach(function(t){i._style._reloadSource(t)}),i._events.forEach(function(t){i._style.fire.apply(i._style,t)}),i._change&&i._style.fire("change")}var r=t("../source/source"),o=t("./style_layer");n.prototype={addLayer:function(t,e){if(void 0!==this._style._layers[t.id])throw new Error("There is already a layer with this ID");return t instanceof o||(t=new o(t)),this._style._layers[t.id]=t,this._style._order.splice(e?this._style._order.indexOf(e):1/0,0,t.id),t.resolveLayout(),t.resolveReference(this._style._layers),t.resolvePaint(),this._groupLayers=!0,this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._events.push(["layer.add",{layer:t}]),this._change=!0,this},removeLayer:function(t){var e=this._style._layers[t];if(void 0===e)throw new Error("There is no layer with this ID");for(var i in this._style._layers)this._style._layers[i].ref===t&&this.removeLayer(i);return delete this._style._layers[t],this._style._order.splice(this._style._order.indexOf(t),1),this._groupLayers=!0,this._broadcastLayers=!0,this._events.push(["layer.remove",{layer:e}]),this._change=!0,this},setPaintProperty:function(t,e,i,n){return this._style.getLayer(t).setPaintProperty(e,i,n),this._change=!0,this},setLayoutProperty:function(t,e,i){return t=this._style.getReferentLayer(t),t.setLayoutProperty(e,i),this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._change=!0,this},setFilter:function(t,e){return t=this._style.getReferentLayer(t),t.filter=e,this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._change=!0,this},setLayerZoomRange:function(t,e,i){var n=this._style.getReferentLayer(t);return null!=e&&(n.minzoom=e),null!=i&&(n.maxzoom=i),this._broadcastLayers=!0,n.source&&(this._reloadSources[n.source]=!0),this._change=!0,this},addSource:function(t,e){if(!this._style._loaded)throw new Error("Style is not done loading");if(void 0!==this._style.sources[t])throw new Error("There is already a source with this ID");return e=r.create(e),this._style.sources[t]=e,e.id=t,e.style=this._style,e.dispatcher=this._style.dispatcher,e.glyphAtlas=this._style.glyphAtlas,e.on("load",this._style._forwardSourceEvent).on("error",this._style._forwardSourceEvent).on("change",this._style._forwardSourceEvent).on("tile.add",this._style._forwardTileEvent).on("tile.load",this._style._forwardTileEvent).on("tile.error",this._style._forwardTileEvent).on("tile.remove",this._style._forwardTileEvent).on("tile.stats",this._style._forwardTileEvent),this._events.push(["source.add",{source:e}]),this._change=!0,this},removeSource:function(t){if(void 0===this._style.sources[t])throw new Error("There is no source with this ID");var e=this._style.sources[t];return delete this._style.sources[t],e.off("load",this._style._forwardSourceEvent).off("error",this._style._forwardSourceEvent).off("change",this._style._forwardSourceEvent).off("tile.add",this._style._forwardTileEvent).off("tile.load",this._style._forwardTileEvent).off("tile.error",this._style._forwardTileEvent).off("tile.remove",this._style._forwardTileEvent).off("tile.stats",this._style._forwardTileEvent),this._events.push(["source.remove",{source:e}]),this._change=!0,this}},e.exports=n},{"../source/source":43,"./style_layer":60}],58:[function(t,e,i){function n(t,e){this.type=t.type,this.transitionable=t.transition,null==e&&(e=t.default),this.json=JSON.stringify(e),"color"===this.type?this.value=o(e):this.value=e,"interpolated"===t.function?this.calculate=u.interpolated(this.value):(this.calculate=u["piecewise-constant"](this.value),t.transition&&(this.calculate=r(this.calculate)))}function r(t){return function(e,i,n){var r,o,s,a=e%1,u=Math.min((Date.now()-i.lastIntegerZoomTime)/n,1),l=1;return e>i.lastIntegerZoom?(r=a+(1-a)*u,l*=2,o=t(e-1),s=t(e)):(r=1-(1-u)*a,s=t(e),o=t(e+1),l/=2),{from:o,fromScale:l,to:s,toScale:1,t:r}}}function o(t){if(c[t])return c[t];if(Array.isArray(t))return t;if(t.stops)return l.extend({},t,{stops:t.stops.map(function(t){return[t[0],o(t[1])]})});if("string"==typeof t){var e=s(a(t));return c[t]=e,e}throw new Error("Invalid color "+t)}function s(t){return[t[0]/255,t[1]/255,t[2]/255,t[3]/1]}var a=t("csscolorparser").parseCSSColor,u=t("mapbox-gl-function"),l=t("../util/util");e.exports=n;var c={}},{"../util/util":106,csscolorparser:107,"mapbox-gl-function":128}],59:[function(t,e,i){function n(t){function e(t){this._values={},this._transitions={};for(var e in t)this[e]=t[e]}return Object.keys(t).forEach(function(i){var n=t[i];Object.defineProperty(e.prototype,i,{set:function(t){this._values[i]=new s(n,t)},get:function(){return this._values[i].value}}),n.transition&&Object.defineProperty(e.prototype,i+"-transition",{set:function(t){this._transitions[i]=t},get:function(){return this._transitions[i]}})}),e.prototype.values=function(){return this._values},e.prototype.transition=function(t,e){var i=this._transitions[t]||{};return{duration:r.coalesce(i.duration,e.duration,300),delay:r.coalesce(i.delay,e.delay,0)}},e.prototype.json=function(){var t={};for(var e in this._values)t[e]=this._values[e].value;for(var i in this._transitions)t[i+"-transition"]=this._transitions[e];return t},e}var r=t("../util/util"),o=t("./reference"),s=t("./style_declaration"),a={paint:{},layout:{}};o.layer.type.values.forEach(function(t){a.paint[t]=n(o["paint_"+t]),a.layout[t]=n(o["layout_"+t])}),e.exports=function(t,e,i){return new a[t][e](i)}},{"../util/util":106,"./reference":55,"./style_declaration":58}],60:[function(t,e,i){function n(t){this._layer=t,this.id=t.id,this.ref=t.ref,this._resolved={},this._cascaded={},this.assign(t)}function r(t,e){var i=e+"-color",n=e+"-halo-color",r=e+"-outline-color",s=t[i],a=t[n],u=t[r],l=t[e+"-opacity"],c=s&&l*s[3],h=a&&l*a[3],f=u&&l*u[3];void 0!==c&&1>c&&(t[i]=o.premultiply([s[0],s[1],s[2],c])),void 0!==h&&1>h&&(t[n]=o.premultiply([a[0],a[1],a[2],h])),void 0!==f&&1>f&&(t[r]=o.premultiply([u[0],u[1],u[2],f]))}var o=t("../util/util"),s=t("./style_transition"),a=t("./style_declaration_set"),u=t("./layout_properties"),l=t("./paint_properties");e.exports=n,n.prototype={resolveLayout:function(){this.ref||(this.layout=new u[this.type](this._layer.layout),"line"===this.layout["symbol-placement"]&&(this.layout.hasOwnProperty("text-rotation-alignment")||(this.layout["text-rotation-alignment"]="map"),this.layout.hasOwnProperty("icon-rotation-alignment")||(this.layout["icon-rotation-alignment"]="map"),this.layout["symbol-avoid-edges"]=!0))},setLayoutProperty:function(t,e){null==e?delete this.layout[t]:this.layout[t]=e},getLayoutProperty:function(t){return this.layout[t]},resolveReference:function(t){this.ref&&this.assign(t[this.ref])},resolvePaint:function(){for(var t in this._layer){var e=t.match(/^paint(?:\.(.*))?$/);e&&(this._resolved[e[1]||""]=new a("paint",this.type,this._layer[t]))}},setPaintProperty:function(t,e,i){var n=this._resolved[i||""];n||(n=this._resolved[i||""]=new a("paint",this.type,{})),n[t]=e},getPaintProperty:function(t,e){var i=this._resolved[e||""];if(i)return i[t]},cascade:function(t,e,i,n){for(var r in this._resolved)if(""===r||t[r]){var o=this._resolved[r],u=o.values();for(var l in u){var c=u[l],h=e.transition?this._cascaded[l]:void 0;if(!h||h.declaration.json!==c.json){var f=o.transition(l,i),d=this._cascaded[l]=new s(c,h,f);d.instant()||(d.loopID=n.set(d.endTime-(new Date).getTime())),h&&n.cancel(h.loopID)}}}if("symbol"===this.type){var p=new a("layout",this.type,this.layout);this._cascaded["text-size"]=new s(p.values()["text-size"],void 0,i),this._cascaded["icon-size"]=new s(p.values()["icon-size"],void 0,i)}},recalculate:function(t,e){var i=this.type,n=this.paint=new l[i];for(var o in this._cascaded)n[o]=this._cascaded[o].at(t,e);if(this.hidden=this.minzoom&&t<this.minzoom||this.maxzoom&&t>=this.maxzoom||"none"===this.layout.visibility,"symbol"===i?0!==n["text-opacity"]&&this.layout["text-field"]||0!==n["icon-opacity"]&&this.layout["icon-image"]?(r(n,"text"),r(n,"icon")):this.hidden=!0:0===n[i+"-opacity"]?this.hidden=!0:r(n,i),this._cascaded["line-dasharray"]){var s=n["line-dasharray"],a=this._cascaded["line-width"]?this._cascaded["line-width"].at(Math.floor(t),1/0):n["line-width"];s.fromScale*=a,s.toScale*=a}return!this.hidden},assign:function(t){o.extend(this,o.pick(t,["type","source","source-layer","minzoom","maxzoom","filter","layout"]))},json:function(){return o.extend({},this._layer,o.pick(this,["type","source","source-layer","minzoom","maxzoom","filter","layout","paint"]))}}},{"../util/util":106,"./layout_properties":53,"./paint_properties":54,"./style_declaration_set":59,"./style_transition":61}],61:[function(t,e,i){function n(t,e,i){this.declaration=t,this.startTime=this.endTime=(new Date).getTime();var n=t.type;"string"!==n&&"array"!==n||!t.transitionable?this.interp=s[n]:this.interp=r,this.oldTransition=e,this.duration=i.duration||0,this.delay=i.delay||0,this.instant()||(this.endTime=this.startTime+this.duration+this.delay,this.ease=o.easeCubicInOut),e&&e.endTime<=this.startTime&&delete e.oldTransition}function r(t,e,i){return{from:t.to,fromScale:t.toScale,to:e.to,toScale:e.toScale,t:i}}var o=t("../util/util"),s=t("../util/interpolate");e.exports=n,n.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay},n.prototype.at=function(t,e,i){var n=this.declaration.calculate(t,e,this.duration);if(this.instant())return n;if((i=i||Date.now())<this.endTime){var r=this.oldTransition.at(t,e,this.startTime),o=this.ease((i-this.startTime-this.delay)/this.duration);n=this.interp(r,n,o)}return n}},{"../util/interpolate":102,"../util/util":106}],62:[function(t,e,i){function n(t,e,i,n){this.x=t,this.y=e,this.angle=i,void 0!==n&&(this.segment=n)}var r=t("point-geometry");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)}},{"point-geometry":137}],63:[function(t,e,i){function n(t,e){this.width=t,this.height=e,this.free=[{x:0,y:0,w:t,h:e}]}e.exports=n,n.prototype.release=function(t){for(var e=0;e<this.free.length;e++){var i=this.free[e];if(i.y===t.y&&i.h===t.h&&i.x+i.w===t.x)i.w+=t.w;else if(i.x===t.x&&i.w===t.w&&i.y+i.h===t.y)i.h+=t.h;else if(t.y===i.y&&t.h===i.h&&t.x+t.w===i.x)i.x=t.x,i.w+=t.w;else{if(t.x!==i.x||t.w!==i.w||t.y+t.h!==i.y)continue;i.y=t.y,i.h+=t.h}return this.free.splice(e,1),void this.release(i)}this.free.push(t)},n.prototype.allocate=function(t,e){for(var i={x:1/0,y:1/0,w:1/0,h:1/0},n=-1,r=0;r<this.free.length;r++){var o=this.free[r];t<=o.w&&e<=o.h&&o.y<=i.y&&o.x<=i.x&&(i=o,n=r)}return 0>n?{x:-1,y:-1}:(this.free.splice(n,1),i.w<i.h?(i.w>t&&this.free.push({x:i.x+t,y:i.y,w:i.w-t,h:e}),i.h>e&&this.free.push({x:i.x,y:i.y+e,w:i.w,h:i.h-e})):(i.w>t&&this.free.push({x:i.x+t,y:i.y,w:i.w-t,h:i.h}),i.h>e&&this.free.push({x:i.x,y:i.y+e,w:t,h:i.h-e})),{x:i.x,y:i.y,w:t,h:e})}},{}],64:[function(t,e,i){function n(t,e,i,n,r){if(void 0===e.segment)return!0;for(var o=e,s=e.segment+1,a=0;a>-i/2;){if(0>--s)return!1;a-=t[s].dist(o),o=t[s]}a+=t[s].dist(t[s+1]),s++;for(var u=[],l=0;i/2>a;){var c=t[s-1],h=t[s],f=t[s+1];if(!f)return!1;var d=c.angleTo(h)-h.angleTo(f);for(d=(d+3*Math.PI)%(2*Math.PI)-Math.PI,u.push({distance:a,angleDelta:d}),l+=d;a-u[0].distance>n;)l-=u.shift().angleDelta;if(Math.abs(l)>r)return!1;s++,a+=h.dist(f)}return!0}e.exports=n},{}],65:[function(t,e,i){function n(t,e,i,n,o){for(var s=[],a=0;a<t.length;a++)for(var u,l=t[a],c=0;c<l.length-1;c++){var h=l[c],f=l[c+1]
;h.x<e&&f.x<e||(h.x<e?h=new r(e,h.y+(f.y-h.y)*((e-h.x)/(f.x-h.x))):f.x<e&&(f=new r(e,h.y+(f.y-h.y)*((e-h.x)/(f.x-h.x)))),h.y<i&&f.y<i||(h.y<i?h=new r(h.x+(f.x-h.x)*((i-h.y)/(f.y-h.y)),i):f.y<i&&(f=new r(h.x+(f.x-h.x)*((i-h.y)/(f.y-h.y)),i)),h.x>=n&&f.x>=n||(h.x>=n?h=new r(n,h.y+(f.y-h.y)*((n-h.x)/(f.x-h.x))):f.x>=n&&(f=new r(n,h.y+(f.y-h.y)*((n-h.x)/(f.x-h.x)))),h.y>=o&&f.y>=o||(h.y>=o?h=new r(h.x+(f.x-h.x)*((o-h.y)/(f.y-h.y)),o):f.y>=o&&(f=new r(h.x+(f.x-h.x)*((o-h.y)/(f.y-h.y)),o)),u&&h.equals(u[u.length-1])||(u=[h],s.push(u)),u.push(f)))))}return s}var r=t("point-geometry");e.exports=n},{"point-geometry":137}],66:[function(t,e,i){function n(t,e,i,n,r,o){this.anchorPoint=t,this.x1=e,this.y1=i,this.x2=n,this.y2=r,this.maxScale=o,this.placementScale=0,this[0]=this[1]=this[2]=this[3]=0}e.exports=n},{}],67:[function(t,e,i){function n(t,e,i,n,s,a){var u=i.top*n-s,l=i.bottom*n+s,c=i.left*n-s,h=i.right*n+s;if(this.boxes=[],a){var f=l-u,d=h-c;if(0>=f)return;f=Math.max(10*n,f),this._addLineCollisionBoxes(t,e,d,f)}else this.boxes.push(new r(new o(e.x,e.y),c,u,h,l,1/0))}var r=t("./collision_box"),o=t("point-geometry");e.exports=n,n.prototype._addLineCollisionBoxes=function(t,e,i,n){var o=n/2,s=Math.floor(i/o),a=-n/2,u=this.boxes,l=e,c=e.segment+1,h=a;do{if(0>--c)return u;h-=t[c].dist(l),l=t[c]}while(h>-i/2);for(var f=t[c].dist(t[c+1]),d=0;s>d;d++){for(var p=-i/2+d*o;p>h+f;){if(h+=f,++c+1>=t.length)return u;f=t[c].dist(t[c+1])}var m=p-h,_=t[c],g=t[c+1],v=g.sub(_)._unit()._mult(m)._add(_),y=Math.max(Math.abs(p-a)-o/2,0),b=i/2/y;u.push(new r(v,-n/2,-n/2,n/2,n/2,b))}return u}},{"./collision_box":66,"point-geometry":137}],68:[function(t,e,i){function n(t,e){this.tree=r(),this.angle=t;var i=Math.sin(t),n=Math.cos(t);this.rotationMatrix=[n,-i,i,n],this.yStretch=1/Math.cos(e/180*Math.PI),this.yStretch=Math.pow(this.yStretch,1.3)}var r=t("rbush");e.exports=n,n.prototype.minScale=.25,n.prototype.maxScale=2,n.prototype.placeCollisionFeature=function(t){for(var e=this.minScale,i=this.rotationMatrix,n=this.yStretch,r=0;r<t.boxes.length;r++){var o=t.boxes[r],s=o.anchorPoint.matMult(i),a=s.x,u=s.y;o[0]=a+o.x1,o[1]=u+o.y1*n,o[2]=a+o.x2,o[3]=u+o.y2*n;for(var l=this.tree.search(o),c=0;c<l.length;c++){var h=l[c],f=h.anchorPoint.matMult(i),d=(h.x1-o.x2)/(a-f.x),p=(h.x2-o.x1)/(a-f.x),m=(h.y1-o.y2)*n/(u-f.y),_=(h.y2-o.y1)*n/(u-f.y);(isNaN(d)||isNaN(p))&&(d=p=1),(isNaN(m)||isNaN(_))&&(m=_=1);var g=Math.min(Math.max(d,p),Math.max(m,_));if(g>h.maxScale&&(g=h.maxScale),g>o.maxScale&&(g=o.maxScale),g>e&&g>=h.placementScale&&(e=g),e>=this.maxScale)return e}}return e},n.prototype.insertCollisionFeature=function(t,e){for(var i=t.boxes,n=0;n<i.length;n++)i[n].placementScale=e;e<this.maxScale&&this.tree.load(i)}},{rbush:139}],69:[function(t,e,i){function n(t,e,i,n,o,s,a,u){var l=n?.6*s*a:0,c=Math.max(n?n.right-n.left:0,o?o.right-o.left:0);if(0===t[0].x||4096===t[0].x||0===t[0].y||4096===t[0].y)var h=!0;e/4>e-c*a&&(e=c*a+e/4);var f=2*s;return r(t,h?e/2*u%e:(c/2+f)*a*u%e,e,l,i,c*a,h,!1)}function r(t,e,i,n,u,l,c,h){for(var f=0,d=e-i,p=[],m=0;m<t.length-1;m++){for(var _=t[m],g=t[m+1],v=_.dist(g),y=g.angleTo(_);f+v>d+i;){d+=i;var b=(d-f)/v,x=o(_.x,g.x,b),w=o(_.y,g.y,b);if(x>=0&&4096>x&&w>=0&&4096>w){x=Math.round(x),w=Math.round(w);var L=new s(x,w,y,m);(!n||a(t,L,l,n,u))&&p.push(L)}}f+=v}return h||p.length||c||(p=r(t,f/2,i,n,u,l,c,!0)),p}var o=t("../util/interpolate"),s=t("../symbol/anchor"),a=t("./check_max_angle");e.exports=n},{"../symbol/anchor":62,"../util/interpolate":102,"./check_max_angle":64}],70:[function(t,e,i){function n(t,e){this.width=t,this.height=e,this.bin=new r(t,e),this.index={},this.ids={},this.data=new Uint8Array(t*e)}var r=t("./bin_pack");e.exports=n,n.prototype={get debug(){return"canvas"in this},set debug(t){t&&!this.canvas?(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")):!t&&this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),delete this.ctx,delete this.canvas)}},n.prototype.getGlyphs=function(){var t,e,i,n={};for(var r in this.ids)t=r.split("#"),e=t[0],i=t[1],n[e]||(n[e]=[]),n[e].push(i);return n},n.prototype.getRects=function(){var t,e,i,n={};for(var r in this.ids)t=r.split("#"),e=t[0],i=t[1],n[e]||(n[e]={}),n[e][i]=this.index[r];return n},n.prototype.removeGlyphs=function(t){for(var e in this.ids){var i=this.ids[e],n=i.indexOf(t);if(n>=0&&i.splice(n,1),this.ids[e]=i,!i.length){for(var r=this.index[e],o=this.data,s=0;s<r.h;s++)for(var a=this.width*(r.y+s)+r.x,u=0;u<r.w;u++)o[a+u]=0;this.dirty=!0,this.bin.release(r),delete this.index[e],delete this.ids[e]}}this.updateTexture(this.gl)},n.prototype.addGlyph=function(t,e,i,n){if(!i)return null;var r=e+"#"+i.id;if(this.index[r])return this.ids[r].indexOf(t)<0&&this.ids[r].push(t),this.index[r];if(!i.bitmap)return null;var o=i.width+2*n,s=i.height+2*n,a=o+2,u=s+2;a+=4-a%4,u+=4-u%4;var l=this.bin.allocate(a,u);if(l.x<0)return console.warn("glyph bitmap overflow"),{glyph:i,rect:null};this.index[r]=l,this.ids[r]=[t];for(var c=this.data,h=i.bitmap,f=0;s>f;f++)for(var d=this.width*(l.y+f+1)+l.x+1,p=o*f,m=0;o>m;m++)c[d+m]=h[p+m];return this.dirty=!0,l},n.prototype.bind=function(t){this.gl=t,this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,null))},n.prototype.updateTexture=function(t){if(this.bind(t),this.dirty){if(t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data),this.ctx){for(var e=this.ctx.getImageData(0,0,this.width,this.height),i=0,n=0;i<this.data.length;i++,n+=4)e.data[n]=this.data[i],e.data[n+1]=this.data[i],e.data[n+2]=this.data[i],e.data[n+3]=255;this.ctx.putImageData(e,0,0),this.ctx.strokeStyle="red";for(var r=0;r<this.bin.free.length;r++){var o=this.bin.free[r];this.ctx.strokeRect(o.x,o.y,o.w,o.h)}}this.dirty=!1}}},{"./bin_pack":63}],71:[function(t,e,i){function n(t,e){this.url=t&&s(t),this.glyphAtlas=e,this.stacks=[],this.loading={}}function r(t,e,i){this.advance=t.advance,this.left=t.left-i-1,this.top=t.top+i+1,this.rect=e}function o(t,e,i,n){return n=n||"abc",i.replace("{s}",n[t.length%n.length]).replace("{fontstack}",t).replace("{range}",e)}var s=t("../util/mapbox").normalizeGlyphsURL,a=t("../util/ajax").getArrayBuffer,u=t("../util/glyphs"),l=t("pbf");e.exports=n,n.prototype.getSimpleGlyphs=function(t,e,i,n){void 0===this.stacks[t]&&(this.stacks[t]={});for(var o,s={},a=this.stacks[t],u=this.glyphAtlas,l={},c=0,h=0;h<e.length;h++){var f=e[h];if(o=Math.floor(f/256),a[o]){var d=a[o].glyphs[f],p=u.addGlyph(i,t,d,3);d&&(s[f]=new r(d,p,3))}else void 0===l[o]&&(l[o]=[],c++),l[o].push(f)}c||n(void 0,s);var m=function(e,o,a){if(!e)for(var h=this.stacks[t][o]=a.stacks[0],f=0;f<l[o].length;f++){var d=l[o][f],p=h.glyphs[d],m=u.addGlyph(i,t,p,3);p&&(s[d]=new r(p,m,3))}--c||n(void 0,s)}.bind(this);for(var _ in l)this.loadRange(t,_,m)},n.prototype.loadRange=function(t,e,i){if(256*e>65535)return i("gyphs > 65535 not supported");void 0===this.loading[t]&&(this.loading[t]={});var n=this.loading[t];if(n[e])n[e].push(i);else{n[e]=[i];var r=256*e+"-"+(256*e+255),s=o(t,r,this.url);a(s,function(t,i){for(var r=!t&&new u(new l(new Uint8Array(i))),o=0;o<n[e].length;o++)n[e][o](t,e,r);delete n[e]})}}},{"../util/ajax":94,"../util/glyphs":101,"../util/mapbox":103,pbf:136}],72:[function(t,e,i){e.exports=function(t,e,i){function n(n){c.push(t[n]),h.push(i[n]),f.push(e[n]),d++}function r(t,e,i){var n=l[t];return delete l[t],l[e]=n,h[n][0].pop(),h[n][0]=h[n][0].concat(i[0]),n}function o(t,e,i){var n=u[e];return delete u[e],u[t]=n,h[n][0].shift(),h[n][0]=i[0].concat(h[n][0]),n}function s(t,e,i){var n=i?e[0][e[0].length-1]:e[0][0];return t+":"+n.x+":"+n.y}var a,u={},l={},c=[],h=[],f=[],d=0;for(a=0;a<t.length;a++){var p=i[a],m=e[a];if(p)if(m){var _=s(m,p),g=s(m,p,!0);if(_ in l&&g in u&&l[_]!==u[g]){var v=o(_,g,p),y=r(_,g,h[v]);delete u[_],delete l[g],l[s(m,h[y],!0)]=y,h[v]=null}else _ in l?r(_,g,p):g in u?o(_,g,p):(n(a),u[_]=d-1,l[g]=d-1)}else n(a)}return{features:c,textFeatures:f,geometries:h}}},{}],73:[function(t,e,i){function n(t,e,i,n,r,o,s,a,u){this.anchorPoint=t,this.tl=e,this.tr=i,this.bl=n,this.br=r,this.tex=o,this.angle=s,this.minScale=a,this.maxScale=u}function r(t,e,i,r,o,s){var l=e.image.rect,c=e.left-1,h=c+l.w,f=e.top-1,d=f+l.h,p=new a(c,f),m=new a(h,f),_=new a(h,d),g=new a(c,d),v=o["icon-rotate"]*Math.PI/180;if(s){var y=r[t.segment];v+=Math.atan2(t.y-y.y,t.x-y.x)}if(v){var b=Math.sin(v),x=Math.cos(v),w=[x,-b,b,x];p=p.matMult(w),m=m.matMult(w),g=g.matMult(w),_=_.matMult(w)}return[new n(new a(t.x,t.y),p,m,g,_,e.image.rect,0,u,1/0)]}function o(t,e,i,r,o,l){for(var c=o["text-rotate"]*Math.PI/180,h=o["text-keep-upright"],f=e.positionedGlyphs,d=[],p=0;p<f.length;p++){var m=f[p],_=m.glyph,g=_.rect;if(g){var v,y=(m.x+_.advance/2)*i,b=u;l?(v=[],b=s(v,t,y,r,t.segment,!0),h&&(b=Math.min(b,s(v,t,y,r,t.segment,!1)))):v=[{anchorPoint:new a(t.x,t.y),offset:0,angle:0,maxScale:1/0,minScale:u}];for(var x=m.x+_.left,w=m.y-_.top,L=x+g.w,S=w+g.h,T=new a(x,w),M=new a(L,w),E=new a(x,S),P=new a(L,S),C=0;C<v.length;C++){var A=v[C],k=T,z=M,I=E,R=P,O=A.angle+c;if(O){var F=Math.sin(O),D=Math.cos(O),j=[D,-F,F,D];k=k.matMult(j),z=z.matMult(j),I=I.matMult(j),R=R.matMult(j)}var N=Math.max(A.minScale,b),B=(t.angle+c+A.offset+2*Math.PI)%(2*Math.PI);d.push(new n(A.anchorPoint,k,z,I,R,g,B,N,A.maxScale))}}}return d}function s(t,e,i,n,r,o){var s=!o;0>i&&(o=!o),o&&r++;var l=new a(e.x,e.y),c=n[r],h=1/0;i=Math.abs(i);for(var f=u;;){var d=l.dist(c),p=i/d,m=Math.atan2(c.y-l.y,c.x-l.x);if(o||(m+=Math.PI),s&&(m+=Math.PI),t.push({anchorPoint:l,offset:s?Math.PI:0,minScale:p,maxScale:h,angle:(m+2*Math.PI)%(2*Math.PI)}),f>=p)break;for(l=c;l.equals(c);)if(r+=o?1:-1,!(c=n[r]))return p;var _=c.sub(l)._unit();l=l.sub(_._mult(d)),h=p}return f}var a=t("point-geometry");e.exports={getIconQuads:r,getGlyphQuads:o};var u=.5},{"point-geometry":137}],74:[function(t,e,i){function n(t,e){for(var i=[],n=0,o=t.length;o>n;n++){var s=r(t[n].properties,e["icon-image"]);s&&i.indexOf(s)<0&&i.push(s)}return i}var r=t("../util/token");e.exports=n},{"../util/token":105}],75:[function(t,e,i){function n(t,e,i){for(var n=[],o=[],a=0,u=t.length;u>a;a++){var l=s(t[a].properties,e["text-field"]);if(l){l=l.toString();var c=e["text-transform"];"uppercase"===c?l=l.toLocaleUpperCase():"lowercase"===c&&(l=l.toLocaleLowerCase());for(var h=0,f=l.length;f>h;h++)o.push(l.charCodeAt(h));n[a]=l}else n[a]=null}return o=r(o,i),{textFeatures:n,codepoints:o}}function r(t,e){var i,n=[];t.sort(o);for(var r=0;r<t.length;r++)t[r]!==i&&(i=t[r],e[i]||n.push(t[r]));return n}function o(t,e){return t-e}var s=t("../util/token");e.exports=n},{"../util/token":105}],76:[function(t,e,i){function n(t,e,i,n){this.codePoint=t,this.x=e,this.y=i,this.glyph=n}function r(t,e,i,n,r,o){this.positionedGlyphs=t,this.text=e,this.top=i,this.bottom=n,this.left=r,this.right=o}function o(t,e,i,o,a,u,l,c,h){for(var f=[],d=new r(f,t,h[1],h[1],h[0],h[0]),p=h[0],m=h[1]+-17,_=0;_<t.length;_++){var g=t.charCodeAt(_),v=e[g];v&&(f.push(new n(g,p,m,v)),p+=v.advance+c)}return!!f.length&&(s(d,e,o,i,a,u,l),d)}function s(t,e,i,n,r,o,s){var l=null,c=0,f=0,d=0,p=0,m=t.positionedGlyphs;if(n)for(var _=0;_<m.length;_++){var g=m[_];if(g.x-=c,g.y+=i*d,g.x>n&&null!==l){var v=m[l+1].x;p=Math.max(v,p);for(var y=l+1;_>=y;y++)m[y].y+=i,m[y].x-=v;s&&a(m,e,f,l-1,s),f=l+1,l=null,c+=v,d++}h[g.codePoint]&&(l=_)}var b=m[m.length-1],x=b.x+e[b.codePoint].advance;p=Math.max(p,x);var w=(d+1)*i;a(m,e,f,m.length-1,s),u(m,s,r,o,p,i,d),t.top+=-o*w,t.bottom=t.top+w,t.left+=-r*p,t.right=t.left+p}function a(t,e,i,n,r){for(var o=e[t[n].codePoint].advance,s=(t[n].x+o)*r,a=i;n>=a;a++)t[a].x-=s}function u(t,e,i,n,r,o,s){for(var a=(e-i)*r,u=(-n*(s+1)+.5)*o,l=0;l<t.length;l++)t[l].x+=a,t[l].y+=u}function l(t,e){if(!t||!t.rect)return null;var i=e["icon-offset"][0],n=e["icon-offset"][1],r=i-t.width/2,o=r+t.width,s=n-t.height/2;return new c(t,s,s+t.height,r,o)}function c(t,e,i,n,r){this.image=t,this.top=e,this.bottom=i,this.left=n,this.right=r}e.exports={shapeText:o,shapeIcon:l};var h={32:!0}},{}],77:[function(t,e,i){function n(t,e){this.width=t,this.height=e,this.bin=new s(t,e),this.images={},this.data=!1,this.texture=0,this.filter=0,this.pixelRatio=1,this.dirty=!0}function r(t,e,i,n,r,o,s,a,u,l,c){var h,f,d=n*e+i,p=a*o+s;if(c)for(p-=o,f=-1;l>=f;f++,d=((f+l)%l+n)*e+i,p+=o)for(h=-1;u>=h;h++)r[p+h]=t[d+(h+u)%u];else for(f=0;l>f;f++,d+=e,p+=o)for(h=0;u>h;h++)r[p+h]=t[d+h]}function o(t,e,i,n){this.rect=t,this.width=e,this.height=i,this.sdf=n}var s=t("./bin_pack");e.exports=n,n.prototype={get debug(){return"canvas"in this},set debug(t){t&&!this.canvas?(this.canvas=document.createElement("canvas"),this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.canvas.style.width=this.width+"px",this.canvas.style.width=this.width+"px",document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")):!t&&this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),delete this.ctx,delete this.canvas)}},n.prototype.resize=function(t){if(this.pixelRatio===t)return!1;var e=this.pixelRatio;if(this.pixelRatio=t,this.canvas&&(this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio),this.data){var i=this.data;this.data=!1,this.allocate(),this.texture=!1;for(var n=this.width*e,r=this.height*e,o=this.width*t,s=this.height*t,a=this.data,u=i,l=0;s>l;l++)for(var c=Math.floor(l*r/s)*n,h=l*o,f=0;o>f;f++){var d=Math.floor(f*n/o);a[h+f]=u[c+d]}i=null,this.dirty=!0}return this.dirty},n.prototype.allocateImage=function(t,e){var i=t+2+(4-(t+2)%4),n=e+2+(4-(e+2)%4),r=this.bin.allocate(i,n);return 0===r.w?r:(r.originalWidth=t,r.originalHeight=e,r)},n.prototype.getImage=function(t,e){if(this.images[t])return this.images[t];if(!this.sprite)return null;var i=this.sprite.getSpritePosition(t);if(!i.width||!i.height)return null;var n=i.width/i.pixelRatio,r=i.height/i.pixelRatio,s=this.allocateImage(n,r);if(0===s.w)return s;var a=new o(s,n,r,i.sdf);return this.images[t]=a,this.copy(s,i,e),a},n.prototype.getPosition=function(t,e){var i=this.getImage(t,e),n=i&&i.rect;if(!n)return null;var r=e?i.width:n.w,o=e?i.height:n.h;return{size:[r,o],tl:[(n.x+1)/this.width,(n.y+1)/this.height],br:[(n.x+1+r)/this.width,(n.y+1+o)/this.height]}},n.prototype.allocate=function(){if(!this.data){var t=Math.floor(this.width*this.pixelRatio),e=Math.floor(this.height*this.pixelRatio);this.data=new Uint32Array(t*e);for(var i=0;i<this.data.length;i++)this.data[i]=0}},n.prototype.copy=function(t,e,i){if(this.sprite.img.data){var n=new Uint32Array(this.sprite.img.data.buffer);this.allocate();var o=this.data;r(n,this.sprite.img.width,e.x,e.y,o,this.width*this.pixelRatio,(t.x+1)*this.pixelRatio,(t.y+1)*this.pixelRatio,e.width,e.height,i),this.dirty=!0}},n.prototype.setSprite=function(t){this.sprite=t},n.prototype.addIcons=function(t,e){for(var i=0;i<t.length;i++)this.getImage(t[i]);e(null,this.images)},n.prototype.bind=function(t,e){var i=!1;this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i=!0);var n=e?t.LINEAR:t.NEAREST;if(n!==this.filter&&(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n),this.filter=n),this.dirty&&(this.allocate(),i?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width*this.pixelRatio,this.height*this.pixelRatio,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width*this.pixelRatio,this.height*this.pixelRatio,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1,this.ctx)){var r=this.ctx.getImageData(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio);r.data.set(new Uint8ClampedArray(this.data.buffer)),this.ctx.putImageData(r,0,0),this.ctx.strokeStyle="red";for(var o=0;o<this.bin.free.length;o++){var s=this.bin.free[o];this.ctx.strokeRect(s.x*this.pixelRatio,s.y*this.pixelRatio,s.w*this.pixelRatio,s.h*this.pixelRatio)}}}},{"./bin_pack":63}],78:[function(t,e,i){var n=t("../util/util"),r=t("../util/interpolate"),o=t("../util/browser"),s=t("../geo/lng_lat"),a=t("../geo/lng_lat_bounds"),u=t("point-geometry"),l=e.exports=function(){};n.extend(l.prototype,{getCenter:function(){return this.transform.center},setCenter:function(t){return this.jumpTo({center:t}),this},panBy:function(t,e){return this.panTo(this.transform.center,n.extend({offset:u.convert(t).mult(-1)},e)),this},panTo:function(t,e){this.stop(),t=s.convert(t),e=n.extend({duration:500,easing:n.ease,offset:[0,0]},e);var i=this.transform,r=u.convert(e.offset).rotate(-i.angle),o=i.point,a=i.project(t).sub(r);return e.noMoveStart||this.fire("movestart"),this._ease(function(t){i.center=i.unproject(o.add(a.sub(o).mult(t))),this.fire("move")},function(){this.fire("moveend")},e),this},getZoom:function(){return this.transform.zoom},setZoom:function(t){return this.jumpTo({zoom:t}),this},zoomTo:function(t,e){this.stop(),e=n.extend({duration:500},e),e.easing=this._updateEasing(e.duration,t,e.easing);var i=this.transform,o=i.center,a=i.zoom;return e.around?o=s.convert(e.around):e.offset&&(o=i.pointLocation(i.centerPoint.add(u.convert(e.offset)))),!1===e.animate&&(e.duration=0),this.zooming||(this.zooming=!0,this.fire("movestart")),this._ease(function(e){i.setZoomAround(r(a,t,e),o),this.fire("move").fire("zoom")},function(){this.ease=null,e.duration>=200&&(this.zooming=!1,this.fire("moveend"))},e),e.duration<200&&(clearTimeout(this._onZoomEnd),this._onZoomEnd=setTimeout(function(){this.zooming=!1,this.fire("moveend")}.bind(this),200)),this},zoomIn:function(t){return this.zoomTo(this.getZoom()+1,t),this},zoomOut:function(t){return this.zoomTo(this.getZoom()-1,t),this},getBearing:function(){return this.transform.bearing},setBearing:function(t){return this.jumpTo({bearing:t}),this},rotateTo:function(t,e){this.stop(),e=n.extend({duration:500,easing:n.ease},e);var i=this.transform,o=this.getBearing(),a=i.center;return e.around?a=s.convert(e.around):e.offset&&(a=i.pointLocation(i.centerPoint.add(u.convert(e.offset)))),t=this._normalizeBearing(t,o),this.rotating=!0,this.fire("movestart"),this._ease(function(e){i.setBearingAround(r(o,t,e),a),this.fire("move").fire("rotate")},function(){this.rotating=!1,this.fire("moveend")},e),this},resetNorth:function(t){return this.rotateTo(0,n.extend({duration:1e3},t)),this},snapToNorth:function(t){return Math.abs(this.getBearing())<this.options.bearingSnap?this.resetNorth(t):this},getPitch:function(){return this.transform.pitch},setPitch:function(t){return this.jumpTo({pitch:t}),this},fitBounds:function(t,e){e=n.extend({padding:0,offset:[0,0],maxZoom:1/0},e),t=a.convert(t);var i=u.convert(e.offset),r=this.transform,o=r.project(t.getNorthWest()),s=r.project(t.getSouthEast()),l=s.sub(o),c=(r.width-2*e.padding-2*Math.abs(i.x))/l.x,h=(r.height-2*e.padding-2*Math.abs(i.y))/l.y;return e.center=r.unproject(o.add(s).div(2)),e.zoom=Math.min(r.scaleZoom(r.scale*Math.min(c,h)),e.maxZoom),e.bearing=0,e.linear?this.easeTo(e):this.flyTo(e)},jumpTo:function(t){this.stop();var e=this.transform,i=!1,n=!1,r=!1;return"center"in t&&(e.center=s.convert(t.center)),"zoom"in t&&e.zoom!==+t.zoom&&(i=!0,e.zoom=+t.zoom),"bearing"in t&&e.bearing!==+t.bearing&&(n=!0,e.bearing=+t.bearing),"pitch"in t&&e.pitch!==+t.pitch&&(r=!0,e.pitch=+t.pitch),this.fire("movestart").fire("move"),i&&this.fire("zoom"),n&&this.fire("rotate"),r&&this.fire("pitch"),this.fire("moveend")},easeTo:function(t){this.stop(),t=n.extend({offset:[0,0],duration:500,easing:n.ease},t);var e=this.transform,i=u.convert(t.offset).rotate(-e.angle),o=e.point,a=this.getZoom(),l=this.getBearing(),c=this.getPitch(),h="zoom"in t?+t.zoom:a,f="bearing"in t?this._normalizeBearing(t.bearing,l):l,d="pitch"in t?+t.pitch:c,p=e.zoomScale(h-a),m="center"in t?e.project(s.convert(t.center)).sub(i.div(p)):o,_=s.convert(t.around);return h!==a&&(this.zooming=!0),l!==f&&(this.rotating=!0),this.zooming&&!_&&(_=e.pointLocation(e.centerPoint.add(m.sub(o).div(1-1/p)))),this.fire("movestart"),this._ease(function(t){this.zooming?e.setZoomAround(r(a,h,t),_):e.center=e.unproject(o.add(m.sub(o).mult(t))),this.rotating&&(e.bearing=r(l,f,t)),d!==c&&(e.pitch=r(c,d,t)),this.fire("move"),this.zooming&&this.fire("zoom"),this.rotating&&this.fire("rotate")},function(){this.zooming=!1,this.rotating=!1,this.fire("moveend")},t),this},flyTo:function(t){function e(t){var e=(L*L-w*w+(t?-1:1)*T*T*S*S)/(2*(t?L:w)*T*S);return Math.log(Math.sqrt(e*e+1)-e)}function i(t){return(Math.exp(t)-Math.exp(-t))/2}function o(t){return(Math.exp(t)+Math.exp(-t))/2}function a(t){return i(t)/o(t)}this.stop(),t=n.extend({offset:[0,0],speed:1.2,curve:1.42,easing:n.ease},t);var l=this.transform,c=u.convert(t.offset),h=this.getZoom(),f=this.getBearing(),d="center"in t?s.convert(t.center):this.getCenter(),p="zoom"in t?+t.zoom:h,m="bearing"in t?this._normalizeBearing(t.bearing,f):f,_=l.zoomScale(p-h),g=l.point,v=l.project(d).sub(c.div(_)),y=l.worldSize,b=t.curve,x=t.speed,w=Math.max(l.width,l.height),L=w/_,S=v.sub(g).mag(),T=b*b,M=e(0),E=function(t){return o(M)/o(M+b*t)},P=function(t){return w*((o(M)*a(M+b*t)-i(M))/T)/S},C=(e(1)-M)/b;if(Math.abs(S)<1e-6){if(Math.abs(w-L)<1e-6)return this;var A=w>L?-1:1;C=Math.abs(Math.log(L/w))/b,P=function(){return 0},E=function(t){return Math.exp(A*b*t)}}return t.duration=1e3*C/x,this.zooming=!0,f!==m&&(this.rotating=!0),this.fire("movestart"),this._ease(function(t){var e=t*C,i=P(e);l.zoom=h+l.scaleZoom(1/E(e)),l.center=l.unproject(g.add(v.sub(g).mult(i)),y),m!==f&&(l.bearing=r(f,m,t)),this.fire("move").fire("zoom"),m!==f&&this.fire("rotate")},function(){this.zooming=!1,this.rotating=!1,this.fire("moveend")},t),this},isEasing:function(){return!!this._abortFn},stop:function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this},_ease:function(t,e,i){this._finishFn=e,this._abortFn=o.timed(function(e){t.call(this,i.easing(e)),1===e&&this._finishEase()},!1===i.animate?0:i.duration,this)},_finishEase:function(){delete this._abortFn;var t=this._finishFn;delete this._finishFn,t.call(this)},_normalizeBearing:function(t,e){t=n.wrap(t,-180,180);var i=Math.abs(t-e);return Math.abs(t-360-e)<i&&(t-=360),Math.abs(t+360-e)<i&&(t+=360),t},_updateEasing:function(t,e,i){var r;if(this.ease){var o=this.ease,s=(Date.now()-o.start)/o.duration,a=o.easing(s+.01)-o.easing(s),u=.27/Math.sqrt(a*a+1e-4)*.01,l=Math.sqrt(.0729-u*u);r=n.bezier(u,l,.25,1)}else r=i?n.bezier.apply(n,i):n.ease;return this.ease={start:(new Date).getTime(),to:Math.pow(2,e),duration:t,easing:r},r}})},{"../geo/lng_lat":20,"../geo/lng_lat_bounds":21,"../util/browser":95,"../util/interpolate":102,"../util/util":106,"point-geometry":137}],79:[function(t,e,i){function n(){}var r=t("./control"),o=t("../../util/dom"),s=t("../../util/util");e.exports=n,n.prototype=s.inherit(r,{options:{position:"bottom-right"},onAdd:function(t){var e=this._container=o.create("div","mapboxgl-ctrl-attrib",t.getContainer());return this._update(),t.on("source.load",this._update.bind(this)),t.on("source.change",this._update.bind(this)),t.on("source.remove",this._update.bind(this)),t.on("moveend",this._updateEditLink.bind(this)),e},_update:function(){var t=[];if(this._map.style)for(var e in this._map.style.sources){var i=this._map.style.sources[e];i.attribution&&t.indexOf(i.attribution)<0&&t.push(i.attribution)}this._container.innerHTML=t.join(" | "),this._editLink=this._container.getElementsByClassName("mapbox-improve-map")[0],this._updateEditLink()},_updateEditLink:function(){if(this._editLink){var t=this._map.getCenter();this._editLink.href="https://www.mapbox.com/map-feedback/#/"+t.lng+"/"+t.lat+"/"+Math.round(this._map.getZoom()+1)}}})},{"../../util/dom":98,"../../util/util":106,"./control":80}],80:[function(t,e,i){function n(){}e.exports=n,n.prototype={addTo:function(t){this._map=t;var e=this._container=this.onAdd(t);if(this.options&&this.options.position){var i=this.options.position,n=t._controlCorners[i];e.className+=" mapboxgl-ctrl",-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e)}return this},remove:function(){return this._container.parentNode.removeChild(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this}}},{}],81:[function(t,e,i){function n(t){s.setOptions(this,t)}var r=t("./control"),o=t("../../util/dom"),s=t("../../util/util");e.exports=n,n.prototype=s.inherit(r,{options:{position:"top-right"},onAdd:function(t){var e="mapboxgl-ctrl",i=this._container=o.create("div",e+"-group",t.getContainer());this._zoomInButton=this._createButton(e+"-icon "+e+"-zoom-in",t.zoomIn.bind(t)),this._zoomOutButton=this._createButton(e+"-icon "+e+"-zoom-out",t.zoomOut.bind(t)),this._compass=this._createButton(e+"-compass",t.resetNorth.bind(t));var n=this._compassCanvas=o.create("canvas",e+"-compass-canvas",this._compass);return n.style.cssText="width:30px; height:30px;",n.width=52,n.height=52,this._compass.addEventListener("mousedown",this._onCompassDown.bind(this)),this._onCompassMove=this._onCompassMove.bind(this),this._onCompassUp=this._onCompassUp.bind(this),this._compassCtx=n.getContext("2d"),t.on("rotate",this._drawNorth.bind(this)),this._drawNorth(),i},_onCompassDown:function(t){o.disableDrag(),document.addEventListener("mousemove",this._onCompassMove),document.addEventListener("mouseup",this._onCompassUp),this._prevX=t.screenX,t.stopPropagation()},_onCompassMove:function(t){var e=t.screenX,i=2>e?-5:e>window.screen.width-2?5:(e-this._prevX)/4;this._map.setBearing(this._map.getBearing()-i),this._prevX=t.screenX,this._moved=!0,t.preventDefault()},_onCompassUp:function(){document.removeEventListener("mousemove",this._onCompassMove),document.removeEventListener("mouseup",this._onCompassUp),o.enableDrag(),this._moved&&(this._moved=!1,o.suppressClick()),this._map.snapToNorth()},_createButton:function(t,e){var i=o.create("button",t,this._container);return i.addEventListener("click",function(){e()}),i},_drawNorth:function(){var t=this._map.transform.angle+Math.PI/2,e=this._compassCtx;this._compassCanvas.width=this._compassCanvas.width,e.translate(26,26),e.rotate(t),e.beginPath(),e.fillStyle="#000",e.lineTo(0,-8),e.lineTo(-20,0),e.lineTo(0,8),e.fill(),e.beginPath(),e.fillStyle="#bbb",e.moveTo(0,0),e.lineTo(0,8),e.lineTo(20,0),e.lineTo(0,-8),e.fill(),e.beginPath(),e.strokeStyle="#fff",e.lineWidth=4,e.moveTo(0,-8),e.lineTo(0,8),e.stroke()}})},{"../../util/dom":98,"../../util/util":106,"./control":80}],82:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),s.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../geo/lng_lat_bounds"),s=t("../../util/util");e.exports=n,n.prototype={enable:function(){this._el.addEventListener("mousedown",this._onMouseDown,!1)},disable:function(){this._el.removeEventListener("mousedown",this._onMouseDown)},_onMouseDown:function(t){(t.shiftKey||1===t.which&&1===t.button)&&(document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("keydown",this._onKeyDown,!1),document.addEventListener("mouseup",this._onMouseUp,!1),this._startPos=r.mousePos(this._el,t),this.active=!0)},_onMouseMove:function(t){var e=this._startPos,i=r.mousePos(this._el,t);this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),r.disableDrag(),this._map.fire("boxzoomstart"));var n=Math.min(e.x,i.x),o=Math.max(e.x,i.x),s=Math.min(e.y,i.y),a=Math.max(e.y,i.y);r.setTransform(this._box,"translate("+n+"px,"+s+"px)"),this._box.style.width=o-n+"px",this._box.style.height=a-s+"px"},_onMouseUp:function(t){var e=this._startPos,i=r.mousePos(this._el,t),n=new o(this._map.unproject(e),this._map.unproject(i));this._finish(),this._map.fitBounds(n,{linear:!0}).fire("boxzoomend",{boxZoomBounds:n})},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._map.fire("boxzoomcancel"))},_finish:function(){this._box&&(this.active=!1,document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("keydown",this._onKeyDown,!1),document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box.parentNode.removeChild(this._box),this._box=null,r.enableDrag())}}},{"../../geo/lng_lat_bounds":21,"../../util/dom":98,"../../util/util":106}],83:[function(t,e,i){function n(t){this._map=t,this._onDblClick=this._onDblClick.bind(this)}e.exports=n,n.prototype={enable:function(){this._map.on("dblclick",this._onDblClick)},disable:function(){this._map.off("dblclick",this._onDblClick)},_onDblClick:function(t){this._map.zoomTo(Math.round(this._map.getZoom())+1,{around:t.lngLat})}}},{}],84:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),o.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/util");e.exports=n;var s=o.bezier(0,0,.25,1);n.prototype={enable:function(){this._el.addEventListener("mousedown",this._onDown,!1),this._el.addEventListener("touchstart",this._onDown,!1)},disable:function(){this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown)},_onDown:function(t){this._startPos=this._pos=r.mousePos(this._el,t),this._inertia=[[Date.now(),this._pos]],t.touches?1===t.touches.length&&(document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onTouchEnd,!1)):(document.addEventListener("mousemove",this._onMove,!1),document.addEventListener("mouseup",this._onMouseUp,!1))},_onMove:function(t){var e=this._map;if(!(e.boxZoom.active||e.dragRotate.active||t.touches&&t.touches.length>1)){this.active=!0;var i=r.mousePos(this._el,t),n=this._inertia,o=Date.now();for(n.push([o,i]);n.length>2&&o-n[0][0]>50;)n.shift();e.stop(),e.transform.setLocationAtPoint(e.transform.pointLocation(this._pos),i),e.fire("move"),this._pos=i,t.preventDefault()}},_onUp:function(){var t=this._inertia;if(t.length<2)return void this._map.fire("moveend");var e=t[t.length-1],i=t[0],n=e[1].sub(i[1]),r=(e[0]-i[0])/1e3,o=n.mult(.25/r),a=o.mag();a>3e3&&(a=3e3,o._unit()._mult(a));var u=a/1e3,l=o.mult(-u/2);this._map.panBy(l,{duration:1e3*u,easing:s,noMoveStart:!0}),this.active=!1},_onMouseUp:function(){this._onUp(),document.removeEventListener("mousemove",this._onMove,!1),document.removeEventListener("mouseup",this._onMouseUp,!1)},_onTouchEnd:function(){this._onUp(),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd)}}},{"../../util/dom":98,"../../util/util":106}],85:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),s.bindHandlers(this)}var r=t("../../util/dom"),o=t("point-geometry"),s=t("../../util/util");e.exports=n,n.prototype={enable:function(){this._el.addEventListener("contextmenu",this._onContextMenu,!1)},disable:function(){this._el.removeEventListener("contextmenu",this._onContextMenu)},_onContextMenu:function(t){this._map.stop(),this._startPos=this._pos=r.mousePos(this._el,t),document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("mouseup",this._onMouseUp,!1),t.preventDefault()},_onMouseMove:function(t){var e=this._startPos,i=this._pos,n=r.mousePos(this._el,t),s=this._map,a=s.transform.centerPoint,u=e.sub(a),l=u.mag();this.active=!0,s.rotating||(s.fire("movestart"),s.rotating=!0),200>l&&(a=e.add(new o(-200,0)._rotate(u.angle())));var c=i.sub(a).angleWith(n.sub(a))/Math.PI*180;s.transform.bearing=s.getBearing()-c,s.fire("move").fire("rotate"),clearTimeout(this._timeout),
this._timeout=setTimeout(this._onTimeout,200),this._pos=n},_onTimeout:function(){var t=this._map;t.rotating=!1,t.snapToNorth(),t.rotating||(t._rerender(),t.fire("moveend"))},_onMouseUp:function(){this.active=!1,document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("mouseup",this._onMouseUp,!1)}}},{"../../util/dom":98,"../../util/util":106,"point-geometry":137}],86:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),this._onKeyDown=this._onKeyDown.bind(this)}e.exports=n,n.prototype={enable:function(){this._el.addEventListener("keydown",this._onKeyDown,!1)},disable:function(){this._el.removeEventListener("keydown",this._onKeyDown)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=this._map;switch(t.keyCode){case 61:case 107:case 171:case 187:e.zoomTo(Math.round(e.getZoom())+(t.shiftKey?2:1));break;case 189:case 109:case 173:e.zoomTo(Math.round(e.getZoom())-(t.shiftKey?2:1));break;case 37:t.shiftKey?e.setBearing(e.getBearing()-2):e.panBy([-80,0]);break;case 39:t.shiftKey?e.setBearing(e.getBearing()+2):e.panBy([80,0]);break;case 38:e.panBy([0,-80]);break;case 40:e.panBy([0,80])}}}}},{}],87:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),o.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/util");e.exports=n,n.prototype={enable:function(){this._el.addEventListener("touchstart",this._onStart,!1)},disable:function(){this._el.removeEventListener("touchstart",this._onStart)},_onStart:function(t){if(2===t.touches.length){var e=r.mousePos(this._el,t.touches[0]),i=r.mousePos(this._el,t.touches[1]);this._startVec=e.sub(i),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onEnd,!1)}},_onMove:function(t){if(2===t.touches.length){var e=r.mousePos(this._el,t.touches[0]),i=r.mousePos(this._el,t.touches[1]),n=e.add(i).div(2),o=e.sub(i),s=o.mag()/this._startVec.mag(),a=180*o.angleWith(this._startVec)/Math.PI,u=this._map;u.easeTo({zoom:u.transform.scaleZoom(this._startScale*s),bearing:this._startBearing+a,duration:0,around:u.unproject(n)}),t.preventDefault()}},_onEnd:function(){this._map.snapToNorth(),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onEnd)}}},{"../../util/dom":98,"../../util/util":106}],88:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),s.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/browser"),s=t("../../util/util");e.exports=n;var a="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",u=-1!==a.indexOf("firefox"),l=-1!==a.indexOf("safari")&&-1===a.indexOf("chrom");n.prototype={enable:function(){this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1)},disable:function(){this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel)},_onWheel:function(t){var e;"wheel"===t.type?(e=t.deltaY,u&&t.deltaMode===window.WheelEvent.DOM_DELTA_PIXEL&&(e/=o.devicePixelRatio),t.deltaMode===window.WheelEvent.DOM_DELTA_LINE&&(e*=40)):"mousewheel"===t.type&&(e=-t.wheelDeltaY,l&&(e/=3));var i=(window.performance||Date).now(),n=i-(this._time||0);this._pos=r.mousePos(this._el,t),this._time=i,0!==e&&e%4.000244140625==0?(this._type="wheel",e=Math.floor(e/4)):0!==e&&Math.abs(e)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(n*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&this._zoom(-e),t.preventDefault()},_onTimeout:function(){this._type="wheel",this._zoom(-this._lastValue)},_zoom:function(t){var e=this._map,i=2/(1+Math.exp(-Math.abs(t/100)));0>t&&0!==i&&(i=1/i);var n=e.ease?e.ease.to:e.transform.scale,r=e.transform.scaleZoom(n*i);e.zoomTo(r,{duration:0,around:e.unproject(this._pos)})}}},{"../../util/browser":95,"../../util/dom":98,"../../util/util":106}],89:[function(t,e,i){function n(){r.bindAll(["_onHashChange","_updateHash"],this)}e.exports=n;var r=t("../util/util");n.prototype={addTo:function(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},remove:function(){return window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},_onHashChange:function(){var t=location.hash.replace("#","").split("/");return t.length>=3&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0)}),!0)},_updateHash:function(){var t=this._map.getCenter(),e=this._map.getZoom(),i=this._map.getBearing(),n=Math.max(0,Math.ceil(Math.log(e)/Math.LN2)),r="#"+Math.round(100*e)/100+"/"+t.lat.toFixed(n)+"/"+t.lng.toFixed(n)+(i?"/"+Math.round(10*i)/10:"");window.history.replaceState("","",r)}}},{"../util/util":106}],90:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer();for(var e in r)t[e]=new r[e](t);s.bindHandlers(this)}var r={scrollZoom:t("./handler/scroll_zoom"),boxZoom:t("./handler/box_zoom"),dragRotate:t("./handler/drag_rotate"),dragPan:t("./handler/drag_pan"),keyboard:t("./handler/keyboard"),doubleClickZoom:t("./handler/dblclick_zoom"),pinch:t("./handler/pinch")},o=t("../util/dom"),s=t("../util/util");e.exports=n,n.prototype={enable:function(){var t=this._map.options,e=this._el;for(var i in r)t[i]&&this._map[i].enable();e.addEventListener("mousedown",this._onMouseDown,!1),e.addEventListener("mouseup",this._onMouseUp,!1),e.addEventListener("touchstart",this._onTouchStart,!1),e.addEventListener("click",this._onClick,!1),e.addEventListener("mousemove",this._onMouseMove,!1),e.addEventListener("dblclick",this._onDblClick,!1),e.addEventListener("contextmenu",this._onContextMenu,!1)},disable:function(){var t=this._map.options,e=this._el;for(var i in r)t[i]&&this._map[i].disable();e.removeEventListener("mousedown",this._onMouseDown),e.removeEventListener("mouseup",this._onMouseUp),e.removeEventListener("touchstart",this._onTouchStart),e.removeEventListener("click",this._onClick),e.removeEventListener("mousemove",this._onMouseMove),e.removeEventListener("dblclick",this._onDblClick),e.removeEventListener("contextmenu",this._onContextMenu)},_onMouseDown:function(t){this._startPos=o.mousePos(this._el,t)},_onMouseUp:function(t){!this._contextMenuFired||this._map.dragRotate.active||this._map.dragPan.active||this._fireEvent("contextmenu",t),this._contextMenuFired=null},_onTouchStart:function(t){!t.touches||t.touches.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._fireEvent("dblclick",t)):this._tapped=setTimeout(this._onTimeout,300))},_onTimeout:function(){this._tapped=null},_onMouseMove:function(t){var e=this._map,i=this._el;if(!e.dragPan.active&&!e.dragRotate.active){for(var n=t.toElement||t.target;n&&n!==i;)n=n.parentNode;n===i&&this._fireEvent("mousemove",t)}},_onClick:function(t){o.mousePos(this._el,t).equals(this._startPos)&&this._fireEvent("click",t)},_onDblClick:function(t){this._fireEvent("dblclick",t),t.preventDefault()},_onContextMenu:function(){this._contextMenuFired=!0},_fireEvent:function(t,e){var i=o.mousePos(this._el,e);this._map.fire(t,{lngLat:this._map.unproject(i),point:i,originalEvent:e})}}},{"../util/dom":98,"../util/util":106,"./handler/box_zoom":82,"./handler/dblclick_zoom":83,"./handler/drag_pan":84,"./handler/drag_rotate":85,"./handler/keyboard":86,"./handler/pinch":87,"./handler/scroll_zoom":88}],91:[function(t,e,i){var n=t("../util/canvas"),r=t("../util/util"),o=t("../util/browser"),s=t("../util/evented"),a=t("../util/dom"),u=t("../style/style"),l=t("../style/animation_loop"),c=t("../render/painter"),h=t("../geo/transform"),f=t("./hash"),d=t("./interaction"),p=t("./camera"),m=t("../geo/lng_lat"),_=t("../geo/lng_lat_bounds"),g=t("point-geometry"),v=t("./control/attribution"),y=e.exports=function(t){if(t=this.options=r.inherit(this.options,t),this.animationLoop=new l,this.transform=new h(t.minZoom,t.maxZoom),t.maxBounds){var e=_.convert(t.maxBounds);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()]}r.bindAll(["_forwardStyleEvent","_forwardSourceEvent","_forwardLayerEvent","_forwardTileEvent","_onStyleLoad","_onStyleChange","_onSourceAdd","_onSourceRemove","_onSourceUpdate","_onWindowResize","onError","update","render"],this),this._setupContainer(),this._setupPainter(),this.on("move",this.update),this.on("zoom",this.update.bind(this,!0)),this.on("moveend",function(){this.animationLoop.set(300),this._rerender()}.bind(this)),"undefined"!=typeof window&&window.addEventListener("resize",this._onWindowResize,!1),this.interaction=new d(this),t.interactive&&this.interaction.enable(),this._hash=t.hash&&(new f).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo(t),this.sources={},this.stacks={},this._classes={},this.resize(),t.classes&&this.setClasses(t.classes),t.style&&this.setStyle(t.style),t.attributionControl&&this.addControl(new v),this.on("style.error",this.onError),this.on("source.error",this.onError),this.on("tile.error",this.onError)};r.extend(y.prototype,s),r.extend(y.prototype,p.prototype),r.extend(y.prototype,{options:{center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:20,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,pinch:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1},addControl:function(t){return t.addTo(this),this},addClass:function(t,e){this._classes[t]||(this._classes[t]=!0,this.style&&this.style._cascade(this._classes,e))},removeClass:function(t,e){this._classes[t]&&(delete this._classes[t],this.style&&this.style._cascade(this._classes,e))},setClasses:function(t,e){this._classes={};for(var i=0;i<t.length;i++)this._classes[t[i]]=!0;this.style&&this.style._cascade(this._classes,e)},hasClass:function(t){return!!this._classes[t]},getClasses:function(){return Object.keys(this._classes)},resize:function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),this._canvas.resize(t,e),this.transform.width=t,this.transform.height=e,this.transform._constrain(),this.painter.resize(t,e),this.fire("movestart").fire("move").fire("resize").fire("moveend")},getBounds:function(){return new _(this.transform.pointLocation(new g(0,0)),this.transform.pointLocation(this.transform.size))},project:function(t){return this.transform.locationPoint(m.convert(t))},unproject:function(t){return this.transform.pointLocation(g.convert(t))},featuresAt:function(t,e,i){var n=this.unproject(t).wrap(),r=this.transform.locationCoordinate(n);return this.style.featuresAt(r,e,i),this},featuresIn:function(t,e,i){return void 0===i&&(i=e,e=t,t=[g.convert([0,0]),g.convert([this.transform.width,this.transform.height])]),t=t.map(g.convert.bind(g)),t=[new g(Math.min(t[0].x,t[1].x),Math.min(t[0].y,t[1].y)),new g(Math.max(t[0].x,t[1].x),Math.max(t[0].y,t[1].y))].map(this.transform.pointCoordinate.bind(this.transform)),this.style.featuresIn(t,e,i),this},batch:function(t){this.style.batch(t),this.style._cascade(this._classes),this.update(!0)},setStyle:function(t){return this.style&&(this.style.off("load",this._onStyleLoad).off("error",this._forwardStyleEvent).off("change",this._onStyleChange).off("source.add",this._onSourceAdd).off("source.remove",this._onSourceRemove).off("source.load",this._onSourceUpdate).off("source.error",this._forwardSourceEvent).off("source.change",this._onSourceUpdate).off("layer.add",this._forwardLayerEvent).off("layer.remove",this._forwardLayerEvent).off("tile.add",this._forwardTileEvent).off("tile.remove",this._forwardTileEvent).off("tile.load",this.update).off("tile.error",this._forwardTileEvent).off("tile.stats",this._forwardTileEvent)._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement)),t?(this.style=t instanceof u?t:new u(t,this.animationLoop),this.style.on("load",this._onStyleLoad).on("error",this._forwardStyleEvent).on("change",this._onStyleChange).on("source.add",this._onSourceAdd).on("source.remove",this._onSourceRemove).on("source.load",this._onSourceUpdate).on("source.error",this._forwardSourceEvent).on("source.change",this._onSourceUpdate).on("layer.add",this._forwardLayerEvent).on("layer.remove",this._forwardLayerEvent).on("tile.add",this._forwardTileEvent).on("tile.remove",this._forwardTileEvent).on("tile.load",this.update).on("tile.error",this._forwardTileEvent).on("tile.stats",this._forwardTileEvent),this.on("rotate",this.style._redoPlacement),this.on("pitch",this.style._redoPlacement),this):(this.style=null,this)},addSource:function(t,e){return this.style.addSource(t,e),this},removeSource:function(t){return this.style.removeSource(t),this},getSource:function(t){return this.style.getSource(t)},addLayer:function(t,e){return this.style.addLayer(t,e),this.style._cascade(this._classes),this},removeLayer:function(t){return this.style.removeLayer(t),this.style._cascade(this._classes),this},setFilter:function(t,e){return this.style.setFilter(t,e),this},setLayerZoomRange:function(t,e,i){return this.style.setLayerZoomRange(t,e,i),this},getFilter:function(t){return this.style.getFilter(t)},setPaintProperty:function(t,e,i,n){return this.batch(function(r){r.setPaintProperty(t,e,i,n)}),this},getPaintProperty:function(t,e,i){return this.style.getPaintProperty(t,e,i)},setLayoutProperty:function(t,e,i){return this.batch(function(n){n.setLayoutProperty(t,e,i)}),this},getLayoutProperty:function(t,e){return this.style.getLayoutProperty(t,e)},getContainer:function(){return this._container},getCanvasContainer:function(){return this._canvasContainer},getCanvas:function(){return this._canvas.getElement()},_setupContainer:function(){var t=this.options.container,e=this._container="string"==typeof t?document.getElementById(t):t;e.classList.add("mapboxgl-map");var i=this._canvasContainer=a.create("div","mapboxgl-canvas-container",e);this.options.interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=new n(this,i);var r=a.create("div","mapboxgl-control-container",e),o=this._controlCorners={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=a.create("div","mapboxgl-ctrl-"+t,r)})},_setupPainter:function(){var t=this._canvas.getWebGLContext({failIfMajorPerformanceCaveat:this.options.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.options.preserveDrawingBuffer});return t?void(this.painter=new c(t,this.transform)):void console.error("Failed to initialize WebGL")},_contextLost:function(t){t.preventDefault(),this._frameId&&o.cancelFrame(this._frameId)},_contextRestored:function(){this._setupPainter(),this.resize(),this.update()},loaded:function(){return!(this._styleDirty||this._sourcesDirty||this.style&&!this.style.loaded())},update:function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender(),this):this},render:function(){return this.style&&this._styleDirty&&(this._styleDirty=!1,this.style._recalculate(this.transform.zoom)),this.style&&this._sourcesDirty&&!this._sourcesDirtyTimeout&&(this._sourcesDirty=!1,this._sourcesDirtyTimeout=setTimeout(function(){this._sourcesDirtyTimeout=null}.bind(this),50),this.style._updateSources(this.transform)),this.painter.render(this.style,{debug:this.debug,vertices:this.vertices,rotating:this.rotating,zooming:this.zooming}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this._frameId=null,this.animationLoop.stopped()||(this._styleDirty=!0),(this._sourcesDirty||this._repaint||!this.animationLoop.stopped())&&this._rerender(),this},remove:function(){return this._hash&&this._hash.remove(),o.cancelFrame(this._frameId),clearTimeout(this._sourcesDirtyTimeout),this.setStyle(null),"undefined"!=typeof window&&window.removeEventListener("resize",this._onWindowResize,!1),this},onError:function(t){console.error(t.error)},_rerender:function(){this.style&&!this._frameId&&(this._frameId=o.frame(this.render))},_forwardStyleEvent:function(t){this.fire("style."+t.type,r.extend({style:t.target},t))},_forwardSourceEvent:function(t){this.fire(t.type,r.extend({style:t.target},t))},_forwardLayerEvent:function(t){this.fire(t.type,r.extend({style:t.target},t))},_forwardTileEvent:function(t){this.fire(t.type,r.extend({style:t.target},t))},_onStyleLoad:function(t){var e=new h,i=this.transform;i.center.lng===e.center.lng&&i.center.lat===e.center.lat&&i.zoom===e.zoom&&i.bearing===e.bearing&&i.pitch===e.pitch&&this.jumpTo(this.style.stylesheet),this.style._cascade(this._classes,{transition:!1}),this._forwardStyleEvent(t)},_onStyleChange:function(t){this.update(!0),this._forwardStyleEvent(t)},_onSourceAdd:function(t){var e=t.source;e.onAdd&&e.onAdd(this),this._forwardSourceEvent(t)},_onSourceRemove:function(t){var e=t.source;e.onRemove&&e.onRemove(this),this._forwardSourceEvent(t)},_onSourceUpdate:function(t){this.update(),this._forwardSourceEvent(t)},_onWindowResize:function(){this.stop().resize().update()}}),r.extendAll(y.prototype,{_debug:!1,get debug(){return this._debug},set debug(t){this._debug=t,this.update()},_collisionDebug:!1,get collisionDebug(){return this._collisionDebug},set collisionDebug(t){this._collisionDebug=t,this.style._redoPlacement()},_repaint:!1,get repaint(){return this._repaint},set repaint(t){this._repaint=t,this.update()},_vertices:!1,get vertices(){return this._vertices},set vertices(t){this._vertices=t,this.update()}})},{"../geo/lng_lat":20,"../geo/lng_lat_bounds":21,"../geo/transform":22,"../render/painter":37,"../style/animation_loop":51,"../style/style":56,"../util/browser":95,"../util/canvas":96,"../util/dom":98,"../util/evented":100,"../util/util":106,"./camera":78,"./control/attribution":79,"./hash":89,"./interaction":90,"point-geometry":137}],92:[function(t,e,i){function n(t){r.setOptions(this,t),r.bindAll(["_updatePosition","_onClickClose"],this)}e.exports=n;var r=t("../util/util"),o=t("../util/evented"),s=t("../util/dom"),a=t("../geo/lng_lat");n.prototype=r.inherit(o,{options:{closeButton:!0,closeOnClick:!0},addTo:function(t){return this._map=t,this._map.on("move",this._updatePosition),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},remove:function(){return this._container&&this._container.parentNode.removeChild(this._container),this._map&&(this._map.off("move",this._updatePosition),this._map.off("click",this._onClickClose),delete this._map),this},getLngLat:function(){return this._lngLat},setLngLat:function(t){return this._lngLat=a.convert(t),this._update(),this},setText:function(t){return this._content=document.createTextNode(t),this._updateContent(),this},setHTML:function(t){this._content=document.createDocumentFragment();var e,i=document.createElement("body");for(i.innerHTML=t;e=i.firstChild;)this._content.appendChild(e);return this._updateContent(),this},_update:function(){this._map&&(this._container||(this._container=s.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=s.create("div","mapboxgl-popup-tip",this._container),this._wrapper=s.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=s.create("button","mapboxgl-popup-close-button",this._wrapper),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))),this._updateContent(),this._updatePosition())},_updateContent:function(){if(this._content&&this._container){for(var t=this._wrapper;t.hasChildNodes();)t.removeChild(t.firstChild);this.options.closeButton&&t.appendChild(this._closeButton),t.appendChild(this._content)}},_updatePosition:function(){if(this._lngLat&&this._container){var t=this._map.project(this._lngLat).round(),e=this.options.anchor;if(!e){var i=this._container.offsetWidth,n=this._container.offsetHeight;e=t.y<n?["top"]:t.y>this._map.transform.height-n?["bottom"]:[],t.x<i/2?e.push("left"):t.x>this._map.transform.width-i/2&&e.push("right"),e=0===e.length?"bottom":e.join("-"),this.options.anchor=e}var r={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},o=this._container.classList;for(var a in r)o.remove("mapboxgl-popup-anchor-"+a);o.add("mapboxgl-popup-anchor-"+e),s.setTransform(this._container,r[e]+" translate("+t.x+"px,"+t.y+"px)")}},_onClickClose:function(){this.remove()}})},{"../geo/lng_lat":20,"../util/dom":98,"../util/evented":100,"../util/util":106}],93:[function(t,e,i){function n(t,e){this.target=t,this.parent=e,this.callbacks={},this.callbackID=0,this.receive=this.receive.bind(this),this.target.addEventListener("message",this.receive,!1)}e.exports=n,n.prototype.receive=function(t){var e,i=t.data;if("<response>"===i.type)e=this.callbacks[i.id],delete this.callbacks[i.id],e(i.error||null,i.data);else if(void 0!==i.id){var n=i.id;this.parent[i.type](i.data,function(t,e,i){this.postMessage({type:"<response>",id:String(n),error:t?String(t):null,data:e},i)}.bind(this))}else this.parent[i.type](i.data)},n.prototype.send=function(t,e,i,n){var r=null;i&&(this.callbacks[r=this.callbackID++]=i),this.postMessage({type:t,id:String(r),data:e},n)},n.prototype.postMessage=function(t,e){try{this.target.postMessage(t,e)}catch(e){this.target.postMessage(t)}}},{}],94:[function(t,e,i){function n(t){var e=document.createElement("a");return e.href=t,e.protocol===document.location.protocol&&e.host===document.location.host}i.getJSON=function(t,e){var i=new XMLHttpRequest;return i.open("GET",t,!0),i.setRequestHeader("Accept","application/json"),i.onerror=function(t){e(t)},i.onload=function(){if(i.status>=200&&i.status<300&&i.response){var t;try{t=JSON.parse(i.response)}catch(t){return e(t)}e(null,t)}else e(new Error(i.statusText))},i.send(),i},i.getArrayBuffer=function(t,e){var i=new XMLHttpRequest;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onerror=function(t){e(t)},i.onload=function(){i.status>=200&&i.status<300&&i.response?e(null,i.response):e(new Error(i.statusText))},i.send(),i},i.getImage=function(t,e){return i.getArrayBuffer(t,function(t,i){t&&e(t);var n=new Image;n.onload=function(){e(null,n),(window.URL||window.webkitURL).revokeObjectURL(n.src)};var r=new Blob([new Uint8Array(i)],{type:"image/png"});return n.src=(window.URL||window.webkitURL).createObjectURL(r),n.getData=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return t.width=n.width,t.height=n.height,e.drawImage(n,0,0),e.getImageData(0,0,n.width,n.height).data},n})},i.getVideo=function(t,e){var i=document.createElement("video");i.onloadstart=function(){e(null,i)};for(var r=0;r<t.length;r++){var o=document.createElement("source");n(t[r])||(i.crossOrigin="Anonymous"),o.src=t[r],i.appendChild(o)}return i.getData=function(){return i},i}},{}],95:[function(t,e,i){var n=t("./canvas"),r=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;i.frame=function(t){return r(t)};var o=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;i.cancelFrame=function(t){o(t)},i.timed=function(t,e,n){function r(a){o||(window.performance||(a=Date.now()),a>=s+e?t.call(n,1):(t.call(n,(a-s)/e),i.frame(r)))}if(!e)return t.call(n,1),null;var o=!1,s=window.performance?window.performance.now():Date.now();return i.frame(r),function(){o=!0}},i.supported=function(t){for(var e=([function(){return"undefined"!=typeof window},function(){return"undefined"!=typeof document},function(){return!!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)},function(){return!(!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions))},function(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON},function(){return(new n).supportsWebGLContext(t&&t.failIfMajorPerformanceCaveat||!1)},function(){return"Worker"in window}]),i=0;i<e.length;i++)if(!e[i]())return!1;return!0},i.hardwareConcurrency=navigator.hardwareConcurrency||8,Object.defineProperty(i,"devicePixelRatio",{get:function(){return window.devicePixelRatio}})},{"./canvas":96}],96:[function(t,e,i){function n(t,e){this.canvas=document.createElement("canvas"),t&&e&&(this.canvas.style.position="absolute",this.canvas.classList.add("mapboxgl-canvas"),this.canvas.addEventListener("webglcontextlost",t._contextLost.bind(t),!1),this.canvas.addEventListener("webglcontextrestored",t._contextRestored.bind(t),!1),this.canvas.setAttribute("tabindex",0),e.appendChild(this.canvas))}var r=t("../util");e.exports=n,n.prototype.resize=function(t,e){var i=window.devicePixelRatio||1;this.canvas.width=i*t,this.canvas.height=i*e,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"};var o={antialias:!1,alpha:!0,stencil:!0,depth:!1};n.prototype.getWebGLContext=function(t){return t=r.extend({},t,o),this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t)},n.prototype.supportsWebGLContext=function(t){var e=r.extend({failIfMajorPerformanceCaveat:t},o);return"probablySupportsContext"in this.canvas?this.canvas.probablySupportsContext("webgl",e)||this.canvas.probablySupportsContext("experimental-webgl",e):"supportsContext"in this.canvas?this.canvas.supportsContext("webgl",e)||this.canvas.supportsContext("experimental-webgl",e):!!window.WebGLRenderingContext&&!!this.getWebGLContext(t)},n.prototype.getElement=function(){return this.canvas}},{"../util":106}],97:[function(t,e,i){function n(e,i){this.actors=[],this.currentActor=0;for(var n=0;e>n;n++){var s=new o(t("../../source/worker")),a=new r(s,i);a.name="Worker "+n,this.actors.push(a)}}var r=t("../actor"),o=t("webworkify");e.exports=n,n.prototype={broadcast:function(t,e){for(var i=0;i<this.actors.length;i++)this.actors[i].send(t,e)},send:function(t,e,i,n,r){return("number"!=typeof n||isNaN(n))&&(n=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[n].send(t,e,i,r),n},remove:function(){for(var t=0;t<this.actors.length;t++)this.actors[t].target.terminate();this.actors=[]}}},{"../../source/worker":49,"../actor":93,webworkify:149}],98:[function(t,e,i){function n(t){for(var e=0;e<t.length;e++)if(t[e]in a)return t[e]}function r(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",r,!0)}var o=t("point-geometry");i.create=function(t,e,i){var n=document.createElement(t);return e&&(n.className=e),i&&i.appendChild(n),n};var s,a=document.documentElement.style,u=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);i.disableDrag=function(){u&&(s=a[u],a[u]="none")},i.enableDrag=function(){u&&(a[u]=s)};var l=n(["transform","WebkitTransform"]);i.setTransform=function(t,e){t.style[l]=e},i.suppressClick=function(){window.addEventListener("click",r,!0),window.setTimeout(function(){window.removeEventListener("click",r,!0)},0)},i.mousePos=function(t,e){var i=t.getBoundingClientRect();return e=e.touches?e.touches[0]:e,new o(e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop)}},{"point-geometry":137}],99:[function(t,e,i){e.exports={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0}},{}],100:[function(t,e,i){var n=t("./util"),r={on:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this},off:function(t,e){if(!t)return delete this._events,this;if(!this.listens(t))return this;if(e){var i=this._events[t].indexOf(e);i>=0&&this._events[t].splice(i,1),this._events[t].length||delete this._events[t]}else delete this._events[t];return this},once:function(t,e){var i=function(n){this.off(t,i),e.call(this,n)}.bind(this);return this.on(t,i),this},fire:function(t,e){if(!this.listens(t))return this;e=n.extend({},e),n.extend(e,{type:t,target:this});for(var i=this._events[t].slice(),r=0;r<i.length;r++)i[r].call(this,e);return this},listens:function(t){return!(!this._events||!this._events[t])}};e.exports=r},{"./util":106}],101:[function(t,e,i){function n(t,e){this.stacks=t.readFields(r,[],e)}function r(t,e,i){if(1===t){var n=i.readMessage(o,{glyphs:{}});e.push(n)}}function o(t,e,i){if(1===t)e.name=i.readString();else if(2===t)e.range=i.readString();else if(3===t){var n=i.readMessage(s,{});e.glyphs[n.id]=n}}function s(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}e.exports=n},{}],102:[function(t,e,i){function n(t,e,i){return t*(1-i)+e*i}e.exports=n,n.number=n,n.vec2=function(t,e,i){return[n(t[0],e[0],i),n(t[1],e[1],i)]},n.color=function(t,e,i){return[n(t[0],e[0],i),n(t[1],e[1],i),n(t[2],e[2],i),n(t[3],e[3],i)]},n.array=function(t,e,i){return t.map(function(t,r){return n(t,e[r],i)})}},{}],103:[function(t,e,i){function n(t,e,i){if(!(i=i||r.ACCESS_TOKEN)&&r.REQUIRE_ACCESS_TOKEN)throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/developers/api/#access-tokens");if(t=t.replace(/^mapbox:\/\//,r.API_URL+e),t+=-1!==t.indexOf("?")?"&access_token=":"?access_token=",r.REQUIRE_ACCESS_TOKEN){if("s"===i[0])throw new Error("Use a public access token (pk.*) with Mapbox GL JS, not a secret access token (sk.*). See https://www.mapbox.com/developers/api/#access-tokens");t+=i}return t}var r=t("./config"),o=t("./browser");e.exports.normalizeStyleURL=function(t,e){if(!t.match(/^mapbox:\/\/styles\//))return t;var i=t.split("/");return n("mapbox://"+i[3]+"/"+i[4]+(i[5]?"/draft":""),"/styles/v1/",e)},e.exports.normalizeSourceURL=function(t,e){return t.match(/^mapbox:\/\//)?n(t+".json","/v4/",e)+"&secure":t},e.exports.normalizeGlyphsURL=function(t,e){return t.match(/^mapbox:\/\//)?n("mapbox://"+t.split("/")[3]+"/{fontstack}/{range}.pbf","/fonts/v1/",e):t},e.exports.normalizeSpriteURL=function(t,e,i,r){if(!t.match(/^mapbox:\/\/sprites\//))return t+e+i;var o=t.split("/");return n("mapbox://"+o[3]+"/"+o[4]+(o[5]?"/draft":"")+"/sprite"+e+i,"/styles/v1/",r)},e.exports.normalizeTileURL=function(t,e){return e&&e.match(/^mapbox:\/\//)?t.replace(/\.((?:png|jpg)\d*)(?=$|\?)/,o.devicePixelRatio>=2?"@2x.$1":".$1"):t}},{"./browser":95,"./config":99}],104:[function(t,e,i){function n(t,e){this.max=t,this.onRemove=e,this.reset()}e.exports=n,n.prototype.reset=function(){for(var t in this.list)this.onRemove(this.list[t]);return this.list={},this.order=[],this},n.prototype.add=function(t,e){if(this.list[t]=e,this.order.push(t),this.order.length>this.max){var i=this.get(this.order[0]);i&&this.onRemove(i)}return this},n.prototype.has=function(t){return t in this.list},n.prototype.keys=function(){return this.order},n.prototype.get=function(t){if(!this.has(t))return null;var e=this.list[t];return delete this.list[t],this.order.splice(this.order.indexOf(t),1),e}},{}],105:[function(t,e,i){function n(t,e){return e.replace(/{([^{}()\[\]<>$=:;.,^]+)}/g,function(e,i){return i in t?t[i]:""})}e.exports=n},{}],106:[function(t,e,i){var n=t("unitbezier"),r=t("../geo/coordinate");i.easeCubicInOut=function(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,i=e*t;return 4*(.5>t?i:3*(t-e)+i-.75)},i.bezier=function(t,e,i,r){var o=new n(t,e,i,r);return function(t){return o.solve(t)}},i.ease=i.bezier(.25,.1,.25,1),i.premultiply=function(t){return t[0]*=t[3],t[1]*=t[3],t[2]*=t[3],t},
i.clamp=function(t,e,i){return Math.min(i,Math.max(e,t))},i.wrap=function(t,e,i){var n=i-e,r=((t-e)%n+n)%n+e;return r===e?i:r},i.coalesce=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if(null!==e&&void 0!==e)return e}},i.asyncEach=function(t,e,i){function n(){0==--r&&i()}var r=t.length;if(0===r)return i();for(var o=0;o<t.length;o++)e(t[o],n)},i.asyncAll=function(t,e,i){var n=t.length,r=new Array(t.length),o=null;t.forEach(function(t,s){e(t,function(t,e){t&&(o=t),r[s]=e,0==--n&&i(o,r)})})},i.keysDifference=function(t,e){var i=[];for(var n in t)n in e||i.push(n);return i},i.extend=function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t},i.extendAll=function(t,e){for(var i in e)Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i));return t},i.inherit=function(t,e){var n="function"==typeof t?t.prototype:t,r=Object.create(n);return i.extendAll(r,e),r},i.pick=function(t,e){for(var i={},n=0;n<e.length;n++){var r=e[n];r in t&&(i[r]=t[r])}return i};var o=1;i.uniqueId=function(){return o++},i.throttle=function(t,e,i){var n,r,o,s;return s=function(){n=!1,r&&(o.apply(i,r),r=!1)},o=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}},i.debounce=function(t,e){var i,n;return function(){n=arguments,clearTimeout(i),i=setTimeout(function(){t.apply(null,n)},e)}},i.bindAll=function(t,e){t.forEach(function(t){e[t]=e[t].bind(e)})},i.bindHandlers=function(t){for(var e in t)"function"==typeof t[e]&&0===e.indexOf("_on")&&(t[e]=t[e].bind(t))},i.setOptions=function(t,e){t.hasOwnProperty("options")||(t.options=t.options?Object.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},i.getCoordinatesCenter=function(t){for(var e=1/0,i=1/0,n=-1/0,o=-1/0,s=0;s<t.length;s++)e=Math.min(e,t[s].column),i=Math.min(i,t[s].row),n=Math.max(n,t[s].column),o=Math.max(o,t[s].row);var a=n-e,u=o-i,l=Math.max(a,u);return new r((e+n)/2,(i+o)/2,0).zoomTo(Math.floor(-Math.log(l)/Math.LN2))}},{"../geo/coordinate":19,unitbezier:141}],107:[function(t,e,i){function n(t){return t=Math.round(t),0>t?0:t>255?255:t}function r(t){return 0>t?0:t>1?1:t}function o(t){return n("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function s(t){return r("%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))}function a(t,e,i){return 0>i?i+=1:i>1&&(i-=1),1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t}function u(t){var e=t.replace(/ /g,"").toLowerCase();if(e in l)return l[e].slice();if("#"===e[0]){if(4===e.length){var i=parseInt(e.substr(1),16);return i>=0&&4095>=i?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null}if(7===e.length){var i=parseInt(e.substr(1),16);return i>=0&&16777215>=i?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null}return null}var r=e.indexOf("("),u=e.indexOf(")");if(-1!==r&&u+1===e.length){var c=e.substr(0,r),h=e.substr(r+1,u-(r+1)).split(","),f=1;switch(c){case"rgba":if(4!==h.length)return null;f=s(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),f];case"hsla":if(4!==h.length)return null;f=s(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,p=s(h[1]),m=s(h[2]),_=.5>=m?m*(p+1):m+p-m*p,g=2*m-_;return[n(255*a(g,_,d+1/3)),n(255*a(g,_,d)),n(255*a(g,_,d-1/3)),f];default:return null}}return null}var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{i.parseCSSColor=u}catch(t){}},{}],108:[function(t,e,i){function n(t){return function(e,i,n){return"$type"===i?"t"+t+a.indexOf(n):"p["+JSON.stringify(i)+"]"+t+JSON.stringify(n)}}function r(t){var e=n(t);return function(t,i,n){return"$type"===i?e(t,i,n):"typeof(p["+JSON.stringify(i)+"]) === typeof("+JSON.stringify(n)+") && "+e(t,i,n)}}function o(t){return u[t[0]].apply(t,t)}function s(){return!0}var a=["Unknown","Point","LineString","Polygon"],u={"==":n("==="),"!=":n("!=="),">":r(">"),"<":r("<"),"<=":r("<="),">=":r(">="),in:function(t,e){return"(function(){"+Array.prototype.slice.call(arguments,2).map(function(i){return"if ("+u["=="](t,e,i)+") return true;"}).join("")+"return false;})()"},"!in":function(){return"!("+u.in.apply(this,arguments)+")"},any:function(){return Array.prototype.slice.call(arguments,1).map(function(t){return"("+o(t)+")"}).join("||")||"false"},all:function(){return Array.prototype.slice.call(arguments,1).map(function(t){return"("+o(t)+")"}).join("&&")||"true"},none:function(){return"!("+u.any.apply(this,arguments)+")"}};e.exports=function(t){if(!t)return s;var e="var p = f.properties || f.tags || {}, t = f.type; return "+o(t)+";";return new Function("f",e)}},{}],109:[function(t,e,i){function n(t,e,i,n,s,a,u,l){if(i/=e,n/=e,u>=i&&n>=l)return t;if(u>n||i>l)return null;for(var c=[],h=0;h<t.length;h++){var f,d,p=t[h],m=p.geometry,_=p.type;if(f=p.min[s],d=p.max[s],f>=i&&n>=d)c.push(p);else if(!(f>n||i>d)){var g=1===_?r(m,i,n,s):o(m,i,n,s,a,3===_);g.length&&c.push({geometry:g,type:_,tags:t[h].tags||null,min:p.min,max:p.max})}}return c.length?c:null}function r(t,e,i,n){for(var r=[],o=0;o<t.length;o++){var s=t[o],a=s[n];a>=e&&i>=a&&r.push(s)}return r}function o(t,e,i,n,r,o){for(var a=[],u=0;u<t.length;u++){var l,c,h,f=0,d=0,p=null,m=t[u],_=m.area,g=m.dist,v=m.length,y=[];for(c=0;v-1>c;c++)l=p||m[c],p=m[c+1],f=d||l[n],d=p[n],e>f?d>i?(y.push(r(l,p,e),r(l,p,i)),o||(y=s(a,y,_,g))):d>=e&&y.push(r(l,p,e)):f>i?e>d?(y.push(r(l,p,i),r(l,p,e)),o||(y=s(a,y,_,g))):i>=d&&y.push(r(l,p,i)):(y.push(l),e>d?(y.push(r(l,p,e)),o||(y=s(a,y,_,g))):d>i&&(y.push(r(l,p,i)),o||(y=s(a,y,_,g))));l=m[v-1],f=l[n],f>=e&&i>=f&&y.push(l),h=y[y.length-1],o&&h&&(y[0][0]!==h[0]||y[0][1]!==h[1])&&y.push(y[0]),s(a,y,_,g)}return a}function s(t,e,i,n){return e.length&&(e.area=i,e.dist=n,t.push(e)),[]}e.exports=n},{}],110:[function(t,e,i){function n(t,e){var i=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)r(i,t.features[n],e);else"Feature"===t.type?r(i,t,e):r(i,{geometry:t},e);return i}function r(t,e,i){var n,u,l,c=e.geometry,h=c.type,f=c.coordinates,d=e.properties;if("Point"===h)t.push(o(d,1,[a(f)]));else if("MultiPoint"===h)t.push(o(d,1,s(f)));else if("LineString"===h)t.push(o(d,2,[s(f,i)]));else if("MultiLineString"===h||"Polygon"===h){for(l=[],n=0;n<f.length;n++)l.push(s(f[n],i));t.push(o(d,"Polygon"===h?3:2,l))}else if("MultiPolygon"===h){for(l=[],n=0;n<f.length;n++)for(u=0;u<f[n].length;u++)l.push(s(f[n][u],i));t.push(o(d,3,l))}else{if("GeometryCollection"!==h)throw new Error("Input data is not a valid GeoJSON object.");for(n=0;n<c.geometries.length;n++)r(t,{geometry:c.geometries[n],properties:d},i)}}function o(t,e,i){var n={geometry:i,type:e,tags:t||null,min:[2,1],max:[-1,0]};return l(n),n}function s(t,e){for(var i=[],n=0;n<t.length;n++)i.push(a(t[n]));return e&&(h(i,e),u(i)),i}function a(t){var e=Math.sin(t[1]*Math.PI/180),i=t[0]/360+.5,n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n=-1>n?-1:n>1?1:n,[i,n,0]}function u(t){for(var e,i,n=0,r=0,o=0;o<t.length-1;o++)e=i||t[o],i=t[o+1],n+=e[0]*i[1]-i[0]*e[1],r+=Math.abs(i[0]-e[0])+Math.abs(i[1]-e[1]);t.area=Math.abs(n/2),t.dist=r}function l(t){var e=t.geometry,i=t.min,n=t.max;if(1===t.type)c(i,n,e);else for(var r=0;r<e.length;r++)c(i,n,e[r]);return t}function c(t,e,i){for(var n,r=0;r<i.length;r++)n=i[r],t[0]=Math.min(n[0],t[0]),e[0]=Math.max(n[0],e[0]),t[1]=Math.min(n[1],t[1]),e[1]=Math.max(n[1],e[1])}e.exports=n;var h=t("./simplify")},{"./simplify":112}],111:[function(t,e,i){function n(t,e){return new r(t,e)}function r(t,e){e=this.options=u(Object.create(this.options),e);var i=e.debug;i&&console.time("preprocess data");var n=1<<e.maxZoom,r=c(t,e.tolerance/(n*e.extent));this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=d(r,e.buffer/e.extent,s),r.length&&this.splitTile(r,0,0,0),i&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function o(t,e,i){return 32*((1<<t)*i+e)+t}function s(t,e,i){return[i,(i-t[0])*(e[1]-t[1])/(e[0]-t[0])+t[1],1]}function a(t,e,i){return[(i-t[1])*(e[0]-t[0])/(e[1]-t[1])+t[0],i,1]}function u(t,e){for(var i in e)t[i]=e[i];return t}function l(t,e,i){var n=t.source;if(1!==n.length)return!1;var r=n[0];if(3!==r.type||r.geometry.length>1)return!1;var o=r.geometry[0].length;if(5!==o)return!1;for(var s=0;o>s;s++){var a=h.point(r.geometry[0][s],e,t.z2,t.x,t.y);if(a[0]!==-i&&a[0]!==e+i||a[1]!==-i&&a[1]!==e+i)return!1}return!0}e.exports=n;var c=t("./convert"),h=t("./transform"),f=t("./clip"),d=t("./wrap"),p=t("./tile");r.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0},r.prototype.splitTile=function(t,e,i,n,r,u,c){for(var h=[t,e,i,n],d=this.options,m=d.debug,_=null;h.length;){n=h.pop(),i=h.pop(),e=h.pop(),t=h.pop();var g=1<<e,v=o(e,i,n),y=this.tiles[v],b=e===d.maxZoom?0:d.tolerance/(g*d.extent);if(!y&&(m>1&&console.time("creation"),y=this.tiles[v]=p(t,g,i,n,b,e===d.maxZoom),this.tileCoords.push({z:e,x:i,y:n}),m)){m>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,n,y.numFeatures,y.numPoints,y.numSimplified),console.timeEnd("creation"));var x="z"+e;this.stats[x]=(this.stats[x]||0)+1,this.total++}if(y.source=t,r){if(e===d.maxZoom||e===r)continue;var w=1<<r-e;if(i!==Math.floor(u/w)||n!==Math.floor(c/w))continue}else if(e===d.indexMaxZoom||y.numPoints<=d.indexMaxPoints)continue;if(d.solidChildren||!l(y,d.extent,d.buffer)){y.source=null,m>1&&console.time("clipping");var L,S,T,M,E,P,C=.5*d.buffer/d.extent,A=.5-C,k=.5+C,z=1+C;L=S=T=M=null,E=f(t,g,i-C,i+k,0,s,y.min[0],y.max[0]),P=f(t,g,i+A,i+z,0,s,y.min[0],y.max[0]),E&&(L=f(E,g,n-C,n+k,1,a,y.min[1],y.max[1]),S=f(E,g,n+A,n+z,1,a,y.min[1],y.max[1])),P&&(T=f(P,g,n-C,n+k,1,a,y.min[1],y.max[1]),M=f(P,g,n+A,n+z,1,a,y.min[1],y.max[1])),m>1&&console.timeEnd("clipping"),L&&h.push(L,e+1,2*i,2*n),S&&h.push(S,e+1,2*i,2*n+1),T&&h.push(T,e+1,2*i+1,2*n),M&&h.push(M,e+1,2*i+1,2*n+1)}else r&&(_=e)}return _},r.prototype.getTile=function(t,e,i){var n=this.options,r=n.extent,s=n.debug,a=1<<t;e=(e%a+a)%a;var u=o(t,e,i);if(this.tiles[u])return h.tile(this.tiles[u],r);s>1&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var c,f=t,d=e,p=i;!c&&f>0;)f--,d=Math.floor(d/2),p=Math.floor(p/2),c=this.tiles[o(f,d,p)];if(!c||!c.source)return null;if(s>1&&console.log("found parent tile z%d-%d-%d",f,d,p),l(c,r,n.buffer))return h.tile(c,r);s>1&&console.time("drilling down");var m=this.splitTile(c.source,f,d,p,t,e,i);if(s>1&&console.timeEnd("drilling down"),null!==m){var _=1<<t-m;u=o(m,Math.floor(e/_),Math.floor(i/_))}return this.tiles[u]?h.tile(this.tiles[u],r):null}},{"./clip":109,"./convert":110,"./tile":113,"./transform":114,"./wrap":115}],112:[function(t,e,i){function n(t,e){var i,n,o,s,a=e*e,u=t.length,l=0,c=u-1,h=[];for(t[l][2]=1,t[c][2]=1;c;){for(n=0,i=l+1;c>i;i++)(o=r(t[i],t[l],t[c]))>n&&(s=i,n=o);n>a?(t[s][2]=n,h.push(l),h.push(s),l=s):(c=h.pop(),l=h.pop())}}function r(t,e,i){var n=e[0],r=e[1],o=i[0],s=i[1],a=t[0],u=t[1],l=o-n,c=s-r;if(0!==l||0!==c){var h=((a-n)*l+(u-r)*c)/(l*l+c*c);h>1?(n=o,r=s):h>0&&(n+=l*h,r+=c*h)}return l=a-n,c=u-r,l*l+c*c}e.exports=n},{}],113:[function(t,e,i){function n(t,e,i,n,o,s){for(var a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z2:e,transformed:!1,min:[2,1],max:[-1,0]},u=0;u<t.length;u++){a.numFeatures++,r(a,t[u],o,s);var l=t[u].min,c=t[u].max;l[0]<a.min[0]&&(a.min[0]=l[0]),l[1]<a.min[1]&&(a.min[1]=l[1]),c[0]>a.max[0]&&(a.max[0]=c[0]),c[1]>a.max[1]&&(a.max[1]=c[1])}return a}function r(t,e,i,n){var r,o,s,a,u=e.geometry,l=e.type,c=[],h=i*i;if(1===l)for(r=0;r<u.length;r++)c.push(u[r]),t.numPoints++,t.numSimplified++;else for(r=0;r<u.length;r++)if(s=u[r],n||!(2===l&&s.dist<i||3===l&&s.area<h)){var f=[];for(o=0;o<s.length;o++)a=s[o],(n||a[2]>h)&&(f.push(a),t.numSimplified++),t.numPoints++;c.push(f)}else t.numPoints+=s.length;c.length&&t.features.push({geometry:c,type:l,tags:e.tags||null})}e.exports=n},{}],114:[function(t,e,i){function n(t,e){if(t.transformed)return t;var i,n,o,s=t.z2,a=t.x,u=t.y;for(i=0;i<t.features.length;i++){var l=t.features[i],c=l.geometry;if(1===l.type)for(n=0;n<c.length;n++)c[n]=r(c[n],e,s,a,u);else for(n=0;n<c.length;n++){var h=c[n];for(o=0;o<h.length;o++)h[o]=r(h[o],e,s,a,u)}}return t.transformed=!0,t}function r(t,e,i,n,r){return[Math.round(e*(t[0]*i-n)),Math.round(e*(t[1]*i-r))]}i.tile=n,i.point=r},{}],115:[function(t,e,i){function n(t,e,i){var n=t,o=s(t,1,-1-e,e,0,i,-1,2),a=s(t,1,1-e,2+e,0,i,-1,2);return(o||a)&&(n=s(t,1,-e,1+e,0,i,-1,2),o&&(n=r(o,1).concat(n)),a&&(n=n.concat(r(a,-1)))),n}function r(t,e){for(var i=[],n=0;n<t.length;n++){var r,s=t[n],a=s.type;if(1===a)r=o(s.geometry,e);else{r=[];for(var u=0;u<s.geometry.length;u++)r.push(o(s.geometry[u],e))}i.push({geometry:r,type:a,tags:s.tags,min:[s.min[0]+e,s.min[1]],max:[s.max[0]+e,s.max[1]]})}return i}function o(t,e){var i=[];i.area=t.area,i.dist=t.dist;for(var n=0;n<t.length;n++)i.push([t[n][0]+e,t[n][1],t[n][2]]);return i}var s=t("./clip");e.exports=n},{"./clip":109}],116:[function(t,e,i){i.glMatrix=t("./gl-matrix/common.js"),i.mat2=t("./gl-matrix/mat2.js"),i.mat2d=t("./gl-matrix/mat2d.js"),i.mat3=t("./gl-matrix/mat3.js"),i.mat4=t("./gl-matrix/mat4.js"),i.quat=t("./gl-matrix/quat.js"),i.vec2=t("./gl-matrix/vec2.js"),i.vec3=t("./gl-matrix/vec3.js"),i.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":117,"./gl-matrix/mat2.js":118,"./gl-matrix/mat2d.js":119,"./gl-matrix/mat3.js":120,"./gl-matrix/mat4.js":121,"./gl-matrix/quat.js":122,"./gl-matrix/vec2.js":123,"./gl-matrix/vec3.js":124,"./gl-matrix/vec4.js":125}],117:[function(t,e,i){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var r=Math.PI/180;n.toRadian=function(t){return t*r},e.exports=n},{}],118:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*o-r*n;return s?(s=1/s,t[0]=o*s,t[1]=-n*s,t[2]=-r*s,t[3]=i*s,t):null},r.adjoint=function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1],l=i[2],c=i[3];return t[0]=n*a+o*u,t[1]=r*a+s*u,t[2]=n*l+o*c,t[3]=r*l+s*c,t},r.mul=r.multiply,r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+o*a,t[1]=r*u+s*a,t[2]=n*-a+o*u,t[3]=r*-a+s*u,t},r.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1];return t[0]=n*a,t[1]=r*a,t[2]=o*u,t[3]=s*u,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,e,i,n){return t[2]=n[2]/n[0],i[0]=n[0],i[1]=n[1],i[3]=n[3]-t[2]*i[1],[t,e,i]},e.exports=r},{"./common.js":117}],119:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=i*o-n*r;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-r*u,t[3]=i*u,t[4]=(r*a-o*s)*u,t[5]=(n*s-i*a)*u,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=i[0],c=i[1],h=i[2],f=i[3],d=i[4],p=i[5];return t[0]=n*l+o*c,t[1]=r*l+s*c,t[2]=n*h+o*f,t[3]=r*h+s*f,t[4]=n*d+o*p+a,t[5]=r*d+s*p+u,t},r.mul=r.multiply,r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=Math.sin(i),c=Math.cos(i);return t[0]=n*c+o*l,t[1]=r*c+s*l,t[2]=n*-l+o*c,t[3]=r*-l+s*c,t[4]=a,t[5]=u,t},r.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=i[0],c=i[1];return t[0]=n*l,t[1]=r*l,t[2]=o*c,t[3]=s*c,t[4]=a,t[5]=u,t},r.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=i[0],c=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=n*l+o*c+a,t[5]=r*l+s*c+u,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.exports=r},{"./common.js":117}],120:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=c*s-a*l,f=-c*o+a*u,d=l*o-s*u,p=i*h+n*f+r*d;return p?(p=1/p,t[0]=h*p,t[1]=(-c*n+r*l)*p,t[2]=(a*n-r*s)*p,t[3]=f*p,t[4]=(c*i-r*u)*p,t[5]=(-a*i+r*o)*p,t[6]=d*p,t[7]=(-l*i+n*u)*p,t[8]=(s*i-n*o)*p,t):null},r.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8];return t[0]=s*c-a*l,t[1]=r*l-n*c,t[2]=n*a-r*s,t[3]=a*u-o*c,t[4]=i*c-r*u,t[5]=r*o-i*a,t[6]=o*l-s*u,t[7]=n*u-i*l,t[8]=i*s-n*o,t},r.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],u=t[7],l=t[8];return e*(l*o-s*u)+i*(-l*r+s*a)+n*(u*r-o*a)},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=i[0],d=i[1],p=i[2],m=i[3],_=i[4],g=i[5],v=i[6],y=i[7],b=i[8];return t[0]=f*n+d*s+p*l,t[1]=f*r+d*a+p*c,t[2]=f*o+d*u+p*h,t[3]=m*n+_*s+g*l,t[4]=m*r+_*a+g*c,t[5]=m*o+_*u+g*h,t[6]=v*n+y*s+b*l,t[7]=v*r+y*a+b*c,t[8]=v*o+y*u+b*h,t},r.mul=r.multiply,r.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=i[0],d=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=f*n+d*s+l,t[7]=f*r+d*a+c,t[8]=f*o+d*u+h,t},r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=Math.sin(i),d=Math.cos(i);return t[0]=d*n+f*s,t[1]=d*r+f*a,t[2]=d*o+f*u,t[3]=d*s-f*n,t[4]=d*a-f*r,t[5]=d*u-f*o,t[6]=l,t[7]=c,t[8]=h,t},r.scale=function(t,e,i){var n=i[0],r=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i+i,a=n+n,u=r+r,l=i*s,c=n*s,h=n*a,f=r*s,d=r*a,p=r*u,m=o*s,_=o*a,g=o*u;return t[0]=1-h-p,t[3]=c-g,t[6]=f+_,t[1]=c+g,t[4]=1-l-p,t[7]=d-m,t[2]=f-_,t[5]=d+m,t[8]=1-l-h,t},r.normalFromMat4=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],_=e[14],g=e[15],v=i*a-n*s,y=i*u-r*s,b=i*l-o*s,x=n*u-r*a,w=n*l-o*a,L=r*l-o*u,S=c*m-h*p,T=c*_-f*p,M=c*g-d*p,E=h*_-f*m,P=h*g-d*m,C=f*g-d*_,A=v*C-y*P+b*E+x*M-w*T+L*S;return A?(A=1/A,t[0]=(a*C-u*P+l*E)*A,t[1]=(u*M-s*C-l*T)*A,t[2]=(s*P-a*M+l*S)*A,t[3]=(r*P-n*C-o*E)*A,t[4]=(i*C-r*M+o*T)*A,t[5]=(n*M-i*P-o*S)*A,t[6]=(m*L-_*w+g*x)*A,t[7]=(_*b-p*L-g*y)*A,t[8]=(p*w-m*b+g*v)*A,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.exports=r},{"./common.js":117}],121:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],_=e[14],g=e[15],v=i*a-n*s,y=i*u-r*s,b=i*l-o*s,x=n*u-r*a,w=n*l-o*a,L=r*l-o*u,S=c*m-h*p,T=c*_-f*p,M=c*g-d*p,E=h*_-f*m,P=h*g-d*m,C=f*g-d*_,A=v*C-y*P+b*E+x*M-w*T+L*S;return A?(A=1/A,t[0]=(a*C-u*P+l*E)*A,t[1]=(r*P-n*C-o*E)*A,t[2]=(m*L-_*w+g*x)*A,t[3]=(f*w-h*L-d*x)*A,t[4]=(u*M-s*C-l*T)*A,t[5]=(i*C-r*M+o*T)*A,t[6]=(_*b-p*L-g*y)*A,t[7]=(c*L-f*b+d*y)*A,t[8]=(s*P-a*M+l*S)*A,t[9]=(n*M-i*P-o*S)*A,t[10]=(p*w-m*b+g*v)*A,t[11]=(h*b-c*w-d*v)*A,t[12]=(a*T-s*E-u*S)*A,t[13]=(i*E-n*T+r*S)*A,t[14]=(m*y-p*x-_*v)*A,t[15]=(c*x-h*y+f*v)*A,t):null},r.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],_=e[14],g=e[15];return t[0]=a*(f*g-d*_)-h*(u*g-l*_)+m*(u*d-l*f),t[1]=-(n*(f*g-d*_)-h*(r*g-o*_)+m*(r*d-o*f)),t[2]=n*(u*g-l*_)-a*(r*g-o*_)+m*(r*l-o*u),t[3]=-(n*(u*d-l*f)-a*(r*d-o*f)+h*(r*l-o*u)),t[4]=-(s*(f*g-d*_)-c*(u*g-l*_)+p*(u*d-l*f)),t[5]=i*(f*g-d*_)-c*(r*g-o*_)+p*(r*d-o*f),t[6]=-(i*(u*g-l*_)-s*(r*g-o*_)+p*(r*l-o*u)),t[7]=i*(u*d-l*f)-s*(r*d-o*f)+c*(r*l-o*u),t[8]=s*(h*g-d*m)-c*(a*g-l*m)+p*(a*d-l*h),t[9]=-(i*(h*g-d*m)-c*(n*g-o*m)+p*(n*d-o*h)),t[10]=i*(a*g-l*m)-s*(n*g-o*m)+p*(n*l-o*a),t[11]=-(i*(a*d-l*h)-s*(n*d-o*h)+c*(n*l-o*a)),t[12]=-(s*(h*_-f*m)-c*(a*_-u*m)+p*(a*f-u*h)),t[13]=i*(h*_-f*m)-c*(n*_-r*m)+p*(n*f-r*h),t[14]=-(i*(a*_-u*m)-s*(n*_-r*m)+p*(n*u-r*a)),t[15]=i*(a*f-u*h)-s*(n*f-r*h)+c*(n*u-r*a),t},r.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11],d=t[12],p=t[13],m=t[14],_=t[15];return(e*s-i*o)*(h*_-f*m)-(e*a-n*o)*(c*_-f*p)+(e*u-r*o)*(c*m-h*p)+(i*a-n*s)*(l*_-f*d)-(i*u-r*s)*(l*m-h*d)+(n*u-r*a)*(l*p-c*d)},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],_=e[13],g=e[14],v=e[15],y=i[0],b=i[1],x=i[2],w=i[3];return t[0]=y*n+b*a+x*h+w*m,t[1]=y*r+b*u+x*f+w*_,t[2]=y*o+b*l+x*d+w*g,t[3]=y*s+b*c+x*p+w*v,y=i[4],b=i[5],x=i[6],w=i[7],t[4]=y*n+b*a+x*h+w*m,t[5]=y*r+b*u+x*f+w*_,t[6]=y*o+b*l+x*d+w*g,t[7]=y*s+b*c+x*p+w*v,y=i[8],b=i[9],x=i[10],w=i[11],t[8]=y*n+b*a+x*h+w*m,t[9]=y*r+b*u+x*f+w*_,t[10]=y*o+b*l+x*d+w*g,t[11]=y*s+b*c+x*p+w*v,y=i[12],b=i[13],x=i[14],w=i[15],t[12]=y*n+b*a+x*h+w*m,t[13]=y*r+b*u+x*f+w*_,t[14]=y*o+b*l+x*d+w*g,t[15]=y*s+b*c+x*p+w*v,t},r.mul=r.multiply,r.translate=function(t,e,i){var n,r,o,s,a,u,l,c,h,f,d,p,m=i[0],_=i[1],g=i[2];return e===t?(t[12]=e[0]*m+e[4]*_+e[8]*g+e[12],t[13]=e[1]*m+e[5]*_+e[9]*g+e[13],t[14]=e[2]*m+e[6]*_+e[10]*g+e[14],t[15]=e[3]*m+e[7]*_+e[11]*g+e[15]):(n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=n*m+a*_+h*g+e[12],t[13]=r*m+u*_+f*g+e[13],t[14]=o*m+l*_+d*g+e[14],t[15]=s*m+c*_+p*g+e[15]),t},r.scale=function(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.rotate=function(t,e,i,r){var o,s,a,u,l,c,h,f,d,p,m,_,g,v,y,b,x,w,L,S,T,M,E,P,C=r[0],A=r[1],k=r[2],z=Math.sqrt(C*C+A*A+k*k);return Math.abs(z)<n.EPSILON?null:(z=1/z,C*=z,A*=z,k*=z,o=Math.sin(i),s=Math.cos(i),a=1-s,u=e[0],l=e[1],c=e[2],h=e[3],f=e[4],d=e[5],p=e[6],m=e[7],_=e[8],g=e[9],v=e[10],y=e[11],b=C*C*a+s,x=A*C*a+k*o,w=k*C*a-A*o,L=C*A*a-k*o,S=A*A*a+s,T=k*A*a+C*o,M=C*k*a+A*o,E=A*k*a-C*o,P=k*k*a+s,t[0]=u*b+f*x+_*w,t[1]=l*b+d*x+g*w,t[2]=c*b+p*x+v*w,t[3]=h*b+m*x+y*w,t[4]=u*L+f*S+_*T,t[5]=l*L+d*S+g*T,t[6]=c*L+p*S+v*T,t[7]=h*L+m*S+y*T,t[8]=u*M+f*E+_*P,t[9]=l*M+d*E+g*P,t[10]=c*M+p*E+v*P,t[11]=h*M+m*E+y*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},r.rotateX=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],s=e[5],a=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*n,t[5]=s*r+c*n,t[6]=a*r+h*n,t[7]=u*r+f*n,t[8]=l*r-o*n,t[9]=c*r-s*n,t[10]=h*r-a*n,t[11]=f*r-u*n,t},r.rotateY=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],s=e[1],a=e[2],u=e[3],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-l*n,t[1]=s*r-c*n,t[2]=a*r-h*n,t[3]=u*r-f*n,t[8]=o*n+l*r,t[9]=s*n+c*r,t[10]=a*n+h*r,t[11]=u*n+f*r,t},r.rotateZ=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],s=e[1],a=e[2],u=e[3],l=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*n,t[1]=s*r+c*n,t[2]=a*r+h*n,t[3]=u*r+f*n,t[4]=l*r-o*n,t[5]=c*r-s*n,t[6]=h*r-a*n,t[7]=f*r-u*n,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,i){var r,o,s,a=i[0],u=i[1],l=i[2],c=Math.sqrt(a*a+u*u+l*l);return Math.abs(c)<n.EPSILON?null:(c=1/c,a*=c,u*=c,l*=c,r=Math.sin(e),o=Math.cos(e),s=1-o,t[0]=a*a*s+o,t[1]=u*a*s+l*r,t[2]=l*a*s-u*r,t[3]=0,t[4]=a*u*s-l*r,t[5]=u*u*s+o,t[6]=l*u*s+a*r,t[7]=0,t[8]=a*l*s+u*r,t[9]=u*l*s-a*r,t[10]=l*l*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,
t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=n+n,u=r+r,l=o+o,c=n*a,h=n*u,f=n*l,d=r*u,p=r*l,m=o*l,_=s*a,g=s*u,v=s*l;return t[0]=1-(d+m),t[1]=h+v,t[2]=f-g,t[3]=0,t[4]=h-v,t[5]=1-(c+m),t[6]=p+_,t[7]=0,t[8]=f+g,t[9]=p-_,t[10]=1-(c+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},r.fromRotationTranslationScale=function(t,e,i,n){var r=e[0],o=e[1],s=e[2],a=e[3],u=r+r,l=o+o,c=s+s,h=r*u,f=r*l,d=r*c,p=o*l,m=o*c,_=s*c,g=a*u,v=a*l,y=a*c,b=n[0],x=n[1],w=n[2];return t[0]=(1-(p+_))*b,t[1]=(f+y)*b,t[2]=(d-v)*b,t[3]=0,t[4]=(f-y)*x,t[5]=(1-(h+_))*x,t[6]=(m+g)*x,t[7]=0,t[8]=(d+v)*w,t[9]=(m-g)*w,t[10]=(1-(h+p))*w,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,i,n,r){var o=e[0],s=e[1],a=e[2],u=e[3],l=o+o,c=s+s,h=a+a,f=o*l,d=o*c,p=o*h,m=s*c,_=s*h,g=a*h,v=u*l,y=u*c,b=u*h,x=n[0],w=n[1],L=n[2],S=r[0],T=r[1],M=r[2];return t[0]=(1-(m+g))*x,t[1]=(d+b)*x,t[2]=(p-y)*x,t[3]=0,t[4]=(d-b)*w,t[5]=(1-(f+g))*w,t[6]=(_+v)*w,t[7]=0,t[8]=(p+y)*L,t[9]=(_-v)*L,t[10]=(1-(f+m))*L,t[11]=0,t[12]=i[0]+S-(t[0]*S+t[4]*T+t[8]*M),t[13]=i[1]+T-(t[1]*S+t[5]*T+t[9]*M),t[14]=i[2]+M-(t[2]*S+t[6]*T+t[10]*M),t[15]=1,t},r.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i+i,a=n+n,u=r+r,l=i*s,c=n*s,h=n*a,f=r*s,d=r*a,p=r*u,m=o*s,_=o*a,g=o*u;return t[0]=1-h-p,t[1]=c+g,t[2]=f-_,t[3]=0,t[4]=c-g,t[5]=1-l-p,t[6]=d+m,t[7]=0,t[8]=f+_,t[9]=d-m,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,i,n,r,o,s){var a=1/(i-e),u=1/(r-n),l=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(r+n)*u,t[10]=(s+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*l,t[15]=0,t},r.perspective=function(t,e,i,n,r){var o=1/Math.tan(e/2),s=1/(n-r);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*s,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,e,i,n){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+a),l=2/(r+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(s-a)*u*.5,t[9]=(r-o)*l*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t},r.ortho=function(t,e,i,n,r,o,s){var a=1/(e-i),u=1/(n-r),l=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*a,t[13]=(r+n)*u,t[14]=(s+o)*l,t[15]=1,t},r.lookAt=function(t,e,i,o){var s,a,u,l,c,h,f,d,p,m,_=e[0],g=e[1],v=e[2],y=o[0],b=o[1],x=o[2],w=i[0],L=i[1],S=i[2];return Math.abs(_-w)<n.EPSILON&&Math.abs(g-L)<n.EPSILON&&Math.abs(v-S)<n.EPSILON?r.identity(t):(f=_-w,d=g-L,p=v-S,m=1/Math.sqrt(f*f+d*d+p*p),f*=m,d*=m,p*=m,s=b*p-x*d,a=x*f-y*p,u=y*d-b*f,m=Math.sqrt(s*s+a*a+u*u),m?(m=1/m,s*=m,a*=m,u*=m):(s=0,a=0,u=0),l=d*u-p*a,c=p*s-f*u,h=f*a-d*s,m=Math.sqrt(l*l+c*c+h*h),m?(m=1/m,l*=m,c*=m,h*=m):(l=0,c=0,h=0),t[0]=s,t[1]=l,t[2]=f,t[3]=0,t[4]=a,t[5]=c,t[6]=d,t[7]=0,t[8]=u,t[9]=h,t[10]=p,t[11]=0,t[12]=-(s*_+a*g+u*v),t[13]=-(l*_+c*g+h*v),t[14]=-(f*_+d*g+p*v),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.exports=r},{"./common.js":117}],122:[function(t,e,i){var n=t("./common.js"),r=t("./mat3.js"),o=t("./vec3.js"),s=t("./vec4.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},a.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),i=o.fromValues(0,1,0);return function(n,r,s){var u=o.dot(r,s);return-.999999>u?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,i,r),o.normalize(t,t),a.setAxisAngle(n,t,Math.PI),n):u>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,r,s),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+u,a.normalize(n,n))}}(),a.setAxes=function(){var t=r.create();return function(e,i,n,r){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-i[0],t[5]=-i[1],t[8]=-i[2],a.normalize(e,a.fromMat3(e,t))}}(),a.clone=s.clone,a.fromValues=s.fromValues,a.copy=s.copy,a.set=s.set,a.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},a.setAxisAngle=function(t,e,i){i*=.5;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t},a.add=s.add,a.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1],l=i[2],c=i[3];return t[0]=n*c+s*a+r*l-o*u,t[1]=r*c+s*u+o*a-n*l,t[2]=o*c+s*l+n*u-r*a,t[3]=s*c-n*a-r*u-o*l,t},a.mul=a.multiply,a.scale=s.scale,a.rotateX=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+s*a,t[1]=r*u+o*a,t[2]=o*u-r*a,t[3]=s*u-n*a,t},a.rotateY=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u-o*a,t[1]=r*u+s*a,t[2]=o*u+n*a,t[3]=s*u-r*a,t},a.rotateZ=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+r*a,t[1]=r*u-n*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t},a.calculateW=function(t,e){var i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t},a.dot=s.dot,a.lerp=s.lerp,a.slerp=function(t,e,i,n){var r,o,s,a,u,l=e[0],c=e[1],h=e[2],f=e[3],d=i[0],p=i[1],m=i[2],_=i[3];return o=l*d+c*p+h*m+f*_,0>o&&(o=-o,d=-d,p=-p,m=-m,_=-_),1-o>1e-6?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-n)*r)/s,u=Math.sin(n*r)/s):(a=1-n,u=n),t[0]=a*l+u*d,t[1]=a*c+u*p,t[2]=a*h+u*m,t[3]=a*f+u*_,t},a.sqlerp=function(){var t=a.create(),e=a.create();return function(i,n,r,o,s,u){return a.slerp(t,n,s,u),a.slerp(e,r,o,u),a.slerp(i,t,e,2*u*(1-u)),i}}(),a.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*i+n*n+r*r+o*o,a=s?1/s:0;return t[0]=-i*a,t[1]=-n*a,t[2]=-r*a,t[3]=o*a,t},a.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},a.length=s.length,a.len=a.length,a.squaredLength=s.squaredLength,a.sqrLen=a.squaredLength,a.normalize=s.normalize,a.fromMat3=function(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*s+s]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*o+s]-e[3*s+o])*i,t[o]=(e[3*o+r]+e[3*r+o])*i,t[s]=(e[3*s+r]+e[3*r+s])*i}return t},a.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=a},{"./common.js":117,"./mat3.js":120,"./vec3.js":124,"./vec4.js":125}],123:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var i=new n.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,i){return t[0]=e,t[1]=i,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},r.lerp=function(t,e,i,n){var r=e[0],o=e[1];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t},r.random=function(t,e){e=e||1;var i=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},r.transformMat2=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t},r.transformMat2d=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t},r.transformMat3=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=2),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exports=r},{"./common.js":117}],124:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.fromValues=function(t,e,i){var r=new n.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=i,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2];return t[0]=r*u-o*a,t[1]=o*s-n*u,t[2]=n*a-r*s,t},r.lerp=function(t,e,i,n){var r=e[0],o=e[1],s=e[2];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=s+n*(i[2]-s),t},r.hermite=function(t,e,i,n,r,o){var s=o*o,a=s*(2*o-3)+1,u=s*(o-2)+o,l=s*(o-1),c=s*(3-2*o);return t[0]=e[0]*a+i[0]*u+n[0]*l+r[0]*c,t[1]=e[1]*a+i[1]*u+n[1]*l+r[1]*c,t[2]=e[2]*a+i[2]*u+n[2]*l+r[2]*c,t},r.bezier=function(t,e,i,n,r,o){var s=1-o,a=s*s,u=o*o,l=a*s,c=3*o*a,h=3*u*s,f=u*o;return t[0]=e[0]*l+i[0]*c+n[0]*h+r[0]*f,t[1]=e[1]*l+i[1]*c+n[1]*h+r[1]*f,t[2]=e[2]*l+i[2]*c+n[2]*h+r[2]*f,t},r.random=function(t,e){e=e||1;var i=2*n.RANDOM()*Math.PI,r=2*n.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*o,t[1]=Math.sin(i)*o,t[2]=r*e,t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[3]*n+i[7]*r+i[11]*o+i[15];return s=s||1,t[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/s,t[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/s,t[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/s,t},r.transformMat3=function(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t},r.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2],l=i[3],c=l*n+a*o-u*r,h=l*r+u*n-s*o,f=l*o+s*r-a*n,d=-s*n-a*r-u*o;return t[0]=c*l+d*-s+h*-u-f*-a,t[1]=h*l+d*-a+f*-s-c*-u,t[2]=f*l+d*-u+c*-a-h*-s,t},r.rotateX=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.rotateY=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.rotateZ=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=3),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),r.angle=function(t,e){var i=r.fromValues(t[0],t[1],t[2]),n=r.fromValues(e[0],e[1],e[2]);r.normalize(i,i),r.normalize(n,n);var o=r.dot(i,n);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exports=r},{"./common.js":117}],125:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,i,r){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return i*i+n*n+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*i+n*n+r*r+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=i*s,t[1]=n*s,t[2]=r*s,t[3]=o*s),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.lerp=function(t,e,i,n){var r=e[0],o=e[1],s=e[2],a=e[3];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=s+n*(i[2]-s),t[3]=a+n*(i[3]-a),t},r.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),r.normalize(t,t),r.scale(t,t,e),t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*s,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*s,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*s,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*s,t},r.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2],l=i[3],c=l*n+a*o-u*r,h=l*r+u*n-s*o,f=l*o+s*r-a*n,d=-s*n-a*r-u*o;return t[0]=c*l+d*-s+h*-u-f*-a,t[1]=h*l+d*-a+f*-s-c*-u,t[2]=f*l+d*-u+c*-a-h*-s,t[3]=e[3],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=4),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=r},{"./common.js":117}],126:[function(t,e,i){i.read=function(t,e,i,n,r){var o,s,a=8*r-n-1,u=(1<<a)-1,l=u>>1,c=-7,h=i?r-1:0,f=i?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-c)-1,d>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+t[e+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=l}return(d?-1:1)*s*Math.pow(2,o-n)},i.write=function(t,e,i,n,r,o){var s,a,u,l=8*o-r-1,c=(1<<l)-1,h=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+h>=1?f/u:f*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*u-1)*Math.pow(2,r),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[i+d]=255&a,d+=p,a/=256,r-=8);for(s=s<<r|a,l+=r;l>0;t[i+d]=255&s,d+=p,s/=256,l-=8);t[i+d-p]|=128*m}},{}],127:[function(t,e,i){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],128:[function(t,e,i){function n(t){return function(){return t}}function r(t,e,i){return t*(1-i)+e*i}function o(t,e,i){for(var n=[],o=0;o<t.length;o++)n[o]=r(t[o],e[o],i);return n}i.interpolated=function(t){if(!t.stops)return n(t);var e=t.stops,i=t.base||1,s=Array.isArray(e[0][1])?o:r;return function(t){for(var n,r,o=0;o<e.length;o++){var a=e[o];if(a[0]<=t&&(n=a),a[0]>t){r=a;break}}if(n&&r){var u=r[0]-n[0],l=t-n[0],c=1===i?l/u:(Math.pow(i,l)-1)/(Math.pow(i,u)-1);return s(n[1],r[1],c)}return n?n[1]:r?r[1]:void 0}},i["piecewise-constant"]=function(t){if(!t.stops)return n(t);var e=t.stops;return function(t){for(var i=0;i<e.length;i++)if(e[i][0]>t)return e[0===i?0:i-1][1];return e[e.length-1][1]}}},{}],129:[function(t,e,i){var n=t("../../reference/latest.min.js"),r=t("./parsed");e.exports=function(t){return r(t,n)}},{"../../reference/latest.min.js":132,"./parsed":130}],130:[function(t,e,i){function n(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function r(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}var o=t("csscolorparser").parseCSSColor,s=t("util").format;e.exports=function(t,e){function i(t,e){var i={message:(t?t+": ":"")+s.apply(s,Array.prototype.slice.call(arguments,2))};null!==e&&void 0!==e&&e.__line__&&(i.line=e.__line__),h.push(i)}function a(t,r,o){var s=n(r);if("string"===s&&"@"===r[0]){if(e.$version>7)return i(t,r,"constants have been deprecated as of v8");if(!(r in l))return i(t,r,'constant "%s" not found',r);r=l[r],s=n(r)}if(o.function&&"object"===s)return a.function(t,r,o);if(o.type){var u=a[o.type];if(u)return u(t,r,o);o=e[o.type]}a.object(t,r,o)}function u(t){return function(e,r,o){var s=n(r);s!==t&&i(e,r,"%s expected, %s found",t,s),"minimum"in o&&r<o.minimum&&i(e,r,"%s is less than the minimum value %s",r,o.minimum),"maximum"in o&&r>o.maximum&&i(e,r,"%s is greater than the maximum value %s",r,o.maximum)}}var l=t.constants||{},c={},h=[];return a.constants=function(t,r){if(e.$version>7){if(r)return i(t,r,"constants have been deprecated as of v8")}else{var o=n(r);if("object"!==o)return i(t,r,"object expected, %s found",o);for(var s in r)"@"!==s[0]&&i(t+"."+s,r[s],'constants must start with "@"')}},a.source=function(t,n){if(!n.type)return void i(t,n,'"type" is required');switch(r(n.type)){case"vector":case"raster":if(a.object(t,n,e.source_tile),"url"in n)for(var o in n)["type","url","tileSize"].indexOf(o)<0&&i(t+"."+o,n[o],'a source with a "url" property may not include a "%s" property',o);break;case"geojson":a.object(t,n,e.source_geojson);break;case"video":a.object(t,n,e.source_video);break;case"image":a.object(t,n,e.source_image);break;default:a.enum(t+".type",n.type,{values:["vector","raster","geojson","video","image"]})}},a.layer=function(n,o){o.type||o.ref||i(n,o,'either "type" or "ref" is required');var s=r(o.type),u=r(o.ref);if(o.id&&(c[o.id]?i(n,o.id,'duplicate layer id "%s", previously used at line %d',o.id,c[o.id]):c[o.id]=o.id.__line__),"ref"in o){["type","source","source-layer","filter","layout"].forEach(function(t){t in o&&i(n,o[t],'"%s" is prohibited for ref layers',t)});var l;t.layers.forEach(function(t){t.id==u&&(l=t)}),l?l.ref?i(n,o.ref,"ref cannot reference another ref layer"):s=l.type:i(n,o.ref,'ref layer "%s" not found',u)}else if("background"!==s)if(o.source){var h=t.sources[o.source];h?"vector"==h.type&&"raster"==s?i(n,o.source,'layer "%s" requires a raster source',o.id):"raster"==h.type&&"raster"!=s?i(n,o.source,'layer "%s" requires a vector source',o.id):"vector"!=h.type||o["source-layer"]||i(n,o,'layer "%s" must specify a "source-layer"',o.id):i(n,o.source,'source "%s" not found',o.source)}else i(n,o,'missing required property "source"');a.object(n,o,e.layer,{filter:a.filter,layout:function(t,i){var n=e["layout_"+s];return s&&n&&a(t,i,n)},paint:function(t,i){var n=e["paint_"+s];return s&&n&&a(t,i,n)}})},a.object=function(t,r,o,s){s=s||{};var u=n(r);if("object"!==u)return i(t,r,"object expected, %s found",u);for(var l in r){var c=l.split(".")[0],h=o[c]||o["*"],f=c.match(/^(.*)-transition$/);h?(s[c]||a)((t?t+".":t)+l,r[l],h):f&&o[f[1]]&&o[f[1]].transition?a((t?t+".":t)+l,r[l],e.transition):""!==t&&1!==t.split(".").length&&i(t,r[l],'unknown property "%s"',l)}for(var d in o)o[d].required&&void 0===o[d].default&&void 0===r[d]&&i(t,r,'missing required property "%s"',d)},a.array=function(e,r,o,s){if("array"!==n(r))return i(e,r,"array expected, %s found",n(r));if(o.length&&r.length!==o.length)return i(e,r,"array length %d expected, length %d found",o.length,r.length);if(o["min-length"]&&r.length<o["min-length"])return i(e,r,"array length at least %d expected, length %d found",o["min-length"],r.length);var u={type:o.value};t.version<7&&(u.function=o.function),"object"===n(o.value)&&(u=o.value);for(var l=0;l<r.length;l++)(s||a)(e+"["+l+"]",r[l],u)},a.filter=function(t,o){var s;if("array"!==n(o))return i(t,o,"array expected, %s found",n(o));if(o.length<1)return i(t,o,"filter array must have at least 1 element");switch(a.enum(t+"[0]",o[0],e.filter_operator),r(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"==o[1]&&i(t,o,'"$type" cannot be use with operator "%s"',o[0]);case"==":case"!=":3!=o.length&&i(t,o,'filter array for operator "%s" must have 3 elements',o[0]);case"in":case"!in":o.length>=2&&(s=n(o[1]),"string"!==s?i(t+"[1]",o[1],"string expected, %s found",s):"@"===o[1][0]&&i(t+"[1]",o[1],"filter key cannot be a constant"));for(var u=2;u<o.length;u++)s=n(o[u]),"$type"==o[1]?a.enum(t+"["+u+"]",o[u],e.geometry_type):"string"===s&&"@"===o[u][0]?i(t+"["+u+"]",o[u],"filter value cannot be a constant"):"string"!==s&&"number"!==s&&"boolean"!==s&&i(t+"["+u+"]",o[u],"string, number, or boolean expected, %s found",s);break;case"any":case"all":case"none":for(u=1;u<o.length;u++)a.filter(t+"["+u+"]",o[u])}},a.function=function(t,r,o){a.object(t,r,e.function,{stops:function(t,e,r){var s=-1/0;a.array(t,e,r,function(t,e){return"array"!==n(e)?i(t,e,"array expected, %s found",n(e)):2!==e.length?i(t,e,"array length %d expected, length %d found",2,e.length):(a(t+"[0]",e[0],{type:"number"}),a(t+"[1]",e[1],o),void("number"===n(e[0])&&("piecewise-constant"===o.function&&e[0]%1!=0&&i(t+"[0]",e[0],"zoom level for piecewise-constant functions must be an integer"),e[0]<=s&&i(t+"[0]",e[0],"array stops must appear in ascending order and have no duplicates"),s=e[0])))}),"array"===n(e)&&0===e.length&&i(t,e,"array must have at least one stop")}})},a.enum=function(t,e,n){-1===n.values.indexOf(r(e))&&i(t,e,"expected one of [%s], %s found",n.values.join(", "),e)},a.color=function(t,e){var r=n(e);return"string"!==r?i(t,e,"color expected, %s found",r):null===o(e)?i(t,e,'color expected, "%s" found',e):void 0},a.number=u("number"),a.string=u("string"),a.boolean=u("boolean"),a["*"]=function(){},a("",t,e.$root),e.$version>7&&t.constants&&a.constants("constants",t.constants),h.sort(function(t,e){return t.line-e.line}),h}},{csscolorparser:107,util:143}],131:[function(t,e,i){e.exports=t("./v8.json")},{"./v8.json":133}],132:[function(t,e,i){e.exports=t("./v8.min.json")},{"./v8.min.json":134}],133:[function(t,e,i){e.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8],doc:"Stylesheet version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:"Default bearing, in degrees.  The style bearing will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface.  The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended.",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. Valid tokens are {fontstack} and {range}.",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties.",example:{duration:300,delay:0}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For GeoJSON and video sources, a URL must be provided."}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"],doc:"The data type of the tile source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<mapid>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},"*":{type:"*",doc:"Other keys to configure the data source."}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"],doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:14,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},buffer:{type:"number",default:64,doc:"Tile buffer size on each side (higher means fewer rendering artifacts near tile edges but slower performance)."},tolerance:{type:"number",default:3,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups."},clusterRadius:{type:"number",default:400,doc:"Radius of each cluster when clustering points, relative to 4096 tile."},clusterMaxZoom:{type:"number",doc:"Max zoom to cluster points on. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered)."}},source_video:{type:{required:!0,type:"enum",values:["video"],doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_image:{type:{required:!0,type:"enum",values:["image"],doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image"},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},layer:{id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"],doc:"Rendering type of this layer."},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},ref:{type:"string",doc:"References another layer to copy `type`, `source`, `source-layer`, `minzoom`, `maxzoom`, `filter`, and `layout` properties from. This allows the layers to share processing and be more efficient."},source:{type:"string",doc:"Name of a source description to be used for this layer."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required if the source supports multiple layers."},minzoom:{
type:"number",minimum:0,maximum:22,doc:"The minimum zoom level on which the layer gets parsed and appears on."},maxzoom:{type:"number",minimum:0,maximum:22,doc:"The maximum zoom level on which the layer gets parsed and appears on."},interactive:{type:"boolean",doc:"Enable querying of feature data from this layer for interactivity.",default:!1},filter:{type:"filter",doc:"A expression specifying conditions on source features. Only features that match the filter are displayed."},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."},"paint.*":{type:"paint",doc:"Class-specific paint properties for this layer. The class name is the part after the first dot."}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_fill:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_circle:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant",values:["butt","round","square"],default:"butt",doc:"The display of line endings."},"line-join":{type:"enum",function:"piecewise-constant",values:["bevel","round","miter"],default:"miter",doc:"The display of lines when joining."},"line-miter-limit":{type:"number",default:2,function:"interpolated",doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated",doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant",values:["point","line"],default:"point",doc:"Label placement relative to its geometry. `line` can only be used on LineStrings and Polygons."},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated",units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer."},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",doc:"Orientation of icon when map is rotated.",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated",doc:"Scale factor for icon. 1 is original size, 3 triples the size.",requires:["icon-image"]},"icon-image":{type:"string",function:"piecewise-constant",doc:"A string with {tokens} replaced, referencing the data property to pull from.",tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated",units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated",units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",doc:"Orientation of text when map is rotated.",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant",default:"",tokens:!0,doc:"Value to use for a text label. Feature properties are specified using tokens like {field_name}."},"text-font":{type:"array",value:"string",function:"piecewise-constant",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated",doc:"Font size.",requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"em",function:"interpolated",doc:"The maximum line width for text wrapping.",requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"em",function:"interpolated",doc:"Text leading value for multi-line text.",requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"em",function:"interpolated",doc:"Text tracking amount.",requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant",values:["left","center","right"],default:"center",doc:"Text justification options.",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated",doc:"Rotates the text clockwise.",requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant",values:["none","uppercase","lowercase"],default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"]},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up.",value:"number",units:"ems",function:"interpolated",length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_raster:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},filter:{type:"array",value:"*",doc:"A filter selects specific features from a layer."},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"],doc:"The filter operator."},geometry_type:{type:"enum",values:["Point","LineString","Polygon"],doc:"The geometry type for the filter to select."},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"],doc:"A color operation to apply."},function:{stops:{type:"array",required:!0,doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2,doc:"Zoom level and value pair."},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant",default:!0,doc:"Whether or not the fill should be antialiased."},"fill-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,doc:"The opacity given to the fill color.",transition:!0},"fill-color":{type:"color",default:"#000000",doc:"The color of the fill.",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"fill-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512)."}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"line-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Stroke thickness."},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",function:"interpolated",transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,doc:'The line\'s offset perpendicular to its direction. Values may be positive or negative, where positive indicates "rightwards" (if you were moving in the direction of the line) and negative indicates "leftwards."',function:"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels."},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512)."}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Circle radius."},"circle-color":{type:"color",default:"#000000",doc:"The color of the circle.",function:"interpolated",transition:!0},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",function:"interpolated",transition:!0},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"circle-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["circle-translate"]}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,doc:"The color of the icon. This can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).",default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["text-field"]},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).",default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated",transition:!0,units:"degrees",doc:"Rotates hues around the color wheel."},"raster-brightness-min":{type:"number",function:"interpolated",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated",transition:!0,units:"milliseconds",doc:"Fade duration when a new tile is added."}},paint_background:{"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",function:"interpolated",transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512)."},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",function:"interpolated",transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}}}},{}],134:[function(t,e,i){e.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"]},url:{type:"string"},tiles:{type:"array",value:"string"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"]},data:{type:"*"},maxzoom:{type:"number",default:14},buffer:{type:"number",default:64},tolerance:{type:"number",default:3},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:400},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:["video"]},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:["image"]},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"]},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:22},maxzoom:{type:"number",minimum:0,maximum:22},interactive:{type:"boolean",default:!1},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"},"paint.*":{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_fill:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_circle:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",function:"piecewise-constant",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated",requires:[{"line-join":"round"}]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated",units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant",default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated",requires:["icon-image"]},"icon-image":{type:"string",function:"piecewise-constant",tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated",units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated",units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",requires:["icon-image"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant",default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated",requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"em",function:"interpolated",requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"em",function:"interpolated",requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"em",function:"interpolated",requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant",values:["left","center","right"],default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated",requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated",requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant",values:["none","uppercase","lowercase"],default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated",length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_raster:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"]},geometry_type:{type:"enum",values:["Point","LineString","Polygon"]},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"]},function:{stops:{type:"array",required:!0,value:"function_stop"},base:{type:"number",default:1,minimum:0}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant",default:!0},"fill-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant",transition:!0}},paint_line:{"line-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant",transition:!0}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated",transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated",transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["circle-translate"]}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated",transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated",default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated",transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"background-pattern"}]},
"background-pattern":{type:"string",function:"piecewise-constant",transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}}}},{}],135:[function(t,e,i){function n(t){var e;t&&t.length&&(e=t,t=e.length);var i=new Uint8Array(t||0);return e&&i.set(e),i.readUInt32LE=o.readUInt32LE,i.writeUInt32LE=o.writeUInt32LE,i.readInt32LE=o.readInt32LE,i.writeInt32LE=o.writeInt32LE,i.readFloatLE=o.readFloatLE,i.writeFloatLE=o.writeFloatLE,i.readDoubleLE=o.readDoubleLE,i.writeDoubleLE=o.writeDoubleLE,i.toString=o.toString,i.write=o.write,i.slice=o.slice,i.copy=o.copy,i._isBuffer=!0,i}function r(t){for(var e,i,n=t.length,r=[],o=0;n>o;o++){if((e=t.charCodeAt(o))>55295&&57344>e){if(!i){e>56319||o+1===n?r.push(239,191,189):i=e;continue}if(56320>e){r.push(239,191,189),i=e;continue}e=i-55296<<10|e-56320|65536,i=null}else i&&(r.push(239,191,189),i=null);128>e?r.push(e):2048>e?r.push(e>>6|192,63&e|128):65536>e?r.push(e>>12|224,e>>6&63|128,63&e|128):r.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}return r}e.exports=n;var o,s,a,u=t("ieee754");o={readUInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},writeUInt32LE:function(t,e){this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24},readInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+(this[t+3]<<24)},readFloatLE:function(t){return u.read(this,t,!0,23,4)},readDoubleLE:function(t){return u.read(this,t,!0,52,8)},writeFloatLE:function(t,e){return u.write(this,t,e,!0,23,4)},writeDoubleLE:function(t,e){return u.write(this,t,e,!0,52,8)},toString:function(t,e,i){var n="",r="";e=e||0,i=Math.min(this.length,i||this.length);for(var o=e;i>o;o++){var s=this[o];127>=s?(n+=decodeURIComponent(r)+String.fromCharCode(s),r=""):r+="%"+s.toString(16)}return n+=decodeURIComponent(r)},write:function(t,e){for(var i=t===s?a:r(t),n=0;n<i.length;n++)this[e+n]=i[n]},slice:function(t,e){return this.subarray(t,e)},copy:function(t,e){e=e||0;for(var i=0;i<this.length;i++)t[e+i]=this[i]}},o.writeInt32LE=o.writeUInt32LE,n.byteLength=function(t){return s=t,a=r(t),a.length},n.isBuffer=function(t){return!(!t||!t._isBuffer)}},{ieee754:126}],136:[function(t,e,i){(function(i){function n(t){this.buf=d.isBuffer(t)?t:new d(t||0),this.pos=0,this.length=this.buf.length}function r(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function o(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function s(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function a(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function u(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function l(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function c(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function h(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}e.exports=n;var d=i.Buffer||t("./buffer");n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var p=Math.pow(2,63);n.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,o=this.pos;t(r,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=this.buf.readUInt32LE(this.pos);return this.pos+=4,t},readSFixed32:function(){var t=this.buf.readInt32LE(this.pos);return this.pos+=4,t},readFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readUInt32LE(this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readInt32LE(this.pos+4);return this.pos+=8,t},readFloat:function(){var t=this.buf.readFloatLE(this.pos);return this.pos+=4,t},readDouble:function(){var t=this.buf.readDoubleLE(this.pos);return this.pos+=8,t},readVarint:function(){var t,e,i,n,r,o,s=this.buf;if(128>(i=s[this.pos++]))return i;if(i&=127,128>(n=s[this.pos++]))return i|n<<7;if(n=(127&n)<<7,128>(r=s[this.pos++]))return i|n|r<<14;if(r=(127&r)<<14,128>(o=s[this.pos++]))return i|n|r|o<<21;if(t=i|n|r|(127&o)<<21,e=s[this.pos++],t+=268435456*(127&e),128>e)return t;if(e=s[this.pos++],t+=34359738368*(127&e),128>e)return t;if(e=s[this.pos++],t+=4398046511104*(127&e),128>e)return t;if(e=s[this.pos++],t+=562949953421312*(127&e),128>e)return t;if(e=s[this.pos++],t+=72057594037927940*(127&e),128>e)return t;if(e=s[this.pos++],t+=0x8000000000000000*(127&e),128>e)return t;throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){var t=this.pos,e=this.readVarint();if(p>e)return e;for(var i=this.pos-2;255===this.buf[i];)i--;t>i&&(i=t),e=0;for(var n=0;i-t+1>n;n++){var r=127&~this.buf[t+n];e+=4>n?r<<7*n:r*Math.pow(2,7*n)}return-e-1},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.buf.toString("utf8",this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.slice(this.pos,t);return this.pos=t,e},readPackedVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readVarint());return e},readPackedSVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(t){var e=7&t;if(e===n.Varint)for(;this.buf[this.pos++]>127;);else if(e===n.Bytes)this.pos=this.readVarint()+this.pos;else if(e===n.Fixed32)this.pos+=4;else{if(e!==n.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new d(e);this.buf.copy(i),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(t){this.realloc(4),this.buf.writeUInt32LE(t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),this.buf.writeInt32LE(t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeUInt32LE(Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeInt32LE(Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){if(127>=(t=+t))this.realloc(1),this.buf[this.pos++]=t;else if(16383>=t)this.realloc(2),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127;else if(2097151>=t)this.realloc(3),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127|128,this.buf[this.pos++]=t>>>14&127;else if(268435455>=t)this.realloc(4),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127|128,this.buf[this.pos++]=t>>>14&127|128,this.buf[this.pos++]=t>>>21&127;else{for(var e=this.pos;t>=128;)this.realloc(1),this.buf[this.pos++]=255&t|128,t/=128;if(this.realloc(1),this.buf[this.pos++]=0|t,this.pos-e>10)throw new Error("Given varint doesn't fit into 10 bytes")}},writeSVarint:function(t){this.writeVarint(0>t?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t);var e=d.byteLength(t);this.writeVarint(e),this.realloc(e),this.buf.write(t,this.pos),this.pos+=e},writeFloat:function(t){this.realloc(4),this.buf.writeFloatLE(t,this.pos),this.pos+=4},writeDouble:function(t){this.realloc(8),this.buf.writeDoubleLE(t,this.pos),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;e>i;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i,r=127>=n?1:16383>=n?2:2097151>=n?3:268435455>=n?4:Math.ceil(Math.log(n)/(7*Math.LN2));if(r>1){this.realloc(r-1);for(var o=this.pos-1;o>=i;o--)this.buf[o+r-1]=this.buf[o]}this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,n.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){this.writeMessage(t,r,e)},writePackedSVarint:function(t,e){this.writeMessage(t,o,e)},writePackedBoolean:function(t,e){this.writeMessage(t,u,e)},writePackedFloat:function(t,e){this.writeMessage(t,s,e)},writePackedDouble:function(t,e){this.writeMessage(t,a,e)},writePackedFixed32:function(t,e){this.writeMessage(t,l,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,c,e)},writePackedFixed64:function(t,e){this.writeMessage(t,h,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,f,e)},writeBytesField:function(t,e){this.writeTag(t,n.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,n.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,n.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,n.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./buffer":135}],137:[function(t,e,i){function n(t,e){this.x=t,this.y=e}e.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x-i*this.y,r=i*this.x+e*this.y;return this.x=n,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},{}],138:[function(t,e,i){function n(){c=!1,a.length?l=a.concat(l):h=-1,l.length&&r()}function r(){if(!c){var t=setTimeout(n);c=!0;for(var e=l.length;e;){for(a=l,l=[];++h<e;)a&&a[h].run();h=-1,e=l.length}a=null,c=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function s(){}var a,u=e.exports={},l=[],c=!1,h=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new o(t,e)),1!==l.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=s,u.addListener=s,u.once=s,u.off=s,u.removeListener=s,u.removeAllListeners=s,u.emit=s,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],139:[function(e,i,n){!function(){function e(t,i){return this instanceof e?(this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&this._initFormat(i),void this.clear()):new e(t,i)}function n(t,e){t.bbox=r(t,0,t.children.length,e)}function r(t,e,i,n){for(var r,a=o(),u=e;i>u;u++)r=t.children[u],s(a,t.leaf?n(r):r.bbox);return a}function o(){return[1/0,1/0,-1/0,-1/0]}function s(t,e){return t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t}function a(t,e){return t.bbox[0]-e.bbox[0]}function u(t,e){return t.bbox[1]-e.bbox[1]}function l(t){return(t[2]-t[0])*(t[3]-t[1])}function c(t){return t[2]-t[0]+(t[3]-t[1])}function h(t,e){return(Math.max(e[2],t[2])-Math.min(e[0],t[0]))*(Math.max(e[3],t[3])-Math.min(e[1],t[1]))}function f(t,e){var i=Math.max(t[0],e[0]),n=Math.max(t[1],e[1]),r=Math.min(t[2],e[2]),o=Math.min(t[3],e[3]);return Math.max(0,r-i)*Math.max(0,o-n)}function d(t,e){return t[0]<=e[0]&&t[1]<=e[1]&&e[2]<=t[2]&&e[3]<=t[3]}function p(t,e){return e[0]<=t[2]&&e[1]<=t[3]&&e[2]>=t[0]&&e[3]>=t[1]}function m(t,e,i,n,r){for(var o,s=[e,i];s.length;)i=s.pop(),e=s.pop(),n>=i-e||(o=e+Math.ceil((i-e)/n/2)*n,_(t,e,i,o,r),s.push(e,o,o,i))}function _(t,e,i,n,r){for(var o,s,a,u,l,c,h,f,d;i>e;){for(i-e>600&&(o=i-e+1,s=n-e+1,a=Math.log(o),u=.5*Math.exp(2*a/3),l=.5*Math.sqrt(a*u*(o-u)/o)*(0>s-o/2?-1:1),c=Math.max(e,Math.floor(n-s*u/o+l)),h=Math.min(i,Math.floor(n+(o-s)*u/o+l)),_(t,c,h,n,r)),f=t[n],s=e,d=i,g(t,e,n),r(t[i],f)>0&&g(t,e,i);d>s;){for(g(t,s,d),s++,d--;r(t[s],f)<0;)s++;for(;r(t[d],f)>0;)d--}0===r(t[e],f)?g(t,e,d):(d++,g(t,d,i)),n>=d&&(e=d+1),d>=n&&(i=d-1)}}function g(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!p(t,e.bbox))return i;for(var r,o,s,a,u=[];e;){for(r=0,o=e.children.length;o>r;r++)s=e.children[r],a=e.leaf?n(s):s.bbox,p(t,a)&&(e.leaf?i.push(s):d(t,a)?this._all(s,i):u.push(s));e=u.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!p(t,e.bbox))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;r>n;n++)if(o=e.children[n],s=e.leaf?i(o):o.bbox,p(t,s)){if(e.leaf||d(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;i>e;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data={children:[],height:1,bbox:o(),leaf:!0},this},remove:function(t){if(!t)return this;for(var e,i,n,r,o=this.data,s=this.toBBox(t),a=[],u=[];o||a.length;){if(o||(o=a.pop(),i=a[a.length-1],e=u.pop(),r=!0),o.leaf&&-1!==(n=o.children.indexOf(t)))return o.children.splice(n,1),a.push(o),this._condense(a),this;r||o.leaf||!d(o.bbox,s)?i?(e++,o=i.children[e],r=!1):o=null:(a.push(o),u.push(e),e=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:function(t,e){return t[0]-e[0]},compareMinY:function(t,e){return t[1]-e[1]},toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,r){var o,s=i-e+1,a=this._maxEntries;if(a>=s)return o={children:t.slice(e,i+1),height:1,bbox:null,leaf:!0},n(o,this.toBBox),o;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),o={children:[],height:r,bbox:null,leaf:!1};var u,l,c,h,f=Math.ceil(s/a),d=f*Math.ceil(Math.sqrt(a));for(m(t,e,i,d,this.compareMinX),u=e;i>=u;u+=d)for(c=Math.min(u+d-1,i),m(t,u,c,f,this.compareMinY),l=u;c>=l;l+=f)h=Math.min(l+f-1,c),o.children.push(this._build(t,l,h,r-1));return n(o,this.toBBox),o},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,u,c,f,d;n.push(e),!e.leaf&&n.length-1!==i;){for(f=d=1/0,r=0,o=e.children.length;o>r;r++)s=e.children[r],u=l(s.bbox),c=h(t,s.bbox)-u,d>c?(d=c,f=f>u?u:f,a=s):c===d&&f>u&&(f=u,a=s);e=a}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t.bbox:n(t),o=[],a=this._chooseSubtree(r,this.data,e,o);for(a.children.push(t),s(a.bbox,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],r=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,r);var s=this._chooseSplitIndex(i,o,r),a={children:i.children.splice(s,i.children.length-s),height:i.height,bbox:null,leaf:!1};i.leaf&&(a.leaf=!0),n(i,this.toBBox),n(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data={children:[t,e],height:t.height+1,bbox:null,leaf:!1},n(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,o,s,a,u,c,h,d;for(c=h=1/0,n=e;i-e>=n;n++)o=r(t,0,n,this.toBBox),s=r(t,n,i,this.toBBox),a=f(o,s),u=l(o)+l(s),c>a?(c=a,d=n,h=h>u?u:h):a===c&&h>u&&(h=u,d=n);return d},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:a,r=t.leaf?this.compareMinY:u,o=this._allDistMargin(t,e,i,n);this._allDistMargin(t,e,i,r)>o&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var o,a,u=this.toBBox,l=r(t,0,e,u),h=r(t,i-e,i,u),f=c(l)+c(h);for(o=e;i-e>o;o++)a=t.children[o],s(l,t.leaf?u(a):a.bbox),f+=c(l);for(o=i-e-1;o>=e;o--)a=t.children[o],s(h,t.leaf?u(a):a.bbox),f+=c(h);return f},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)s(e[n].bbox,t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children,e.splice(e.indexOf(t[i]),1)):this.clear():n(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return [a"+t.join(", a")+"];")}},"function"==typeof t&&t.amd?t("rbush",function(){return e}):void 0!==i?i.exports=e:"undefined"!=typeof self?self.rbush=e:window.rbush=e}()},{}],140:[function(e,i,n){!function(e,r){"function"==typeof t&&t.amd?t(r):"object"==typeof n?i.exports=r():e.resolveUrl=r()}(this,function(){function t(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var i=document.getElementsByTagName("head")[0];i.insertBefore(e,i.firstChild);for(var n,r=document.createElement("a"),o=1;t>o;o++)r.href=arguments[o],n=r.href,e.href=n;return i.removeChild(e),n}return t})},{}],141:[function(t,e,i){function n(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=i,this.p2y=n}e.exports=n,n.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},n.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},n.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},n.prototype.solveCurveX=function(t,e){void 0===e&&(e=1e-6);var i,n,r,o,s;for(r=t,s=0;8>s;s++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=o/a}if(i=0,n=1,r=t,i>r)return i;if(r>n)return n;for(;n>i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?i=r:n=r,r=.5*(n-i)+i}return r},n.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},{}],142:[function(t,e,i){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],143:[function(t,e,i){(function(e,n){function r(t,e){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(e)?n.showHidden=e:e&&i._extend(n,e),x(n.showHidden)&&(n.showHidden=!1),x(n.depth)&&(n.depth=2),x(n.colors)&&(n.colors=!1),x(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,t,n.depth)}function o(t,e){var i=r.styles[e];return i?"["+r.colors[i][0]+"m"+t+"["+r.colors[i][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,i){e[t]=!0}),e}function u(t,e,n){if(t.customInspect&&e&&M(e.inspect)&&e.inspect!==i.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return y(r)||(r=u(t,r,n)),r}var o=l(t,e);if(o)return o;var s=Object.keys(e),m=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),T(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(e);if(0===s.length){if(M(e)){var _=e.name?": "+e.name:"";return t.stylize("[Function"+_+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(S(e))return t.stylize(Date.prototype.toString.call(e),"date");if(T(e))return c(e)}var g="",v=!1,b=["{","}"];if(p(e)&&(v=!0,b=["[","]"]),M(e)&&(g=" [Function"+(e.name?": "+e.name:"")+"]"),w(e)&&(g=" "+RegExp.prototype.toString.call(e)),S(e)&&(g=" "+Date.prototype.toUTCString.call(e)),T(e)&&(g=" "+c(e)),0===s.length&&(!v||0==e.length))return b[0]+g+b[1];if(0>n)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var x;return x=v?h(t,e,n,m,s):s.map(function(i){return f(t,e,n,m,i,v)}),t.seen.pop(),d(x,g,b)}function l(t,e){if(x(e))return t.stylize("undefined","undefined");if(y(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return v(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):_(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,i,n,r){for(var o=[],s=0,a=e.length;a>s;++s)k(e,String(s))?o.push(f(t,e,i,n,String(s),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(f(t,e,i,n,r,!0))}),o}function f(t,e,i,n,r,o){var s,a,l;if(l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},l.get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),k(n,r)||(s="["+r+"]"),a||(t.seen.indexOf(l.value)<0?(a=_(i)?u(t,l.value,null):u(t,l.value,i-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),x(s)){if(o&&r.match(/^\d+$/))return a;s=JSON.stringify(""+r),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function d(t,e,i){var n=0;return t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}function p(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function _(t){return null===t}function g(t){return null==t}function v(t){return"number"==typeof t}function y(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function x(t){return void 0===t}function w(t){return L(t)&&"[object RegExp]"===P(t)}function L(t){return"object"==typeof t&&null!==t}function S(t){return L(t)&&"[object Date]"===P(t)}function T(t){return L(t)&&("[object Error]"===P(t)||t instanceof Error)}function M(t){return"function"==typeof t}function E(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function P(t){return Object.prototype.toString.call(t)}function C(t){return 10>t?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[C(t.getHours()),C(t.getMinutes()),C(t.getSeconds())].join(":");return[t.getDate(),O[t.getMonth()],e].join(" ")}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var z=/%[sdj%]/g;i.format=function(t){if(!y(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(r(arguments[i]));return e.join(" ")}for(var i=1,n=arguments,o=n.length,s=String(t).replace(z,function(t){if("%%"===t)return"%";if(i>=o)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return t}}),a=n[i];o>i;a=n[++i])s+=_(a)||!L(a)?" "+a:" "+r(a);return s},i.deprecate=function(t,r){function o(){if(!s){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),s=!0}return t.apply(this,arguments)}if(x(n.process))return function(){return i.deprecate(t,r).apply(this,arguments)};if(!0===e.noDeprecation)return t;var s=!1;return o};var I,R={};i.debuglog=function(t){if(x(I)&&(I=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!R[t])if(new RegExp("\\b"+t+"\\b","i").test(I)){var n=e.pid;R[t]=function(){var e=i.format.apply(i,arguments);console.error("%s %d: %s",t,n,e)}}else R[t]=function(){};return R[t]},i.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=p,i.isBoolean=m,i.isNull=_,i.isNullOrUndefined=g,i.isNumber=v,i.isString=y,i.isSymbol=b,i.isUndefined=x,i.isRegExp=w,i.isObject=L,i.isDate=S,i.isError=T,i.isFunction=M,i.isPrimitive=E,i.isBuffer=t("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",A(),i.format.apply(i,arguments))},i.inherits=t("inherits"),i._extend=function(t,e){if(!e||!L(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":142,_process:138,inherits:127}],144:[function(t,e,i){e.exports.VectorTile=t("./lib/vectortile.js"),e.exports.VectorTileFeature=t("./lib/vectortilefeature.js"),e.exports.VectorTileLayer=t("./lib/vectortilelayer.js")},{"./lib/vectortile.js":145,"./lib/vectortilefeature.js":147,"./lib/vectortilelayer.js":148}],145:[function(t,e,i){function n(t,e){this.layers=t.readFields(r,{},e)}function r(t,e,i){if(3===t){var n=new o(i,i.readVarint()+i.pos);n.length&&(e[n.name]=n)}}var o=t("./vectortilelayer");e.exports=n},{"./vectortilelayer":148}],146:[function(t,e,i){function n(t){this.feature=t,this.finalRatio=4096/t.extent*Math.pow(2,t.dz);var e=64;e/=this.finalRatio;var i=t.extent>>t.dz;e>i&&(e=i),this.dz=t.dz,this.margin=e,this.xmin=i*t.xPos-e,this.ymin=i*t.yPos-e,this.xmax=this.xmin+i+2*e,this.ymax=this.ymin+i+2*e,this.lines=[],this._prevIsIn=!1,this.type=t.type}var r=t("point-geometry");e.exports=n,n.prototype.loadGeometry=function(){var t=this.feature._pbf;t.pos=this.feature._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,r=0,o=0;t.pos<e;){if(!n){var s=t.readVarint();i=7&s,n=s>>3}if(n--,1===i||2===i)r+=t.readSVarint(),o+=t.readSVarint(),1===i?this.moveTo(r,o):this.lineTo(r,o);else{if(7!==i)throw new Error("unknown command "+i);this.closePolygon()}}return this.result()},n.prototype.moveTo=function(t,e){this._push_line(),this._prevIsIn=this._isIn(t,e),this._moveTo(t,e,this._prevIsIn),this._prevPt=new r(t,e),this._firstPt=new r(t,e)},n.prototype.lineTo=function(t,e){var i,n,o,s,a,u,l,c,h,f,d,p,m=this._isIn(t,e);if(m)this._prevIsIn?this._lineTo(t,e,!0):(i=this._prevPt,n=new r(t,e),o=this._intersect(n,i),this._lineTo(o.x,o.y,!0),this._lineTo(n.x,n.y,!0));else if(this._prevIsIn)n=this._prevPt,i=new r(t,e),o=this._intersect(n,i),this._lineTo(o.x,o.y,!0),this._lineTo(i.x,i.y,!1);else if(s=this._prevPt,a=new r(t,e),s.x<=this.xmin&&a.x<=this.xmin||s.x>=this.xmax&&a.x>=this.xmax||s.y<=this.ymin&&a.y<=this.ymin||s.y>=this.ymax&&a.y>=this.ymax)this._lineTo(a.x,a.y,!1);else{if(c=[],(s.x<this.xmin&&a.x>this.xmin||s.x>this.xmin&&a.x<this.xmin)&&(u=(this.xmin-s.x)/(a.x-s.x),p=s.y+u*(a.y-s.y),p<=this.ymin?f=!1:p>=this.ymax?f=!0:(l={},l.ratio=u,l.x=this.xmin,l.y=p,c.push(l))),(s.x<this.xmax&&a.x>this.xmax||s.x>this.xmax&&a.x<this.xmax)&&(u=(this.xmax-s.x)/(a.x-s.x),p=s.y+u*(a.y-s.y),p<=this.ymin?f=!1:p>=this.ymax?f=!0:(l={},l.ratio=u,l.x=this.xmax,l.y=p,c.push(l))),(s.y<this.ymin&&a.y>this.ymin||s.y>this.ymin&&a.y<this.ymin)&&(u=(this.ymin-s.y)/(a.y-s.y),d=s.x+u*(a.x-s.x),d<=this.xmin?h=!1:d>=this.xmax?h=!0:(l={},l.ratio=u,l.x=d,l.y=this.ymin,c.push(l))),(s.y<this.ymax&&a.y>this.ymax||s.y>this.ymax&&a.y<this.ymax)&&(u=(this.ymax-s.y)/(a.y-s.y),d=s.x+u*(a.x-s.x),d<=this.xmin?h=!1:d>=this.xmax?h=!0:(l={},l.ratio=u,l.x=d,l.y=this.ymax,c.push(l))),0===c.length)h?f?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):f?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(c.length>1&&c[0].ratio>c[1].ratio)this._lineTo(c[1].x,c[1].y,!0),this._lineTo(c[0].x,c[0].y,!0);else for(var _=0;_<c.length;_++)this._lineTo(c[_].x,c[_].y,!0);this._lineTo(a.x,a.y,!1)}this._prevIsIn=m,this._prevPt=new r(t,e)},n.prototype.closePolygon=function(){var t,e;this.line.length>0&&(t=this._firstPt,e=this._prevPt,(t.x!==e.x||t.y!==e.y)&&this.lineTo(t.x,t.y))},n.prototype.result=function(){return this._push_line(),0===this.lines.length?null:this.lines},n.prototype._isIn=function(t,e){return t>=this.xmin&&t<=this.xmax&&e>=this.ymin&&e<=this.ymax},n.prototype._intersect=function(t,e){var i,n,o,s;return e.x>=this.xmin&&e.x<=this.xmax?(n=e.y<=this.ymin?this.ymin:this.ymax,i=t.x+(n-t.y)/(e.y-t.y)*(e.x-t.x)):e.y>=this.ymin&&e.y<=this.ymax?(i=e.x<=this.xmin?this.xmin:this.xmax,n=t.y+(i-t.x)/(e.x-t.x)*(e.y-t.y)):(n=e.y<=this.ymin?this.ymin:this.ymax,i=e.x<=this.xmin?this.xmin:this.xmax,o=(i-t.x)/(e.x-t.x),s=(n-t.y)/(e.y-t.y),s>o?n=t.y+o*(e.y-t.y):i=t.x+s*(e.x-t.x)),new r(i,n)},n.prototype._push_line=function(){this.line&&(1===this.type?this.line.length>0&&this.lines.push(this.line):2===this.type?this.line.length>1&&this.lines.push(this.line):3===this.type&&this.line.length>3&&this.lines.push(this.line)),this.line=[]},n.prototype._moveTo=function(t,e,i){3!==this.type?i&&(t=(t-(this.xmin+this.margin))*this.finalRatio,e=(e-(this.ymin+this.margin))*this.finalRatio,this.line.push(new r(t,e))):(i||(t<this.xmin&&(t=this.xmin),t>this.xmax&&(t=this.xmax),e<this.ymin&&(e=this.ymin),e>this.ymax&&(e=this.ymax)),t=(t-(this.xmin+this.margin))*this.finalRatio,e=(e-(this.ymin+this.margin))*this.finalRatio,this.line.push(new r(t,e)),this._is_h=!1,this._is_v=!1)},n.prototype._lineTo=function(t,e,i){var n,o;if(3!==this.type)if(i){if(t=(t-(this.xmin+this.margin))*this.finalRatio,
e=(e-(this.ymin+this.margin))*this.finalRatio,this.line.length>0&&(n=this.line[this.line.length-1],n.x===t&&n.y===e))return;this.line.push(new r(t,e))}else this.line&&this.line.length>0&&this._push_line();else if(i||(t<this.xmin&&(t=this.xmin),t>this.xmax&&(t=this.xmax),e<this.ymin&&(e=this.ymin),e>this.ymax&&(e=this.ymax)),t=(t-(this.xmin+this.margin))*this.finalRatio,e=(e-(this.ymin+this.margin))*this.finalRatio,this.line&&this.line.length>0){n=this.line[this.line.length-1];var s=n.x===t,a=n.y===e;if(s&&a)return;this._is_h&&s?(n.x=t,n.y=e,o=this.line[this.line.length-2],this._is_h=o.x===t,this._is_v=o.y===e):this._is_v&&a?(n.x=t,n.y=e,o=this.line[this.line.length-2],this._is_h=o.x===t,this._is_v=o.y===e):(this.line.push(new r(t,e)),this._is_h=s,this._is_v=a)}else this.line.push(new r(t,e))}},{"point-geometry":137}],147:[function(t,e,i){function n(t,e,i,n,o){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=o,t.readFields(r,this,e)}function r(t,e,i){1==t?e._id=i.readVarint():2==t?o(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function o(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var n=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[n]=r}}var s=t("point-geometry"),a=t("./vectortileclipper");e.exports=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var t;if(this.dz)t=new a(this).loadGeometry();else{for(var e=0,i=this.extent;i>4096;)e+=1,i>>=1;var n=this._pbf;n.pos=this._geometry;var r,o=n.readVarint()+n.pos,u=1,l=0,c=0,h=0;for(t=[];n.pos<o;){if(!l){var f=n.readVarint();u=7&f,l=f>>3}if(l--,1===u||2===u)c+=n.readSVarint(),h+=n.readSVarint(),1===u&&(r&&t.push(r),r=[]),r.push(new s(c>>e,h>>e));else{if(7!==u)throw new Error("unknown command "+u);r&&r.push(r[0].clone())}}r&&t.push(r)}return t},n.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,r=0,o=0,s=1/0,a=-1/0,u=1/0,l=-1/0;t.pos<e;){if(!n){var c=t.readVarint();i=7&c,n=c>>3}if(n--,1===i||2===i)r+=t.readSVarint(),o+=t.readSVarint(),s>r&&(s=r),r>a&&(a=r),u>o&&(u=o),o>l&&(l=o);else if(7!==i)throw new Error("unknown command "+i)}return[s,u,a,l]},n.prototype.toGeoJSON=function(t,e,i){for(var r=this.extent*Math.pow(2,i),o=this.extent*t,s=this.extent*e,a=this.loadGeometry(),u=n.types[this.type],l=0;l<a.length;l++)for(var c=a[l],h=0;h<c.length;h++){var f=c[h],d=180-360*(f.y+s)/r;c[h]=[360*(f.x+o)/r-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}return"Point"===u&&1===a.length?a=a[0][0]:"Point"===u?(a=a[0],u="MultiPoint"):"LineString"===u&&1===a.length?a=a[0]:"LineString"===u&&(u="MultiLineString"),{type:"Feature",geometry:{type:u,coordinates:a},properties:this.properties}}},{"./vectortileclipper":146,"point-geometry":137}],148:[function(t,e,i){function n(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(r,this,e),this.length=this._features.length}function r(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(o(i))}function o(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}var s=t("./vectortilefeature.js");e.exports=n,n.prototype.feature=function(t){if(0>t||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new s(this._pbf,e,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":147}],149:[function(t,e,i){var n=arguments[3],r=arguments[4],o=arguments[5],s=JSON.stringify;e.exports=function(t){for(var e,i=Object.keys(o),a=0,u=i.length;u>a;a++){var l=i[a],c=o[l].exports;if(c===t||c.default===t){e=l;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var h={},a=0,u=i.length;u>a;a++){var l=i[a];h[l]=l}r[e]=[Function(["require","module","exports"],"("+t+")(self)"),h]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),d={};d[e]=e,r[f]=[Function(["require"],"var f = require("+s(e)+");(f.default ? f.default : f)(self);"),d];var p="("+n+")({"+Object.keys(r).map(function(t){return s(t)+":["+r[t][0]+","+s(r[t][1])+"]"}).join(",")+"},{},["+s(f)+"])",m=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(m.createObjectURL(new Blob([p],{type:"text/javascript"})))}},{}]},{},[24])(24)}),L.MapboxGL=L.Layer.extend({options:{updateInterval:32},initialize:function(t){if(L.setOptions(this,t),!t.accessToken)throw new Error("You should provide a Mapbox GL access token as a token option.");mapboxgl.accessToken=t.accessToken,this._throttledUpdate=function(t,e,i){var n,r,o,s;return s=function(){n=!1,r&&(o.apply(i,r),r=!1)},o=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}}(L.Util.bind(this._update,this),this.options.updateInterval)},onAdd:function(t){this._glContainer||this._initContainer(),t._panes.tilePane.appendChild(this._glContainer),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),t.options.zoomAnimation&&L.DomEvent.on(t._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(t){this._map.options.zoomAnimation&&L.DomEvent.off(this._map._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this),t.getPanes().tilePane.removeChild(this._glContainer),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd}},_initContainer:function(){var t=this._glContainer=L.DomUtil.create("div","leaflet-gl-layer"),e=this._map.getSize();t.style.width=e.x+"px",t.style.height=e.y+"px"},_initGL:function(){var t=this._map.getCenter(),e=L.extend({},this.options,{container:this._glContainer,interactive:!1,center:[t.lng,t.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new mapboxgl.Map(e),this._glMap.transform.latRange=null,this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas,L.DomUtil.addClass(this._glMap._actualCanvas,"leaflet-image-layer"),L.DomUtil.addClass(this._glMap._actualCanvas,"leaflet-zoom-animated")},_update:function(t){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var e=this._map.getSize(),i=this._glContainer,n=this._glMap,r=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(i,r);var o=this._map.getCenter(),s=n.transform;s.center=mapboxgl.LngLat.convert([o.lng,o.lat]),s.zoom=this._map.getZoom()-1,n.transform.width!==e.x||n.transform.height!==e.y?(i.style.width=e.x+"px",i.style.height=e.y+"px",null!==n._resize&&void 0!==n._resize?n._resize():n.resize()):null!==n._update&&void 0!==n._update?n._update():n.update()}},_pinchZoom:function(t){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),t.zoom,t.center);L.DomUtil.setTransform(this._glMap._actualCanvas,i.subtract(this._offset),e)},_zoomStart:function(t){this._zooming=!0},_zoomEnd:function(){var t=this._map.getZoomScale(this._map.getZoom()),e=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),this._map.getZoom(),this._map.getCenter());L.DomUtil.setTransform(this._glMap._actualCanvas,e.subtract(this._offset),t),this._zooming=!1},_transitionEnd:function(t){L.Util.requestAnimFrame(function(){var t=this._map.getZoom(),e=this._map.getCenter(),i=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());L.DomUtil.setTransform(this._glMap._actualCanvas,i,1),this._glMap.once("moveend",L.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:e,zoom:t-1})},this)}}),L.mapboxGL=function(t){return new L.MapboxGL(t)};var a=e.Layer.extend({statics:{URLPREFIX:"https://www.arcgis.com/sharing/rest/content/items/",URLSUFFIX:"/resources/styles/root.json",STYLES:{DarkGray:"57436c01bc754dbb87dfb636b6484022",Gray:"8a2cba3b0ebf4140b7c0dc5ee149549a",Hybrid:"af6063d6906c4eb589dfe03819610660",Navigation:"e19e9330bf08490ca8353d76b5e2e658",Streets:"a60a37a27cc140ddad15f919cd5a69f2",StreetsNight:"92c551c9f07b4147846aae273e822714",StreetsRelief:"78c0a9ab4fbf4198a8b951848aab19d8",Topographic:"86d5ed4b6dc741de9dad5f0fbe09ae95",Spring:"763884983d3544c0a418a97992881fce",Newspaper:"4f4843d99c34436f82920932317893ae",MidCentury:"267f44f08a844c7abee2b62b00600540",ModernAntique:"996d9e7a3aac4514bb692ce7a990f1c1",BlackAndWhite:"3161443179244702a5e0449010013b54"}},initialize:function(t){if(t={key:t},"string"!=typeof t.key||!a.STYLES[t.key])throw new Error('L.esri.Vector.Basemap: Invalid parameter. Use one of "DarkGray", "Gray", "Hybrid", "Navigation", "Streets", "StreetsNight", "StreetsRelief", "Topographic"');n(a.URLPREFIX+a.STYLES[t.key]+a.URLSUFFIX,this)},onAdd:function(t){this._map=t,i.Util.setEsriAttribution(t),t.attributionControl&&(i.Util._getAttributionData("https://static.arcgis.com/attribution/World_Street_Map",t),t.attributionControl.addAttribution('<span class="esri-dynamic-attribution">USGS, NOAA</span>')),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(t){if(t.off("moveend",i.Util._updateMapAttribution),t.removeLayer(this._mapboxGL),t.attributionControl){var e=document.getElementsByClassName("esri-dynamic-attribution")[0].outerHTML;t.attributionControl.removeAttribution(e)}},_asyncAdd:function(){var t=this._map;t.getContainer().style.background=this._mapboxGL.options.style.layers[0].paint["background-color"],t.on("moveend",i.Util._updateMapAttribution),this._mapboxGL.addTo(t,this)}}),u=e.Layer.extend({statics:{URLPREFIX:"https://www.arcgis.com/sharing/rest/content/items/"},initialize:function(t){if(t={id:t},"string"!=typeof t.id)throw new Error("L.esri.Vector.Layer: Invalid parameter. Use the id of an ArcGIS Online vector tile item");var o,s,a=u.URLPREFIX+t.id;i.request(a,{},function(t,u){t||(o=u.url,-1===o.indexOf("basemaps.arcgis.com")?(this._customTileset=!0,u.accessInformation&&(this._copyrightText=u.accessInformation),i.request(o,{},function(t,n){t||("/"!==n.defaultStyles.charAt(0)&&(n.defaultStyles="/"+n.defaultStyles),s=o+n.defaultStyles+"/root.json",i.request(s,{},function(t,i){t||(r(i,n,s),this._mapboxGL=e.mapboxGL({accessToken:"ezree",style:i}),this._ready=!0,this.fire("ready",{},!0))},this))},this)):n(a+"/resources/styles/root.json",this))},this)},onAdd:function(t){this._map=t,i.Util.setEsriAttribution(t),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(t){if(t.off("moveend",i.Util._updateMapAttribution),t.removeLayer(this._mapboxGL),t.attributionControl){var e=document.getElementsByClassName("esri-dynamic-attribution")[0].outerHTML;t.attributionControl.removeAttribution(e)}},_asyncAdd:function(){var t=this._map;t.attributionControl&&(this._customTileset?this._copyrightText&&t.attributionControl.addAttribution('<span class="esri-dynamic-attribution">'+this._copyrightText+"</span>"):(i.Util._getAttributionData("https://static.arcgis.com/attribution/World_Street_Map",t),t.attributionControl.addAttribution('<span class="esri-dynamic-attribution">USGS, NOAA</span>'),t.on("moveend",i.Util._updateMapAttribution))),t.getContainer().style.background=this._mapboxGL.options.style.layers[0].paint["background-color"],this._mapboxGL.addTo(t,this)}});t.VERSION="1.0.7",t.Basemap=a,t.basemap=o,t.Layer=u,t.layer=s}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leaflet"),require("esri-leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet","esri-leaflet"],e):e((t.L=t.L||{},t.L.esri=t.L.esri||{},t.L.esri.Cluster=t.L.esri.Cluster||{}),t.L,t.L.esri)}(this,function(t,e,i){"use strict";function n(t){return new r(t)}e="default"in e?e.default:e;var r=i.FeatureManager.extend({statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose",CLUSTEREVENTS:"clusterclick clusterdblclick clustermouseover clustermouseout clustermousemove clustercontextmenu"},initialize:function(t){i.FeatureManager.prototype.initialize.call(this,t),t=e.setOptions(this,t),this._layers={},this._leafletIds={},this.cluster=e.markerClusterGroup(t),this._key="c"+(1e9*Math.random()).toString(36).replace(".","_"),this.cluster.addEventParent(this)},onAdd:function(t){i.FeatureManager.prototype.onAdd.call(this,t),this._map.addLayer(this.cluster)},onRemove:function(t){i.FeatureManager.prototype.onRemove.call(this,t),this._map.removeLayer(this.cluster)},createLayers:function(t){for(var i=[],n=t.length-1;n>=0;n--){var r=t[n];if(!this._layers[r.id]){var o=e.GeoJSON.geometryToLayer(r,this.options);o.feature=e.GeoJSON.asFeature(r),o.defaultOptions=o.options,o._leaflet_id=this._key+"_"+r.id,this.resetStyle(o.feature.id),this._layers[o.feature.id]=o,this._leafletIds[o._leaflet_id]=r.id,this.options.onEachFeature&&this.options.onEachFeature(o.feature,o),this.fire("createfeature",{feature:o.feature}),(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(r))&&i.push(o)}}i.length&&this.cluster.addLayers(i)},addLayers:function(t){for(var e=[],i=t.length-1;i>=0;i--){var n=this._layers[t[i]];this.fire("addfeature",{feature:n.feature}),e.push(n)}this.cluster.addLayers(e)},removeLayers:function(t,e){for(var i=[],n=t.length-1;n>=0;n--){var r=t[n],o=this._layers[r];this.fire("removefeature",{feature:o.feature,permanent:e}),i.push(o),this._layers[r]&&e&&delete this._layers[r]}this.cluster.removeLayers(i)},resetStyle:function(t){var e=this._layers[t];return e&&(e.options=e.defaultOptions,this.setFeatureStyle(e.feature.id,this.options.style)),this},setStyle:function(t){return this.eachFeature(function(e){this.setFeatureStyle(e.feature.id,t)},this),this},setFeatureStyle:function(t,e){var i=this._layers[t];"function"==typeof e&&(e=e(i.feature)),i.setStyle&&i.setStyle(e)},eachFeature:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getFeature:function(t){return this._layers[t]}});t.FeatureLayer=r,t.featureLayer=n,t.default=n,t.VERSION="2.0.0"}),function(){L.Control.FullScreen=L.Control.extend({options:{position:"topleft",title:"Full Screen",titleCancel:"Exit Full Screen",forceSeparateButton:!1,forcePseudoFullscreen:!1,fullscreenElement:!1},onAdd:function(t){var e,i="leaflet-control-zoom-fullscreen",n="";return e=t.zoomControl&&!this.options.forceSeparateButton?t.zoomControl._container:L.DomUtil.create("div","leaflet-bar"),this.options.content?n=this.options.content:i+=" fullscreen-icon",this._createButton(this.options.title,i,n,e,this.toggleFullScreen,this),this._map.on("enterFullscreen exitFullscreen",this._toggleTitle,this),e},_createButton:function(e,i,n,r,o,s){return this.link=L.DomUtil.create("a",i,r),this.link.href="#",this.link.title=e,this.link.innerHTML=n,L.DomEvent.addListener(this.link,"click",L.DomEvent.stopPropagation).addListener(this.link,"click",L.DomEvent.preventDefault).addListener(this.link,"click",o,s),L.DomEvent.addListener(r,t.fullScreenEventName,L.DomEvent.stopPropagation).addListener(r,t.fullScreenEventName,L.DomEvent.preventDefault).addListener(r,t.fullScreenEventName,this._handleFullscreenChange,s),L.DomEvent.addListener(document,t.fullScreenEventName,L.DomEvent.stopPropagation).addListener(document,t.fullScreenEventName,L.DomEvent.preventDefault).addListener(document,t.fullScreenEventName,this._handleFullscreenChange,s),this.link},toggleFullScreen:function(){var e=this._map;e._exitFired=!1,e._isFullscreen?(t.supportsFullScreen&&!this.options.forcePseudoFullscreen?t.cancelFullScreen():L.DomUtil.removeClass(this.options.fullscreenElement?this.options.fullscreenElement:e._container,"leaflet-pseudo-fullscreen"),e.fire("exitFullscreen"),e._exitFired=!0,e._isFullscreen=!1):(t.supportsFullScreen&&!this.options.forcePseudoFullscreen?t.requestFullScreen(this.options.fullscreenElement?this.options.fullscreenElement:e._container):L.DomUtil.addClass(this.options.fullscreenElement?this.options.fullscreenElement:e._container,"leaflet-pseudo-fullscreen"),e.fire("enterFullscreen"),e._isFullscreen=!0)},_toggleTitle:function(){this.link.title=this._map._isFullscreen?this.options.title:this.options.titleCancel},_handleFullscreenChange:function(){var e=this._map;e.invalidateSize(),t.isFullScreen()||e._exitFired||(e.fire("exitFullscreen"),e._exitFired=!0,e._isFullscreen=!1)}}),L.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=L.control.fullscreen(this.options.fullscreenControlOptions),this.addControl(this.fullscreenControl))}),L.control.fullscreen=function(t){return new L.Control.FullScreen(t)};var t={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},e="webkit moz o ms khtml".split(" ");if(void 0!==document.exitFullscreen)t.supportsFullScreen=!0;else{for(var i=0,n=e.length;i<n;i++)if(t.prefix=e[i],void 0!==document[t.prefix+"CancelFullScreen"]){t.supportsFullScreen=!0;break}void 0!==document.msExitFullscreen&&(t.prefix="ms",t.supportsFullScreen=!0)}t.supportsFullScreen&&("ms"===t.prefix?t.fullScreenEventName="MSFullscreenChange":t.fullScreenEventName=t.prefix+"fullscreenchange",t.isFullScreen=function(){switch(this.prefix){case"":return document.fullscreen;case"webkit":return document.webkitIsFullScreen;case"ms":return document.msFullscreenElement;default:return document[this.prefix+"FullScreen"]}},t.requestFullScreen=function(t){switch(this.prefix){case"":return t.requestFullscreen();case"ms":return t.msRequestFullscreen();default:return t[this.prefix+"RequestFullScreen"]()}},t.cancelFullScreen=function(){switch(this.prefix){case"":return document.exitFullscreen();case"ms":return document.msExitFullscreen();default:return document[this.prefix+"CancelFullScreen"]()}}),"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each(function(){var e=jQuery(this);t.supportsFullScreen&&t.requestFullScreen(e)})}),window.fullScreenApi=t}();var GEOCODER_URL="https://map.toronto.ca/cotgeocoder/rest/geocoder",cot_map=function(t,e){this.container=t;e.enableControlBox&&(e.enableControlBox=$.extend({position:"bottomright",width:300},e.enableControlBox||{})),e.enableFullscreen&&(e.enableFullscreen=$.extend({options:{position:"topleft",title:"See the map in fullscreen",titleCancel:"Exit fullscreen mode",content:'<span class="glyphicon glyphicon-fullscreen"></span>',forceSeparateButton:!1,forcePseudoFullscreen:!1,fullscreenElement:!1},enterFullscreen:function(){},exitFullscreen:function(){}},e.enableFullscreen||{})),e.enableSearchBar&&(e.enableSearchBar=$.extend({position:"topright",width:300,maxSuggest:10},e.enableSearchBar||{})),this.options=$.extend({mapCenter:[43.66,-79.373903],maxBounds:[[43.39,-80.29],[44,-78.6]],zoom:12,mapType:"Topographic",mapHeight:400,isVectorBasemap:!1},e||{}),this.map=null,this.featureLayerList={},this.markerList={defaultLayer:L.layerGroup()}};cot_map.prototype.render=function(){function t(t){var e=GEOCODER_URL+"/suggest",i=$.Deferred(),n={f:"json",addressOnly:0,retRowLimit:s.enableSearchBar.maxSuggest,searchString:t};return $.ajax({method:"GET",url:e+"?"+$.param(n),type:"GET",jsonpCallback:"jQueryFindGeocod",contentType:"application/json",dataType:"jsonp"}).done(function(t){i.resolve(t.result.rows)}).fail(function(){i.resolve([])}),i.promise()}function e(e){var i=$("#searchTerm").val().trim();if(i.length<4)return $("#searchResults, .js-aria-live").html("Your search term must have at least 4  characters"),e?$("#searchResults").addClass("hidden"):o(),!1;o(),$.when(t(i)).done(function(t){if(0==(h=t.length))$("#searchResults, .js-aria-live").html("No location found");else{var e="";$.each(t,function(t,n){e+='<div class="searchResultsList" role="option" id="res'+n.KEYSTRING.replace(":","-")+'">',e+='<button tabindex="-1" class="js-getLocationAndDisplay resultbutton btn btn-link" data-keystring="'+n.KEYSTRING+'">'+n.ADDRESS.replace(new RegExp("("+i+")","i"),'<span class="hlgt">$1</span>')+"</button>",e+="</div>"}),$("#searchResults").html('<h5 id="searchResultsTitle">Address Search Results</h5><div aria-labelledby="searchResultsTitle"  role="listbox" id="resultsListbox" aria-expanded="true">'+e+"</div>"),$(".js-aria-live").html(h+' Results are available for "'+i+'", use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.')}})}function i(){c||(c=$("#searchTerm").val());var t=$(".resultbutton").index($(".isActive"));t--,t<0&&(t=h-1),$(".resultbutton").removeClass("isActive");var e=$(".resultbutton").eq(t).text(),i=$(".searchResultsList").eq(t).attr("id");$(".resultbutton").eq(t).addClass("isActive"),$("#searchTerm").val(e).attr("aria-activedescendant",i)}function n(){c||(c=$("#searchTerm").val());var t=$(".resultbutton").index($(".isActive"));(++t<=0||t>=h)&&(t=0);var e=$(".resultbutton").eq(t).text(),i=$(".searchResultsList").eq(t).attr("id");$(".resultbutton").removeClass("isActive"),$(".resultbutton").eq(t).addClass("isActive"),$("#searchTerm").val(e).attr("aria-activedescendant",i)}function r(){keepFocus||$("#searchResults").addClass("hidden")}function o(){keepFocus=!0,$("#searchResults").removeClass("hidden")}var s={zoom:this.options.zoom,center:this.options.mapCenter,mapTypeId:this.options.mapType,mapHeight:this.options.mapHeight,enableControlBox:this.options.enableControlBox,enableFullscreen:this.options.enableFullscreen,enableSearchBar:this.options.enableSearchBar};$("#"+this.container).css("height",this.options.mapHeight),this.map=L.map(this.container),this.options.isVectorBasemap?L.esri.Vector.basemap(s.mapTypeId).addTo(this.map):L.esri.basemapLayer(s.mapTypeId).addTo(this.map),this.map.options.minZoom=10,this.map.options.maxZoom=18,this.map.setMaxBounds(this.options.maxBounds),this.map.setView(s.center,s.zoom);var a=this.map;if($("#"+this.container).delegate(".leaflet-control","mouseout",function(){a.dragging.enable()}).delegate(".leaflet-control","mouseover",function(){a.dragging.disable()}).delegate(".js-getLocationAndDisplay","click",function(t){var e=$(this),i=e.data("keystring"),n=GEOCODER_URL+"/findAddressCandidates",r={f:"json",keyString:i,retRowLimit:10};$.ajax({url:n+"?"+$.param(r),type:"GET",jsonpCallback:"jQueryFindAddressCandidates",contentType:"application/json",dataType:"jsonp"}).done(function(t){1==t.result.rows.length&&(a.setView([t.result.rows[0].LATITUDE,t.result.rows[0].LONGITUDE],16),L.popup().setLatLng([t.result.rows[0].LATITUDE,t.result.rows[0].LONGITUDE]).setContent(t.result.rows[0].KEY_DESC).openOn(a),$("#searchTerm").val(t.result.rows[0].KEY_DESC),$("#searchResults").addClass("hidden"),$(".leaflet-popup-close-button").focus())})}),s.enableControlBox){var u=L.control({position:s.enableControlBox.position});u.onAdd=function(t){var e=L.DomUtil.create("div","map-legend--fl",L.DomUtil.get("map"));return e.style.width=s.enableControlBox.width+"px",e},u.addTo(this.map),L.DomEvent.disableClickPropagation(u._container).disableScrollPropagation(u._container),featLay=this.featureLayerList,a=this.map,$(".map-legend--fl").addClass("hidden").html('<div class="map-legend--fl__title">Control</div><div class="map-legend--fl__content hidden-xs" />').delegate(".js-fl_control","change",function(){0==$(this).prop("checked")?a.removeLayer(featLay[$(this).attr("id")].fl):a.addLayer(featLay[$(this).attr("id")].fl)}),$(".map-legend--fl__title").on("click",function(){var t=$(".map-legend--fl__content");t.hasClass("hidden-xs")?t.removeClass("hidden-xs").addClass("visible-xs-*"):t.removeClass("visible-xs-*").addClass("hidden-xs")})}if(s.enableFullscreen){L.control.fullscreen(s.enableFullscreen.options).addTo(this.map);this.map.on("enterFullscreen",function(){s.enableFullscreen.enterFullscreen()}),this.map.on("exitFullscreen",function(){s.enableFullscreen.exitFullscreen()})}if(s.enableSearchBar){var l=L.control({position:s.enableSearchBar.position});l.onAdd=function(t){var e=L.DomUtil.create("div","map-legend--searchBar searchBar",L.DomUtil.get("map"));return e.style.width=s.enableSearchBar.width+"px",e},l.addTo(this.map),L.DomEvent.disableClickPropagation(l._container).disableScrollPropagation(l._container);var c=!1,h=0,f="";f+='<form role="search"       id="'+this.container+'_search">',f+="<fieldset>",f+='<div class="input-group input-group-md">',f+='<input type="text" name="searchTerm" id="searchTerm" class="form-control" placeholder="Address or Intersection" spellcheck="false" autocomplete="off" aria-activedescendant="" aria-owns="resultsListbox" role="combobox" aria-readonly="true" aria-autocomplete="list" aria-haspopup="true" aria-labelledby="searchMapTitle">',f+='<div class="input-group-btn">',f+='<button type="button" class="btn btn-primary" id="searchButton"><span class="glyphicon glyphicon-search" aria-hidden="true"></span><span class="label-icon sr-only">Find Location</span></button>',f+="</div>",f+="</div>",f+="</fieldset>",f+="</form>",f+='<div id="searchResults" class="searchResults hidden"></div>',$(".map-legend--searchBar").html(f),$("#"+this.container+"_search").on("submit",function(t){return t.preventDefault(),e(),!1}).find("#searchButton").on("click",e);var d=null;$("#"+this.container+"_search").delegate(".resultbutton","mousemove",function(){$(".resultbutton").removeClass("isActive")}),$("#searchTerm").on("keydown",function(t){switch(t.keyCode){case 220:t.preventDefault();break;case 37:case 39:break;case 38:0==$(".searchResults.hidden").length&&i(),t.preventDefault();break;case 9:0==$(".searchResults.hidden").length&&(n(),o(),t.preventDefault());break;case 27:keepFocus=!1,r(),c&&($("#searchTerm").val(c),c=!1),$("#searchTerm").attr("aria-activedescendant",""),t.preventDefault();break;case 40:0==$(".searchResults.hidden").length&&n(),t.preventDefault();break;case 13:0==$(".searchResults.hidden").length?($(".resultbutton.isActive").trigger("click"),$("#searchTerm").attr("aria-activedescendant","")):(window.clearTimeout(d),d=window.setTimeout(function(){e()},500)),t.preventDefault();break;case 8:default:window.clearTimeout(d),d=window.setTimeout(function(){e(!0)},500)}}).on("blur",function(){window.clearTimeout(d),keepFocus=!1,window.setTimeout(r,200)}).on("focus",function(){e(!0)}),$(".searchResults").on("focus",function(){o()}).on("blur",function(){window.clearTimeout(d),keepFocus=!1,window.setTimeout(r,200)}),$("#searchButton").on("keydown",function(t){switch(t.keyCode){case 9:(0==$(".searchResults.hidden").length||t.shiftKey)&&(t.preventDefault(),$("#searchTerm").focus());break;case 13:case 32:$("#searchTerm").focus();break;case 27:keepFocus=!1,r(),t.preventDefault();break;default:t.preventDefault()}}).on("click",function(){window.clearTimeout(d),d=window.setTimeout(function(){e()},500)})}},cot_map.prototype.addMarker=function(t){if(t=$.extend({addToLayer:"defaultLayer",title:"Please give that Marker a name",description:"Please give that marker a popup description"},t||{}),!t.LatLng)return console.log("Your marker needs LatLng parameter!"),!1;var e=L.icon({iconUrl:L.Icon.Default.prototype._detectIconPath()+L.Icon.Default.prototype.options.iconUrl,iconAnchor:[12,0]});this.markerList.hasOwnProperty(t.addToLayer)||(this.markerList[t.addToLayer]=t.enableClustering?L.markerClusterGroup():L.layerGroup());var i={LatLng:t.LatLng,options:{draggable:!1,title:t.title,alt:t.title,icon:e}};L.marker(i.LatLng,i.options).bindPopup("<h3>"+t.title+"</h3><div>"+t.description+"</div>").addTo(this.markerList[t.addToLayer]),this.map.addLayer(this.markerList[t.addToLayer])},cot_map.prototype.addFeatureLayer=function(t){if(t=$.extend({title:"Give that layer a title!",enableClustering:!0,addToControlBox:!0,loadByDefault:!0,template:""},t||{}),!t.hasOwnProperty("id")||!t.hasOwnProperty("url"))return console.log("Please check your featureLayer options !"),!1;t.enableClustering?this.featureLayerList[t.id]={title:t.title,addToControlBox:t.addToControlBox,fl:L.esri.Cluster.featureLayer(t)}:this.featureLayerList[t.id]={title:t.title,addToControlBox:t.addToControlBox,fl:L.esri.featureLayer(t)},t.loadByDefault&&this.featureLayerList[t.id].fl.addTo(this.map),""!=t.template&&this.featureLayerList[t.id].fl.bindPopup(function(e){return L.Util.template(t.template,e.feature.properties)}),this.options.enableControlBox&&t.addToControlBox&&($(".map-legend--fl__content").html(""),$.each(this.featureLayerList,function(t,e){e.addToControlBox&&$(".map-legend--fl__content").append('<label class="custom-checkbox" for="'+t+'"><input type="checkbox" class="js-fl_control" name="fl_control" id="'+t+'" checked><span></span> '+e.title+"</label>")}),$(".map-legend--fl").removeClass("hidden"))};var CotApp=function(){this.appContentKeySuffix="/"};CotApp.prototype.loadAppContent=function(t){var e={},i=$.extend({keys:[],tag:"",onComplete:function(t){},onProgress:function(t,e,i,n){}},t),n=this;if(i.tag);else{var r=0;i.keys.forEach(function(t){$.ajax({url:"/app_content/"+t+n.appContentKeySuffix,success:function(n){e[t]=n,i.onProgress(t)},error:function(e,n,r){i.onProgress(t,e,n,r)},complete:function(){++r>=i.keys.length&&i.onComplete(e)}})}),0===i.keys.length&&i.onComplete(e)}},!function(){"use strict";function t(e){return this instanceof t?(this._canvas=e="string"==typeof e?document.getElementById(e):e,this._ctx=e.getContext("2d"),this._width=e.width,this._height=e.height,this._max=1,void this.clear()):new t(e)}t.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(t,e){return this._data=t,this},max:function(t){return this._max=t,this},add:function(t){return this._data.push(t),this},clear:function(){return this._data=[],this},radius:function(t,e){e=e||15;var i=this._circle=document.createElement("canvas"),n=i.getContext("2d"),r=this._r=t+e;return i.width=i.height=2*r,n.shadowOffsetX=n.shadowOffsetY=200,n.shadowBlur=e,n.shadowColor="black",n.beginPath(),n.arc(r-200,r-200,t,0,2*Math.PI,!0),n.closePath(),n.fill(),this},gradient:function(t){var e=document.createElement("canvas"),i=e.getContext("2d"),n=i.createLinearGradient(0,0,0,256);e.width=1,e.height=256;for(var r in t)n.addColorStop(r,t[r]);return i.fillStyle=n,i.fillRect(0,0,1,256),this._grad=i.getImageData(0,0,1,256).data,this},draw:function(t){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var e=this._ctx;e.clearRect(0,0,this._width,this._height);for(var i,n=0,r=this._data.length;r>n;n++)i=this._data[n],e.globalAlpha=Math.max(i[2]/this._max,t||.05),e.drawImage(this._circle,i[0]-this._r,i[1]-this._r);var o=e.getImageData(0,0,this._width,this._height);return this._colorize(o.data,this._grad),e.putImageData(o,0,0),this},_colorize:function(t,e){for(var i,n=3,r=t.length;r>n;n+=4)(i=4*t[n])&&(t[n-3]=e[i],t[n-2]=e[i+1],t[n-1]=e[i+2])}},window.simpleheat=t}(),L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(t,e){this._latlngs=t,L.setOptions(this,e)},setLatLngs:function(t){return this._latlngs=t,this.redraw()},addLatLng:function(t){return this._latlngs.push(t),this.redraw()},setOptions:function(t){return L.setOptions(this,t),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return!this._heat||this._frame||this._map._animating||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(t){this._map=t,this._canvas||this._initCanvas(),t._panes.overlayPane.appendChild(this._canvas),t.on("moveend",this._reset,this),t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._canvas),t.off("moveend",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){
return t.addLayer(this),this},_initCanvas:function(){var t=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),e=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);t.style[e]="50% 50%";var i=this._map.getSize();t.width=i.x,t.height=i.y;var n=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(t,"leaflet-zoom-"+(n?"animated":"hide")),this._heat=simpleheat(t),this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur),this.options.gradient&&this._heat.gradient(this.options.gradient),this.options.max&&this._heat.max(this.options.max)},_reset:function(){var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t);var e=this._map.getSize();this._heat._width!==e.x&&(this._canvas.width=this._heat._width=e.x),this._heat._height!==e.y&&(this._canvas.height=this._heat._height=e.y),this._redraw()},_redraw:function(){var t,e,i,n,r,o,s,a,u,l=[],c=this._heat._r,h=this._map.getSize(),f=new L.Bounds(L.point([-c,-c]),h.add([c,c])),d=void 0===this.options.max?1:this.options.max,p=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom,m=1/Math.pow(2,Math.max(0,Math.min(p-this._map.getZoom(),12))),_=c/2,g=[],v=this._map._getMapPanePos(),y=v.x%_,b=v.y%_;for(t=0,e=this._latlngs.length;e>t;t++)if(i=this._map.latLngToContainerPoint(this._latlngs[t]),f.contains(i)){r=Math.floor((i.x-y)/_)+2,o=Math.floor((i.y-b)/_)+2;var x=void 0!==this._latlngs[t].alt?this._latlngs[t].alt:void 0!==this._latlngs[t][2]?+this._latlngs[t][2]:1;u=x*m,g[o]=g[o]||[],n=g[o][r],n?(n[0]=(n[0]*n[2]+i.x*u)/(n[2]+u),n[1]=(n[1]*n[2]+i.y*u)/(n[2]+u),n[2]+=u):g[o][r]=[i.x,i.y,u]}for(t=0,e=g.length;e>t;t++)if(g[t])for(s=0,a=g[t].length;a>s;s++)(n=g[t][s])&&l.push([Math.round(n[0]),Math.round(n[1]),Math.min(n[2],d)]);this._heat.data(l).draw(this.options.minOpacity),this._frame=null},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,i,e):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(i)+" scale("+e+")"}}),L.heatLayer=function(t,e){return new L.HeatLayer(t,e)},function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leaflet"),require("esri-leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet","esri-leaflet"],e):e((t.L=t.L||{},t.L.esri=t.L.esri||{},t.L.esri.Heat=t.L.esri.Heat||{}),t.L,t.L.esri)}(this,function(t,e,i){"use strict";function n(t){return new r(t)}e="default"in e?e.default:e;var r=i.FeatureManager.extend({initialize:function(t){i.FeatureManager.prototype.initialize.call(this,t),t=e.setOptions(this,t),this._cache={},this._active={},this.heat=window.L.heatLayer([],t)},onAdd:function(t){i.FeatureManager.prototype.onAdd.call(this,t),this._map.addLayer(this.heat)},onRemove:function(t){i.FeatureManager.prototype.onRemove.call(this,t),this._map.removeLayer(this.heat)},createLayers:function(t){for(var i=t.length-1;i>=0;i--){var n=t[i],r=n.id,o=new e.LatLng(n.geometry.coordinates[1],n.geometry.coordinates[0]);this._cache[r]=o,!this._active[r]&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(n))&&(this._active[r]=o,this.heat._latlngs.push(o))}this.heat.redraw()},addLayers:function(t){for(var e=t.length-1;e>=0;e--){var i=t[e];if(!this._active[i]){var n=this._cache[i];this.heat._latlngs.push(n),this._active[i]=n}}this.heat.redraw()},removeLayers:function(t,e){for(var i=[],n=t.length-1;n>=0;n--){var r=t[n];this._active[r]&&delete this._active[r],this._cache[r]&&e&&delete this._cache[r]}for(var o in this._active)i.push(this._active[o]);this.heat.setLatLngs(i)},setOptions:function(t){this.heat.setOptions(t)},redraw:function(){this.heat.redraw()}});t.FeatureLayer=r,t.featureLayer=n,t.default=n,t.VERSION="2.0.0"});var APPNAME="visionzero2018",heat_map_button="",_SAFETY_MEASURES=[{cat_title:"Engineering Improvements",cat_iconColor:"#1873CD",cat_isOnlyYear:!1,cat_subcat:[{subcat_title:"Traffic Calming",subcat_id:"Traffic Calming",subcat_info:"Traffic calming is a term commonly associated with physical features such as speed humps, pinch-points, and chicanes that are installed on roads. Traffic calming is used to reduce the speeds at which vehicles travel, to discourage through traffic, to improve traffic safety, and to improve comfort levels for all road users.",subcat_featureLayer:"safetymeasure_lines"}]},{cat_title:"Signs, Markings & Beacons",cat_iconColor:"#007A7C",cat_isOnlyYear:!0,cat_subcat:[{subcat_title:"Driver Feedback Sign",subcat_id:"Watch Your Speed Signs",subcat_info:"Watch Your Speed Signs are digital displays that are equipped with radar technology to measure the speeds of oncoming vehicles and an LED sign to display their speeds to passing motorists. Watch Your Speed Signs are used to remind motorists to check their speeds and to obey speed limits.",subcat_featureLayer:"safetymeasure_points"},{subcat_title:"Static Signs",subcat_id:"Static Signs",subcat_info:"A sign installed in support of Vision Zero initiatives including Senior Safety Zone and School Safety Zone signs.",subcat_featureLayer:"safetymeasure_points"},{subcat_title:"Flashing Beacons",subcat_id:"Flashing Beacons",subcat_info:"A traffic beacon with a single flashing light hung over an intersection or placed over signs or on obstacles in the road.",subcat_featureLayer:"safetymeasure_points"},{subcat_title:"Pavement Markings",subcat_id:"Pavement Markings",subcat_info:"Pavement markings divide traffic lanes, show turning lanes, mark pedestrian crossings, indicate obstacles and tell you when it is not safe to pass. The most common new pavement markings are zebra markings, school stencils and speed limit stencils.",subcat_featureLayer:"safetymeasure_points"}]},{cat_title:"Automated Enforcement",cat_iconColor:"#9b59b6",cat_isOnlyYear:!1,cat_subcat:[{subcat_title:"Red Light Cameras",subcat_id:"Red Light Cameras",subcat_info:"A type of traffic enforcement camera that captures an image of a vehicle which has entered an intersection in spite of the traffic signal indicating red. By automatically photographing vehicles that run red lights, the photo is evidence that assists authorities in their enforcement of traffic laws.",subcat_featureLayer:"safetymeasure_points"}]},{cat_title:"Traffic Bylaw Changes",cat_iconColor:"#9F6B3F",cat_isOnlyYear:!1,cat_subcat:[{subcat_title:"Speed Limit Reductions",subcat_id:"Speed Limit Reductions",subcat_info:"Streets where speed limits have been reduced from 50 km/h to 40 km/h and in some places from 40 km/h to 30 km/h.",subcat_featureLayer:"safetymeasure_lines"},{subcat_title:"Turn Restrictions",subcat_id:"Turn Restrictions",subcat_info:"A restricted movement (e.g. right turns or left turns) at an intersection.",subcat_featureLayer:"safetymeasure_points"}]},{cat_title:"Traffic Control",cat_iconColor:"#000000",cat_isOnlyYear:!1,cat_subcat:[{subcat_title:"Accessible Pedestrian Signal (APS)",subcat_id:"Audible Pedestrian Signals",subcat_info:"A pedestrian signal with an audible chirp or chime to indicate to the visually impaired that the pedestrian signal is currently active.",subcat_featureLayer:"safetymeasure_points"},{subcat_title:"Leading Pedestrian Interval (LPI)",subcat_id:"Leading Pedestrian Intervals",subcat_info:"A traffic signal that provides an advanced walk signal to pedestrians allowing them to cross the street before vehicles get a green signal.",subcat_featureLayer:"safetymeasure_points"},{subcat_title:"Uninterrupted Power Supply (UPS)",subcat_id:"Uninterruptable Power Supply",subcat_info:"An electrical apparatus that provides emergency power to critical devises when the main power source fails.",subcat_featureLayer:"safetymeasure_points"},{subcat_title:"LED Blank-outs Sign",subcat_id:"LED Blankout Signs",subcat_info:"An LED sign that is illuminated to indicate time-of-day turning restrictions at intersections.",subcat_featureLayer:"safetymeasure_points"},{subcat_title:"Traffic Signals",subcat_id:"Traffic Signals",subcat_info:"A set of automatically operated colored lights, typically red, amber, and green, for controlling traffic at road junctions and crosswalks.",subcat_featureLayer:"safetymeasure_points"},{subcat_title:"Pedestrian Crossover (PXO) Signal",subcat_id:"Pedestrian Crossovers",subcat_info:"A designated road crossing for pedestrians outside of an intersection. These crosswalks are equipped with overhead yellow lights and side mounted flashers.",subcat_featureLayer:"safetymeasure_points"}]},{cat_title:"Safety Zones",cat_iconColor:"#AA8F00",cat_isOnlyYear:!0,cat_subcat:[{subcat_title:"Senior Safety Zones",subcat_id:"Senior Safety Zones",subcat_info:"A designated stretches of roadway which includes senior safety zone signs and a variety of measures such as lower speed limits, improved street lighting, advance green for pedestrians, Watch Your Speed” signs, red light cameras, sidewalk extensions, increased crossing times, improved pavement markings, among other possible improvements.",subcat_featureLayer:"safetymeasure_polygons"},{subcat_title:"School Safety Zones",subcat_id:"School Safety Zones",subcat_info:"A designated stretches of roadway which includes school safety zone signs and a variety of measures such as lower speed limits, improved street lighting, leading pedestrian intervals, mid-block crossings, improved pavement makings, flashing beacons, among other possible improvements.",subcat_featureLayer:"safetymeasure_polygons"},{subcat_title:"Pedestrian Safety Corridors",subcat_id:"Pedestrian Safety Corridors",subcat_info:"A designated stretches of roadway which includes a variety of measures such as targeted speed limit reductions, signal timing adjustments and enhanced pedestrian crosswalk markings (zebra markings), among other possible improvements.",subcat_featureLayer:"safetymeasure_polygons"}]},{cat_title:"Cycling Infrastructure",cat_iconColor:"#008A00",cat_isDotted:!0,cat_isOnlyYear:!0,cat_subcat:[{subcat_title:"Cycle Tracks",subcat_id:"Cycle Tracks",subcat_info:"A dedicated cycling lane on the road, marked with a diamond symbol next to the lane line, which includes a separator (i.e. bollard) between the cyclists and the adjacent traffic lane. This lane is reserved for the use of cyclists only.",subcat_featureLayer:"safetymeasure_lines"},{subcat_title:"Bike Lanes",subcat_id:"Bike Lanes",subcat_info:"A cycling lane on the road, marked with a diamond symbol next to the lane line. This lane is reserved for the use of cyclists only.",subcat_featureLayer:"safetymeasure_lines"},{subcat_title:"Sharrows (Shared Road)",subcat_id:"Sharrows (Shared Road)",subcat_info:"A shared lane on the road marked with a bike and arrows used to indicate a shared environment for cyclists and motor vehicles.",subcat_featureLayer:"safetymeasure_lines"},{subcat_title:"Multi-Use Trails",subcat_id:"Multi-Use Trails",subcat_info:"Trails found in Parks, Ravines, Hydro Corridors or similar green spaces. These trails are for cyclists and pedestrians only, not motor vehicles.",subcat_featureLayer:"safetymeasure_lines"},{subcat_title:"Upgraded Infrastructure",subcat_id:"Upgraded Infrastructure",subcat_info:"Upgrades to existing bike infrastructure such as: new paint, bollards, signage etc.",subcat_featureLayer:"safetymeasure_lines"}]}],_PANEL_CONTENT={list:'<h2> List </h2><ul class="list-results"></ul>',about:'\n      <div class="row">\n        <div class="col-xs-12 col-md-10 col-md-offset-1">\n          <h2>About</h2>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-xs-12 col-md-10 col-md-offset-1">\n        <h3 class="header">The Map</h3>\n        <p>The Toronto\'s Vision Zero Map is an interactive tool that displays information on historical collisions (fatalities and seriously injured) and safety measures that have been implemented under the City of Toronto’s Vision Zero program. The map was built to provide a transparent view into the historical locations of collisions in the city side by side with the suite of safety measures that are being deployed through the Vision Zero program.</p>\n        <h4>Version 1 Beta Release includes:</h4>\n        <ul>\n          <li>New mapping interface & filters</li>\n          <li>Year selection </li>\n          <li>10 years of Collision data from 2008 to present (Displays collisions by severity, mode of travel and age of injured person) </li>\n          <li>Safety measures from 2016 to present (Shows the location of safety measures that have been deployed as part of Vision Zero e.g. engineering improvements, signs, marking & beacons)</li>\n          <li>Search feature and City ward selection</li>\n          <li>Heat map to display collision hotspots</li>\n        </ul>\n        <h4>Future releases will include:</h4>\n        <ul><li>Interactive dashboards</li>\n          <li>Additional safety measure data including: curb radii reductions, right turn channel removals, automated bike detection, increased pedestrian crossing times, community safety zones, bike boxes and bike intersection crossings </li>\n          <li>Open data releases </li>\n          <li>Supporting contextual data layers (e.g. school locations, senior facility locations etc.)</li>\n          <li>Upgraded features and enhancements based on user feedback </li>\n          </ul>\n\n          <h3 class="header">The Data</h3>\n\n          <h4>Collision Data:</h4>\n          <p>The Toronto Police Service maintains a database together with Transportation Services of collisions involving motorized vehicles, cyclists, and pedestrians. These datasets contain information on all recorded collisions between 2008 and 2017. A collision is defined by the Province of Ontario as:\n            <cite>“… the contact resulting from the motion of a motorized vehicle or a streetcar or its load, that produces property damage, injury, or death. For the purposes of this dataset, a collision indicates that the initial point of contact involves at least one motor vehicle or streetcar.”</cite>\n            The collision data feed is a live connection to the City’s collision database, however a reporting lag does exist between when a collision occurs and when it is logged in the database. If you are looking for information on a recent collision, please check back at a later date if it does not yet appear on the map.</p>\n          <h4>Safety Measure Data</h4>\n          <p>The City has assembled a database of all the safety measures that have been implemented as part of Vision Zero. The data under each category is maintained by those responsible for the individual programs and staff are striving to have timely updates after safety measures are deployed.</p>\n          <h4>Open Data</h4>\n          <p>Transportation Services are working to post all datasets in the Vision Zero Map on the open data portal. Stay tuned!</p>\n              <p><small>Disclaimer: Please note that the data and information on this website is for informational purposes only. While we strive to provide accurate information, errors may be present and information may not be complete. Accordingly, the City of Toronto, Transportation Services Division make no representation as to the accuracy of the information or its suitability for any purpose and disclaim any liability for omissions or errors that may be contained therein. </small></p>\n          <h3 class="header">The Program</h3>\n          <p>The Vision Zero Road Safety program is focused on eliminating fatalities and reducing serious injuries, with an emphasis on pedestrian, school children, older adult, cyclist and motorcyclist safety and reducing aggressive and distracted driving.</p>\n          <p>The City’s total five-year Vision Zero investment is $109 million.</p>\n          <p>More information about Toronto\'s Vision Zero program is available on the project website: <a href="https://www.toronto.ca/services-payments/streets-parking-transportation/road-safety/vision-zero/" title="Visit Vision Zero page on Toronto website">toronto.ca/VisionZeroTO</a>.</p>\n        </div>\n      </div>\n    ',glossary:'\n      <div class="row">\n        <div class="col-xs-12 col-md-10 col-md-offset-1"><h2>Glossary</h2>\n      </div>\n    </div>\n    <div class="row">\n      <div class="col-xs-12 col-md-10 col-md-offset-1">\n        <h3 class="header">Traffic Collisions</h3>\n        <h4>Injury Type</h4>\n        <dl>\n          <dt>Injury Type</dt>\n          <dd> The type of injury sustained. </dd>\n          <dt>Fatality</dt>\n          <dd> A collision resulting in a death. </dd>\n          <dt>Seriously Injured</dt>\n          <dd> A collision resulting in a serious injury.</dd>\n        </dl>\n        <h4>Mode of Travel</h4>\n        <dl>\n          <dt>Pedestrian</dt>\n          <dd> A person travelling by foot</dd>\n          <dt>Cyclist</dt>\n          <dd> A person travelling by bicycle.</dd>\n          <dt>Motorcyclist</dt>\n          <dd> A person who rides a two-wheeled vehicle that is powered by a motor and has no pedals</dd>\n          <dt>Motorist</dt>\n          <dd> A driver or passenger in an automobile.</dd>\n        </dl>\n        <h4>\n          Age\n        </h4>\n        <dl>\n          <dt>Children (0-14 years)</dt>\n          <dd> Children are defined as people between the ages of 0-14 years old.</dd>\n          <dt>Youth (15-24 years)</dt>\n          <dd> Youth are defined as people between the ages of 15-24 years old.</dd>\n          <dt>Adults (25-64 years)</dt>\n          <dd> Adults are defined as people between the ages of 25-64 years old.</dd>\n          <dt>Seniors (65+ years)</dt>\n          <dd> Seniors are defined as people over the age of 65 years old.</dd>\n        </dl>\n      </div>\n    </div>\n    <div class="row">\n      <div class="col-xs-12 col-md-10 col-md-offset-1">\n        <h3 class="header">Safety Measures</h3>\n        '+_SAFETY_MEASURES.map(function(t,e){return"\n          <h4>"+t.cat_title+"</h4>\n          <dl>\n          "+t.cat_subcat.map(function(t,e){return"\n            <dt>"+t.subcat_title+"</dt>\n            <dd>"+t.subcat_info+"</dd>\n          "}).join("")+"\n          </dl>\n        "}).join("")+'\n\n        <h3 class="header">Other Terminology</h3>\n\n        <dl><dt>Zebra Markings</dt><dd> The alternating pattern of large white rectangles of paint on pavement which indicates a pedestrian crosswalk.\n        </dd>\n\n        <dt>School Stencils</dt><dd> A painted stencil on the road spelling "SCHOOL"\n        </dd>\n\n        <dt>Speed Limit Stencil</dt><dd> A painted stencil on the road indicating the speed limit.\n        </dd>\n\n\n        <dt>Speed Humps</dt><dd> A raised sections of the roadway designed to discourage motor vehicle drivers from travelling at excessive speeds. Speed humps are a type of traffic calming measure.\n        </dd>\n\n        <dt>Raised Intersections</dt><dd> An intersection constructed at a higher elevation than the adjacent roadway. Raised intersections are a type of traffic calming measure.\n        </dd>\n\n        <dt>Chicanes</dt><dd> A series of curb extensions on alternate sides of a roadway which narrow the roadway and requires drivers to steer from one side to the other to travel through the chicane. Chicanes are a type of traffic calming measure.\n        </dd>\n\n        <dt>Curb Extensions</dt><dd> A horizontal intrusion of the curb into the roadway, resulting in a narrower section. Curb extensions are a type of traffic calming measure.\n        </dd>\n\n        <dt>Traffic Islands</dt><dd> A raised area near the sidewalk, resulting in a narrower section. Not intended for pedestrians, as they have no dropped curbs and tactile paving. Traffic islands are a type of traffic calming measure.\n        </dd>\n\n        <dt>Traffic Circles</dt><dd> A raised island located in the centre of an intersection which requires vehicles to travel through the intersection in a counter-clockwise direction around the island. Traffic circles are a type of traffic calming measure.\n        </dd>\n\n      </div>\n    </div>',contactus:'\n      <div class="row">\n        <div class="col-xs-12 col-md-10 col-md-offset-1">\n          <h2>Contact Us</h2>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-xs-12 col-md-10 col-md-offset-1">\n        <p>&nbsp;</p>\n        <dl>\n            <dt><span class="sr-only">Email</span><span aria-hidden="true"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 150 150" enable-background="new 0 0 150 150" xml:space="preserve" width="24" height="24"><g id="Layer_1">\n            </g><g id="_x34_2">\n            \t<path fill-rule="evenodd" clip-rule="evenodd" d="M25.4,37.9h104.3c1.4,0,2.4,0.5,3.3,1.4c0.9,0.7,1.4,1.7,1.4,3.1v64\n            \t\tc0,1.4-0.5,2.4-1.4,3.1c-0.9,0.9-1.9,1.4-3.3,1.4H25.4c-1,0-2.1-0.5-2.9-1.4c-0.7-0.7-1.2-1.7-1.2-3.1v-64c0-1.4,0.5-2.4,1.2-3.1\n            \t\tC23.3,38.4,24.3,37.9,25.4,37.9L25.4,37.9z"/>\n            \t<polygon fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" points="75.7,95.3 75.7,95.3 61.8,81.8 31.4,105.8 124.1,105.8\n            \t\t93.3,81.8 79.7,95.3 79,95.6 76.2,95.6 \t"/>\n            \t<polygon fill-rule="evenodd" clip-rule="evenodd" fill="#79A6D9" points="30.2,42.9 30.2,42.9 77.6,89 125,42.9 \t"/>\n            \t<polygon fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" points="57.5,77.6 57.5,77.6 25.9,47 25.9,102.5 \t"/>\n            \t<polygon fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" points="129.5,47 129.5,47 97.6,77.6 129.5,102.5 \t"/>\n            </g><g id="Layer_3">\n            </g><g id="object">\n            </g><g id="Isolation_Mode">\n            </g>\n            </svg></span></dt>\n            <dd><a href="mailto:VisionZeroTO@toronto.ca"  title="send an email to Vision Zero Toronto team">VisionZeroTO@toronto.ca</a></dd>\n            <dt><span class="sr-only">Twitter</span><span aria-hidden="true"><svg  width="24" height="24" version="1.1" id="Layer_12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 410.155 410.155" style="enable-background:new 0 0 410.155 410.155;" xml:space="preserve" ><path style="fill:#76A9EA;" d="M403.632,74.18c-9.113,4.041-18.573,7.229-28.28,9.537c10.696-10.164,18.738-22.877,23.275-37.067\tl0,0c1.295-4.051-3.105-7.554-6.763-5.385l0,0c-13.504,8.01-28.05,14.019-43.235,17.862c-0.881,0.223-1.79,0.336-2.702,0.336\tc-2.766,0-5.455-1.027-7.57-2.891c-16.156-14.239-36.935-22.081-58.508-22.081c-9.335,0-18.76,1.455-28.014,4.325\tc-28.672,8.893-50.795,32.544-57.736,61.724c-2.604,10.945-3.309,21.9-2.097,32.56c0.139,1.225-0.44,2.08-0.797,2.481\tc-0.627,0.703-1.516,1.106-2.439,1.106c-0.103,0-0.209-0.005-0.314-0.015c-62.762-5.831-119.358-36.068-159.363-85.14l0,0\tc-2.04-2.503-5.952-2.196-7.578,0.593l0,0C13.677,65.565,9.537,80.937,9.537,96.579c0,23.972,9.631,46.563,26.36,63.032\tc-7.035-1.668-13.844-4.295-20.169-7.808l0,0c-3.06-1.7-6.825,0.485-6.868,3.985l0,0c-0.438,35.612,20.412,67.3,51.646,81.569\tc-0.629,0.015-1.258,0.022-1.888,0.022c-4.951,0-9.964-0.478-14.898-1.421l0,0c-3.446-0.658-6.341,2.611-5.271,5.952l0,0\tc10.138,31.651,37.39,54.981,70.002,60.278c-27.066,18.169-58.585,27.753-91.39,27.753l-10.227-0.006\tc-3.151,0-5.816,2.054-6.619,5.106c-0.791,3.006,0.666,6.177,3.353,7.74c36.966,21.513,79.131,32.883,121.955,32.883\tc37.485,0,72.549-7.439,104.219-22.109c29.033-13.449,54.689-32.674,76.255-57.141c20.09-22.792,35.8-49.103,46.692-78.201\tc10.383-27.737,15.871-57.333,15.871-85.589v-1.346c-0.001-4.537,2.051-8.806,5.631-11.712c13.585-11.03,25.415-24.014,35.16-38.591\tl0,0C411.924,77.126,407.866,72.302,403.632,74.18L403.632,74.18z"/><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></span></dt>\n            <dd><a href="https://twitter.com/TO_Transport" target="_blank" rel="noopener" title="Visit Totonto Transportation Twitter page">@TO_Transport</a></dd>\n            <dt><span class="sr-only">Hashtag</span><span aria-hidden="true"><svg version="1.1" width="24" height="24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 150 150" enable-background="new 0 0 150 150" xml:space="preserve"><g id="Layer_13">\t<circle cx="73.5" cy="74.2" r="51.2"/>\t<g>\t\t<line fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" x1="57.1" y1="43" x2="57.1" y2="106.7"/>\t\t<line fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" x1="88.9" y1="43" x2="88.9" y2="106.7"/>\t\t<line fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" x1="41.2" y1="58.9" x2="104.8" y2="58.9"/>\t\t<line fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" x1="41.2" y1="90.8" x2="104.8" y2="90.8"/>\t</g></g><g id="_x34_1"></g><g id="Layer_3_2"></g><g id="object2"></g><g id="Isolation_Mode2"></g></svg></span></dt>\n            <dd><a href="https://twitter.com/search?q=%23VisionZeroTO" title="Visit Vision Zero Twitter page">#VisionZeroTO</a></dd>\n            <dt><span class="sr-only">Youtube</span><span aria-hidden="true"><svg  width="24" height="24" version="1.1" id="Layer_14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 461.001 461.001" style="enable-background:new 0 0 461.001 461.001;" xml:space="preserve"><path style="fill:#F61C0D;" d="M365.257,67.393H95.744C42.866,67.393,0,110.259,0,163.137v134.728\tc0,52.878,42.866,95.744,95.744,95.744h269.513c52.878,0,95.744-42.866,95.744-95.744V163.137\tC461.001,110.259,418.135,67.393,365.257,67.393z M300.506,237.056l-126.06,60.123c-3.359,1.602-7.239-0.847-7.239-4.568V168.607\tc0-3.774,3.982-6.22,7.348-4.514l126.06,63.881C304.363,229.873,304.298,235.248,300.506,237.056z"/><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></span></dt>\n            <dd><a href="https://www.youtube.com/watch?v=HtjfjIxHbqQ" target="_blank" rel="noopener" title="Visit Toronto Transportation Youtube page">Transportation Services</a></dd>\n        </dl>\n        </div>\n      </div>\n\n      <div class="row">\n        <div class="col-xs-12 col-md-10 col-md-offset-1">\n        <h3 class="header">What is a beta release? </h3>\n      <p>The map is still in development. We are putting this map out to gather feedback to refine the final product and we will be periodically rolling out enhancements over the Fall. </p>\n      <h3 class="header">Send us your Feedback:</h3>\n      <p>We’re looking for ways to improve our map and would love to hear from you. Tell us about your experience, what you like, what you don’t like, what is missing or what is confusing and let us know about any bugs you’ve found. Email us at  <a href="mailto:VisionZeroTO@toronto.ca" title="Send an email to Vision Zero Toronto team">VisionZeroTO@toronto.ca</a>, we look forward to hearing your feedback.</p>\n\n        </div>\n      </div>\n      '},_SUPPORTING_LAYERS=[{id:"shadowWards",title:"Wards",isActive:!1,pane:"shadowWards",enableClustering:!1,addToControlBox:!1,url:"WARDS",loadByDefault:!1,iconColor:"rgb(33, 33, 33)",style:function(t){return{color:"rgb(33, 33, 33)",opacity:.7,dashArray:"6,10",fill:!1,lineJoin:"round",weight:1}}},{id:"bikeLames",title:"Cycling Network",isActive:!1,pane:"bikelanes",enableClustering:!1,addToControlBox:!1,url:"BIKELANES",loadByDefault:!1,iconColor:"#008A00",style:function(t){return{color:"#008A00",opacity:.7,fill:!1,weight:1}}}],today=new Date,today_year=today.getFullYear()>2030?2019:today.getFullYear(),_config={APPNAME:APPNAME,PAGE_NAME:"Vision Zero",APP_CONFIG:"/app_content/",MAP_CONTAINER:"vzmap",MAP_HEIGHT:"90vh",MAP_BASEMAP:"Gray",MAP_CENTER:[43.71885747416588,-79.50479239225389],MAP_ZOOM:11,MAP_MAXZOOM:18,HEATMAP_RADIUS:20,HEATMAP_GRADIENT:{.2:"#ffffb2",.4:"#EEBF8F",.6:"#EEBF8F",.8:"#E4997A",1:"#bd0026"},PANEL_CONTENT:_PANEL_CONTENT,SUPPORTING_LAYERS:_SUPPORTING_LAYERS,SAFETY_MEASURES:_SAFETY_MEASURES,INJURY:{3:"Seriously Injured",4:"Fatality"},INJURY_COLOR:{3:"#E26A6A",4:"#e41a1c"},INVOLVEMENT_TYPE:{"03":"Pedestrian",17:"Pedestrian",19:"Pedestrian",20:"Pedestrian","04":"Cyclist","05":"Cyclist",21:"Cyclist","06":"Motorcyclist","07":"Motorcyclist","08":"Motorcyclist","09":"Motorcyclist","01":"Motorist","02":"Motorist",18:"Motorist",22:"Motorist"},DISCLAIMER_CONTENT:'\n      <h2>Toronto\'s Vision Zero Map: Version 1 Beta Release\n    </h2>\n    <p>The Toronto\'s Vision Zero Map is an interactive tool that displays information on historical collisions (fatalities and seriously injured) and safety measures that have been implemented under the City of Toronto’s Vision Zero program. The map was built to provide a transparent view into the historical locations of collisions in the city side by side with the suite of safety measures that are being deployed through the Vision Zero program.</p>\n    <h3 class="header">What is a beta release? </h3>\n    <p>The map is still in development. We are putting this map out to gather feedback to refine the final product and we will be periodically rolling out enhancements over the Fall. </p>\n\n    <h3 class="header">Version 1 Beta Release includes:</h3>\n\n    <ul>\n      <li>New mapping interface & filters</li>\n      <li>Year selection </li>\n      <li>10 years of Collision data from 2008 to present (Displays collisions by severity, mode of travel and age of injured person) </li>\n      <li>Safety measures from 2016 to present (Shows the location of safety measures that have been deployed as part of Vision Zero e.g. engineering improvements, signs, marking & beacons)</li>\n      <li>Search feature and City ward selection</li>\n      <li>Heat map to display collision hotspots</li>\n    </ul>\n    <h3 class="header">Future releases will include:</h3>\n    <ul>\n      <li>Interactive dashboards</li>\n      <li>Additional safety measure data including: curb radii reductions, right turn channel removals, automated bike detection, increased pedestrian crossing times, community safety zones, bike boxes and bike intersection crossings </li>\n      <li>Open data releases </li>\n      <li>Supporting contextual data layers (e.g. school locations, senior facility locations etc.)</li>\n      <li>Upgraded features and enhancements based on user feedback</li>\n    </ul>\n    <h3 class="header">Send us your Feedback:</h3>\n    <p>We’re looking for ways to improve our map and would love to hear from you. Tell us about your experience, what you like, what you don’t like, what is missing or what is confusing and let us know about any bugs you’ve found. Email us at <a href="mailto:VisionZeroTO@toronto.ca?subject=Vision Zero Map Feedback" title="Send your feedback by email to Vision Zero Toronto team">VisionZeroTO@toronto.ca</a>, we look forward to hearing your feedback.</p>\n  ',MENU_CONTENT:{
logo:'\n      <a href="https://www.toronto.ca/services-payments/streets-parking-transportation/road-safety/vision-zero/" target="_blank" title="Visit Vision Zero Toronto"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="142pt" height="40pt" viewBox="0 0 142 40" version="1.1"><g id="surface1"><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 23.011719 5.015625 L 22.855469 5.015625 L 22.855469 3.148438 L 22.820312 3.148438 L 22.820312 1.238281 L 22.507812 1.238281 L 22.507812 3.148438 L 22.46875 3.148438 L 22.46875 5.015625 L 22.3125 5.015625 Z M 23.011719 5.015625 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 23.128906 6.730469 L 23.011719 4.664062 L 22.3125 4.664062 L 22.234375 6.691406 C 22.507812 6.730469 22.820312 6.730469 23.128906 6.730469 Z M 23.128906 6.730469 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 23.554688 11.671875 L 21.808594 11.671875 L 22.3125 4.433594 L 23.011719 4.433594 Z M 23.554688 11.671875 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 25.460938 12.53125 L 25.1875 11.75 L 25.304688 11.75 L 25.304688 10.894531 L 20.136719 10.894531 L 20.136719 11.75 L 20.214844 11.75 L 20.019531 12.53125 L 19.167969 12.53125 L 19.167969 14.242188 L 19.203125 14.242188 L 19.515625 14.828125 L 19.59375 14.828125 C 19.4375 14.945312 19.320312 15.136719 19.320312 15.371094 L 19.320312 15.488281 C 19.320312 15.878906 19.632812 16.1875 19.980469 16.1875 L 25.304688 16.1875 C 25.65625 16.1875 25.964844 15.878906 25.964844 15.488281 L 25.964844 15.371094 C 25.964844 15.136719 25.847656 14.945312 25.695312 14.828125 L 26.003906 14.28125 L 26.042969 14.28125 L 26.042969 12.570312 L 25.460938 12.570312 Z M 25.1875 12.492188 L 20.332031 12.492188 L 20.332031 11.945312 L 25.1875 11.945312 Z M 25.1875 12.492188 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 18.234375 16.734375 L 13.804688 39.507812 L 6.035156 39.507812 L 1.796875 16.734375 L 7.238281 16.734375 L 10.074219 35.304688 L 12.988281 16.734375 Z M 18.234375 16.734375 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 25.382812 39.507812 L 19.941406 39.507812 L 20.992188 16.734375 L 24.410156 16.734375 Z M 25.382812 39.507812 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 41.585938 21.601562 L 41.585938 24.363281 L 36.300781 24.363281 L 36.300781 21.796875 C 36.300781 19.769531 35.679688 18.757812 34.433594 18.757812 C 33.347656 18.757812 32.804688 19.304688 32.804688 20.433594 L 32.804688 21.757812 C 32.804688 23.117188 33.582031 24.441406 35.097656 25.726562 L 39.214844 28.917969 C 40.691406 30.203125 41.429688 31.449219 41.429688 32.617188 L 41.429688 35.734375 C 41.429688 38.652344 39.097656 40.09375 34.433594 40.09375 C 29.695312 40.09375 27.324219 38.222656 27.324219 34.449219 L 27.324219 31.410156 L 32.882812 31.410156 L 32.882812 35.847656 C 32.882812 36.785156 33.386719 37.25 34.433594 37.25 C 35.640625 37.25 36.222656 36.589844 36.222656 35.304688 L 36.222656 33.515625 C 36.222656 32.65625 35.445312 31.605469 33.851562 30.320312 L 29.734375 27.089844 C 28.257812 25.726562 27.519531 24.402344 27.519531 23.117188 L 27.519531 20.394531 C 27.519531 17.511719 29.8125 16.074219 34.433594 16.074219 C 36.765625 16.074219 38.476562 16.421875 39.5625 17.125 C 40.886719 17.980469 41.585938 19.460938 41.585938 21.601562 Z M 41.585938 21.601562 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 48.964844 39.507812 L 43.527344 39.507812 L 43.527344 16.734375 L 48.964844 16.734375 Z M 48.964844 39.507812 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 65.050781 35.65625 C 65.050781 37.171875 64.234375 38.339844 62.566406 39.160156 C 61.28125 39.820312 59.769531 40.132812 58.058594 40.132812 C 56.308594 40.132812 54.792969 39.820312 53.550781 39.160156 C 51.878906 38.339844 51.027344 37.171875 51.027344 35.65625 L 51.027344 20.511719 C 51.027344 18.992188 51.878906 17.824219 53.550781 17.007812 C 54.832031 16.382812 56.308594 16.074219 58.058594 16.074219 C 59.730469 16.074219 61.246094 16.382812 62.566406 17.007812 C 64.234375 17.824219 65.050781 18.992188 65.050781 20.511719 Z M 59.613281 35.773438 L 59.613281 20.238281 C 59.613281 19.304688 59.070312 18.835938 58.019531 18.835938 C 56.96875 18.835938 56.425781 19.304688 56.425781 20.238281 L 56.425781 35.773438 C 56.425781 36.746094 56.96875 37.210938 58.019531 37.210938 C 59.070312 37.210938 59.613281 36.707031 59.613281 35.773438 Z M 59.613281 35.773438 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 81.136719 39.507812 L 75.699219 39.507812 L 75.699219 20.433594 C 75.699219 19.460938 75.152344 18.992188 74.105469 18.992188 C 73.054688 18.992188 72.511719 19.460938 72.511719 20.433594 L 72.511719 39.507812 L 67.070312 39.507812 L 67.070312 20.511719 C 67.070312 18.992188 67.886719 17.824219 69.558594 17.007812 C 70.878906 16.382812 72.394531 16.074219 74.105469 16.074219 C 75.773438 16.074219 77.289062 16.382812 78.613281 17.007812 C 80.28125 17.824219 81.097656 18.992188 81.097656 20.511719 L 81.097656 39.507812 Z M 81.136719 39.507812 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(9.019608%,33.72549%,53.72549%);fill-opacity:1;" d="M 95.28125 39.507812 L 83.078125 39.507812 L 83.078125 36.863281 L 89.453125 19.652344 L 83.234375 19.652344 L 83.234375 16.734375 L 95.28125 16.734375 L 95.28125 19.421875 L 88.984375 36.589844 L 95.28125 36.589844 Z M 95.28125 39.507812 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(9.019608%,33.72549%,53.72549%);fill-opacity:1;" d="M 109.265625 39.507812 L 97.222656 39.507812 L 97.222656 16.773438 L 109.265625 16.773438 L 109.265625 19.847656 L 102.699219 19.847656 L 102.699219 25.570312 L 109.113281 25.570312 L 109.113281 28.570312 L 102.699219 28.570312 L 102.699219 36.355469 L 109.265625 36.355469 Z M 109.265625 39.507812 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(9.019608%,33.72549%,53.72549%);fill-opacity:1;" d="M 125.117188 39.46875 L 119.679688 39.46875 L 119.679688 31.410156 C 119.679688 30.125 118.785156 29.503906 117 29.503906 L 116.609375 29.503906 L 116.609375 39.46875 L 111.171875 39.46875 L 111.171875 20.511719 C 111.171875 18.992188 111.988281 17.824219 113.65625 17.007812 C 114.976562 16.382812 116.492188 16.074219 118.203125 16.074219 C 119.914062 16.074219 121.390625 16.382812 122.710938 17.007812 C 124.34375 17.824219 125.15625 18.992188 125.15625 20.511719 L 125.15625 24.597656 C 125.15625 26.777344 123.757812 27.984375 121 28.140625 C 123.757812 28.375 125.15625 29.464844 125.15625 31.410156 L 125.15625 39.46875 Z M 119.953125 24.597656 L 119.953125 21.71875 C 119.953125 19.808594 119.367188 18.875 118.203125 18.875 C 117.152344 18.875 116.609375 19.34375 116.609375 20.238281 L 116.609375 26.933594 L 116.648438 26.933594 C 118.863281 26.933594 119.953125 26.15625 119.953125 24.597656 Z M 119.953125 24.597656 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(9.019608%,33.72549%,53.72549%);fill-opacity:1;" d="M 141.125 35.65625 C 141.125 37.171875 140.3125 38.339844 138.640625 39.160156 C 137.359375 39.820312 135.84375 40.132812 134.132812 40.132812 C 132.382812 40.132812 130.871094 39.820312 129.625 39.160156 C 127.957031 38.339844 127.101562 37.171875 127.101562 35.65625 L 127.101562 20.511719 C 127.101562 18.992188 127.957031 17.824219 129.625 17.007812 C 130.90625 16.382812 132.382812 16.074219 134.132812 16.074219 C 135.804688 16.074219 137.320312 16.382812 138.640625 17.007812 C 140.3125 17.824219 141.125 18.992188 141.125 20.511719 Z M 135.6875 35.773438 L 135.6875 20.238281 C 135.6875 19.304688 135.144531 18.835938 134.09375 18.835938 C 133.046875 18.835938 132.5 19.304688 132.5 20.238281 L 132.5 35.773438 C 132.5 36.746094 133.046875 37.210938 134.09375 37.210938 C 135.144531 37.210938 135.6875 36.707031 135.6875 35.773438 Z M 135.6875 35.773438 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 23.554688 8.832031 L 21.769531 8.832031 C 21.496094 8.832031 21.304688 8.636719 21.304688 8.363281 C 21.304688 8.089844 21.496094 7.898438 21.769531 7.898438 L 23.554688 7.898438 C 23.828125 7.898438 24.023438 8.089844 24.023438 8.363281 C 24.023438 8.636719 23.828125 8.832031 23.554688 8.832031 Z M 21.769531 7.976562 C 21.574219 7.976562 21.417969 8.128906 21.417969 8.324219 C 21.417969 8.519531 21.574219 8.675781 21.769531 8.675781 L 23.554688 8.675781 C 23.75 8.675781 23.90625 8.519531 23.90625 8.324219 C 23.90625 8.128906 23.75 7.976562 23.554688 7.976562 Z M 21.769531 7.976562 "/><path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 21.964844 7.9375 L 23.050781 7.976562 L 23.671875 7.976562 L 23.945312 8.246094 L 23.984375 8.402344 L 23.90625 8.558594 L 23.867188 8.675781 L 23.554688 8.792969 L 21.691406 8.792969 L 21.378906 8.558594 L 21.417969 8.089844 L 21.691406 7.9375 Z M 21.964844 7.9375 "/></g></svg></a><div class="vzmobile">  <button class="nav-trigger btn btn-default visible-xs" aria-haspopup="true" aria-expanded="false"><span>Toggle Menu</span></button></div>',filters:'\n      <div class="filters__wrapper">\n      <button class="filters__closebutton js-toggleFilters">\n        <span class="glyphicon glyphicon-menu-right"></span>\n        <span class="sr-only">Toggle the filters menu open or closed</span>\n      </button>\n      <section class="filters__content">\n\n      <h3>Filters\n      <button class="btn btn-link btn-sm select-all js-reset-all">Reset All</button></h3>\n\n        <div class="content-element" id="accordion-element" role="group">\n          <div style="text-align: right; font-size: 12px; margin-bottom: 10px;padding-top:10px">\n          <button onclick="$(\'.collapse\').collapse(\'show\');">\n          <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 256 256" aria-hidden="true"><defs><style>.a{fill:#bbb;}</style></defs><path class="a" d="M185.07,128c0,3.53-2.87,6-6.4,6H134v44.67c0,3.53-2.47,6.4-6,6.4s-6-2.87-6-6.4V134H77.33c-3.54,0-6.4-2.47-6.4-6s2.87-6,6.4-6H122V77.33c0-3.53,2.47-6.4,6-6.4s6,2.87,6,6.4V122h44.67C182.2,122,185.07,124.47,185.07,128ZM256,128A128,128,0,1,0,128,256,128.14,128.14,0,0,0,256,128Zm-12.8,0A115.2,115.2,0,1,1,128,12.8,115.33,115.33,0,0,1,243.2,128Z"/></svg> <strong class="accordion">Expand All</strong></button> &nbsp;\n          <button onclick="$(\'.collapse\').collapse(\'hide\');"><svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 256 256" aria-hidden="true"><defs><style>.a{fill:#bbb; margin-top:15px;}</style></defs><path class="a" d="M77.33,134c-3.54,0-6.4-2.47-6.4-6s2.87-6,6.4-6H178.67c3.53,0,6.4,2.47,6.4,6s-2.87,6-6.4,6ZM256,128A128,128,0,1,0,128,256,128.14,128.14,0,0,0,256,128Zm-12.8,0A115.2,115.2,0,1,1,128,12.8,115.33,115.33,0,0,1,243.2,128Z"/></svg> <strong class="accordion">Collapse All</strong></button>\n          </div>\n          \x3c!-- Accordion Panel: Collisions ---\x3e\n            <div class="panel panel-default" id="accordion-panel-1">\n              <div class="panel-heading" id="heading-collisions">\n                <h2 class="panel-title">\n                  <button class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-collisions" aria-expanded="false" aria-controls="collapse-collisions" id="heading1">Collisions <span>[2008-Present]</span></button>\n                </h2>\n              </div>\n              <div id="collapse-collisions" class="panel-collapse collapse" aria-labelledby="heading1">\n                <div class="panel-body">\n                  <div class="warningtext"></div>\n                  <div class="row yearsWrapper">\n                      <h4>Years</h4>\n                    <div class="col-sm-4 col-lg-2 year_form">\n                      <label for="year_from" class="control-label">From</label>\n                    </div>\n                    <div class="col-sm-8 col-lg-4 year_form">\n                      <select name="year_from" id="year_from" class="form-control js-years">\n                    '+function(){for(var t=[],e=2008;e<=today_year;e++)t.push(e);return t}().map(function(t){return"\n                      <option"+(t==today_year-4?' selected="selected"':"")+' value="'+t+'">'+t+"</option>\n                    "}).join("")+'\n                    </select>\n                    </div>\n\n                    <div class="col-sm-4 col-lg-2 year_form">\n                      <label for="year_to" class="control-label">To</label>\n                    </div>\n                    <div class="col-sm-8 col-lg-4 year_form">\n                      <select name="year_to" id="year_to" class="form-control js-years">\n                    '+function(){for(var t=[],e=2008;e<=today_year;e++)t.push(e);return t}().map(function(t){return"\n                      <option"+(t==today_year?' selected="selected"':"")+' value="'+t+'">'+t+"</option>\n                    "}).join("")+'\n                    </select>\n                    </div>\n                  </div>\n\n                  <div class="customCheckbox">\n                    <label for="allcollisions">All Collisions</label>\n                    <input type="checkbox" name="allcollisions" id="allcollisions" value="1" checked="checked" class="allcollisions js-toggle-select" data-target="collisions">\n                  </div>\n                  '+heat_map_button+'\n                  <h4>Type</h4>\n                    <div class="customCheckbox">\n                      <label for="collisions1"><svg width="12" height="12" aria-hidden="true"><circle cx="6" cy="6" r="4" stroke="#e41a1c" fill="#e41a1c" stroke-width="3"/></svg> Fatality</label>\n                      <span data-toggle="tooltip" tabindex="0" data-placement="top" data-original-title="Fatality : A collision resulting in a death."><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">Fatality : A collision resulting in a death. </span></span>\n                      <input type="checkbox" name="injury" id="collisions1" value="4" checked="checked" class="collisions">\n                    </div>\n                    <div class="customCheckbox">\n                      <label for="collisions2"><svg width="12" height="12" aria-hidden="true"><circle cx="6" cy="6" r="4" stroke="#E26A6A" fill="#fff" stroke-width="3"/></svg> Seriously Injured </label><span data-toggle="tooltip" tabindex="0" data-placement="top" data-original-title="Seriously Injured: A collision resulting in a serious injury."><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">Seriously Injured: A collision resulting in a serious injury.</span></span>\n                      <input type="checkbox" name="injury" id="collisions2" value="3" checked="checked" class="collisions">\n                    </div>\n\n                    <h4>Mode of Travel</h4>\n                      <div class="customCheckbox">\n                        <label for="collision3">Pedestrian</label>\n                        <span data-toggle="tooltip" tabindex="0" data-placement="top" data-original-title="Pedestrian: A person travelling by foot"><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">Pedestrian: A person travelling by foot.</span></span>\n\n                        <input type="checkbox" name="involvement_type" id="collision3" value="pedestrians" checked="checked" class="collisions">\n                      </div>\n                      <div class="customCheckbox">\n                        <label for="collision4">Cyclist</label>\n                        <span data-toggle="tooltip" tabindex="0" data-placement="top" data-original-title="Cyclist: A person travelling by bicycle."><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">Cyclist: A person travelling by bicycle.</span></span>\n                        <input type="checkbox" name="involvement_type" id="collision4" value="bike" checked="checked" class="collisions">\n                      </div>\n                      <div class="customCheckbox">\n                        <label for="collision5">Motorcyclist</label>\n                        <span data-toggle="tooltip" tabindex="0" data-placement="top" data-original-title="Motorcyclist: A person who rides a two-wheeled vehicle that is powered by a motor and has no pedals"><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">Motorcyclist: A person who rides a two-wheeled vehicle that is powered by a motor and has no pedals</span></span>\n\n                        <input type="checkbox" name="involvement_type" id="collision5" value="cycle" checked="checked" class="collisions">\n                      </div>\n                      <div class="customCheckbox">\n                        <label for="collision6">Motorist</label>\n                        <span data-toggle="tooltip" tabindex="0" data-placement="top" data-original-title="Motorist: A driver or passenger in an automobile."><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">Motorist: A driver or passenger in an automobile.</span></span>\n                        <input type="checkbox" name="involvement_type" id="collision6" value="car" checked="checked" class="collisions">\n                      </div>\n\n                      <h4>Ages</h4>\n                        <div class="customCheckbox">\n                          <label for="collision7">Children (0-14)</label>\n                          <input type="checkbox" name="involved_age" id="collision7" value="1" checked="checked" class="collisions">\n                        </div>\n                          <div class="customCheckbox">\n                            <label for="collision8">Youth (15-24)</label>\n                            <input type="checkbox" name="involved_age" id="collision8" value="2" checked="checked" class="collisions">\n                          </div>\n                        <div class="customCheckbox">\n                          <label for="collision9">Adults (25-64)</label>\n                          <input type="checkbox" name="involved_age" id="collision9" value="3" checked="checked" class="collisions">\n                        </div>\n                        <div class="customCheckbox">\n                          <label for="collision10">Seniors (65+)</label>\n                          <input type="checkbox" name="involved_age" id="collision10" value="4" checked="checked" class="collisions">\n                        </div>\n                  </div>\n                </div>\n              </div>\n\n          \x3c!-- Accordion Panel: safetymeasures ---\x3e\n              <div class="panel panel-default" id="accordion-panel-2">\n                <div class="panel-heading" id="heading-safetymeasures">\n                  <h2 class="panel-title">\n                    <button class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-safetymeasures" aria-expanded="false" aria-controls="collapse-safetymeasures" id="heading2">Safety Measures <span>[July 2016-Present]</span></button>\n                  </h2>\n                </div>\n                <div id="collapse-safetymeasures" class="panel-collapse collapse" aria-labelledby="heading2">\n                  <div class="panel-body">\n                    <div class="warningtext">\x3c!-- Data is available from July 1, 2016. --\x3e</div>\n\n                    <div class="row yearsWrapper">\n                        <h4>Years</h4>\n                      <div class="col-sm-4 col-lg-2 year_form2">\n                        <label for="year_from2" class="control-label">From</label>\n                      </div>\n                      <div class="col-sm-8 col-lg-4 year_form2">\n                        <select name="year_from2" id="year_from2" class="form-control js-years2">\n                      '+function(){for(var t=[],e=2016;e<=today_year;e++)t.push(e);return t}().map(function(t){return"\n                        <option"+(t==today_year-4?' selected="selected"':"")+' value="'+t+'">'+t+"</option>\n                      "}).join("")+'\n                      </select>\n                      </div>\n\n                      <div class="col-sm-4 col-lg-2 year_form">\n                        <label for="year_to2" class="control-label">To</label>\n                      </div>\n                      <div class="col-sm-8 col-lg-4 year_form2">\n                        <select name="year_to2" id="year_to2" class="form-control js-years2">\n                      '+function(){for(var t=[],e=2016;e<=today_year;e++)t.push(e);return t}().map(function(t){return"\n                        <option"+(t==today_year?' selected="selected"':"")+' value="'+t+'">'+t+"</option>\n                      "}).join("")+"\n                      </select>\n                      </div>\n                    </div>\n\n                  "+_SAFETY_MEASURES.map(function(t,e){return'\n                    <div class="customCheckbox"><h4>\n                    <label for="cat'+e+'"><svg width="12" height="12" aria-hidden="true">\n                    <circle cx="6" cy="6" r="4" stroke="'+t.cat_iconColor+'" fill="'+t.cat_iconColor+'" stroke-width="3"/></svg> '+t.cat_title+'\n                    </label>\n                    <input type="checkbox" name="allsafetymeasures" id="cat'+e+'" value="1" class="safetymeasures js-toggle-select" data-target="safetymeasures-cat'+e+'">\n                    </h4></div>\n                    '+t.cat_subcat.map(function(t,i){return'\n                      <div class="customCheckbox">\n                        <label for="safetymeasures'+e+"-"+i+'">'+t.subcat_title+'</label>\n                        <span data-toggle="tooltip" tabindex="0" data-placement="top" data-original-title="'+t.subcat_title+": "+t.subcat_info+'"><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">'+t.subcat_title+": "+t.subcat_info+'</span></span>\n                        <input type="checkbox" name="'+t.subcat_featureLayer+'" id="safetymeasures'+e+"-"+i+'" value="'+t.subcat_id+'" class="safetymeasures safetymeasures-cat'+e+'">\n                      </div>\n                    '}).join("")+"\n                  "}).join("")+'\n\n                  </div>\n                </div>\n              </div>\n\n              \x3c!-- Accordion Panel: Supporting Layers ---\x3e\n                <div class="panel panel-default" id="accordion-panel-3">\n                  <div class="panel-heading" id="heading-supportinglayers">\n                    <h2 class="panel-title">\n                      <button class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-supportinglayers" aria-expanded="false" aria-controls="collapse-supportinglayers" id="heading3">Supporting Layers</button>\n                    </h2>\n                  </div>\n                  <div id="collapse-supportinglayers" class="panel-collapse collapse" aria-labelledby="heading3">\n                    <div class="panel-body">\n                      '+_SUPPORTING_LAYERS.map(function(t,e){return'\n                        <div class="customCheckbox">\n                          <label for="supportinglayers'+e+'"><svg width="12" height="12" aria-hidden="true"><circle cx="6" cy="6" r="4" stroke="'+t.iconColor+'" fill="'+t.iconColor+'" stroke-width="3"/></svg> '+t.title+'</label>\n                          <input type="checkbox" name="supportinglayers" id="supportinglayers'+e+'" value="'+e+'" class="supportinglayers js-toggle-supportinglayer" '+(t.isActive?'checked="checked"':"")+">\n                        </div>\n                      "}).join("")+'\n                        <div class="warningtext warningtext--bottom"><strong>Coming Soon:</strong> Supporting contextual data layers such as school locations, senior facility locations etc.</div>\n                    </div>\n                  </div>\n                </div>\n\n        </div>\n      </div>\n      </div>',searchbar:'\n      <button class="js-search-trigger search-trigger btn btn-default visible-xs-block"><span class="glyphicon glyphicon-search" aria-hidden="true"></span><span class="label-icon sr-only">Show search options</span></button>\n      <div class="searchmenu clearfix hidden-xs">\n        <ul>\n          <li class="searchli"><form role="search" id="map_search" class="map_search">\n          <fieldset>\n          <label class="sr-only" for="sTerm" id="searchMapTitle">Search address or intersection</label>\n          <div class="input-group input-group-md">\n          <input type="text" name="sTerm" id="sTerm" class="form-control" placeholder="Search address or intersection" spellcheck="false" autocomplete="off"  aria-owns="rListbox" role="combobox" aria-readonly="true" aria-autocomplete="list" aria-haspopup="true" aria-labelledby="searchMapTitle">\n          <div class="input-group-btn">\n          <button type="submit" class="btn btn-primary" id="searchButton"><span class="glyphicon glyphicon-search" aria-hidden="true"></span><span class="label-icon sr-only">Find Location</span></button>\n          </div>\n          </div>\n          </fieldset>\n          <div class="sResults hidden" tabindex="-1">\n            <div class="statusLine" role="status" aria-live="polite">\n\n            </div>\n            <div class="res" role="listbox" aria-expanded="false" id="rListbox"></div>\n          </div>\n          </form>\n          <div id="sResults" class="sResults vzhidden"></div></li>\n          <li class="wardsli">\n          <label class="sr-only" for="wardSelect" id="wardselectTitle">Select a Ward</label>\n          <select class="form-control ward_number" id="wardSelect" aria-labelledby="wardselectTitle" disabled>\n            <option value="0">Select a Ward </option>\n          </select><button class="btn btn-default"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span><span class="sr-only">Reset the wards selection</span></button></li>\n        </ul>\n      </div>',maplist:'\n      <div class="btn-group"><button class="btn btn-default btn-primary" data-viewmode="map" aria-pressed="true"><span class="glyphicon glyphicon-list" aria-hidden="true"></span><span class="sr-only">View </span> Map</button><button class="btn btn-default" data-viewmode="list" aria-pressed="false"><span class="glyphicon glyphicon-list" aria-hidden="true"></span><span class="sr-only">View </span> List</button></div>',homebutton:'\n      <button class="btn btn-default leaflet-control-homebutton js-home" title="Back to original state"><span class="glyphicon glyphicon-home"></span><span class="sr-only">Back to original state</span></button>',panelmenu:'\n      <div class="topMenu topMenu--links clearfix">\n      <ul>\n        <li><a href="#menuTarget" class="btn btn-link" data-action="about" title="Visit About page">About</a></li>\n        <li><a href="#menuTarget" class="btn btn-link" data-action="glossary" title="Visit Glossary page">Glossary</a></li>\n        <li><a href="#menuTarget" class="btn btn-link" data-action="contactus" title="Visit Contact page">Contact Us</a></li>\n        \x3c!--\n        <li><a href="http://www.toronto.ca" target="_blank" class="btn btn-link">Data</a></li>\n        --\x3e\n      </ul>\n      </div>',panels:'\n      <div class="panels__wrapper">\n      <div class="js-closePanel">\n        <a name="menuTarget" id="menuTarget"></a><button class="btn btn-default"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span><span class="sr-only">Close the panel</span></button></div>\n      <div class="vzpanels">\n        '+Object.keys(_PANEL_CONTENT).map(function(t){return'<div class="vzpanel vzpanel-'+t+' vzhidden">\n        '+_PANEL_CONTENT[t]+"\n        </div>"}).join("")+"\n      </div>\n      </div>"}},_utils=function(t,e,i){function n(t,e){var i=Math.PI*t.lat/180,n=Math.PI*e.lat/180,r=t.lng-e.lng,o=Math.PI*r/180,s=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos(o);return s=180*Math.acos(s)/Math.PI*60*1.1515*1.609344}function r(t,e){var i=s.SAFETY_MEASURES.filter(function(e){return e.cat_subcat.some(function(e){return e.subcat_id===t})});return!(1!=i.length||!i[0].hasOwnProperty(e))&&i[0][e]}function o(t,e){var i=s.SAFETY_MEASURES.filter(function(e){return e.cat_subcat.some(function(e){return e.subcat_id===t})});if(1==i.length){var n=i[0].cat_subcat.filter(function(e){return e.subcat_id===t});if(1==n.length&&n[0].hasOwnProperty(e))return n[0][e]}return!1}var s=e._config||{};return{distanceBetween:n,getSafetymeasureFeatureFromProperty:r,getSafetymeasureSubfeatureFromProperty:o}}(jQuery,window,document);!function(t,e,i){"use strict";function n(){t(".panels__wrapper").css("height",t("#"+y).height()-145),t(".filters__wrapper").css("height",t("#"+y).height()-145)}function r(t,e,i,n){return'<li class="listviewCard listviewCard--'+t+'" style="border-left:10px solid '+e+'">\n      <h3>'+i+"</h3>\n      <dl>\n        "+Object.keys(n).map(function(t){return""!=n[t]?"\n          <dt>"+t+":</dt>\n          <dd>"+n[t]+"</dd>\n        ":""}).join("")+"\n      </dl>\n    </li>"}function o(t,e,i,n){return'<div class="markerPopup markerPopup--'+t+'">\n      <h3 style="background-color:'+e+'">'+i+"</h3>\n      <dl>\n        "+Object.keys(n).map(function(t){return""!=n[t]?"\n          <dt>"+t+":</dt>\n          <dd>"+n[t]+"</dd>\n        ":""}).join("")+"\n      </dl>\n      </div>"}function s(){var e=[],i=[],n=[],o=[],s=".collisions,.safetymeasures, .js-toggle-select, .js-heatmap-toggle";t(s).prop("disabled",!0);var a=t("#year_from").val(),u=t("#year_to").val(),l=t("#year_from2").val(),c=t("#year_to2").val();e.push("ACCIDENT_YEAR BETWEEN "+a+" AND "+u),i.push("year BETWEEN "+l+" AND "+c),n.push("year BETWEEN "+l+" AND "+c),o.push("year BETWEEN "+l+" AND "+c);var h=[];t('[name="injury"]:checked').each(function(){h.push(t(this).val())}),e.push("INJURY IN ("+h.join(",")+")");var f=[];t('[name="involvement_type"]:checked').each(function(){switch(t(this).val()){case"pedestrians":f.push("03"),f.push("17"),f.push("19"),f.push("20");break;case"bike":f.push("04"),f.push("05"),f.push("21");break;case"cycle":f.push("06"),f.push("07"),f.push("08"),f.push("09");break;case"car":f.push("01"),f.push("02"),f.push("18"),f.push("22")}}),e.push("INVOLVEMENT_TYPE IN ("+f.map(function(t){return"'"+t+"'"}).join(",")+")");var d=[];t('[name="involved_age"]:checked').each(function(){switch(t(this).val()){case"1":d.push("0 to 4"),d.push("5 to 9"),d.push("10 to 14");break;case"2":d.push("15 to 19"),d.push("20 to 24");break;case"3":d.push("25 to 29"),d.push("30 to 34"),d.push("35 to 39"),d.push("40 to 44"),d.push("45 to 49"),d.push("50 to 54"),d.push("55 to 59"),d.push("60 to 64");break;case"4":d.push("65 to 69"),d.push("70 to 74"),d.push("75 to 79"),d.push("80 to 84"),d.push("85 to 89"),d.push("90 to 94"),d.push("Over 95")}}),e.push("INVOLVED_AGE IN ("+d.map(function(t){return"'"+t+"'"}).join(",")+")");var p=t(".ward_number").val(),m=t(".ward_number option:selected").data("area");0!=p&&(e.push("(WARD_NUMBER = '"+m+"' OR WARD_NUMBER LIKE '"+m+",%' OR WARD_NUMBER LIKE '%,"+m+",%' OR WARD_NUMBER LIKE '%,"+m+"')"),i.push("WARD_NUMBER='"+m+"'"),n.push("(WARD_NUMBER = '"+m+"' OR WARD_NUMBER LIKE '"+m+",%' OR WARD_NUMBER LIKE '%,"+m+",%' OR WARD_NUMBER LIKE '%,"+m+"')"),o.push("(WARD_NUMBER = '"+m+"' OR WARD_NUMBER LIKE '"+m+",%' OR WARD_NUMBER LIKE '%,"+m+",%' OR WARD_NUMBER LIKE '%,"+m+"')"));var b=[];t('[name="safetymeasure_points"]:checked').each(function(){b.push(t(this).val())}),i.push("SAFETY_PROGRAM_TYPE IN ("+b.map(function(t){return"'"+t+"'"}).join(",")+")");var x=i.join(" AND "),w=[];t('[name="safetymeasure_lines"]:checked').each(function(){
w.push(t(this).val())}),n.push("SAFETY_PROGRAM_TYPE IN ("+w.map(function(t){return"'"+t+"'"}).join(",")+")");var S=n.join(" AND "),T=[];t('[name="safetymeasure_polygons"]:checked').each(function(){T.push(t(this).val())}),o.push("SAFETY_PROGRAM_TYPE IN ("+T.map(function(t){return"'"+t+"'"}).join(",")+")");var M=o.join(" AND "),E={lat:_[y].map.getCenter().lat.toFixed(6),lng:_[y].map.getCenter().lng.toFixed(6)};v.hasClass("listMode")?t.when(function(){var i=t.Deferred();return 0==h.length||0==f.length||0==d.length?i.resolve([]):_[y].featureLayerList.collision.fl.query().where(e.join(" AND ")).run(function(t,e){var n=[];e&&e.features.forEach(function(t,e){var i=new Date(t.properties.ACCIDENT_DATE),o={year:"numeric",month:"long",day:"numeric"},s=t.properties.ACCIDENT_TIME?t.properties.ACCIDENT_TIME.split(":"):[];n.push({distance:g.distanceBetween(E,{lat:t.properties.LATITUDE,lng:t.properties.LONGITUDE}),card:r("collision",_.INJURY_COLOR[t.properties.INJURY],_.INJURY[t.properties.INJURY],{"Mode of travel":_.INVOLVEMENT_TYPE[t.properties.INVOLVEMENT_TYPE],Age:t.properties.INVOLVED_AGE,Location:t.properties.STREET1+(""!=t.properties.STREET2.trim()?" / "+t.properties.STREET2:""),Date:i.toLocaleDateString("en-CA",o),Time:3==s.length?s[0]+":"+s[1]:"n/a"})})}),i.resolve(n)}),i.promise()}(),function(){var e=t.Deferred();return 0==b.length?e.resolve([]):_[y].featureLayerList.sm_points.fl.query().where(x).run(function(t,i){var n=[];i&&i.features.forEach(function(t,e){var i=new Date(t.properties.DT),o=g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_isOnlyYear")?{year:"numeric"}:{year:"numeric",month:"long",day:"numeric"};n.push({distance:g.distanceBetween(E,{lat:t.geometry.coordinates[1],lng:t.geometry.coordinates[0]}),card:r("safetymeasure",g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor"),g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_title"),{Type:g.getSafetymeasureSubfeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"subcat_title"),Location:t.properties.LOC.trim(),Date:i.toLocaleDateString("en-CA",o),Details:t.properties.DETAILS.trim()})})}),e.resolve(n)}),e.promise()}(),function(){var e=t.Deferred();return 0==w.length?e.resolve([]):_[y].featureLayerList.sm_lines.fl.query().where(S).run(function(t,i){var n=[];i&&i.features.forEach(function(t,e){var i=new Date(t.properties.DT),o=g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_isOnlyYear")?{year:"numeric"}:{year:"numeric",month:"long",day:"numeric"},s=L.latLngBounds(t.geometry.coordinates).getCenter();n.push({distance:g.distanceBetween(E,{lat:s.lng,lng:s.lat}),card:r("safetymeasure",g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor"),g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_title"),{Type:g.getSafetymeasureSubfeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"subcat_title"),Location:t.properties.LOC.trim(),Date:i.toLocaleDateString("en-CA",o),Details:t.properties.DETAILS.trim()})})}),e.resolve(n)}),e.promise()}(),function(){var e=t.Deferred();return 0==T.length?e.resolve([]):_[y].featureLayerList.sm_polygons.fl.query().where(M).run(function(t,i){var n=[];i&&i.features.forEach(function(t,e){var i=new Date(t.properties.DT),o=g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_isOnlyYear")?{year:"numeric"}:{year:"numeric",month:"long",day:"numeric"},s=L.latLngBounds(t.geometry.coordinates).getCenter();n.push({distance:g.distanceBetween(E,{lat:s.lng,lng:s.lat}),card:r("safetymeasure",g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor"),g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_title"),{Type:g.getSafetymeasureSubfeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"subcat_title"),Location:t.properties.LOC.trim(),Date:i.toLocaleDateString("en-CA",o),Details:t.properties.DETAILS.trim()})})}),e.resolve(n)}),e.promise()}()).done(function(e,i,n,r){var o=[].concat(_toConsumableArray(e),_toConsumableArray(i),_toConsumableArray(n),_toConsumableArray(r));if(o.length>0){o.sort(function(t,e){return t.distance-e.distance}),t(".list-results").html(" ");for(var a=0;a<o.length&&(t(".list-results").append(o[a].card),!(a>99));a++);}else t(".list-results").html("There is no results. Try to change Filters settings.");t(s).prop("disabled",!1)}):(t(".list-results").html("Loading data..."),t.when(function(){var i=t.Deferred();return 0==h.length||0==f.length||0==d.length?(_[y].map.removeLayer(_[y].featureLayerList.collision.fl),i.resolve(!0)):(_[y].map.hasLayer(_[y].featureLayerList.collision.fl)||_[y].map.addLayer(_[y].featureLayerList.collision.fl),_[y].featureLayerList.collision.fl.setWhere(e.join(" AND "),function(){i.resolve(!0)})),i.promise()}(),function(){var e=t.Deferred();return 0==b.length?(_[y].map.removeLayer(_[y].featureLayerList.sm_points.fl),e.resolve(!0)):(_[y].map.hasLayer(_[y].featureLayerList.sm_points.fl)||_[y].map.addLayer(_[y].featureLayerList.sm_points.fl),_[y].featureLayerList.sm_points.fl.setWhere(x,function(){e.resolve(!0)})),e.promise()}(),function(){var e=t.Deferred();return 0==w.length?(_[y].map.removeLayer(_[y].featureLayerList.sm_lines.fl),e.resolve(!0)):(_[y].map.hasLayer(_[y].featureLayerList.sm_lines.fl)||_[y].map.addLayer(_[y].featureLayerList.sm_lines.fl),_[y].featureLayerList.sm_lines.fl.setWhere(S,function(){e.resolve(!0)})),e.promise()}(),function(){var e=t.Deferred();return 0==T.length?(_[y].map.removeLayer(_[y].featureLayerList.sm_polygons.fl),e.resolve(!0)):(_[y].map.hasLayer(_[y].featureLayerList.sm_polygons.fl)||_[y].map.addLayer(_[y].featureLayerList.sm_polygons.fl),_[y].featureLayerList.sm_polygons.fl.setWhere(M,function(){e.resolve(!0)})),e.promise()}()).done(function(){t(s).prop("disabled",!1)}))}function a(){e.clearTimeout(b),b=e.setTimeout(s,100)}function u(){v.append('<div id="'+y+'" />'),_[y]=new cot_map(y,{enableControlBox:!1,enableSearchBar:!1,zoom:_.MAP_ZOOM,mapCenter:_.MAP_CENTER,mapType:_.MAP_BASEMAP,mapHeight:_.MAP_HEIGHT,isVectorBasemap:!0,enableFullscreen:!1,zoomControl:!1,maxZoom:_.MAP_MAXZOOM}),_[y].render(),L.control.scale({position:"bottomright",imperial:!1}).addTo(_[y].map),_[y].map.zoomControl.remove(),_[y].map.createPane("wards"),_[y].map.createPane("sm_polygons_pane"),_[y].map.createPane("sm_lines_pane"),_[y].map.createPane("sm_points_pane"),_[y].map.createPane("collisions_pane"),_[y].map.on("moveend",function(){n()})}function l(){function e(e){v.addClass("openPanels"),t(".vzpanel").addClass("vzhidden").prop("hidden",!0),t(".vzpanel-"+e).removeClass("vzhidden").prop("hidden",!1),n()}function r(){v.removeClass("openPanels"),t(".vzpanel").addClass("vzhidden").prop("hidden",!0)}var o=L.control({position:"topleft"});o.onAdd=function(t){var e=L.DomUtil.create("div","vzlogo");return e.innerHTML=_.MENU_CONTENT.logo,e},o.addTo(_[y].map),L.DomEvent.disableClickPropagation(o._container).disableScrollPropagation(o._container);var s=L.control({position:"topleft"});s.onAdd=function(t){var e=L.DomUtil.create("div","panels-menu");return e.innerHTML=_.MENU_CONTENT.panelmenu,e},s.addTo(_[y].map),L.DomEvent.disableClickPropagation(s._container).disableScrollPropagation(s._container);var u=L.control({position:"topleft"});u.onAdd=function(t){var e=L.DomUtil.create("div","searchbar");return e.innerHTML=_.MENU_CONTENT.searchbar,e},u.addTo(_[y].map),L.DomEvent.disableClickPropagation(u._container).disableScrollPropagation(u._container);var l=L.control({position:"topleft"});l.onAdd=function(t){var e=L.DomUtil.create("div","maplistmenu");return e.innerHTML=_.MENU_CONTENT.maplist,e},l.addTo(_[y].map),L.DomEvent.disableClickPropagation(l._container).disableScrollPropagation(l._container);var c=L.control({position:"topleft"});c.onAdd=function(t){var e=L.DomUtil.create("div","filters");return e.innerHTML=_.MENU_CONTENT.filters,e},c.addTo(_[y].map),L.DomEvent.disableClickPropagation(c._container).disableScrollPropagation(c._container),t(i).width()>767&&v.addClass("openFilters"),t(".js-toggleFilters").on("click",function(){v.toggleClass("openFilters")}),t(".nav-trigger").on("click",function(){v.toggleClass("vzmobileOpen")});var h=L.control({position:"topleft"});h.onAdd=function(t){var e=L.DomUtil.create("div","panels");return e.innerHTML=_.MENU_CONTENT.panels,e},h.addTo(_[y].map),L.DomEvent.disableClickPropagation(h._container).disableScrollPropagation(h._container),t(".js-closePanel").on("click",function(){t('[data-viewmode="map"]').trigger("click")}),L.control.zoom({position:"topleft"}).addTo(_[y].map);var f=L.control({position:"topleft"});f.onAdd=function(t){var e=L.DomUtil.create("div","homebutton");return e.innerHTML=_.MENU_CONTENT.homebutton,e},f.addTo(_[y].map),L.DomEvent.disableClickPropagation(f._container).disableScrollPropagation(f._container),t(".js-home").on("click",function(){_[y].map.flyTo(_[y].options.mapCenter,_[y].options.zoom)});L.control.fullscreen({position:"topleft",title:"See the map in fullscreen",titleCancel:"Exit fullscreen mode",content:'<span class="glyphicon glyphicon-fullscreen"></span><span class="label-icon sr-only">Display the map in fullscreen</span>',forceSeparateButton:!0,forcePseudoFullscreen:!1}).addTo(_[y].map);_[y].map.on("enterFullscreen",function(){setTimeout(n,1e3)}),_[y].map.on("exitFullscreen",function(){setTimeout(n,1e3)});var d=L.control({position:"topleft"});d.onAdd=function(t){var e=L.DomUtil.create("div","vz-preloader");return e.innerHTML='\n        <div id="loading-indicator" role="alert" aria-labelledby="loading-indicator-label"\n        class="preloader hidden">\n            <label id="loading-indicator-label" class="sr-only">Loading</label>\n            <div class="loader loader--small">Loading...</div>\n        </div>',e},d.addTo(_[y].map),L.DomEvent.disableClickPropagation(d._container).disableScrollPropagation(d._container),Cookies.get("vzdisclaimer")||(Cookies.set("vzdisclaimer","yes",{expires:7}),CotApp.showModal({body:_.DISCLAIMER_CONTENT,originatingElement:t(".vzlogo a"),modalSize:"modal-lg"})),t("[data-action]").on("click",function(){var i=t(this),n=i.data("action");if(t(".js-search-trigger.btn-primary").trigger("click"),v.removeClass("vzmobileOpen"),i.hasClass("btn-primary"))i.removeClass("btn-primary"),t("[data-viewmode].btn-primary").trigger("click");else if(_.PANEL_CONTENT.hasOwnProperty(n))t("[data-action]").removeClass("btn-primary"),i.addClass("btn-primary"),e(n);else switch(n){case"opendata":r(),alert("custom action for "+n)}}),t("[data-viewmode]").on("click",function(){var i=t(this),n=i.data("viewmode");v.removeClass("vzmobileOpen"),t("button[data-action],button[data-viewmode]").removeClass("btn-primary"),i.addClass("btn-primary"),"map"==n?(r(),t(".js-search-trigger.btn-primary").trigger("click"),v.removeClass("listMode")):(e(n),v.addClass("listMode")),a()}),t(i).keyup(function(e){27==e.keyCode&&t('[data-viewmode="map"]').trigger("click"),(event.ctrlKey||event.metaKey)&&70==event.which&&(event.preventDefault(),t("#sTerm").focus())}),n()}function c(){t('[aria-controls="collapse-collisions"]').trigger("click"),t(".filters__wrapper").delegate(".js-select-all","click",function(){var e=t(this),i=e.data("target");t("."+i).not(":checked").each(function(){t(this).prop("checked",!0)}),a()}).delegate(".js-reset-all","click",function(){t("#year_from").find('[value="'+(today_year-4)+'"]').prop("selected",!0),t("#year_to").find('[value="'+today_year+'"]').prop("selected",!0),t("#year_from2").find('[value="'+(today_year-2)+'"]').prop("selected",!0),t("#year_to2").find('[value="'+today_year+'"]').prop("selected",!0),t(".collisions, .allcollisions").not(":checked").each(function(){t(this).prop("checked",!0)}),t(".safetymeasures, .allsafetymeasures").filter(":checked").each(function(){t(this).prop("checked",!1)}),a(),t(".supportinglayers").each(function(){t(this).prop("checked",!0).trigger("click")})}).delegate(".js-toggle-select","click",function(){var e=t(this),i=e.data("target");e.is(":checked")?t("."+i).prop("checked",!0):t("."+i).prop("checked",!1),a()}).delegate(".js-toggle-supportinglayer","click",function(){var e=t(this),i=e.val(),n=_.SUPPORTING_LAYERS[i];e.is(":checked")?_[y].featureLayerList.hasOwnProperty(n.id)?_[y].featureLayerList[n.id].fl.addTo(_[y].map):(_[y].addFeatureLayer({id:n.id,title:n.title,enableClustering:!1,addToControlBox:!1,url:n.url,pointToLayer:function(t,e){return L.circleMarker(e,{color:n.iconColor,fillColor:n.iconColor,fillOpacity:1,radius:3})}}),_[y].featureLayerList[n.id].fl.bindPopup(function(t){return L.Util.template('<div class="markerPopup markerPopup--supportinglayer">\n              <h3 style="background-color:'+n.iconColor+'">Supporting Layer : '+n.title+"</h3>\n              "+n.template+"\n              </div>",t.feature.properties)},{minWidth:400,maxWidth:400,autoPanPaddingTopLeft:L.point(0,200)})):_[y].map.removeLayer(_[y].featureLayerList[n.id].fl)}).delegate(".js-heatmap-toggle","click",function(){f(t(this).is(":checked")?"heatmap":"cluster"),a()}),t(".years, .safetymeasures, .collisions").on("change",a),t(".js-years").on("change",function(){var e=t(this),i=t("year_from"==e.attr("name")?"#year_to":"#year_from");t("#year_from").val()>t("#year_to").val()&&i.find('[value="'+e.val()+'"]').prop("selected",!0),a()}),t(".js-years2").on("change",function(){var e=t(this),i=t("year_from2"==e.attr("name")?"#year_to2":"#year_from2");t("#year_from2").val()>t("#year_to2").val()&&i.find('[value="'+e.val()+'"]').prop("selected",!0),a()}),t('[data-toggle="tooltip"]').tooltip()}function h(){function i(){t(".sResults").addClass("hidden"),t(".statusLine").removeClass("statusLine--error").html("")}function n(e){var i={f:"json",keyString:e,retRowLimit:10};t.ajax({url:l+"?"+t.param(i),type:"GET",jsonpCallback:"jQueryFindAddressCandidates_1380876031040",contentType:"application/json",dataType:"jsonp"}).done(function(e){1==e.result.rows.length?(_[y].map.flyTo([e.result.rows[0].LATITUDE,e.result.rows[0].LONGITUDE],15),L.popup().setLatLng([e.result.rows[0].LATITUDE,e.result.rows[0].LONGITUDE]).setContent('<div class="popupSearch">'+e.result.rows[0].KEY_DESC+"</div>").openOn(_[y].map),t(".leaflet-popup-close-button").focus(),a()):alert("Error : multiple results for the same address (?)")})}function r(){t(".wardsli.resetOn button").trigger("click");var e=t(".map_search input").val().trim();t(".map_search input").on("focus",function(){i()});var n={f:"json",addressOnly:0,retRowLimit:31,searchString:e};return t.ajax({method:"GET",url:u+"?"+t.param(n),type:"GET",jsonpCallback:"jQueryFindAddressCandidates_1380876031040",contentType:"application/json",dataType:"jsonp"}).done(function(i){f=i.result.rows.length>10?10:i.result.rows.length,i.result.rows.length>0?(t(".sResults").removeClass("hidden").find(".statusLine").html('<div class="row">\n            <div class="col-xs-12" id="rListTitle">'+(i.result.rows.length>30?"More than 30":""+i.result.rows.length)+" result"+(1==i.result.rows.length?"":"s")+":</div>\n          </div>"),t(".statusLine").append('\n            <div role="listbox" aria-expanded="true" id="rListbox">\n              <div class="row" role="presentation">\n                  <div role="group" aria-labelledby="rListTitle">\n                    '+i.result.rows.map(function(t,i){if(i<10)return'\n                    <div class="col-xs-12 sResultsList" role="option" id="res'+t.KEYSTRING.replace(":","-")+'"><button tabindex="-1" class="js-getLocationAndDisplay resultbutton btn btn-link" data-keystring="'+t.KEYSTRING+'">'+t.ADDRESS.replace(new RegExp("("+e+")","i"),'<span class="hlgt">$1</span>')+"</button>\n                    </div>\n                    "}).join("")+"\n\n                </div>\n              </div>\n            </div>")):t(".sResults").removeClass("hidden").find(".statusLine").addClass("statusLine--error").html('<div class="row">\n            <div class="col-xs-12 statusError">We are sorry, we were unable to locate "'+e+'". Make sure your search is spelled correctly</div>\n          </div>')}),!1}function o(){var e=t(".resultbutton").index(t(".isActive"));e--,e<0&&(e=f-1),t(".resultbutton").removeClass("isActive");var i=t(".resultbutton").eq(e).text(),n=t(".sResultsList").eq(e).attr("id");t(".resultbutton").eq(e).addClass("isActive"),t("#sTerm").val(i).attr("aria-activedescendant",n)}function s(){var e=t(".resultbutton").index(t(".isActive"));(++e<0||e>=f)&&(e=0);var i=t(".resultbutton").eq(e).text(),n=t(".sResultsList").eq(e).attr("id");t(".resultbutton").removeClass("isActive"),t(".resultbutton").eq(e).addClass("isActive"),t("#sTerm").val(i).attr("aria-activedescendant",n)}t(".js-search-trigger").on("click",function(){t(this).toggleClass("btn-primary"),v.toggleClass("searchMobileOpen"),t(".searchmenu").toggleClass("hidden-xs")});var u=_.URL.GEOCODING+"/suggest",l=_.URL.GEOCODING+"/findAddressCandidates",c=t(".sResults"),h=null,f=0;c.delegate(".js-getLocationAndDisplay","click",function(e){var r=t(this);n(r.data("keystring")),t(".map_search input").val(r.text()),i()}),t(".map_search").on("submit",r).find("input").on("keydown",function(n){switch(n.keyCode){case 220:n.preventDefault();break;case 37:case 39:break;case 38:0==t(".sResults.hidden").length&&o(),n.preventDefault();break;case 9:0==t(".sResults.hidden").length&&(s(),n.preventDefault());break;case 27:i(),t("#sTerm").attr("aria-activedescendant","").val(""),n.preventDefault();break;case 40:0==t(".sResults.hidden").length&&s(),n.preventDefault();break;case 13:0==t(".sResults.hidden").length?(t(".resultbutton.isActive").trigger("click"),t("#sTerm").attr("aria-activedescendant","")):(e.clearTimeout(h),h=e.setTimeout(function(){r()},500)),n.preventDefault();break;case 8:default:e.clearTimeout(h),h=e.setTimeout(function(){r()},500)}})}function f(e){var i=t.Deferred();return e=e||"heatmap",_.hasOwnProperty("currentState")&&_.currentState==e||(_.currentState=e,_[y].featureLayerList.hasOwnProperty("collision")&&_[y].map.removeLayer(_[y].featureLayerList.collision.fl),_.currentState,_[y].addFeatureLayer({id:"collision",title:"Collisions",pane:"collisions_pane",enableClustering:!0,maxClusterRadius:20,addToControlBox:!1,loadByDefault:!1,animate:!0,animateAddingMarkers:!0,url:_.URL.COLLISION,pointToLayer:function(t,e){return"4"==t.properties.INJURY?L.circleMarker(e,{color:"#e41a1c",fillColor:"#e41a1c",fillOpacity:1,radius:5}):L.circleMarker(e,{color:"#E26A6A",fillColor:!1,fillOpacity:0,radius:5})},where:"1=0",iconCreateFunction:function(e){var i=e.getChildCount(),n=t("#collisions1").is(":checked"),r=t("#collisions2").is(":checked"),o=n&&r?"both":n?"fat":"inj";return new L.divIcon({html:"<span>"+i+"</span>",iconSize:null,className:"customCluster customCluster--"+(i<20?"s":i<50?"m":"l")+" customCluster--"+o})}}),_[y].featureLayerList.collision.fl.bindPopup(function(t){var e=new Date(t.feature.properties.ACCIDENT_DATE),i={year:"numeric",month:"long",day:"numeric"},n=t.feature.properties.ACCIDENT_TIME&&""!=t.feature.properties.ACCIDENT_TIME.trim()?t.feature.properties.ACCIDENT_TIME.split(":"):[];return L.Util.template(o("collision",_.INJURY_COLOR[t.feature.properties.INJURY],_.INJURY[t.feature.properties.INJURY],{"Mode of travel":_.INVOLVEMENT_TYPE[t.feature.properties.INVOLVEMENT_TYPE],Age:"{INVOLVED_AGE}",Location:"{STREET1}"+(""!=t.feature.properties.STREET2.trim()?" / "+t.feature.properties.STREET2:""),Date:e.toLocaleDateString("en-CA",i),Time:3==n.length?n[0]+":"+n[1]:"n/a"}),t.feature.properties)},{minWidth:400,maxWidth:400,autoPanPaddingTopLeft:L.point(0,200)}),_[y].featureLayerList.collision.fl.on("load",function(){i.resolve("true")})),i.promise()}function d(){function e(){if(1==t(".ward_number option").length){var e=Object.keys(_.allWards).sort(function(t,e){return _.allWards[t].AREA_SHORT_CODE-_.allWards[e].AREA_SHORT_CODE});t(".ward_number").append(e.map(function(t){return'<option value="'+t+'" data-area="'+_.allWards[t].AREA_SHORT_CODE+'">'+_.allWards[t].AREA_NAME+"</option>"}).join("")),t(".wardsli select").prop("disabled",!1)}a()}_.allWards={},t(".wardsli").delegate(".ward_number","change",function(){var e=t(this).val(),i=_[y].featureLayerList.wards.fl;if(i.resetStyle(),0!=e){t(".wardsli").addClass("resetOn");var n=i.getFeature(e).getBounds();_[y].map.flyToBounds(n),i.setFeatureStyle(e,{color:"rgba(23, 86, 137, 0.7)",fill:!1,weight:2})}else _[y].map.flyTo(_[y].options.mapCenter,_[y].options.zoom),t(".wardsli").removeClass("resetOn");a()}).delegate("button","click",function(){t(".ward_number").val(0).trigger("change")}),_[y].addFeatureLayer({id:"wards",title:"Wards",pane:"wards",enableClustering:!1,addToControlBox:!1,url:_.URL.WARDS,style:function(t){return{color:!1,fill:!1,weight:0}},onEachFeature:function(t){_.allWards[t.id]=t.properties}}),_[y].featureLayerList.wards.fl.on("load",e)}function p(){function e(e,i){e&&t("#collapse-collisions .warningtext").prepend('<div class="lastupdate"><span style="float:right" data-toggle="dt-tooltip" tabindex="0" data-placement="top" data-original-title="Collision records are the result of police investigations and may not be available until up to 30 days after a collision has taken place."><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">Collision records are the result of police investigations and may not be available until up to 30 days after a collision has taken place. </span></span>Last reported collision:<br>'+e+" </div>"),i&&t("#collapse-safetymeasures .warningtext").prepend('<div class="lastupdate"><span style="float:right" data-toggle="dt-tooltip" tabindex="0" data-placement="top" data-original-title="Safety measure layers are updated by staff from programs across the Division at varying frequencies, ranging from daily to semi-annually."><i class="glyphicon glyphicon-info-sign" aria-hidden="true"></i><span class="sr-only">Safety measure layers are updated by staff from programs across the Division at varying frequencies, ranging from daily to semi-annually. </span></span>Last reported installation:<br>'+i+" </div>"),t('[data-toggle="dt-tooltip"]').tooltip()}function i(e,i){var n=t.Deferred(),r="/query?where=1%3D1&outFields="+i+"&orderByFields="+i+"+DESC&resultRecordCount=1&f=json";return t.ajax({url:e+r,method:"GET",success:function(t){var e=JSON.parse(t);e.hasOwnProperty("features")&&n.resolve(parseInt(e.features[0].attributes[i]))}}),n.promise()}_[y].addFeatureLayer({id:"sm_points",pane:"sm_points_pane",title:"Safety Measures Points",enableClustering:!1,addToControlBox:!1,url:_.URL.SM_POINTS,loadByDefault:!1,pointToLayer:function(t,e){var i=g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor");return L.circleMarker(e,{color:i,fillColor:i,fillOpacity:1,radius:3})},where:"1=0",iconCreateFunction:function(t){var e=t.getChildCount();return new L.divIcon({html:"<span>"+e+"</span>",iconSize:null,className:"customClusterSM customClusterSM--"+(e<40?"s":e<100?"m":"l")})}}),_[y].featureLayerList.sm_points.fl.bindPopup(function(t){var e=new Date(t.feature.properties.DT),i=g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_isOnlyYear")?{year:"numeric"}:{year:"numeric",month:"long",day:"numeric"};return L.Util.template(o("safetymeasure",g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor"),g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_title")||"Safety Measure",{Type:g.getSafetymeasureSubfeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"subcat_title"),Location:t.feature.properties.LOC.trim(),"Installation Date":e.toLocaleDateString("en-CA",i),Details:t.feature.properties.DETAILS.trim()}),t.feature.properties)},{minWidth:400,maxWidth:400,autoPanPaddingTopLeft:L.point(0,200)}),_[y].addFeatureLayer({id:"sm_lines",pane:"sm_lines_pane",title:"Safety Measures Lines",enableClustering:!1,addToControlBox:!1,url:_.URL.SM_LINES,loadByDefault:!1,style:function(t){return{color:g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor"),opacity:.9,weight:3,dashArray:!!g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_isDotted")&&"6,10",lineJoin:"round"}},where:"1=0"}),_[y].featureLayerList.sm_lines.fl.bindPopup(function(t){var e=new Date(t.feature.properties.DT),i=g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_isOnlyYear")?{year:"numeric"}:{year:"numeric",month:"long",day:"numeric"};return L.Util.template(o("safetymeasure",g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor"),g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_title")||"Safety Measure",{Type:g.getSafetymeasureSubfeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"subcat_title"),Location:t.feature.properties.LOC,"Installation Date":e.toLocaleDateString("en-CA",i),Details:t.feature.properties.DETAILS.trim()}),t.feature.properties)},{minWidth:400,maxWidth:400,autoPanPaddingTopLeft:L.point(0,200)}),_[y].addFeatureLayer({id:"sm_polygons",pane:"sm_polygons_pane",title:"Safety Measures Polygons",enableClustering:!1,addToControlBox:!1,url:_.URL.SM_POLYGONS,loadByDefault:!1,style:function(t){return{color:g.getSafetymeasureFeatureFromProperty(t.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor"),opacity:.9,weight:3}},where:"1=0"}),_[y].featureLayerList.sm_polygons.fl.bindPopup(function(t){var e=new Date(t.feature.properties.DT),i=g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_isOnlyYear")?{year:"numeric"}:{year:"numeric",month:"long",day:"numeric"};return L.Util.template(o("safetymeasure",g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_iconColor"),g.getSafetymeasureFeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"cat_title")||"Safety Measure",{Type:g.getSafetymeasureSubfeatureFromProperty(t.feature.properties.SAFETY_PROGRAM_TYPE,"subcat_title"),Location:t.feature.properties.LOC.trim(),"Installation Date":e.toLocaleDateString("en-CA",i),Details:t.feature.properties.DETAILS.trim()}),t.feature.properties)},{minWidth:400,maxWidth:400,autoPanPaddingTopLeft:L.point(0,200)});var n=void 0,r=void 0;if(Cookies.get("fetchedflag")){var s=Cookies.get("fetchedflag").split("|||");n=s[0]||!1,r=s[1]||!1,e(n,r)}else t.when(i(_.URL.SM_POINTS,"DT"),i(_.URL.SM_LINES,"DT"),i(_.URL.SM_POLYGONS,"DT"),i(_.URL.COLLISION,"ACCIDENT_DATE")).done(function(t,i,o,s){var a=[t,i,o].sort().reverse(),u={year:"numeric",month:"long",day:"numeric"};r=new Date(a[0]),r=r.toLocaleDateString("en-CA",u),n=new Date(s),n=n.toLocaleDateString("en-CA",u),Cookies.set("fetchedflag",n+"|||"+r,{expires:1}),e(n,r)})}function m(){_.SUPPORTING_LAYERS.forEach(function(t){_[y].map.createPane(t.pane),t.url=_.URL[t.url],_[y].addFeatureLayer(t)})}var _=e._config||{},g=e._utils||{},v=t("#"+_.APPNAME+"_container"),y=_.MAP_CONTAINER,b=(t("#"+y),null);t(i).ready(function(){t.ajax({url:_.APP_CONFIG+"visionzero_url",method:"GET",success:function(t){_.URL=t},error:function(t,e,i){v.html("Application failed to load. Please try again later.")}}).done(function(){u(),l(),c(),h(),f(),d(),p(),m()})})}(jQuery,window,document);